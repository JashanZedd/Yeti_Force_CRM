/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */
const e={dev:window.env.Env.dev,modules:{},getPath:e=>"src"===e.substring(0,3)?e.substring(4).replace(/\\/gi,"/"):"src"===e.substring(2,5)?e.substring(6).replace(/\\/gi,"/"):"string"==typeof e?e.replace(/\\/gi,"/"):void console.error("unknown path",e),attachRoute(e,t,o){for(const o of e)o.name===t.parent?(void 0===o.children&&(o.children=[]),o.children.push(t)):void 0!==o.children&&this.attachRoute(o.children,t)},prepareRoutes(e,t){return t?t.map(t=>{const o={...t};return o.children=[],void 0===o.componentPath?o:("/"!==o.componentPath.substring(0,1)?o.component=(()=>(this.dev&&console.log(`Loading ${this.getPath(e.path)}/${t.componentPath}${this.dev?"?dev="+(new Date).getTime():""}`),import(`/src/${this.getPath(e.path)}/${t.componentPath}${this.dev?"?dev="+(new Date).getTime():""}`))):o.component=(()=>(this.dev&&console.log(`Loading /src/${t.componentPath.substring(1)}${this.dev?"?dev="+(new Date).getTime():""}`),import(`/src/${t.componentPath.substring(1)}${this.dev?"?dev="+(new Date).getTime():""}`))),void 0!==t.children&&this.prepareRoutes(e,t.children).forEach(e=>o.children.push(e)),o)}):[]},attachRoutes(e,t){this.prepareRoutes(t,void 0!==t?t.routes:[]).forEach(o=>{"string"==typeof o.parent?this.attachRoute(e,o,t):e.push(o)})},loadRoutes(e,t){for(const o of t)this.attachRoutes(e,o),void 0!==o.modules&&this.loadRoutes(e,o.modules);return e},getModule(e,t){for(let o of t){if(o.fullName===e)return o;if(void 0!==o.modules){let t=null;if(t=this.getModule(e,o.modules))return t}}return null},prepareStoreNames(e,t){const o=this.getModule(e,window.modules);if(void 0===o.store)return t;const n={...t};for(let e in t)if(void 0!==o.store[e]){n[e]={};for(let s in t[e])n[e][o.store[e][s]]=t[e][s]}return n},_flattenModules(e,t={components:{},modules:[]}){for(const o of e){if(void 0!==o.entry){const e=this.getPath(o.entry);t.components[o.name]={module:o,component(){return this.dev&&console.log(`importing /src/${e}${this.dev?"?dev="+(new Date).getTime():""}`),import(`/src/${e}${this.dev?"?dev="+(new Date).getTime():""}`)}},t.modules.push({component:t.components[o.name].component,...o})}void 0!==o.modules&&(t=this._flattenModules(o.modules,t))}return t},flattenModules(e,t=!0){const o=this._flattenModules(e);return o.modules.sort((e,t)=>t.priority-e.priority),t&&(o.modules=o.modules.filter(e=>!!e.autoLoad||(delete o.components[e.fullName],!1))),o}};"undefined"!=typeof window&&(window.ModuleLoader=e),"undefined"!=typeof global&&(global.ModuleLoader=e);export default e;