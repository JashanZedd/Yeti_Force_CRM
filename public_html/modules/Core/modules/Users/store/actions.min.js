/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */
import e from"/src/services/Login.min.js";import r from"/src/store/getters.min.js";import o from"/src/store/mutations.min.js";export default{fetchData({commit:o,rootGetters:t},s){e({url:t[r.Core.Url.get](`Users.${s}.getData`),method:"POST"}).then(e=>{o("Global/update",{Core:e.data.env})}),o("Global/update",{Core:{Env:{layout:"material",layouts:["material","ios"]},Language:{defaultLanguage:"en-US",lang:"en-US",langs:["pl-PL","en-US"]},Users:{isBlockedIp:!1,message:"",messageType:"",loginPageRememberCredentials:!0,forgotPassword:!0,languageSelection:!0,layoutSelection:!0}}})},login({commit:t,rootGetters:s},{formData:a,vm:l}){e({url:s[r.Core.Url.get]("Users.Login.login"),data:a,method:"POST"}).then(e=>{const r=e.data;if(!0===r.result)t("Global/update",{Core:r.env}),t(o.Core.Users.isLoggedIn,!0),this.$router.replace("/");else if("2fa"===r.result)this.$router.replace("/users/login/2FA");else{if(void 0===r.error)return console.error("Server error",e);Quasar.plugins.Notify.create({color:"negative",icon:"mdi-exclamation",message:l.$t(r.error.message,"Users"),position:"top",actions:[{label:l.$t("LBL_CLOSE"),color:"white"}]})}})},logout({commit:t,rootGetters:s}){e({url:s[r.Core.Url.get]("Users.Login.logout"),method:"POST"}).then(e=>{!0===e.data.result&&(t(o.Core.Users.isLoggedIn,!1),this.$router.replace("/users/login"))})},remind({commit:o,rootGetters:t},s){e({url:t[r.Core.Url.get]("Users.remind"),data:s,method:"POST"}).then(e=>{this.$router.replace("/users/login/form")})}};