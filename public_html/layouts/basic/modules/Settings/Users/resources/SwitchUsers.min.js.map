{"version":3,"file":"SwitchUsers.min.js","sources":["SwitchUsers.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class('Settings_Users_SwitchUsers_Js', {}, {\n\tregisterAdd: function (content) {\n\t\tvar thisInstance = this;\n\t\tcontent.find('.addItem').on('click', function (e) {\n\t\t\tvar data = [];\n\t\t\tcontent.find('.switchUsersTable tbody tr').each(function (index) {\n\t\t\t\tdata.push({\n\t\t\t\t\tuser: $(this).find('.sufrom').val(),\n\t\t\t\t});\n\t\t\t});\n\t\t\tvar id = parseInt(content.find('#suCount').val()) + 1;\n\t\t\tvar cloneItem = content.find('.cloneItem tbody').clone(true, true);\n\t\t\tvar suFrom = cloneItem.find('.sufrom option')\n\t\t\tsuFrom.each(function (index, option) {\n\t\t\t\t$.each(data, function (key, selectedUser) {\n\t\t\t\t\tif ($(option).val() == selectedUser.user) {\n\t\t\t\t\t\tcloneItem.find(option).remove()\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tcloneItem.find('tr').attr('data-id', id).addClass('row' + id);\n\t\t\tcontent.find('.switchUsersTable tbody').append(cloneItem.html());\n\t\t\tcontent.find('#suCount').val(id);\n\t\t\tthisInstance.registerDelete(content.find('tr.row' + id));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(content.find('tr.row' + id).find('select'));\n\t\t});\n\t},\n\tregisterDelete: function (content) {\n\t\tcontent.find('.delate').on('click', function (e) {\n\t\t\tvar target = $(e.currentTarget);\n\t\t\ttarget.closest('tr').remove();\n\t\t});\n\t},\n\tregisterSave: function (content) {\n\t\tcontent.find('.saveItems').on('click', function (e) {\n\t\t\tvar data = [];\n\t\t\tcontent.find('.switchUsersTable tbody tr').each(function (index) {\n\t\t\t\tif ($(this).find('.suto :selected').length > 0) {\n\t\t\t\t\tdata.push({\n\t\t\t\t\t\tuser: $(this).find('.sufrom').val(),\n\t\t\t\t\t\taccess: $(this).find('.suto').val(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tapp.saveAjax('saveSwitchUsers', data).done(function (data) {\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage({type: 'success', text: data.result.message});\n\t\t\t});\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tvar content = $('.contentsDiv');\n\t\tthis.registerAdd(content);\n\t\tthis.registerDelete(content);\n\t\tthis.registerSave(content);\n\t}\n});\n"],"names":["jQuery","Class","content","thisInstance","find","on","e","data","each","index","push","$","val","id","parseInt","cloneItem","clone","suFrom","option","key","selectedUser","user","remove","attr","addClass","append","html","registerDelete","Fields","Picklist","showSelect2ElementView","target","currentTarget","closest","length","saveAjax","done","showMessage","type","text","result","message","registerAdd","registerSave"],"mappings":";;AAAA;AACA;AAEAA,OAAOC,KAAP,CAAa,+BAAb,EAA8C,EAA9C,EAAkD;cACpC,qBAAUC,OAAV,EAAmB;MAC3BC,eAAe,IAAnB;UACQC,IAAR,CAAa,UAAb,EAAyBC,EAAzB,CAA4B,OAA5B,EAAqC,UAAUC,CAAV,EAAa;OAC7CC,OAAO,EAAX;WACQH,IAAR,CAAa,4BAAb,EAA2CI,IAA3C,CAAgD,UAAUC,KAAV,EAAiB;SAC3DC,IAAL,CAAU;WACHC,EAAE,IAAF,EAAQP,IAAR,CAAa,SAAb,EAAwBQ,GAAxB;KADP;IADD;OAKIC,KAAKC,SAASZ,QAAQE,IAAR,CAAa,UAAb,EAAyBQ,GAAzB,EAAT,IAA2C,CAApD;OACIG,YAAYb,QAAQE,IAAR,CAAa,kBAAb,EAAiCY,KAAjC,CAAuC,IAAvC,EAA6C,IAA7C,CAAhB;OACIC,SAASF,UAAUX,IAAV,CAAe,gBAAf,CAAb;UACOI,IAAP,CAAY,UAAUC,KAAV,EAAiBS,MAAjB,EAAyB;MAClCV,IAAF,CAAOD,IAAP,EAAa,UAAUY,GAAV,EAAeC,YAAf,EAA6B;SACrCT,EAAEO,MAAF,EAAUN,GAAV,MAAmBQ,aAAaC,IAApC,EAA0C;gBAC/BjB,IAAV,CAAec,MAAf,EAAuBI,MAAvB;;KAFF;IADD;aAOUlB,IAAV,CAAe,IAAf,EAAqBmB,IAArB,CAA0B,SAA1B,EAAqCV,EAArC,EAAyCW,QAAzC,CAAkD,QAAQX,EAA1D;WACQT,IAAR,CAAa,yBAAb,EAAwCqB,MAAxC,CAA+CV,UAAUW,IAAV,EAA/C;WACQtB,IAAR,CAAa,UAAb,EAAyBQ,GAAzB,CAA6BC,EAA7B;gBACac,cAAb,CAA4BzB,QAAQE,IAAR,CAAa,WAAWS,EAAxB,CAA5B;OACIe,MAAJ,CAAWC,QAAX,CAAoBC,sBAApB,CAA2C5B,QAAQE,IAAR,CAAa,WAAWS,EAAxB,EAA4BT,IAA5B,CAAiC,QAAjC,CAA3C;GArBD;EAHgD;iBA2BjC,wBAAUF,OAAV,EAAmB;UAC1BE,IAAR,CAAa,SAAb,EAAwBC,EAAxB,CAA2B,OAA3B,EAAoC,UAAUC,CAAV,EAAa;OAC5CyB,SAASpB,EAAEL,EAAE0B,aAAJ,CAAb;UACOC,OAAP,CAAe,IAAf,EAAqBX,MAArB;GAFD;EA5BgD;eAiCnC,sBAAUpB,OAAV,EAAmB;UACxBE,IAAR,CAAa,YAAb,EAA2BC,EAA3B,CAA8B,OAA9B,EAAuC,UAAUC,CAAV,EAAa;OAC/CC,OAAO,EAAX;WACQH,IAAR,CAAa,4BAAb,EAA2CI,IAA3C,CAAgD,UAAUC,KAAV,EAAiB;QAC5DE,EAAE,IAAF,EAAQP,IAAR,CAAa,iBAAb,EAAgC8B,MAAhC,GAAyC,CAA7C,EAAgD;UAC1CxB,IAAL,CAAU;YACHC,EAAE,IAAF,EAAQP,IAAR,CAAa,SAAb,EAAwBQ,GAAxB,EADG;cAEDD,EAAE,IAAF,EAAQP,IAAR,CAAa,OAAb,EAAsBQ,GAAtB;MAFT;;IAFF;OAQIuB,QAAJ,CAAa,iBAAb,EAAgC5B,IAAhC,EAAsC6B,IAAtC,CAA2C,UAAU7B,IAAV,EAAgB;6BACjC8B,WAAzB,CAAqC,EAACC,MAAM,SAAP,EAAkBC,MAAMhC,KAAKiC,MAAL,CAAYC,OAApC,EAArC;IADD;GAVD;EAlCgD;iBAiDjC,0BAAY;MACvBvC,UAAUS,EAAE,cAAF,CAAd;OACK+B,WAAL,CAAiBxC,OAAjB;OACKyB,cAAL,CAAoBzB,OAApB;OACKyC,YAAL,CAAkBzC,OAAlB;;CArDF"}