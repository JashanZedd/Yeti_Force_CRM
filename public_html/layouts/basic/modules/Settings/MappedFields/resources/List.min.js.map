{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nSettings_Vtiger_List_Js(\"Settings_MappedFields_List_Js\", {}, {\n\tgetListContainer: function () {\n\t\treturn jQuery('#listViewContainer');\n\t},\n\tregisterFilterChangeEvent: function () {\n\t\tvar thisInstance = this;\n\t\tjQuery('#moduleFilter').on('change', function (e) {\n\t\t\tjQuery('#pageNumber').val(\"1\");\n\t\t\tjQuery('#pageToJump').val('1');\n\t\t\tjQuery('#orderBy').val('');\n\t\t\tjQuery(\"#sortOrder\").val('');\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tsourceModule: jQuery(e.currentTarget).val()\n\t\t\t}\n\t\t\t//Make the select all count as empty\n\t\t\tjQuery('#recordsCount').val('');\n\t\t\t//Make total number of pages as empty\n\t\t\tjQuery('#totalPageCount').text(\"\");\n\t\t\tthisInstance.getListViewRecords(params).done(function (data) {\n\t\t\t\tthisInstance.updatePagination();\n\t\t\t\tthisInstance.registerBasic();\n\t\t\t});\n\t\t});\n\t},\n\t/*\n\t * Function to register the list view row click event\n\t */\n\tregisterRowClickEvent: function () {\n\t\tvar listViewContentDiv = this.getListViewContentContainer();\n\t\tlistViewContentDiv.on('click', '.listViewEntries td:not(.tdActions)', function (e) {\n\t\t\tvar editUrl = jQuery(e.currentTarget).parent().find('..fas').closest('a').attr('href');\n\t\t\twindow.location.href = editUrl;\n\t\t});\n\t},\n\tgetDefaultParams: function () {\n\t\tvar pageNumber = jQuery('#pageNumber').val();\n\t\tvar module = app.getModuleName();\n\t\tvar parent = app.getParentModuleName();\n\t\tvar params = {\n\t\t\t'module': module,\n\t\t\t'parent': parent,\n\t\t\t'page': pageNumber,\n\t\t\t'view': \"List\",\n\t\t\tsourceModule: jQuery('#moduleFilter').val()\n\t\t}\n\n\t\treturn params;\n\t},\n\tregisterAddNewTemplate: function (container) {\n\t\tjQuery('#addButton', container).on('click', function () {\n\t\t\tvar selectedModule = jQuery('#moduleFilter option:selected').val();\n\t\t\twindow.location.href = jQuery(this).data('url') + ((selectedModule) ? '&source_module=' + selectedModule : '');\n\t\t});\n\t},\n\tregisterImportTemplate: function (container) {\n\t\tvar thisInstance = this;\n\t\tjQuery('#importButton', container).on('click', function (e) {\n\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\tvar url = currentElement.data('url');\n\t\t\tif (typeof url !== \"undefined\") {\n\t\t\t\tapp.showModalWindow(null, url,\n\t\t\t\t\tfunction (data) {\n\t\t\t\t\t\tvar form = data.find('form');\n\t\t\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\tform.on('submit', function (e) {\n\t\t\t\t\t\t\tvar form = jQuery(e.currentTarget);\n\t\t\t\t\t\t\tvar invalidFields = form.data('jqv').InvalidFields;\n\t\t\t\t\t\t\tif (invalidFields.length > 0) {\n\t\t\t\t\t\t\t\t//If validation fails, form should submit again\n\t\t\t\t\t\t\t\tform.removeData('submit');\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t\t\t\t'position': 'html',\n\t\t\t\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthisInstance.importSave(form).done(function (data) {\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'})\n\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage({text: data.result.message, type: 'info'});\n\t\t\t\t\t\t\t\tjQuery('#moduleFilter').trigger('change');\n\t\t\t\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t});\n\t},\n\timportSave: function (form) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar formData = new FormData(form[0]);\n\t\tvar params = {\n\t\t\turl: \"index.php\",\n\t\t\ttype: \"POST\",\n\t\t\tdata: formData,\n\t\t\tprocessData: false,\n\t\t\tcontentType: false\n\t\t};\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (textStatus, errorThrown) {\n\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tregisterDeleteMap: function () {\n\t\tthis.getListContainer().on('click', '.deleteMap', function (e) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\tvar templateId = $(e.currentTarget).closest('tr').data('id');\n\t\t\tSettings_MappedFields_List_Js.deleteById(templateId);\n\t\t});\n\t},\n\tregisterBasic: function () {\n\t\tthis.registerDeleteMap();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tvar container = this.getListContainer();\n\t\tthis.registerFilterChangeEvent();\n\t\tthis.registerAddNewTemplate(container);\n\t\tthis.registerImportTemplate(container);\n\t\tthis.registerBasic();\n\t}\n});\n"],"names":["Settings_Vtiger_List_Js","jQuery","thisInstance","this","on","e","val","params","app","getModuleName","getParentModuleName","currentTarget","text","getListViewRecords","done","data","updatePagination","registerBasic","getListViewContentContainer","editUrl","parent","find","closest","attr","location","href","pageNumber","container","selectedModule","url","showModalWindow","form","validationEngine","validationEngineOptions","InvalidFields","length","removeData","progressIndicatorElement","progressIndicator","importSave","hideModalWindow","mode","showMessage","result","message","type","trigger","fail","error","err","preventDefault","stopPropagation","aDeferred","Deferred","FormData","request","resolve","textStatus","errorThrown","reject","promise","getListContainer","templateId","$","deleteById","registerDeleteMap","_super","registerFilterChangeEvent","registerAddNewTemplate","registerImportTemplate"],"mappings":"aAGAA,wBAAwB,gCAAiC,GAAI,kBAC1C,kBACVC,OAAO,iDAEY,eACtBC,aAAeC,YACZ,iBAAiBC,GAAG,UAAU,SAAUC,UACvC,eAAeC,IAAI,YACnB,eAAeA,IAAI,YACnB,YAAYA,IAAI,WAChB,cAAcA,IAAI,QACrBC,OAAS,QACJC,IAAIC,uBACJD,IAAIE,mCACET,OAAOI,EAAEM,eAAeL,OAGvCL,OAAO,iBAAiBK,IAAI,WAErB,mBAAmBM,KAAK,iBAClBC,mBAAmBN,QAAQO,MAAK,SAAUC,mBACzCC,gCACAC,6CAOO,WACGd,KAAKe,8BACXd,GAAG,QAAS,uCAAuC,SAAUC,OAC3Ec,QAAUlB,OAAOI,EAAEM,eAAeS,SAASC,KAAK,SAASC,QAAQ,KAAKC,KAAK,eACxEC,SAASC,KAAON,6BAGP,eACbO,WAAazB,OAAO,eAAeK,YAG1B,QAFAE,IAAIC,uBACJD,IAAIE,2BAIRgB,gBACA,oBACMzB,OAAO,iBAAiBK,+BAKhB,SAAUqB,kBAC1B,aAAcA,WAAWvB,GAAG,SAAS,eACvCwB,eAAiB3B,OAAO,iCAAiCK,aACtDkB,SAASC,KAAOxB,OAAOE,MAAMY,KAAK,QAAWa,eAAkB,kBAAoBA,eAAiB,+BAGrF,SAAUD,eAC7BzB,aAAeC,YACZ,gBAAiBwB,WAAWvB,GAAG,SAAS,SAAUC,OAEpDwB,IADiB5B,OAAOI,EAAEM,eACLI,KAAK,YACX,IAARc,SACNC,gBAAgB,KAAMD,KACzB,SAAUd,UACLgB,KAAOhB,KAAKM,KAAK,aAChBW,iBAAiBxB,IAAIyB,8BACrB7B,GAAG,UAAU,SAAUC,OACvB0B,KAAO9B,OAAOI,EAAEM,kBACAoB,KAAKhB,KAAK,OAAOmB,cACnBC,OAAS,OAErBC,WAAW,mBAGbC,yBAA2BpC,OAAOqC,kBAAkB,UAC3C,iBACC,UACD,kBAGAC,WAAWR,MAAMjB,MAAK,SAAUC,UACxCyB,2CACqBF,kBAAkB,CAACG,KAAQ,kCAC3BC,YAAY,CAAC9B,KAAMG,KAAK4B,OAAOC,QAASC,KAAM,gBAChE,iBAAiBC,QAAQ,aAC9BC,MAAK,SAAUC,MAAOC,WAEvBC,0BAIJC,iCAGQ,SAAUpB,UACjBqB,UAAYnD,OAAOoD,WAEnB9C,OAAS,KACP,iBACC,YAHQ,IAAI+C,SAASvB,KAAK,iBAKnB,eACA,uBAEDwB,QAAQhD,QAAQO,MAAK,SAAUC,gBACjCyC,QAAQzC,SAChBgC,MAAK,SAAUU,WAAYC,uBACnBC,OAAOF,WAAYC,gBAEvBN,UAAUQ,6BAEC,gBACbC,mBAAmBzD,GAAG,QAAS,cAAc,SAAUC,KACzD8C,oBACAD,qBACEY,WAAaC,EAAE1D,EAAEM,eAAeW,QAAQ,MAAMP,KAAK,oCACzBiD,WAAWF,8BAG5B,gBACTG,oCAEU,gBACVC,aACDvC,UAAYxB,KAAK0D,wBAChBM,iCACAC,uBAAuBzC,gBACvB0C,uBAAuB1C,gBACvBV"}