{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class('Settings_TreesManager_Edit_Js', {}, {\n\tjstreeInstance: false,\n\tjstreeLastID: 0,\n\tregisterEvents: function () {\n\t\tconst self = this,\n\t\t\teditContainer = $(\"#EditView\"),\n\t\t\tjstreeInstance = self.createTree();\n\t\teditContainer.validationEngine();\n\t\t$('.addNewElementBtn').on('click', () => {\n\t\t\tconst newElement = $('input.addNewElement'),\n\t\t\t\tref = jstreeInstance.jstree(true);\n\t\t\tif (newElement.val() === '') {\n\t\t\t\tconst message = app.vtranslate('JS_FIELD_CAN_NOT_BE_EMPTY');\n\t\t\t\tnewElement.validationEngine('showPrompt', message, 'error', 'bottomLeft', true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tself.jstreeLastID += 1;\n\t\t\tref.create_node('#', {\n\t\t\t\tid: self.jstreeLastID,\n\t\t\t\ttext: newElement.val(),\n\t\t\t\ticon: false\n\t\t\t}, 'last');\n\t\t\tnewElement.val('');\n\t\t});\n\t\t$('.saveTree').on('click', () => {\n\t\t\tjstreeInstance.jstree('deselect_all', true);\n\t\t\tconst json = jstreeInstance.jstree(\"get_json\");\n\t\t\tlet forSave = [];\n\t\t\t$.each(json, function (index, value) {\n\t\t\t\tif (value.text == value.li_attr.text) {\n\t\t\t\t\tvalue.text = value.li_attr.key;\n\t\t\t\t}\n\t\t\t\tforSave[index] = value;\n\t\t\t});\n\t\t\t$('#treeValues').val(JSON.stringify(forSave));\n\t\t\teditContainer.submit();\n\t\t});\n\t\t$('.addNewElement').on('keydown', (event) => {\n\t\t\tif (event.keyCode == 13) {\n\t\t\t\t$('.addNewElementBtn').trigger(\"click\");\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tcreateTree: function () {\n\t\tconst self = this;\n\t\tif (this.jstreeInstance == false) {\n\t\t\tself.jstreeLastID = parseInt($('#treeLastID').val());\n\t\t\tlet treeValues = $('#treeValues').val(),\n\t\t\t\tdata = JSON.parse(treeValues);\n\t\t\tself.jstreeInstance = $(\"#treeContents\");\n\t\t\tself.jstreeInstance.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: data,\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t},\n\t\t\t\t\tcheck_callback: true\n\t\t\t\t},\n\t\t\t\tcontextmenu: {\n\t\t\t\t\titems: {\n\t\t\t\t\t\tcreate: {\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_CREATE'),\n\t\t\t\t\t\t\taction: function (data) {\n\t\t\t\t\t\t\t\tlet treeInstance = $.jstree.reference(data.reference),\n\t\t\t\t\t\t\t\t\tselectedNode = treeInstance.get_node(data.reference);\n\t\t\t\t\t\t\t\tself.jstreeLastID = self.jstreeLastID + 1;\n\t\t\t\t\t\t\t\ttreeInstance.create_node(selectedNode, {\n\t\t\t\t\t\t\t\t\tid: self.jstreeLastID,\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_NEW_ITEM')\n\t\t\t\t\t\t\t\t}, \"last\", function (new_node) {\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\t\t\ttreeInstance.edit(new_node);\n\t\t\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\trename: {\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_RENAME'),\n\t\t\t\t\t\t\taction: function (data) {\n\t\t\t\t\t\t\t\tlet treeInstance = $.jstree.reference(data.reference),\n\t\t\t\t\t\t\t\t\tselectedNode = treeInstance.get_node(data.reference);\n\t\t\t\t\t\t\t\ttreeInstance.edit(selectedNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchangeIcon: {\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_CHANGE_ICON'),\n\t\t\t\t\t\t\taction: function (data) {\n\t\t\t\t\t\t\t\tlet treeInstance = $.jstree.reference(data.reference),\n\t\t\t\t\t\t\t\t\tselectedNode = treeInstance.get_node(data.reference);\n\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.selectIcon().done(function (data) {\n\t\t\t\t\t\t\t\t\tif (data['name'] == '-') {\n\t\t\t\t\t\t\t\t\t\tself.jstreeInstance.jstree(true).set_icon(selectedNode.id, false);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tself.jstreeInstance.jstree(true).set_icon(selectedNode.id, data['name']);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tremove: {\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_REMOVE'),\n\t\t\t\t\t\t\taction: function (data) {\n\t\t\t\t\t\t\t\tlet treeInstance = $.jstree.reference(data.reference),\n\t\t\t\t\t\t\t\t\tid = treeInstance.get_selected(),\n\t\t\t\t\t\t\t\t\tstatus = true;\n\t\t\t\t\t\t\t\t$.each(id, function (index, value) {\n\t\t\t\t\t\t\t\t\tlet menu = treeInstance.get_node(value);\n\t\t\t\t\t\t\t\t\tif (menu.children.length > 0) {\n\t\t\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage({\n\t\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_YOU_CANNOT_DELETE_PERENT_ITEM'),\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tstatus = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (status) {\n\t\t\t\t\t\t\t\t\tself.deleteItemEvent(id, treeInstance).done(function (e) {\n\t\t\t\t\t\t\t\t\t\tif (e.length > 0) {\n\t\t\t\t\t\t\t\t\t\t\t$.each(id, function (index, value) {\n\t\t\t\t\t\t\t\t\t\t\t\ttreeInstance.delete_node(value);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tccp: {\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_CCP'),\n\t\t\t\t\t\t\tsubmenu: {\n\t\t\t\t\t\t\t\tcut: {\n\t\t\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_CUT'),\n\t\t\t\t\t\t\t\t\t\"action\": function (data) {\n\t\t\t\t\t\t\t\t\t\tlet treeInstance = $.jstree.reference(data.reference),\n\t\t\t\t\t\t\t\t\t\t\tselectedNode = treeInstance.get_node(data.reference);\n\t\t\t\t\t\t\t\t\t\tif (treeInstance.is_selected(selectedNode)) {\n\t\t\t\t\t\t\t\t\t\t\ttreeInstance.cut(treeInstance.get_top_selected());\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\ttreeInstance.cut(selectedNode);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tpaste: {\n\t\t\t\t\t\t\t\t\tlabel: app.vtranslate('JS_JSTREE_PASTE'),\n\t\t\t\t\t\t\t\t\t\"action\": function (data) {\n\t\t\t\t\t\t\t\t\t\tlet treeInstance = $.jstree.reference(data.reference),\n\t\t\t\t\t\t\t\t\t\t\tselectedNode = treeInstance.get_node(data.reference);\n\t\t\t\t\t\t\t\t\t\ttreeInstance.paste(selectedNode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplugins: [\"contextmenu\", \"dnd\"]\n\t\t\t});\n\t\t}\n\t\treturn this.jstreeInstance;\n\t},\n\tdeleteItemEvent: function (id, inst) {\n\t\tlet self = this,\n\t\t\taDeferred = jQuery.Deferred(),\n\t\t\tdata = inst.get_json();\n\t\t$.each(id, function (index, id) {\n\t\t\tdata = self.checkChildren(id, data);\n\t\t});\n\t\tif (data.length == 0) {\n\t\t\tSettings_Vtiger_Index_Js.showMessage({\n\t\t\t\ttext: app.vtranslate('JS_YOU_CANNOT_DELETE_ALL_THE_ITEMS'),\n\t\t\t\ttype: 'error'\n\t\t\t})\n\t\t\taDeferred.resolve();\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t\tapp.showModalWindow(null, 'index.php?module=TreesManager&parent=Settings&view=ReplaceTreeItem', function (wizardContainer) {\n\t\t\tlet jstreeInstanceReplace = wizardContainer.find('#treePopupContents');\n\t\t\tjstreeInstanceReplace.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: data,\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}).on(\"loaded.jstree\", function (event, data) {\n\t\t\t\t$(this).jstree(\"open_all\");\n\t\t\t});\n\t\t\twizardContainer.find('.js-modal__save').on('click', () => {\n\t\t\t\tlet selected = jstreeInstanceReplace.jstree(\"get_selected\"),\n\t\t\t\t\treplaceIdsElement = $('#replaceIds'),\n\t\t\t\t\treplaceIds = replaceIdsElement.val(),\n\t\t\t\t\tdata = [];\n\t\t\t\tif (replaceIds !== '') {\n\t\t\t\t\tdata = JSON.parse(replaceIds);\n\t\t\t\t}\n\t\t\t\tif (!selected.length || selected.length > 1) {\n\t\t\t\t\tlet message = 'JS_ONLY_ONE_ITEM_SELECTED';\n\t\t\t\t\tif (!selected.length) {\n\t\t\t\t\t\tmessage = 'JS_NO_ITEM_SELECTED';\n\t\t\t\t\t}\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\ttext: app.vtranslate(message)\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tdata = $.merge(data, [{'old': id, 'new': selected}]);\n\t\t\t\treplaceIdsElement.val(JSON.stringify(data));\n\t\t\t\tapp.hideModalWindow();\n\t\t\t\taDeferred.resolve(selected);\n\t\t\t});\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tcheckChildren: function (id, data) {\n\t\tlet self = this,\n\t\t\tdataNew = [];\n\t\tfor (var key in data) {\n\t\t\tif (data[key].id != id) {\n\t\t\t\tif (data[key].children.length) {\n\t\t\t\t\tdata[key].children = self.checkChildren(id, data[key].children);\n\t\t\t\t}\n\t\t\t\tdataNew.push(data[key]);\n\t\t\t}\n\t\t}\n\t\treturn dataNew;\n\t}\n});\n"],"names":["jQuery","Class","self","editContainer","$","jstreeInstance","createTree","validationEngine","on","newElement","ref","jstree","val","message","app","vtranslate","jstreeLastID","create_node","json","forSave","each","index","value","text","li_attr","key","JSON","stringify","submit","event","keyCode","trigger","preventDefault","parseInt","treeValues","data","parse","treeInstance","reference","selectedNode","get_node","new_node","edit","selectIcon","done","set_icon","id","get_selected","status","menu","children","length","showMessage","deleteItemEvent","e","delete_node","is_selected","cut","get_top_selected","paste","inst","aDeferred","Deferred","get_json","checkChildren","resolve","promise","showModalWindow","wizardContainer","jstreeInstanceReplace","find","selected","replaceIdsElement","replaceIds","merge","hideModalWindow","dataNew","push"],"mappings":"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"}