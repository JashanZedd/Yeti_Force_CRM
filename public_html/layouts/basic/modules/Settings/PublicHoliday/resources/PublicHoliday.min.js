'use strict';

jQuery.Class('Settings_PublicHoliday_Js',{},{registerDeleteHoliday:function c(a){var b=this;a.find('.deleteHoliday').each(function(){jQuery(this).on('click',function(){b.deleteHoliday(jQuery(this).data('holiday-id'));});});},deleteHoliday:function d(a){var b=this,c=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'Holiday',mode:'delete',id:a}).done(function(a){AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),view:'Configuration',async:!1}).done(function(a){jQuery('.contentsDiv').html(a),b.registerEvents(),c.progressIndicator({mode:'hide'});}),Settings_Vtiger_Index_Js.showMessage({text:a.result.message});}).fail(function(){c.progressIndicator({mode:'hide'});});},registerAddDate:function c(){var a=this,b=jQuery('#layoutDashBoards');b.find('.addDateWindow').on('click',function(){var c=b.find('.addDateWindowModal').clone(!0,!0),d=app.vtranslate('JS_ADD_NEW_HOLIDAY');c.find('.modal-title').text(d);var e=function(b){b.find('.addDateWindowModal').removeClass('d-none').show();var c=b.find('.addDateWindowForm');jQuery('[name="holidayId"]').val(''),jQuery(document).find('div.blockOverlay').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),jQuery('.cancelLink').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),c.on('submit',function(b){b.preventDefault();var d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return a.saveNewDate(c).done(function(b){b.success?(Settings_Vtiger_Index_Js.showMessage({text:b.result.message}),AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(b){jQuery('.contentsDiv').html(b),a.registerEvents(),d.progressIndicator({mode:'hide'});})):(d.progressIndicator({mode:'hide'}),Settings_Vtiger_Index_Js.showMessage({text:b.result.message,type:'error'}));}),app.hideModalWindow(),!0});};app.showModalWindow(c,function(a){'function'==typeof e&&e(a);},{width:'1000px'});});},registerEditDate:function c(){var a=this,b=jQuery('#layoutDashBoards');b.find('.editHoliday').on('click',function(){var c=b.find('.addDateWindowModal').clone(!0,!0),d=jQuery(this).closest('.holidayElement');c.find('[name="holidayId"]').val(d.data('holiday-id')),c.find('[name="holidayDate"]').val(d.data('holiday-date')),c.find('[name="holidayName"]').val(d.data('holiday-name')),c.find('[name="holidayType"]').val(d.data('holiday-type'));var e=app.vtranslate('JS_EDIT_HOLIDAY');c.find('.modal-title').text(e);var f=function(b){b.find('.addDateWindowModal').removeClass('d-none').show();var c=b.find('.addDateWindowForm');jQuery('[name="saveButton"]').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return a.saveNewDate(c).done(function(c){c.success?(Settings_Vtiger_Index_Js.showMessage({text:c.result.message}),AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});})):(b.progressIndicator({mode:'hide'}),Settings_Vtiger_Index_Js.showMessage({text:c.result.message,type:'error'}));}),app.hideModalWindow(),!0}),jQuery(document).find('div.blockOverlay').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),jQuery('.cancelLink').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),c.on('submit',function(a){a.preventDefault();});};app.showModalWindow(c,function(a){'function'==typeof f&&f(a);},{width:'1000px'});});},saveNewDate:function d(a){var b=this,c=a.serializeFormData();if(c.module=app.getModuleName(),c.parent=app.getParentModuleName(),c.action='Holiday',c.mode='save',''==c.holidayName||''==c.holidayDate){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate('JS_FILL_FORM_ERROR'),type:'error'});var e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(a){jQuery('.contentsDiv').html(a),b.registerEvents(),e.progressIndicator({mode:'hide'});});}else{var f=jQuery.Deferred();return AppConnector.request(c).done(function(a){f.resolve(a);}).fail(function(a){f.reject(a);}),f.promise()}return !0},registerChangeDate:function c(){var a=this,b=jQuery('.dateFilter');App.Fields.Date.registerRange(b,{ranges:!1}),b.on('apply.daterangepicker',function(b,c){var d=jQuery(b.currentTarget).data('dateFormat').toUpperCase();$(this).val(c.startDate.format(d)+','+c.endDate.format(d));var e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName(),date:'["'+c.startDate.format(d)+'","'+c.endDate.format(d)+'"]'}).done(function(b){jQuery('.contentsDiv').html(b),a.registerEvents(),e.progressIndicator({mode:'hide'});});});},registerEvents:function a(){this.registerDeleteHoliday(jQuery('#moduleBlocks')),this.registerAddDate(),this.registerEditDate(),this.registerChangeDate();}}),jQuery(document).ready(function(){var a=new Settings_PublicHoliday_Js;a.registerEvents();});
//# sourceMappingURL=PublicHoliday.min.js.map
