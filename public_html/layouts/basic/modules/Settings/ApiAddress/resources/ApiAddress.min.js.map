{"version":3,"file":"ApiAddress.min.js","sources":["ApiAddress.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_ApiAddress_Configuration_Js',\n\t{},\n\t{\n\t\tregisterSave: function(container) {\n\t\t\tcontainer.validationEngine(app.validationEngineOptions);\n\t\t\tcontainer.find('.saveGlobal').on('click', event => {\n\t\t\t\tif (!container.validationEngine('validate')) {\n\t\t\t\t\tapp.formAlignmentAfterValidation(container);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst defaultProvider = $('[name=\"default_provider\"]:checked');\n\t\t\t\tlet elements = {\n\t\t\t\t\tglobal: {\n\t\t\t\t\t\tmin_length: $('[name=\"min_length\"]').val(),\n\t\t\t\t\t\tresult_num: $('[name=\"result_num\"]').val(),\n\t\t\t\t\t\tdefault_provider: defaultProvider.length ? defaultProvider.val() : 0\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t$('[name=\"active\"]').each((i, e) => {\n\t\t\t\t\telements[e.dataset.type] = { active: e.checked ? 1 : 0 };\n\t\t\t\t});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmodule: 'ApiAddress',\n\t\t\t\t\t\tparent: 'Settings',\n\t\t\t\t\t\taction: 'SaveConfig',\n\t\t\t\t\t\telements: elements\n\t\t\t\t\t},\n\t\t\t\t\tasync: false,\n\t\t\t\t\tdataType: 'json'\n\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterConfigModal(container) {\n\t\t\tcontainer.find('.js-show-config-modal').on('click', e => {\n\t\t\t\tconst providerName = e.currentTarget.dataset.provider;\n\t\t\t\tapp.showModalWindow(\n\t\t\t\t\tnull,\n\t\t\t\t\t`index.php?module=ApiAddress&parent=Settings&view=ApiConfigModal&provider=${providerName}`,\n\t\t\t\t\tmodalContainer => {\n\t\t\t\t\t\tconst form = modalContainer.find('.js-form-validation');\n\t\t\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', _ => {\n\t\t\t\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\t\t\t\tapp.formAlignmentAfterValidation(container);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet elements = {};\n\t\t\t\t\t\t\tlet customField = modalContainer.find('.js-custom-field');\n\t\t\t\t\t\t\tcustomField.each((i, e) => {\n\t\t\t\t\t\t\t\telements[$(e).attr('name')] = e.value;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\telements = { [providerName]: elements };\n\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tmodule: 'ApiAddress',\n\t\t\t\t\t\t\t\t\tparent: 'Settings',\n\t\t\t\t\t\t\t\t\taction: 'SaveConfig',\n\t\t\t\t\t\t\t\t\telements: elements\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tasync: false,\n\t\t\t\t\t\t\t\tdataType: 'json'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\tregisterValidateBtn(container) {\n\t\t\tcontainer.find('.js-validate').on('click', e => {\n\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\tlet icon = currentTarget.find('.js-validate__icon');\n\t\t\t\ticon.addClass('fa-spin');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'ApiAddress',\n\t\t\t\t\tparent: 'Settings',\n\t\t\t\t\taction: 'ValidateConfiguration',\n\t\t\t\t\tprovider: currentTarget.data('provider')\n\t\t\t\t}).done(data => {\n\t\t\t\t\ticon.removeClass('fa-spin');\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\ttype: data['result']['type']\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\tconst container = $('.js-validation-form');\n\t\t\tthis.registerConfigModal(container);\n\t\t\tthis.registerSave(container);\n\t\t\tthis.registerValidateBtn(container);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","container","validationEngine","app","validationEngineOptions","find","on","formAlignmentAfterValidation","defaultProvider","$","elements","val","length","each","i","e","dataset","type","active","checked","request","done","data","showPnotify","fail","vtranslate","providerName","currentTarget","provider","showModalWindow","form","modalContainer","customField","attr","value","location","reload","icon","addClass","removeClass","registerConfigModal","registerSave","registerValidateBtn"],"mappings":"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"}