"use strict";var defineProperty=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj};jQuery.Class("Settings_ApiAddress_Configuration_Js",{},{registerSave:function(container){container.validationEngine(app.validationEngineOptions),container.find(".saveGlobal").on("click",(function(event){if(!container.validationEngine("validate"))return app.formAlignmentAfterValidation(container),!1;var defaultProvider=$('[name="default_provider"]:checked'),elements={global:{min_length:$('[name="min_length"]').val(),result_num:$('[name="result_num"]').val(),default_provider:defaultProvider.length?defaultProvider.val():0}};$('[name="active"]').each((function(i,e){elements[e.dataset.type]={active:e.checked?1:0}})),AppConnector.request({data:{module:"ApiAddress",parent:"Settings",action:"SaveConfig",elements:elements},async:!1,dataType:"json"}).done((function(data){Vtiger_Helper_Js.showPnotify({text:data.result.message,type:"success"})})).fail((function(){Vtiger_Helper_Js.showPnotify({text:app.vtranslate("JS_ERROR"),type:"error"})}))}))},registerConfigModal:function(container){container.find(".js-show-config-modal").on("click",(function(e){var providerName=e.currentTarget.dataset.provider;app.showModalWindow(null,"index.php?module=ApiAddress&parent=Settings&view=ApiConfigModal&provider="+providerName,(function(modalContainer){var form=modalContainer.find(".js-form-validation");form.validationEngine(app.validationEngineOptions),modalContainer.find(".js-modal__save").on("click",(function(_){if(!form.validationEngine("validate"))return app.formAlignmentAfterValidation(container),!1;var elements={};modalContainer.find(".js-custom-field").each((function(i,e){elements[$(e).attr("name")]=e.value})),elements=defineProperty({},providerName,elements),AppConnector.request({data:{module:"ApiAddress",parent:"Settings",action:"SaveConfig",elements:elements},async:!1,dataType:"json"}).done((function(data){Vtiger_Helper_Js.showPnotify({text:data.result.message,type:"success"}),window.location.reload()})).fail((function(){Vtiger_Helper_Js.showPnotify({text:app.vtranslate("JS_ERROR"),type:"error"})}))}))}))}))},registerValidateBtn:function(container){container.find(".js-validate").on("click",(function(e){var currentTarget=$(e.currentTarget),icon=currentTarget.find(".js-validate__icon");icon.addClass("fa-spin"),AppConnector.request({module:"ApiAddress",parent:"Settings",action:"ValidateConfiguration",provider:currentTarget.data("provider")}).done((function(data){icon.removeClass("fa-spin"),Vtiger_Helper_Js.showPnotify({text:data.result.message,type:data.result.type})}))}))},registerEvents:function(){var container=$(".js-validation-form");this.registerConfigModal(container),this.registerSave(container),this.registerValidateBtn(container)}});
//# sourceMappingURL=ApiAddress.min.js.map
