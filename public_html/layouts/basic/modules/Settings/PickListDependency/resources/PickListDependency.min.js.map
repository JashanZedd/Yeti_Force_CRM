{"version":3,"file":"PickListDependency.min.js","sources":["PickListDependency.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class('Settings_PickListDependency_Js', {\n\t//holds the picklist dependency instance\n\tpickListDependencyInstance: false,\n\t/**\n\t * Function used to triggerAdd new Dependency for the picklists\n\t */\n\ttriggerAdd: function (event) {\n\t\tevent.stopPropagation();\n\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\t\tinstance.updatedSourceValues = [];\n\t\tinstance.showEditView(instance.listViewForModule).done(function (data) {\n\t\t\tinstance.registerAddViewEvents();\n\t\t});\n\t},\n\t/**\n\t * This function used to trigger Edit picklist dependency\n\t */\n\ttriggerEdit: function (event, module, sourceField, targetField) {\n\t\tevent.stopPropagation();\n\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\t\tinstance.updatedSourceValues = [];\n\t\tinstance.showEditView(module, sourceField, targetField).done(\n\t\t\tfunction (data) {\n\t\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\t\tform.find('select[name=\"sourceModule\"],select[name=\"sourceField\"],select[name=\"targetField\"]').prop(\"disabled\", true);\n\t\t\t\tinstance.registerDependencyGraphEvents();\n\t\t\t\tinstance.registerSubmitEvent();\n\t\t\t}\n\t\t);\n\t},\n\t/**\n\t * This function used to trigger Delete picklist dependency\n\t */\n\ttriggerDelete: function (event, module, sourceField, targetField) {\n\t\tevent.stopPropagation();\n\t\tvar currentTarget = jQuery(event.currentTarget);\n\t\tvar currentTrEle = currentTarget.closest('tr');\n\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\n\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(function (e) {\n\t\t\tinstance.deleteDependency(module, sourceField, targetField).done(function (data) {\n\t\t\t\tvar params = {};\n\t\t\t\tparams.text = app.vtranslate('JS_DEPENDENCY_DELETED_SUEESSFULLY');\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\tcurrentTrEle.fadeOut('slow').remove();\n\t\t\t});\n\t\t});\n\t}\n\n}, {\n\t//constructor\n\tinit: function () {\n\t\tSettings_PickListDependency_Js.pickListDependencyInstance = this;\n\t},\n\t//holds the listview forModule\n\tlistViewForModule: '',\n\t//holds the updated sourceValues while editing dependency\n\tupdatedSourceValues: [],\n\t//holds the new mapping of source values and target values\n\tvalueMapping: [],\n\t//holds the list of selected source values for dependency\n\tselectedSourceValues: [],\n\t/*\n\t * function to show editView for Add/Edit Dependency\n\t * @params: module - selected module\n\t *\t\t\tsourceField - source picklist\n\t *\t\t\ttargetField - target picklist\n\t */\n\tshowEditView: function (module, sourceField, targetField) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['view'] = 'Edit';\n\t\tparams['sourceModule'] = module;\n\t\tparams['sourcefield'] = sourceField;\n\t\tparams['targetfield'] = targetField;\n\n\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\tvar container = jQuery('.contentsDiv');\n\t\t\tcontainer.html(data);\n\t\t\t//register all select2 Elements\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('select.select2'), {dropdownCss: {'z-index': 0}});\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\taDeferred.reject(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function to get the Dependency graph based on selected module\n\t */\n\tgetModuleDependencyGraph: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.find('[name=\"sourceModule\"]').on('change', function () {\n\t\t\tvar forModule = form.find('[name=\"sourceModule\"]').val();\n\t\t\tthisInstance.showEditView(forModule).done(function (data) {\n\t\t\t\tthisInstance.registerAddViewEvents();\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register change event for picklist fields in add/edit picklist dependency\n\t */\n\tregisterPicklistFieldsChangeEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.find('[name=\"sourceField\"],[name=\"targetField\"]').on('change', function () {\n\t\t\tthisInstance.checkValuesForDependencyGraph(form);\n\t\t});\n\t},\n\t/**\n\t * Function used to check the selected picklist fields are valid before showing dependency graph\n\t */\n\tcheckValuesForDependencyGraph: function (form) {\n\t\tvar thisInstance = this;\n\t\tvar sourceField = form.find('[name=\"sourceField\"]');\n\t\tvar targetField = form.find('[name=\"targetField\"]');\n\t\tvar select2SourceField = app.getSelect2ElementFromSelect(sourceField);\n\t\tvar select2TargetField = app.getSelect2ElementFromSelect(targetField);\n\t\tvar sourceFieldValue = sourceField.val();\n\t\tvar targetFieldValue = targetField.val();\n\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\tif (sourceFieldValue != '' && targetFieldValue != '') {\n\t\t\tvar resultMessage = app.vtranslate('JS_SOURCE_AND_TARGET_FIELDS_SHOULD_NOT_BE_SAME');\n\t\t\tform.find('.errorMessage').addClass('d-none');\n\t\t\tif (sourceFieldValue == targetFieldValue) {\n\t\t\t\tselect2TargetField.validationEngine('showPrompt', resultMessage, 'error', 'topLeft', true);\n\t\t\t\tdependencyGraph.html('');\n\t\t\t} else {\n\t\t\t\tselect2SourceField.validationEngine('hide');\n\t\t\t\tselect2TargetField.validationEngine('hide');\n\t\t\t\tvar sourceModule = form.find('[name=\"sourceModule\"]').val();\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t'position': 'html',\n\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.checkCyclicDependency(sourceModule, sourceFieldValue, targetFieldValue).done(function (data) {\n\t\t\t\t\tvar result = data['result'];\n\t\t\t\t\tif (!result['result']) {\n\t\t\t\t\t\tthisInstance.addNewDependencyPickList(sourceModule, sourceFieldValue, targetFieldValue);\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\tform.find('.errorMessage').removeClass('d-none');\n\t\t\t\t\t\tform.find('.cancelAddView').removeClass('d-none');\n\t\t\t\t\t\tdependencyGraph.html('');\n\t\t\t\t\t}\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tform.find('.errorMessage').addClass('d-none');\n\t\t\tvar result = app.vtranslate('JS_SELECT_SOME_VALUE');\n\t\t\tif (sourceFieldValue == '') {\n\t\t\t\tselect2SourceField.validationEngine('showPrompt', result, 'error', 'topLeft', true);\n\t\t\t} else if (targetFieldValue == '') {\n\t\t\t\tselect2TargetField.validationEngine('showPrompt', result, 'error', 'topLeft', true);\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * Function used to check the cyclic dependency of the selected picklist fields\n\t * @params: sourceModule - selected module\n\t *            sourceFieldValue - source picklist value\n\t *            targetFieldValue - target picklist value\n\t */\n\tcheckCyclicDependency: function (sourceModule, sourceFieldValue, targetFieldValue) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar params = {};\n\t\tparams['mode'] = 'checkCyclicDependency';\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'Index';\n\t\tparams['sourceModule'] = sourceModule;\n\t\tparams['sourcefield'] = sourceFieldValue;\n\t\tparams['targetfield'] = targetFieldValue;\n\n\t\tAppConnector.request(params).done(\n\t\t\tfunction (data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t}, function (error, err) {\n\t\t\t\taDeferred.reject();\n\t\t\t}\n\t\t);\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function used to show the new picklist dependency graph\n\t * @params: sourceModule - selected module\n\t *            sourceFieldValue - source picklist value\n\t *            targetFieldValue - target picklist value\n\t */\n\taddNewDependencyPickList: function (sourceModule, sourceFieldValue, targetFieldValue) {\n\t\tvar thisInstance = this;\n\t\tvar dependencyGraph = $('#dependencyGraph');\n\t\tthisInstance.updatedSourceValues = [];\n\t\tAppConnector.request({\n\t\t\tmode: 'getDependencyGraph',\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'IndexAjax',\n\t\t\tsourceModule: sourceModule,\n\t\t\tsourcefield: sourceFieldValue,\n\t\t\ttargetfield: targetFieldValue\n\t\t}).done(function (data) {\n\t\t\tdependencyGraph.html(data).css({'padding': '10px', 'border': '1px solid #ddd', 'background': '#fff'});\n\t\t\tthisInstance.registerDependencyGraphEvents();\n\t\t});\n\t},\n\t/**\n\t * This function will delete the pickList Dependency\n\t * @params: module - selected module\n\t *            sourceField - source picklist value\n\t *            targetField - target picklist value\n\t */\n\tdeleteDependency: function (module, sourceField, targetField) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'DeleteAjax';\n\t\tparams['sourceModule'] = module;\n\t\tparams['sourcefield'] = sourceField;\n\t\tparams['targetfield'] = targetField;\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\t\taDeferred.reject(error, err);\n\t\t\t}\n\t\t);\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function used to show cancel link in add view and register click event for cancel\n\t */\n\tregisterCancelAddView: function (form) {\n\t\tvar thisInstance = this;\n\t\tvar cancelDiv = form.find('.cancelAddView');\n\t\tcancelDiv.removeClass('d-none');\n\t\tcancelDiv.find('.cancelLink').on('click', function () {\n\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t})\n\t},\n\t/**\n\t * Register all the events related to addView of picklist dependency\n\t */\n\tregisterAddViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tthisInstance.registerCancelAddView(form);\n\t\tthisInstance.getModuleDependencyGraph(form);\n\t\tthisInstance.registerPicklistFieldsChangeEvent(form);\n\t\tthisInstance.registerSubmitEvent();\n\t},\n\t/**\n\t * Register all the events in editView of picklist dependency\n\t */\n\tregisterDependencyGraphEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\tform.find('.cancelAddView').addClass('d-none');\n\t\tthisInstance.registerTargetFieldsClickEvent(dependencyGraph);\n\t\tthisInstance.registerTargetFieldsUnmarkAll(dependencyGraph);\n\t\tthisInstance.registerSelectSourceValuesClick(dependencyGraph);\n\t\tthisInstance.registerCancelDependency(form);\n\t},\n\t/**\n\t * Register all the events related to listView of picklist dependency\n\t */\n\tregisterListViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar forModule = jQuery('.contentsDiv').find('.pickListSupportedModules').val();\n\t\tthisInstance.listViewForModule = forModule;\n\t\t//thisInstance.triggerDisplayTypeEvent();\n\t\tthisInstance.registerSourceModuleChangeEvent();\n\t},\n\t/**\n\t * Register the click event for cancel picklist dependency changes\n\t */\n\tregisterCancelDependency: function (form) {\n\t\tvar thisInstance = this;\n\t\t//Register click event for cancel link\n\t\tvar cancelDependencyLink = form.find('.cancelDependency');\n\t\tcancelDependencyLink.on('click', function () {\n\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t})\n\t},\n\t/**\n\t * Register the click event for target fields in dependency graph\n\t */\n\tregisterTargetFieldsClickEvent: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.updatedSourceValues = [];\n\t\tdependencyGraph.find('td.picklistValueMapping').on('click', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar sourceValue = currentTarget.data('sourceValue');\n\t\t\tif (jQuery.inArray(sourceValue, thisInstance.updatedSourceValues) == -1) {\n\t\t\t\tthisInstance.updatedSourceValues.push(sourceValue);\n\t\t\t}\n\t\t\tif (currentTarget.hasClass('selectedCell')) {\n\t\t\t\tcurrentTarget.addClass('unselectedCell').removeClass('selectedCell');\n\t\t\t} else {\n\t\t\t\tcurrentTarget.addClass('selectedCell').removeClass('unselectedCell');\n\t\t\t}\n\t\t});\n\t},\n\tregisterTargetFieldsUnmarkAll: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.updatedSourceValues = [];\n\t\tdependencyGraph.find('.unmarkAll').on('click', function (e) {\n\t\t\tdependencyGraph.find('td.picklistValueMapping').each(function (index) {\n\t\t\t\tvar currentTarget = jQuery(this);\n\t\t\t\tvar sourceValue = currentTarget.data('sourceValue');\n\t\t\t\tif (jQuery.inArray(sourceValue, thisInstance.updatedSourceValues) == -1) {\n\t\t\t\t\tthisInstance.updatedSourceValues.push(sourceValue);\n\t\t\t\t}\n\t\t\t\tcurrentTarget.addClass('unselectedCell').removeClass('selectedCell');\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function used to update the value mapping to save the picklist dependency\n\t */\n\tupdateValueMapping: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.valueMapping = [];\n\t\tvar sourceValuesArray = thisInstance.updatedSourceValues;\n\t\tvar dependencyTable = dependencyGraph.find('.pickListDependencyTable');\n\t\tfor (var key in sourceValuesArray) {\n\t\t\tlet encodedSourceValue;\n\t\t\tif (typeof sourceValuesArray[key] == 'string') {\n\t\t\t\tencodedSourceValue = sourceValuesArray[key].replace(/\"/g, '\\\\\"');\n\t\t\t} else {\n\t\t\t\tencodedSourceValue = sourceValuesArray[key];\n\t\t\t}\n\t\t\tvar selectedTargetValues = dependencyTable.find('td[data-source-value=\"' + encodedSourceValue + '\"]').filter('.selectedCell');\n\t\t\tvar targetValues = [];\n\t\t\tif (selectedTargetValues.length > 0) {\n\t\t\t\tjQuery.each(selectedTargetValues, function (index, element) {\n\t\t\t\t\ttargetValues.push(jQuery(element).data('targetValue'));\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\ttargetValues.push('');\n\t\t\t}\n\t\t\tthisInstance.valueMapping.push({'sourcevalue': sourceValuesArray[key], 'targetvalues': targetValues});\n\t\t}\n\t},\n\t/**\n\t * Register click event for select source values button in add/edit view\n\t */\n\tregisterSelectSourceValuesClick(dependencyGraph) {\n\t\tdependencyGraph.find('button.sourceValues').on('click', () => {\n\t\t\tconst selectSourceValues = dependencyGraph.find('.modalCloneCopy');\n\t\t\tconst clonedContainer = selectSourceValues.clone(true, true).removeClass('modalCloneCopy');\n\t\t\tapp.showModalWindow(clonedContainer, (data) => {\n\t\t\t\tdata.find('.sourcePicklistValuesModal').removeClass('d-none');\n\t\t\t\tdata.find('[name=\"saveButton\"]').on('click', (e) => {\n\t\t\t\t\tthis.selectedSourceValues = [];\n\t\t\t\t\tconst sourceValues = data.find('.sourceValue');\n\t\t\t\t\t$.each(sourceValues, (index, ele) => {\n\t\t\t\t\t\tconst element = $(ele);\n\t\t\t\t\t\tconst elementId = element.attr('id');\n\t\t\t\t\t\tconst hiddenElement = selectSourceValues.find('#' + elementId);\n\t\t\t\t\t\tif (element.is(':checked')) {\n\t\t\t\t\t\t\tthis.selectedSourceValues.push(element.val());\n\t\t\t\t\t\t\thiddenElement.prop('checked', true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thiddenElement.prop('checked', false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tthis.loadMappingForSelectedValues(dependencyGraph);\n\t\t\t\t});\n\t\t\t}, {'width': '1000px'});\n\t\t});\n\t},\n\t/**\n\t * Function used to load mapping for selected picklist fields\n\t */\n\tloadMappingForSelectedValues: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tvar allSourcePickListValues = JSON.parse(dependencyGraph.find('.allSourceValues').val());\n\t\tvar dependencyTable = dependencyGraph.find('.pickListDependencyTable');\n\t\tfor (var key in allSourcePickListValues) {\n\t\t\tif (typeof allSourcePickListValues[key] == 'string') {\n\t\t\t\tvar encodedSourcePickListValue = allSourcePickListValues[key].replace(/\"/g, '\\\\\"');\n\t\t\t} else {\n\t\t\t\tencodedSourcePickListValue = allSourcePickListValues[key];\n\t\t\t}\n\t\t\tvar mappingCells = dependencyTable.find('[data-source-value=\"' + encodedSourcePickListValue + '\"]');\n\t\t\tif (jQuery.inArray(allSourcePickListValues[key], thisInstance.selectedSourceValues) == -1) {\n\t\t\t\tmappingCells.hide();\n\t\t\t} else {\n\t\t\t\tmappingCells.show();\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * This function will save the picklist dependency details\n\t */\n\tsavePickListDependency: function(form) {\n\t\tconst self = this;\n\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t}),\n\t\t\tparams = form.serializeFormData();\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'SaveAjax';\n\t\tparams['mapping'] = JSON.stringify(self.valueMapping);\n\t\tAppConnector.request(params).done(function(data) {\n\t\t\tif (data['success']) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\ttext: app.vtranslate('JS_PICKLIST_DEPENDENCY_SAVED'),\n\t\t\t\t\ttype: 'success'\n\t\t\t\t});\n\t\t\t\tself.loadListViewContents(params['sourceModule']);\n\t\t\t}\n\t\t}).fail(function(error) {\n\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t});\n\t},\n\t/**\n\t * This function will load the listView contents after Add/Edit picklist dependency\n\t */\n\tloadListViewContents: function (forModule) {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['view'] = 'List';\n\t\tparams['formodule'] = forModule;\n\n\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t//replace the new list view contents\n\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\tApp.Fields.Picklist.changeSelectElementView(jQuery('.contentsDiv'));\n\t\t\tthisInstance.registerListViewEvents();\n\t\t}).fail(function (error, err) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * trigger the display type event to show the width\n\t */\n\ttriggerDisplayTypeEvent: function () {\n\t\tvar widthType = app.cacheGet('widthType', 'narrowWidthType');\n\t\tif (widthType) {\n\t\t\tvar elements = jQuery('.listViewEntriesTable').find('td,th');\n\t\t\telements.attr('class', widthType);\n\t\t}\n\t},\n\t/**\n\t * register change event for source module in add/edit picklist dependency\n\t */\n\tregisterSourceModuleChangeEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('.contentsDiv');\n\t\tcontainer.find('.pickListSupportedModules').on('change', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar forModule = currentTarget.val();\n\t\t\tthisInstance.loadListViewContents(forModule);\n\t\t});\n\t},\n\t/**\n\t * register the form submit event\n\t */\n\tregisterSubmitEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t\ttry {\n\t\t\t\tthisInstance.updateValueMapping(dependencyGraph);\n\t\t\t} catch (e) {\n\t\t\t\tbootbox.alert(e.message);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (form.find('.editDependency').val() != \"true\" && thisInstance.valueMapping.length < 1) {\n\t\t\t\tvar params = {};\n\t\t\t\tparams.text = app.vtranslate('JS_PICKLIST_DEPENDENCY_NO_SAVED');\n\t\t\t\tparams.type = 'info';\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t} else {\n\t\t\t\tthisInstance.savePickListDependency(form);\n\t\t\t}\n\n\t\t});\n\t},\n\t/**\n\t * register events for picklist dependency\n\t */\n\tregisterEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tif (form.length > 0) {\n\t\t\tif (form.find('.editDependency').val() == \"true\") {\n\t\t\t\tform.find('select[name=\"sourceModule\"],select[name=\"sourceField\"],select[name=\"targetField\"]').prop(\"disabled\", true);\n\t\t\t\tthisInstance.registerDependencyGraphEvents();\n\t\t\t\tthisInstance.registerSubmitEvent();\n\t\t\t} else {\n\t\t\t\tthisInstance.registerAddViewEvents();\n\t\t\t}\n\t\t} else {\n\t\t\tthisInstance.registerListViewEvents();\n\t\t}\n\t}\n\n});\n\njQuery(document).ready(function () {\n\tvar instance = new Settings_PickListDependency_Js();\n\tinstance.registerEvents();\n})\n"],"names":["jQuery","Class","event","stopPropagation","instance","Settings_PickListDependency_Js","pickListDependencyInstance","updatedSourceValues","showEditView","listViewForModule","done","data","registerAddViewEvents","module","sourceField","targetField","form","find","prop","registerDependencyGraphEvents","registerSubmitEvent","currentTarget","currentTrEle","closest","message","app","vtranslate","showConfirmationBox","e","deleteDependency","params","text","showMessage","fadeOut","remove","aDeferred","Deferred","progressIndicatorElement","progressIndicator","getModuleName","getParentModuleName","requestPjax","container","html","Fields","Picklist","showSelect2ElementView","dropdownCss","resolve","fail","error","reject","promise","thisInstance","on","forModule","val","checkValuesForDependencyGraph","select2SourceField","getSelect2ElementFromSelect","select2TargetField","sourceFieldValue","targetFieldValue","dependencyGraph","resultMessage","addClass","validationEngine","sourceModule","checkCyclicDependency","result","addNewDependencyPickList","removeClass","err","request","$","css","cancelDiv","loadListViewContents","registerCancelAddView","getModuleDependencyGraph","registerPicklistFieldsChangeEvent","registerTargetFieldsClickEvent","registerTargetFieldsUnmarkAll","registerSelectSourceValuesClick","registerCancelDependency","registerSourceModuleChangeEvent","cancelDependencyLink","sourceValue","inArray","push","hasClass","each","index","valueMapping","sourceValuesArray","dependencyTable","key","encodedSourceValue","replace","selectedTargetValues","filter","targetValues","length","element","selectSourceValues","clonedContainer","clone","showModalWindow","selectedSourceValues","sourceValues","ele","elementId","attr","hiddenElement","is","hideModalWindow","loadMappingForSelectedValues","allSourcePickListValues","JSON","parse","encodedSourcePickListValue","mappingCells","hide","show","self","serializeFormData","stringify","mode","changeSelectElementView","registerListViewEvents","widthType","cacheGet","elements","preventDefault","updateValueMapping","alert","type","savePickListDependency","document","ready","registerEvents"],"mappings":"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"}