{"version":3,"file":"Search.min.js","sources":["Search.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nvar Settings_Index_Js = {\n\tupdatedBlockFieldsList: [],\n\tinitEvants: function () {\n\t\t$('.SearchFieldsEdit .fieldname').on('change', Settings_Index_Js.save);\n\t\t$('.SearchFieldsEdit .searchcolumn').on('change', Settings_Index_Js.save);\n\t\t$('.SearchFieldsEdit .updateLabels').on('click', Settings_Index_Js.updateLabels);\n\t\t$('.SearchFieldsEdit .editLabels').on('click', Settings_Index_Js.editLabels);\n\t\t$('.SearchFieldsEdit .turn_off').on('click', Settings_Index_Js.replacement);\n\t},\n\treplacement: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tif (parseInt(target.val())) {\n\t\t\ttarget.val(0).html('<span class=\"fas fa-power-off u-mr-5px\"></span>' + app.vtranslate('JS_TURN_ON'));\n\t\t} else {\n\t\t\ttarget.val(1).html('<span class=\"fas fa-power-off u-mr-5px\"></span>' + app.vtranslate('JS_TURN_OFF'));\n\t\t}\n\t\ttarget.toggleClass(\"btn-success btn-danger\");\n\t\tSettings_Index_Js.save(e);\n\t},\n\tupdateLabels: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tvar closestTrElement = target.closest('tr');\n\t\tif (!closestTrElement.hasClass('ui-sortable-handle')) {\n\t\t\tclosestTrElement = closestTrElement.prev();\n\t\t}\n\t\tSettings_Index_Js.registerSaveEvent('updateLabels', {\n\t\t\t'tabid': closestTrElement.data('tabid'),\n\t\t});\n\t},\n\teditLabels: function (e) {\n\t\tlet tabId = $(e.currentTarget).data('tabid'),\n\t\t\tselect = $('.elementEdit' + tabId).removeClass('d-none').find('[data-select-cb=\"registerSelectSortable\"]');\n\n\t\t$('.elementLabels' + tabId).addClass('d-none');\n\t\tApp.Fields.Picklist.showSelect2ElementView(select, {\n\t\t\tsortableCb: (currentSelect) => {\n\t\t\t\tSettings_Index_Js.registerSaveEvent('save', {\n\t\t\t\t\tname: currentSelect.attr('name'),\n\t\t\t\t\tvalue: currentSelect.val(),\n\t\t\t\t\ttabid: currentSelect.data('tabid'),\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\tsave: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tSettings_Index_Js.registerSaveEvent('save', {\n\t\t\tname: target.attr('name'),\n\t\t\tvalue: target.val(),\n\t\t\ttabid: target.data('tabid'),\n\t\t});\n\t},\n\tregisterSaveEvent: function (mode, data) {\n\t\tvar progress = $.progressIndicator({\n\t\t\t'message': app.vtranslate('Saving changes'),\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar resp = '';\n\t\tvar params = {}\n\t\tparams.data = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\taction: 'SaveAjax',\n\t\t\tmode: mode,\n\t\t\tparams: data\n\t\t}\n\t\tparams.async = false;\n\t\tparams.dataType = 'json';\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tvar response = data['result'];\n\t\t\tvar params = {\n\t\t\t\ttext: response['message'],\n\t\t\t\ttype: 'success'\n\t\t\t};\n\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\tprogress.progressIndicator({'mode': 'hide'});\n\t\t}).fail(function (data, err) {\n\t\t\tprogress.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * Function to regiser the event to make the modules sortable\n\t */\n\tmakeFieldsListSortable: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('.SearchFieldsEdit').find('.contents');\n\t\tvar table = contents.find('table');\n\n\t\ttable.each(function () {\n\t\t\tjQuery(this).find('tbody').sortable({\n\t\t\t\t'containment': '#modulesEntity',\n\t\t\t\t'revert': true,\n\t\t\t\t'tolerance': 'pointer',\n\t\t\t\t'cursor': 'move',\n\t\t\t\t'helper': function (e, ui) {\n\t\t\t\t\t//while dragging helper elements td element will take width as contents width\n\t\t\t\t\t//so we are explicitly saying that it has to be same width so that element will not\n\t\t\t\t\t//look like disturbed\n\t\t\t\t\tui.children().each(function (index, element) {\n\t\t\t\t\t\telement = jQuery(element);\n\t\t\t\t\t\telement.width(element.width());\n\t\t\t\t\t})\n\t\t\t\t\treturn ui;\n\t\t\t\t},\n\t\t\t\t'update': function (e, ui) {\n\t\t\t\t\tthisInstance.showSaveModuleSequenceButton();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to show the save button of moduleSequence\n\t */\n\tshowSaveModuleSequenceButton: function () {\n\t\tvar thisInstance = this;\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tvar saveButton = layout.find('.saveModuleSequence');\n\t\tthisInstance.updatedBlockFieldsList = [];\n\t\tsaveButton.removeClass('d-none');\n\t},\n\t/**\n\t * Function which will hide the saveModuleSequence button\n\t */\n\thideSaveModuleSequenceButton: function () {\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tvar saveButton = layout.find('.saveModuleSequence');\n\t\tsaveButton.addClass('d-none');\n\t},\n\t/**\n\t * Function will save the field sequences\n\t */\n\tupdateModulesSequence: function () {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'SaveAjax';\n\t\tparams['mode'] = 'saveSequenceNumber';\n\t\tparams['updatedFields'] = thisInstance.updatedBlockFieldsList;\n\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\tvar params = {};\n\t\t\tparams['text'] = app.vtranslate('JS_MODULES_SEQUENCE_UPDATED');\n\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * Function to create the list of updated modules and their sequences\n\t */\n\tcreateUpdatedSequenceModulesList: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('.SearchFieldsEdit').find('.contents');\n\n\t\tvar updatedModules = contents.find('tbody');\n\t\tvar editModules = updatedModules.find('tr');\n\t\tvar expectedModuleSequence = 1;\n\t\teditModules.each(function (i, domElement) {\n\t\t\tvar moduleEle = jQuery(domElement);\n\t\t\tvar moduleId = moduleEle.data('tabid');\n\t\t\tthisInstance.updatedBlockFieldsList.push({'tabid': moduleId, 'sequence': expectedModuleSequence});\n\t\t\texpectedModuleSequence = expectedModuleSequence + 1;\n\t\t});\n\t},\n\t/**\n\t * Function to register click event for save button of modules sequence\n\t */\n\tregisterModuleSequenceSaveClick: function () {\n\t\tvar thisInstance = this;\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tlayout.on('click', '.saveModuleSequence', function () {\n\t\t\tthisInstance.hideSaveModuleSequenceButton();\n\t\t\tthisInstance.createUpdatedSequenceModulesList();\n\t\t\tthisInstance.updateModulesSequence();\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tSettings_Index_Js.initEvants();\n\t\tthis.makeFieldsListSortable();\n\t\tthis.registerModuleSequenceSaveClick();\n\t}\n}\n$(document).ready(function () {\n\tSettings_Index_Js.registerEvents();\n})\n"],"names":["Settings_Index_Js","on","save","updateLabels","editLabels","replacement","e","target","$","currentTarget","parseInt","val","html","app","vtranslate","toggleClass","closestTrElement","closest","hasClass","prev","registerSaveEvent","data","tabId","select","removeClass","find","addClass","Fields","Picklist","showSelect2ElementView","currentSelect","attr","mode","progress","progressIndicator","params","getModuleName","getParentModuleName","async","dataType","request","done","showPnotify","fail","err","thisInstance","this","jQuery","each","sortable","ui","children","index","element","width","showSaveModuleSequenceButton","saveButton","updatedBlockFieldsList","progressIndicatorElement","showMessage","error","editModules","expectedModuleSequence","i","domElement","moduleId","push","tabid","sequence","hideSaveModuleSequenceButton","createUpdatedSequenceModulesList","updateModulesSequence","initEvants","makeFieldsListSortable","registerModuleSequenceSaveClick","document","ready","registerEvents"],"mappings":"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"}