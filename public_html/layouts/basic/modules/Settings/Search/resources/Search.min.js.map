{"version":3,"file":"Search.min.js","sources":["Search.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nvar Settings_Index_Js = {\n\tupdatedBlockFieldsList: [],\n\tinitEvants: function () {\n\t\t$('.SearchFieldsEdit .fieldname').on('change', Settings_Index_Js.save);\n\t\t$('.SearchFieldsEdit .searchcolumn').on('change', Settings_Index_Js.save);\n\t\t$('.SearchFieldsEdit .updateLabels').on('click', Settings_Index_Js.updateLabels);\n\t\t$('.SearchFieldsEdit .editLabels').on('click', Settings_Index_Js.editLabels);\n\t\t$('.SearchFieldsEdit .turn_off').on('click', Settings_Index_Js.replacement);\n\t},\n\treplacement: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tif (parseInt(target.val())) {\n\t\t\ttarget.val(0).html('<span class=\"fas fa-power-off u-mr-5px\"></span>' + app.vtranslate('JS_TURN_ON'));\n\t\t} else {\n\t\t\ttarget.val(1).html('<span class=\"fas fa-power-off u-mr-5px\"></span>' + app.vtranslate('JS_TURN_OFF'));\n\t\t}\n\t\ttarget.toggleClass(\"btn-success btn-danger\");\n\t\tSettings_Index_Js.save(e);\n\t},\n\tupdateLabels: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tvar closestTrElement = target.closest('tr');\n\t\tif (!closestTrElement.hasClass('ui-sortable-handle')) {\n\t\t\tclosestTrElement = closestTrElement.prev();\n\t\t}\n\t\tSettings_Index_Js.registerSaveEvent('updateLabels', {\n\t\t\t'tabid': closestTrElement.data('tabid'),\n\t\t});\n\t},\n\teditLabels: function (e) {\n\t\tlet tabId = $(e.currentTarget).data('tabid'),\n\t\t\tselect = $('.elementEdit' + tabId).removeClass('d-none').find('[data-select-cb=\"registerSelectSortable\"]');\n\n\t\t$('.elementLabels' + tabId).addClass('d-none');\n\t\tApp.Fields.Picklist.showSelect2ElementView(select, {\n\t\t\tsortableCb: (currentSelect) => {\n\t\t\t\tSettings_Index_Js.registerSaveEvent('save', {\n\t\t\t\t\tname: currentSelect.attr('name'),\n\t\t\t\t\tvalue: currentSelect.val(),\n\t\t\t\t\ttabid: currentSelect.data('tabid'),\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\tsave: function (e) {\n\t\tvar target = $(e.currentTarget);\n\t\tSettings_Index_Js.registerSaveEvent('save', {\n\t\t\tname: target.attr('name'),\n\t\t\tvalue: target.val(),\n\t\t\ttabid: target.data('tabid'),\n\t\t});\n\t},\n\tregisterSaveEvent: function (mode, data) {\n\t\tvar progress = $.progressIndicator({\n\t\t\t'message': app.vtranslate('Saving changes'),\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar resp = '';\n\t\tvar params = {}\n\t\tparams.data = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\taction: 'SaveAjax',\n\t\t\tmode: mode,\n\t\t\tparams: data\n\t\t}\n\t\tparams.async = false;\n\t\tparams.dataType = 'json';\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tvar response = data['result'];\n\t\t\tvar params = {\n\t\t\t\ttext: response['message'],\n\t\t\t\ttype: 'success'\n\t\t\t};\n\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\tprogress.progressIndicator({'mode': 'hide'});\n\t\t}).fail(function (data, err) {\n\t\t\tprogress.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * Function to regiser the event to make the modules sortable\n\t */\n\tmakeFieldsListSortable: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('.SearchFieldsEdit').find('.contents');\n\t\tvar table = contents.find('table');\n\n\t\ttable.each(function () {\n\t\t\tjQuery(this).find('tbody').sortable({\n\t\t\t\t'containment': '#modulesEntity',\n\t\t\t\t'revert': true,\n\t\t\t\t'tolerance': 'pointer',\n\t\t\t\t'cursor': 'move',\n\t\t\t\t'helper': function (e, ui) {\n\t\t\t\t\t//while dragging helper elements td element will take width as contents width\n\t\t\t\t\t//so we are explicitly saying that it has to be same width so that element will not\n\t\t\t\t\t//look like disturbed\n\t\t\t\t\tui.children().each(function (index, element) {\n\t\t\t\t\t\telement = jQuery(element);\n\t\t\t\t\t\telement.width(element.width());\n\t\t\t\t\t})\n\t\t\t\t\treturn ui;\n\t\t\t\t},\n\t\t\t\t'update': function (e, ui) {\n\t\t\t\t\tthisInstance.showSaveModuleSequenceButton();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to show the save button of moduleSequence\n\t */\n\tshowSaveModuleSequenceButton: function () {\n\t\tvar thisInstance = this;\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tvar saveButton = layout.find('.saveModuleSequence');\n\t\tthisInstance.updatedBlockFieldsList = [];\n\t\tsaveButton.removeClass('d-none');\n\t},\n\t/**\n\t * Function which will hide the saveModuleSequence button\n\t */\n\thideSaveModuleSequenceButton: function () {\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tvar saveButton = layout.find('.saveModuleSequence');\n\t\tsaveButton.addClass('d-none');\n\t},\n\t/**\n\t * Function will save the field sequences\n\t */\n\tupdateModulesSequence: function () {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'SaveAjax';\n\t\tparams['mode'] = 'saveSequenceNumber';\n\t\tparams['updatedFields'] = thisInstance.updatedBlockFieldsList;\n\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\tvar params = {};\n\t\t\tparams['text'] = app.vtranslate('JS_MODULES_SEQUENCE_UPDATED');\n\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * Function to create the list of updated modules and their sequences\n\t */\n\tcreateUpdatedSequenceModulesList: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('.SearchFieldsEdit').find('.contents');\n\n\t\tvar updatedModules = contents.find('tbody');\n\t\tvar editModules = updatedModules.find('tr');\n\t\tvar expectedModuleSequence = 1;\n\t\teditModules.each(function (i, domElement) {\n\t\t\tvar moduleEle = jQuery(domElement);\n\t\t\tvar moduleId = moduleEle.data('tabid');\n\t\t\tthisInstance.updatedBlockFieldsList.push({'tabid': moduleId, 'sequence': expectedModuleSequence});\n\t\t\texpectedModuleSequence = expectedModuleSequence + 1;\n\t\t});\n\t},\n\t/**\n\t * Function to register click event for save button of modules sequence\n\t */\n\tregisterModuleSequenceSaveClick: function () {\n\t\tvar thisInstance = this;\n\t\tvar layout = jQuery('.SearchFieldsEdit');\n\t\tlayout.on('click', '.saveModuleSequence', function () {\n\t\t\tthisInstance.hideSaveModuleSequenceButton();\n\t\t\tthisInstance.createUpdatedSequenceModulesList();\n\t\t\tthisInstance.updateModulesSequence();\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tSettings_Index_Js.initEvants();\n\t\tthis.makeFieldsListSortable();\n\t\tthis.registerModuleSequenceSaveClick();\n\t}\n}\n$(document).ready(function () {\n\tSettings_Index_Js.registerEvents();\n})\n"],"names":["Settings_Index_Js","on","save","updateLabels","editLabels","replacement","e","target","$","currentTarget","parseInt","val","html","app","vtranslate","toggleClass","closestTrElement","closest","hasClass","prev","registerSaveEvent","data","tabId","select","removeClass","find","addClass","Fields","Picklist","showSelect2ElementView","currentSelect","attr","mode","progress","progressIndicator","params","getModuleName","getParentModuleName","async","dataType","request","done","response","showPnotify","fail","err","thisInstance","contents","jQuery","table","each","sortable","ui","children","index","element","width","showSaveModuleSequenceButton","layout","saveButton","updatedBlockFieldsList","progressIndicatorElement","showMessage","error","updatedModules","editModules","expectedModuleSequence","i","domElement","moduleEle","moduleId","push","hideSaveModuleSequenceButton","createUpdatedSequenceModulesList","updateModulesSequence","initEvants","makeFieldsListSortable","registerModuleSequenceSaveClick","document","ready","registerEvents"],"mappings":";;AAAA;AACA;AAEA,IAAIA,oBAAoB;yBACC,EADD;aAEX,sBAAY;IACrB,8BAAF,EAAkCC,EAAlC,CAAqC,QAArC,EAA+CD,kBAAkBE,IAAjE;IACE,iCAAF,EAAqCD,EAArC,CAAwC,QAAxC,EAAkDD,kBAAkBE,IAApE;IACE,iCAAF,EAAqCD,EAArC,CAAwC,OAAxC,EAAiDD,kBAAkBG,YAAnE;IACE,+BAAF,EAAmCF,EAAnC,CAAsC,OAAtC,EAA+CD,kBAAkBI,UAAjE;IACE,6BAAF,EAAiCH,EAAjC,CAAoC,OAApC,EAA6CD,kBAAkBK,WAA/D;EAPsB;cASV,qBAAUC,CAAV,EAAa;MACrBC,SAASC,EAAEF,EAAEG,aAAJ,CAAb;MACIC,SAASH,OAAOI,GAAP,EAAT,CAAJ,EAA4B;UACpBA,GAAP,CAAW,CAAX,EAAcC,IAAd,CAAmB,oDAAoDC,IAAIC,UAAJ,CAAe,YAAf,CAAvE;GADD,MAEO;UACCH,GAAP,CAAW,CAAX,EAAcC,IAAd,CAAmB,oDAAoDC,IAAIC,UAAJ,CAAe,aAAf,CAAvE;;SAEMC,WAAP,CAAmB,wBAAnB;oBACkBb,IAAlB,CAAuBI,CAAvB;EAjBsB;eAmBT,sBAAUA,CAAV,EAAa;MACtBC,SAASC,EAAEF,EAAEG,aAAJ,CAAb;MACIO,mBAAmBT,OAAOU,OAAP,CAAe,IAAf,CAAvB;MACI,CAACD,iBAAiBE,QAAjB,CAA0B,oBAA1B,CAAL,EAAsD;sBAClCF,iBAAiBG,IAAjB,EAAnB;;oBAEiBC,iBAAlB,CAAoC,cAApC,EAAoD;YAC1CJ,iBAAiBK,IAAjB,CAAsB,OAAtB;GADV;EAzBsB;aA6BX,oBAAUf,CAAV,EAAa;MACpBgB,QAAQd,EAAEF,EAAEG,aAAJ,EAAmBY,IAAnB,CAAwB,OAAxB,CAAZ;MACCE,SAASf,EAAE,iBAAiBc,KAAnB,EAA0BE,WAA1B,CAAsC,QAAtC,EAAgDC,IAAhD,CAAqD,2CAArD,CADV;;IAGE,mBAAmBH,KAArB,EAA4BI,QAA5B,CAAqC,QAArC;MACIC,MAAJ,CAAWC,QAAX,CAAoBC,sBAApB,CAA2CN,MAA3C,EAAmD;eACtC,oBAACO,aAAD,EAAmB;sBACZV,iBAAlB,CAAoC,MAApC,EAA4C;WACrCU,cAAcC,IAAd,CAAmB,MAAnB,CADqC;YAEpCD,cAAcnB,GAAd,EAFoC;YAGpCmB,cAAcT,IAAd,CAAmB,OAAnB;KAHR;;GAFF;EAlCsB;OA4CjB,cAAUf,CAAV,EAAa;MACdC,SAASC,EAAEF,EAAEG,aAAJ,CAAb;oBACkBW,iBAAlB,CAAoC,MAApC,EAA4C;SACrCb,OAAOwB,IAAP,CAAY,MAAZ,CADqC;UAEpCxB,OAAOI,GAAP,EAFoC;UAGpCJ,OAAOc,IAAP,CAAY,OAAZ;GAHR;EA9CsB;oBAoDJ,2BAAUW,IAAV,EAAgBX,IAAhB,EAAsB;MACpCY,WAAWzB,EAAE0B,iBAAF,CAAoB;cACvBrB,IAAIC,UAAJ,CAAe,gBAAf,CADuB;eAEtB,MAFsB;gBAGrB;eACD;;GAJE,CAAf;AAOA,AACA,MAAIqB,SAAS,EAAb;SACOd,IAAP,GAAc;WACLR,IAAIuB,aAAJ,EADK;WAELvB,IAAIwB,mBAAJ,EAFK;WAGL,UAHK;SAIPL,IAJO;WAKLX;GALT;SAOOiB,KAAP,GAAe,KAAf;SACOC,QAAP,GAAkB,MAAlB;eACaC,OAAb,CAAqBL,MAArB,EAA6BM,IAA7B,CAAkC,UAAUpB,IAAV,EAAgB;OAC7CqB,WAAWrB,KAAK,QAAL,CAAf;OACIc,SAAS;UACNO,SAAS,SAAT,CADM;UAEN;IAFP;oBAIiBC,WAAjB,CAA6BR,MAA7B;YACSD,iBAAT,CAA2B,EAAC,QAAQ,MAAT,EAA3B;GAPD,EAQGU,IARH,CAQQ,UAAUvB,IAAV,EAAgBwB,GAAhB,EAAqB;YACnBX,iBAAT,CAA2B,EAAC,QAAQ,MAAT,EAA3B;GATD;EAvEsB;;;;yBAsFC,kCAAY;MAC/BY,eAAe,IAAnB;MACIC,WAAWC,OAAO,mBAAP,EAA4BvB,IAA5B,CAAiC,WAAjC,CAAf;MACIwB,QAAQF,SAAStB,IAAT,CAAc,OAAd,CAAZ;;QAEMyB,IAAN,CAAW,YAAY;UACf,IAAP,EAAazB,IAAb,CAAkB,OAAlB,EAA2B0B,QAA3B,CAAoC;mBACpB,gBADoB;cAEzB,IAFyB;iBAGtB,SAHsB;cAIzB,MAJyB;cAKzB,gBAAU7C,CAAV,EAAa8C,EAAb,EAAiB;;;;QAIvBC,QAAH,GAAcH,IAAd,CAAmB,UAAUI,KAAV,EAAiBC,OAAjB,EAA0B;gBAClCP,OAAOO,OAAP,CAAV;cACQC,KAAR,CAAcD,QAAQC,KAAR,EAAd;MAFD;YAIOJ,EAAP;KAbkC;cAezB,gBAAU9C,CAAV,EAAa8C,EAAb,EAAiB;kBACbK,4BAAb;;IAhBF;GADD;EA3FsB;;;;+BAoHO,wCAAY;MACrCX,eAAe,IAAnB;MACIY,SAASV,OAAO,mBAAP,CAAb;MACIW,aAAaD,OAAOjC,IAAP,CAAY,qBAAZ,CAAjB;eACamC,sBAAb,GAAsC,EAAtC;aACWpC,WAAX,CAAuB,QAAvB;EAzHsB;;;;+BA8HO,wCAAY;MACrCkC,SAASV,OAAO,mBAAP,CAAb;MACIW,aAAaD,OAAOjC,IAAP,CAAY,qBAAZ,CAAjB;aACWC,QAAX,CAAoB,QAApB;EAjIsB;;;;wBAsIA,iCAAY;MAC9BoB,eAAe,IAAnB;MACIe,2BAA2Bb,OAAOd,iBAAP,CAAyB;eAC3C,MAD2C;gBAE1C;eACD;;GAHkB,CAA/B;MAMIC,SAAS,EAAb;SACO,QAAP,IAAmBtB,IAAIuB,aAAJ,EAAnB;SACO,QAAP,IAAmBvB,IAAIwB,mBAAJ,EAAnB;SACO,QAAP,IAAmB,UAAnB;SACO,MAAP,IAAiB,oBAAjB;SACO,eAAP,IAA0BS,aAAac,sBAAvC;;eAEapB,OAAb,CAAqBL,MAArB,EAA6BM,IAA7B,CAAkC,UAAUpB,IAAV,EAAgB;4BACxBa,iBAAzB,CAA2C,EAAC,QAAQ,MAAT,EAA3C;OACIC,SAAS,EAAb;UACO,MAAP,IAAiBtB,IAAIC,UAAJ,CAAe,6BAAf,CAAjB;4BACyBgD,WAAzB,CAAqC3B,MAArC;GAJD,EAKGS,IALH,CAKQ,UAAUmB,KAAV,EAAiB;4BACC7B,iBAAzB,CAA2C,EAAC,QAAQ,MAAT,EAA3C;GAND;EArJsB;;;;mCAiKW,4CAAY;MACzCY,eAAe,IAAnB;MACIC,WAAWC,OAAO,mBAAP,EAA4BvB,IAA5B,CAAiC,WAAjC,CAAf;;MAEIuC,iBAAiBjB,SAAStB,IAAT,CAAc,OAAd,CAArB;MACIwC,cAAcD,eAAevC,IAAf,CAAoB,IAApB,CAAlB;MACIyC,yBAAyB,CAA7B;cACYhB,IAAZ,CAAiB,UAAUiB,CAAV,EAAaC,UAAb,EAAyB;OACrCC,YAAYrB,OAAOoB,UAAP,CAAhB;OACIE,WAAWD,UAAUhD,IAAV,CAAe,OAAf,CAAf;gBACauC,sBAAb,CAAoCW,IAApC,CAAyC,EAAC,SAASD,QAAV,EAAoB,YAAYJ,sBAAhC,EAAzC;4BACyBA,yBAAyB,CAAlD;GAJD;EAxKsB;;;;kCAkLU,2CAAY;MACxCpB,eAAe,IAAnB;MACIY,SAASV,OAAO,mBAAP,CAAb;SACO/C,EAAP,CAAU,OAAV,EAAmB,qBAAnB,EAA0C,YAAY;gBACxCuE,4BAAb;gBACaC,gCAAb;gBACaC,qBAAb;GAHD;EArLsB;iBA2LP,0BAAY;oBACTC,UAAlB;OACKC,sBAAL;OACKC,+BAAL;;CA9LF;AAiMArE,EAAEsE,QAAF,EAAYC,KAAZ,CAAkB,YAAY;mBACXC,cAAlB;CADD"}