"use strict";var Settings_Index_Js={updatedBlockFieldsList:[],initEvants:function(){$(".SearchFieldsEdit .fieldname").on("change",Settings_Index_Js.save),$(".SearchFieldsEdit .searchcolumn").on("change",Settings_Index_Js.save),$(".SearchFieldsEdit .updateLabels").on("click",Settings_Index_Js.updateLabels),$(".SearchFieldsEdit .editLabels").on("click",Settings_Index_Js.editLabels),$(".SearchFieldsEdit .turn_off").on("click",Settings_Index_Js.replacement)},replacement:function(e){var target=$(e.currentTarget);parseInt(target.val())?target.val(0).html('<span class="fas fa-power-off u-mr-5px"></span>'+app.vtranslate("JS_TURN_ON")):target.val(1).html('<span class="fas fa-power-off u-mr-5px"></span>'+app.vtranslate("JS_TURN_OFF")),target.toggleClass("btn-success btn-danger"),Settings_Index_Js.save(e)},updateLabels:function(e){var closestTrElement=$(e.currentTarget).closest("tr");closestTrElement.hasClass("ui-sortable-handle")||(closestTrElement=closestTrElement.prev()),Settings_Index_Js.registerSaveEvent("updateLabels",{tabid:closestTrElement.data("tabid")})},editLabels:function(e){var tabId=$(e.currentTarget).data("tabid"),select=$(".elementEdit"+tabId).removeClass("d-none").find('[data-select-cb="registerSelectSortable"]');$(".elementLabels"+tabId).addClass("d-none"),App.Fields.Picklist.showSelect2ElementView(select,{sortableCb:function(currentSelect){Settings_Index_Js.registerSaveEvent("save",{name:currentSelect.attr("name"),value:currentSelect.val(),tabid:currentSelect.data("tabid")})}})},save:function(e){var target=$(e.currentTarget);Settings_Index_Js.registerSaveEvent("save",{name:target.attr("name"),value:target.val(),tabid:target.data("tabid")})},registerSaveEvent:function(mode,data){var progress=$.progressIndicator({message:app.vtranslate("Saving changes"),position:"html",blockInfo:{enabled:!0}}),params={};params.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:mode,params:data},params.async=!1,params.dataType="json",AppConnector.request(params).done((function(data){var params={text:data.result.message,type:"success"};Vtiger_Helper_Js.showPnotify(params),progress.progressIndicator({mode:"hide"})})).fail((function(data,err){progress.progressIndicator({mode:"hide"})}))},makeFieldsListSortable:function(){var thisInstance=this;jQuery(".SearchFieldsEdit").find(".contents").find("table").each((function(){jQuery(this).find("tbody").sortable({containment:"#modulesEntity",revert:!0,tolerance:"pointer",cursor:"move",helper:function(e,ui){return ui.children().each((function(index,element){(element=jQuery(element)).width(element.width())})),ui},update:function(e,ui){thisInstance.showSaveModuleSequenceButton()}})}))},showSaveModuleSequenceButton:function(){var saveButton=jQuery(".SearchFieldsEdit").find(".saveModuleSequence");this.updatedBlockFieldsList=[],saveButton.removeClass("d-none")},hideSaveModuleSequenceButton:function(){jQuery(".SearchFieldsEdit").find(".saveModuleSequence").addClass("d-none")},updateModulesSequence:function(){var progressIndicatorElement=jQuery.progressIndicator({position:"html",blockInfo:{enabled:!0}}),params={};params.module=app.getModuleName(),params.parent=app.getParentModuleName(),params.action="SaveAjax",params.mode="saveSequenceNumber",params.updatedFields=this.updatedBlockFieldsList,AppConnector.request(params).done((function(data){progressIndicatorElement.progressIndicator({mode:"hide"});var params={};params.text=app.vtranslate("JS_MODULES_SEQUENCE_UPDATED"),Settings_Vtiger_Index_Js.showMessage(params)})).fail((function(error){progressIndicatorElement.progressIndicator({mode:"hide"})}))},createUpdatedSequenceModulesList:function(){var thisInstance=this,editModules=jQuery(".SearchFieldsEdit").find(".contents").find("tbody").find("tr"),expectedModuleSequence=1;editModules.each((function(i,domElement){var moduleId=jQuery(domElement).data("tabid");thisInstance.updatedBlockFieldsList.push({tabid:moduleId,sequence:expectedModuleSequence}),expectedModuleSequence+=1}))},registerModuleSequenceSaveClick:function(){var thisInstance=this;jQuery(".SearchFieldsEdit").on("click",".saveModuleSequence",(function(){thisInstance.hideSaveModuleSequenceButton(),thisInstance.createUpdatedSequenceModulesList(),thisInstance.updateModulesSequence()}))},registerEvents:function(){Settings_Index_Js.initEvants(),this.makeFieldsListSortable(),this.registerModuleSequenceSaveClick()}};$(document).ready((function(){Settings_Index_Js.registerEvents()}));
//# sourceMappingURL=Search.min.js.map
