{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"Settings_CurrencyUpdate_Index_Js\", {}, {\n\t/*\n\t * Shows or hides block informing about supported currencies by presently chosen bank\n\t */\n\tregisterInfoButton: function (container) {\n\t\tcontainer.find('#supportedCurrencies').on('click', function () {\n\t\t\tjQuery('#infoBlock').toggleClass('d-none');\n\t\t});\n\t},\n\t/*\n\t * Shows or hides block informing about unsupported currencies by presently chosen bank\n\t */\n\tregisterAlertButton: function (container) {\n\t\tcontainer.find('#unsupportedCurrencies').on('click', function () {\n\t\t\tcontainer.find('#alertBlock').toggleClass('d-none');\n\t\t});\n\t},\n\t/*\n\t * Event fired on bank picklist change.\n\t * Daves the chosen bank as active in database.\n\t * Updates information about supported and unsupported currencies for currently chosen bank,\n\t */\n\tregisterBankChange: function (container) {\n\t\tcontainer.find('#bank').on('change', function () {\n\t\t\tlet bankName = container.find('#bank option:selected').data('name');\n\t\t\tcontainer.find('#alertSpan').html('');\n\t\t\tcontainer.find('#infoSpan').html('');\n\t\t\tlet infoProgress = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tparams = {};\n\t\t\tparams.data = {\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'GetBankCurrencies',\n\t\t\t\tmode: 'supported',\n\t\t\t\tname: bankName\n\t\t\t};\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tlet response = data['result'],\n\t\t\t\t\thtml = '',\n\t\t\t\t\tname;\n\t\t\t\tfor (name in response) {\n\t\t\t\t\thtml += '<p><strong>' + name + '</strong> - ' + response[name] + '</p>';\n\t\t\t\t}\n\t\t\t\tcontainer.find('#infoSpan').html(html);\n\t\t\t});\n\n\t\t\tparams.data = {\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'GetBankCurrencies',\n\t\t\t\tmode: 'unsupported',\n\t\t\t\tname: bankName\n\t\t\t};\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (jQuery.isEmptyObject(response)) {\n\t\t\t\t\tif (!container.find('#unsupportedCurrencies').hasClass('d-none')) {\n\t\t\t\t\t\tcontainer.find('#unsupportedCurrencies').addClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tif (!container.find('#alertBlock').hasClass('d-none')) {\n\t\t\t\t\t\tcontainer.find('#alertBlock').addClass('d-none')\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.find('#unsupportedCurrencies').removeClass('d-none');\n\t\t\t\t}\n\t\t\t\tlet html = '',\n\t\t\t\t\tname;\n\t\t\t\tfor (name in response) {\n\t\t\t\t\thtml += '<p><strong>' + name + '</strong> - ' + response[name] + '</p>';\n\t\t\t\t}\n\t\t\t\tcontainer.find('#alertSpan').html(html);\n\t\t\t});\n\n\t\t\tlet bankId = jQuery('#bank option:selected').val();\n\t\t\tparams.data = {\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'SaveActiveBank',\n\t\t\t\tid: bankId\n\t\t\t};\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (response['success']) {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\thide: false,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tinfoProgress.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents: function () {\n\t\tvar container = jQuery('#currencyUpdateContainer');\n\t\tApp.Fields.Date.register('#datepicker', false, {});\n\t\tthis.registerInfoButton(container);\n\t\tthis.registerAlertButton(container);\n\t\tthis.registerBankChange(container);\n\t}\n});\n"],"names":["jQuery","Class","container","find","on","toggleClass","bankName","data","html","infoProgress","progressIndicator","params","app","getParentModuleName","getModuleName","dataType","request","done","response","name","isEmptyObject","hasClass","addClass","removeClass","bankId","val","showPnotify","Fields","Date","register","registerInfoButton","registerAlertButton","registerBankChange"],"mappings":"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"}