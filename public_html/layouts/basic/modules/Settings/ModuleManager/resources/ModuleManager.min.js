

"use strict";jQuery.Class("Settings_Module_Manager_Js",{validateField:function(e,t,a,n){return!/[&\<\>\:\'\"\,]/.test(e.val())||app.vtranslate("JS_SPECIAL_CHARACTERS_NOT_ALLOWED")},registerMondalCreateModule:function(e){e.find('[name="saveButton"]').attr("disabled",!0);var t=e.find("form");t.validationEngine(app.validationEngineOptions);var a=new Settings_Module_Manager_Js;e.find("input").on("change",function(t){"module_name"==$(this).attr("name")?a.checkModuleName($(this).val(),e):""!=$(this).val()?$(this).attr("check",!0):$(this).attr("check",!1);var n=!0;e.find("input[name]").each(function(){"false"!=$(this).attr("check")&&null!=$(this).attr("check")||(n=!1)}),n?e.find('[name="saveButton"]').attr("disabled",!1):e.find('[name="saveButton"]').attr("disabled",!0)}),e.find('[name="saveButton"]').on("click",function(a){if(t.validationEngine("validate")){e.find('[name="saveButton"]').attr("disabled",!0);var n=t.serializeFormData(),o=$.progressIndicator({message:app.vtranslate("Adding a Key"),blockInfo:{enabled:!0}}),r={};r.module=app.getModuleName(),r.parent=app.getParentModuleName(),r.action="Basic",r.mode="createModule",r.formData=n,AppConnector.request(r).done(function(e){var t=e.result;t.success?window.location.href="index.php?parent=Settings&module=LayoutEditor&sourceModule="+t.text:(Vtiger_Helper_Js.showPnotify({text:t.text,type:"error"}),e.find('[name="saveButton"]').attr("disabled",!1))}),o.progressIndicator({mode:"hide"})}})}},{updateModuleStatus:function(e){var t=jQuery.Deferred(),a=e.data("module"),n=e.is(":checked"),o=jQuery.progressIndicator({position:"html",blockInfo:{enabled:!0}}),r={};return r.module=app.getModuleName(),r.parent=app.getParentModuleName(),r.updateStatus=n,r.forModule=a,r.action="Basic",r.mode="updateModuleStatus",AppConnector.request(r).done(function(e){o.progressIndicator({mode:"hide"}),t.resolve(e)}).fail(function(e){o.progressIndicator({mode:"hide"}),t.reject(e)}),t.promise()},createModule:function(e){var t=jQuery.progressIndicator();app.showModalWindow(null,"index.php?module=ModuleManager&parent=Settings&view=CreateModule",function(e){t.progressIndicator({mode:"hide"}),Settings_Module_Manager_Js.registerMondalCreateModule(e)})},checkModuleName:function(e,t){var a=jQuery.progressIndicator();t.find('[name="module_name"]').attr("check",!1);var n={};n.data={module:app.getModuleName(),action:"Basic",parent:app.getParentModuleName(),mode:"checkModuleName",moduleName:e},n.async=!1,n.dataType="json",AppConnector.request(n).done(function(e){var n=e.result;n.success?t.find('[name="module_name"]').attr("check",!0):(t.find('[name="module_name"]').attr("check",!1),Vtiger_Helper_Js.showPnotify({text:n.text,type:"error"}),t.find('[name="saveButton"]').attr("disabled",!0)),a.progressIndicator({mode:"hide"})})},showNotify:function(e){var t={title:app.vtranslate("JS_MESSAGE"),text:"",type:"info"};$.extend(t,e),Vtiger_Helper_Js.showPnotify(t)},frameProgress:!1,deleteModule:function(e){e.on("click",".deleteModule",function(e){var t=jQuery(e.currentTarget).attr("name"),a={};a.data={module:app.getModuleName(),action:"Basic",parent:app.getParentModuleName(),mode:"deleteModule",forModule:t},this.frameProgress=$.progressIndicator({position:"html",message:app.vtranslate("JS_FRAME_IN_PROGRESS"),blockInfo:{enabled:!0}}),AppConnector.request(a).done(function(e){Vtiger_Helper_Js.showPnotify({title:app.vtranslate("JS_REMOVED_MODULE"),type:"info"}),window.location.href="index.php?module=ModuleManager&parent=Settings&view=List"})})},registerEvents:function(e){var t=this,a=jQuery("#moduleManagerContents");a.find(".createModule").on("click",t.createModule);var n=a.find(".js-scrollbar");app.showNewScrollbarTopBottom(n),t.deleteModule(a),a.on("click",'[name="moduleStatus"]',function(e){var a=jQuery(e.currentTarget),n=a.closest(".moduleManagerBlock"),o=n.find(".actions"),r=a.data("moduleTranslation"),d=n.find(".moduleImage, .moduleName");a.is(":checked")?(o.removeClass("d-none"),d.removeClass("dull"),t.updateModuleStatus(a).done(function(e){var a={text:r+" "+app.vtranslate("JS_MODULE_ENABLED")};0==e.success&&(a.type="error",a.text=e.error.message),t.showNotify(a)})):(o.addClass("d-none"),d.addClass("dull"),t.updateModuleStatus(a).done(function(e){var a={text:r+" "+app.vtranslate("JS_MODULE_DISABLED")};t.showNotify(a)}))})}}),jQuery(document).ready(function(){(new Settings_Module_Manager_Js).registerEvents()});
//# sourceMappingURL=ModuleManager.min.js.map