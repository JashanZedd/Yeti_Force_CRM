{"version":3,"file":"Edit3.min.js","sources":["Edit3.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\"Settings_Workflows_Edit3_Js\", {}, {\n\tstep3Container: false,\n\tadvanceFilterInstance: false,\n\tconditionBuilderInstance: false,\n\tckEditorInstance: false,\n\tfieldValueMap: false,\n\tinit: function () {\n\t\tthis.initialize();\n\t},\n\t/**\n\t * Function to get the container which holds all the reports step1 elements\n\t * @return jQuery object\n\t */\n\tgetContainer: function () {\n\t\treturn this.step3Container;\n\t},\n\t/**\n\t * Function to set the reports step1 container\n\t * @params : element - which represents the reports step1 container\n\t * @return : current instance\n\t */\n\tsetContainer: function (element) {\n\t\tthis.step3Container = element;\n\t\treturn this;\n\t},\n\t/**\n\t * Function  to intialize the reports step1\n\t */\n\tinitialize: function (container) {\n\t\tif (typeof container === \"undefined\") {\n\t\t\tcontainer = $('#workflow_step3');\n\t\t}\n\t\tif (container.is('#workflow_step3')) {\n\t\t\tthis.setContainer(container);\n\t\t} else {\n\t\t\tthis.setContainer($('#workflow_step3'));\n\t\t}\n\t},\n\tregisterEditTaskEvent: function () {\n\t\tlet thisInstance = this,\n\t\t\tcontainer = this.getContainer();\n\t\tcontainer.on('click', '[data-url]', function (e) {\n\t\t\tlet currentElement = $(e.currentTarget),\n\t\t\t\tparams = currentElement.data('url'),\n\t\t\t\tprogressIndicatorElement = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\tapp.showModalWindow(null, params, function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\t\tif (data) {\n\t\t\t\t\tlet clipboard = App.Fields.Text.registerCopyClipboard(data);\n\t\t\t\t\tcontainer.one('hidden.bs.modal', () => {\n\t\t\t\t\t\tclipboard.destroy();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthisInstance.registerVTCreateTodoTaskEvents();\n\t\t\t\tvar taskType = $('#taskType').val();\n\t\t\t\tvar functionName = 'register' + taskType + 'Events';\n\t\t\t\tif (typeof thisInstance[functionName] !== \"undefined\") {\n\t\t\t\t\tthisInstance[functionName].apply(thisInstance);\n\t\t\t\t}\n\t\t\t\tthisInstance.registerSaveTaskSubmitEvent(taskType);\n\t\t\t\t$('#saveTask').validationEngine(app.validationEngineOptions);\n\t\t\t\tthisInstance.registerFillTaskFieldsEvent();\n\t\t\t\tthisInstance.registerCheckSelectDateEvent();\n\t\t\t\tApp.Tools.VariablesPanel.registerRefreshCompanyVariables(data);\n\t\t\t\tthisInstance.conditionBuilderInstance = new Vtiger_ConditionBuilder_Js(data.find('.js-condition-builder'), data.find('.js-source-module').val());\n\t\t\t\tthisInstance.conditionBuilderInstance.registerEvents();\n\t\t\t});\n\n\t\t});\n\t},\n\tregisterCheckSelectDateEvent: function () {\n\t\t$('[name=\"check_select_date\"]').on('change', function (e) {\n\t\t\tif ($(e.currentTarget).is(':checked')) {\n\t\t\t\t$('#checkSelectDateContainer').removeClass('d-none').addClass('show');\n\t\t\t} else {\n\t\t\t\t$('#checkSelectDateContainer').removeClass('show').addClass('d-none');\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Register save task submit event\n\t * @param {string} taskType\n\t */\n\tregisterSaveTaskSubmitEvent(taskType) {\n\t\t$('#saveTask').on('submit', (e) => {\n\t\t\tlet form = $(e.currentTarget);\n\t\t\tif (form.validationEngine('validate') === true) {\n\t\t\t\tlet customValidationFunctionName = taskType + 'CustomValidation';\n\t\t\t\tif (typeof this[customValidationFunctionName] !== \"undefined\") {\n\t\t\t\t\tlet result = this[customValidationFunctionName].apply(this);\n\t\t\t\t\tif (result !== true) {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: result,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet preSaveActionFunctionName = 'preSave' + taskType;\n\t\t\t\tif (typeof this[preSaveActionFunctionName] !== \"undefined\") {\n\t\t\t\t\tthis[preSaveActionFunctionName].apply(this, [taskType]);\n\t\t\t\t}\n\t\t\t\tlet formData = form.serializeFormData();\n\t\t\t\tformData.entity_type = form.find('.createEntityModule:visible option:selected').val();\n\t\t\t\tAppConnector.request(formData).done((data) => {\n\t\t\t\t\tif (data.result) {\n\t\t\t\t\t\tthis.getTaskList();\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t});\n\t},\n\tVTUpdateFieldsTaskCustomValidation: function () {\n\t\treturn this.checkDuplicateFieldsSelected();\n\t},\n\tVTCreateEntityTaskCustomValidation: function () {\n\t\treturn this.checkDuplicateFieldsSelected();\n\t},\n\tcheckDuplicateFieldsSelected: function () {\n\t\tvar selectedFieldNames = $('#save_fieldvaluemapping').find('.js-conditions-row').find('[name=\"fieldname\"]');\n\t\tvar result = true;\n\t\tvar failureMessage = app.vtranslate('JS_SAME_FIELDS_SELECTED_MORE_THAN_ONCE');\n\t\t$.each(selectedFieldNames, function (i, ele) {\n\t\t\tvar fieldName = $(ele).attr(\"value\");\n\t\t\tvar fields = $(\"[name=\" + fieldName + \"]\").not(':hidden');\n\t\t\tif (fields.length > 1) {\n\t\t\t\tresult = failureMessage;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\tpreSaveVTUpdateFieldsTask: function (tasktype) {\n\t\tvar values = this.getValues(tasktype);\n\t\t$('[name=\"field_value_mapping\"]').val(JSON.stringify(values));\n\t},\n\tpreSaveVTCreateEntityTask: function (tasktype) {\n\t\tvar values = this.getValues(tasktype);\n\t\t$('[name=\"field_value_mapping\"]').val(JSON.stringify(values));\n\t},\n\tpreSaveVTEmailTask: function (tasktype) {\n\t\tvar textAreaElement = $('#content');\n\t\t//To keep the plain text value to the textarea which need to be\n\t\t//sent to server\n\t\ttextAreaElement.val(CKEDITOR.instances['content'].getData());\n\t},\n\tpreSaveVTUpdateRelatedFieldTask: function (tasktype) {\n\t\tvar values = this.getValues(tasktype);\n\t\t$('[name=\"field_value_mapping\"]').val(JSON.stringify(values));\n\t},\n\tpreSaveSumFieldFromDependent: function (tasktype) {\n\t\t$('[name=\"conditions\"]').val(JSON.stringify(this.conditionBuilderInstance.getConditions()));\n\t},\n\t/**\n\t * Function to check if the field selected is empty field\n\t * @params : select element which represents the field\n\t * @return : boolean true/false\n\t */\n\tisEmptyFieldSelected: function (fieldSelect) {\n\t\tvar selectedOption = fieldSelect.find('option:selected');\n\t\t//assumption that empty field will be having value none\n\t\tif (selectedOption.val() === 'none' || !selectedOption.val()) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\tgetVTCreateEntityTaskFieldList: function () {\n\t\treturn new Array('fieldname', 'value', 'valuetype', 'modulename');\n\t},\n\tgetVTUpdateFieldsTaskFieldList: function () {\n\t\treturn new Array('fieldname', 'value', 'valuetype');\n\t},\n\tgetVTUpdateRelatedFieldTaskFieldList: function () {\n\t\treturn new Array('fieldname', 'value', 'valuetype');\n\t},\n\t/**\n\t * Get values\n\t * @param {string} tasktype\n\t * @returns {Array}\n\t */\n\tgetValues(tasktype) {\n\t\tlet fieldListFunctionName = 'get' + tasktype + 'FieldList',\n\t\t\tfieldList = [];\n\t\tif (typeof this[fieldListFunctionName] !== \"undefined\") {\n\t\t\tfieldList = this[fieldListFunctionName].apply()\n\t\t}\n\n\t\tlet values = [];\n\t\t$('.js-conditions-row', $('#save_fieldvaluemapping')).each((i, conditionDomElement) => {\n\t\t\tlet rowElement = $(conditionDomElement),\n\t\t\t\tfieldSelectElement = $('[name=\"fieldname\"]', rowElement),\n\t\t\t\tvalueSelectElement = $('[data-value=\"value\"]', rowElement);\n\t\t\t//To not send empty fields to server\n\t\t\tif (this.isEmptyFieldSelected(fieldSelectElement)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet fieldDataInfo = fieldSelectElement.find('option:selected').data('fieldinfo'),\n\t\t\t\tfieldType = fieldDataInfo.type,\n\t\t\t\trowValues = {},\n\t\t\t\tkey,\n\t\t\t\tfield;\n\t\t\tif (fieldType === 'owner') {\n\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\tif (field == 'value' && valueSelectElement.is('select')) {\n\t\t\t\t\t\trowValues[field] = valueSelectElement.find('option:selected').val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (fieldType === 'picklist' || fieldType == 'multipicklist') {\n\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\tif (field === 'value' && valueSelectElement.is('input')) {\n\t\t\t\t\t\tlet pickListValues = valueSelectElement.data('picklistvalues'),\n\t\t\t\t\t\t\tvaluesArr = valueSelectElement.val().split(','),\n\t\t\t\t\t\t\tnewValuesArr = [];\n\t\t\t\t\t\tfor (let j = 0; j < valuesArr.length; j++) {\n\t\t\t\t\t\t\tif (typeof pickListValues[valuesArr[j]] !== \"undefined\") {\n\t\t\t\t\t\t\t\tnewValuesArr.push(pickListValues[valuesArr[j]]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewValuesArr.push(valuesArr[j]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trowValues[field] = newValuesArr.join(',');\n\t\t\t\t\t} else if (field === 'value' && valueSelectElement.is('select') && fieldType == 'picklist') {\n\t\t\t\t\t\trowValues[field] = valueSelectElement.val();\n\t\t\t\t\t} else if (field === 'value' && valueSelectElement.is('select') && fieldType == 'multipicklist') {\n\t\t\t\t\t\tvar value = valueSelectElement.val();\n\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\trowValues[field] = value;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trowValues[field] = value.join(',');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\tif (field == 'value') {\n\t\t\t\t\t\trowValues[field] = valueSelectElement.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($('[name=\"valuetype\"]', rowElement).val() == 'false' || ($('[name=\"valuetype\"]', rowElement).length == 0)) {\n\t\t\t\trowValues['valuetype'] = 'rawtext';\n\t\t\t}\n\n\t\t\tvalues.push(rowValues);\n\t\t});\n\t\treturn values;\n\t},\n\tgetTaskList: function () {\n\t\tvar container = this.getContainer();\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'TasksList',\n\t\t\trecord: $('[name=\"record\"]', container).val()\n\t\t}\n\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\t$('#taskListContainer').html(data);\n\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t});\n\t},\n\t/**\n\t * Function to get ckEditorInstance\n\t */\n\tgetckEditorInstance: function () {\n\t\tif (this.ckEditorInstance === false) {\n\t\t\tthis.ckEditorInstance = new App.Fields.Text.Editor();\n\t\t}\n\t\treturn this.ckEditorInstance;\n\t},\n\tregisterTaskStatusChangeEvent: function () {\n\t\tvar container = this.getContainer();\n\t\tcontainer.on('change', '.taskStatus', function (e) {\n\t\t\tvar currentStatusElement = $(e.currentTarget);\n\t\t\tvar url = currentStatusElement.data('statusurl');\n\t\t\tif (currentStatusElement.is(':checked')) {\n\t\t\t\turl = url + '&status=true';\n\t\t\t} else {\n\t\t\t\turl = url + '&status=false';\n\t\t\t}\n\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\tif (data.result == \"ok\") {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\ttext: app.vtranslate('JS_STATUS_CHANGED_SUCCESSFULLY'),\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t}\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t\t\te.stopImmediatePropagation();\n\t\t});\n\t},\n\tregisterTaskDeleteEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = this.getContainer();\n\t\tcontainer.on('click', '.deleteTask', function (e) {\n\t\t\tvar message = app.vtranslate('LBL_DELETE_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t'message': message\n\t\t\t}).done(function () {\n\t\t\t\tvar currentElement = $(e.currentTarget);\n\t\t\t\tvar deleteUrl = currentElement.data('deleteurl');\n\t\t\t\tAppConnector.request(deleteUrl).done(function (data) {\n\t\t\t\t\tif (data.result == 'ok') {\n\t\t\t\t\t\tthisInstance.getTaskList();\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_TASK_DELETED_SUCCESSFULLY'),\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\tregisterFillTaskFromEmailFieldEvent: function () {\n\t\t$('#saveTask').on('change', '#fromEmailOption', function (e) {\n\t\t\tvar currentElement = $(e.currentTarget);\n\t\t\tvar inputElement = currentElement.closest('.row').find('.fields');\n\t\t\tinputElement.val(currentElement.val());\n\t\t})\n\t},\n\tregisterFillTaskFieldsEvent: function () {\n\t\t$('#saveTask').on('change', '.task-fields', function (e) {\n\t\t\tvar currentElement = $(e.currentTarget);\n\t\t\tvar inputElement = currentElement.closest('.row').find('.fields');\n\t\t\tvar oldValue = inputElement.val();\n\t\t\tvar newValue = oldValue + currentElement.val();\n\t\t\tinputElement.val(newValue);\n\t\t})\n\t},\n\tregisterFillMailContentEvent: function () {\n\t\t$('#task-fieldnames,#task_timefields,#task-templates').on('change', function (e) {\n\t\t\tvar textarea = CKEDITOR.instances.content;\n\t\t\tvar value = $(e.currentTarget).val();\n\t\t\tif (textarea != undefined) {\n\t\t\t\ttextarea.insertHtml(value);\n\t\t\t} else if ($('textarea[name=\"content\"]')) {\n\t\t\t\tvar textArea = $('textarea[name=\"content\"]');\n\t\t\t\ttextArea.insertAtCaret(value);\n\t\t\t}\n\t\t});\n\t},\n\tregisterVTEmailTaskEvents: function () {\n\t\tvar textAreaElement = $('#content');\n\t\tvar ckEditorInstance = this.getckEditorInstance();\n\t\tckEditorInstance.loadEditor(textAreaElement);\n\t\tthis.registerFillMailContentEvent();\n\t\tthis.registerFillTaskFromEmailFieldEvent();\n\t\tthis.registerCcAndBccEvents();\n\t},\n\tregisterVTCreateTodoTaskEvents: function () {\n\t\tapp.registerEventForClockPicker();\n\t},\n\tregisterVTUpdateFieldsTaskEvents: function () {\n\t\tvar thisInstance = this;\n\t\tthis.registerAddFieldEvent();\n\t\tthis.registerDeleteConditionEvent();\n\t\tthis.registerFieldChange();\n\t\tthis.fieldValueMap = false;\n\t\tif ($('#fieldValueMapping').val() != '') {\n\t\t\tthis.fieldValueReMapping();\n\t\t}\n\t\tvar fields = $('#save_fieldvaluemapping').find('select[name=\"fieldname\"]');\n\t\t$.each(fields, function (i, field) {\n\t\t\tthisInstance.loadFieldSpecificUi($(field));\n\t\t});\n\t\tthis.getPopUp($('#saveTask'));\n\t},\n\tregisterVTUpdateRelatedFieldTaskEvents: function () {\n\t\tvar thisInstance = this;\n\t\tthis.registerAddFieldEvent();\n\t\tthis.registerDeleteConditionEvent();\n\t\tthis.registerFieldChange();\n\t\tthis.fieldValueMap = false;\n\t\tif ($('#fieldValueMapping').val() != '') {\n\t\t\tthis.fieldValueReMapping();\n\t\t}\n\t\tvar fields = $('#save_fieldvaluemapping').find('select[name=\"fieldname\"]');\n\t\t$.each(fields, function (i, field) {\n\t\t\tthisInstance.loadFieldSpecificUi($(field));\n\t\t});\n\t\tthis.getPopUp($('#saveTask'));\n\t},\n\t/**\n\t * Add field\n\t * @param {jQuery|null} replaceElement - if we want to replace existing field container with new one\n\t */\n\taddField(replaceElement = null) {\n\t\tconst newAddFieldContainer = $('.js-add-basic-field-container').clone(true, true).removeClass('js-add-basic-field-container d-none').addClass('js-conditions-row');\n\t\t$('select', newAddFieldContainer).addClass('select2');\n\t\tif (replaceElement === null) {\n\t\t\t$('#save_fieldvaluemapping').append(newAddFieldContainer);\n\t\t} else {\n\t\t\treplaceElement.replaceWith(newAddFieldContainer);\n\t\t}\n\t\t//change in to select elements\n\t\tApp.Fields.Picklist.changeSelectElementView(newAddFieldContainer);\n\t},\n\t/**\n\t * Register add field event\n\t */\n\tregisterAddFieldEvent() {\n\t\t$('#addFieldBtn').on('click', (e) => {\n\t\t\tthis.addField();\n\t\t});\n\t},\n\tregisterDeleteConditionEvent() {\n\t\t$('#saveTask').on('click', '.js-condition-delete', (e) => {\n\t\t\t$(e.currentTarget).closest('.js-conditions-row').remove();\n\t\t});\n\t},\n\t/**\n\t * Function which will register field change event\n\t */\n\tregisterFieldChange() {\n\t\t$('#saveTask').on('change', 'select[name=\"fieldname\"]', (e) => {\n\t\t\tconst selectedElement = $(e.currentTarget);\n\t\t\tconst conditionRow = selectedElement.closest('.js-conditions-row');\n\t\t\tif (selectedElement.val() !== 'none' && selectedElement.val()) {\n\t\t\t\tvar moduleNameElement = conditionRow.find('[name=\"modulename\"]');\n\t\t\t\tif (moduleNameElement.length > 0) {\n\t\t\t\t\tvar selectedOptionFieldInfo = selectedElement.find('option:selected').data('fieldinfo');\n\t\t\t\t\tvar type = selectedOptionFieldInfo.type;\n\t\t\t\t\tif (type == 'picklist' || type == 'multipicklist') {\n\t\t\t\t\t\tvar selectElement = $('select.createEntityModule:not(:disabled)');\n\t\t\t\t\t\tvar moduleName = selectElement.val();\n\t\t\t\t\t\tmoduleNameElement.val(moduleName).change().prop('disabled', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.loadFieldSpecificUi(selectedElement);\n\t\t\t} else {\n\t\t\t\tthis.addField(conditionRow);\n\t\t\t}\n\t\t});\n\t},\n\tgetModuleName: function () {\n\t\treturn app.getModuleName();\n\t},\n\tgetFieldValueMapping: function () {\n\t\tvar fieldValueMap = this.fieldValueMap;\n\t\tif (fieldValueMap != false) {\n\t\t\treturn fieldValueMap;\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t},\n\tfieldValueReMapping: function () {\n\t\tvar object = JSON.parse($('#fieldValueMapping').val());\n\t\tvar fieldValueReMap = {};\n\n\t\t$.each(object, function (i, array) {\n\t\t\tfieldValueReMap[array.fieldname] = {};\n\t\t\tvar values = {}\n\t\t\t$.each(array, function (key, value) {\n\t\t\t\tvalues[key] = value;\n\t\t\t});\n\t\t\tfieldValueReMap[array.fieldname] = values\n\t\t});\n\t\tthis.fieldValueMap = fieldValueReMap;\n\t},\n\t/**\n\t * Load field specific UI\n\t * @param {jQuery} fieldSelect\n\t * @returns this\n\t */\n\tloadFieldSpecificUi(fieldSelect) {\n\t\tconst selectedOption = fieldSelect.find('option:selected');\n\t\tconst row = fieldSelect.closest('div.js-conditions-row');\n\t\tconst fieldUiHolder = row.find('.fieldUiHolder');\n\t\tconst fieldInfo = selectedOption.data('fieldinfo');\n\t\tconst fieldValueMapping = this.getFieldValueMapping();\n\t\tlet selectField = '';\n\t\tif (fieldValueMapping && typeof fieldValueMapping[fieldInfo.name] !== \"undefined\") {\n\t\t\tselectField = fieldValueMapping[fieldInfo.name];\n\t\t} else if (fieldValueMapping && typeof fieldValueMapping[fieldSelect.val()] !== \"undefined\") {\n\t\t\tselectField = fieldValueMapping[fieldSelect.val()];\n\t\t}\n\t\tif (selectField) {\n\t\t\tfieldInfo.value = selectField['value'];\n\t\t\tfieldInfo.workflow_valuetype = selectField['valuetype'];\n\t\t} else {\n\t\t\tfieldInfo.workflow_valuetype = 'rawtext';\n\t\t}\n\t\tconst moduleName = this.getModuleName();\n\t\tconst fieldModel = Vtiger_Field_Js.getInstance(fieldInfo, moduleName);\n\t\tthis.fieldModelInstance = fieldModel;\n\t\tconst fieldSpecificUi = this.getFieldSpecificUi(fieldSelect);\n\t\t//remove validation since we dont need validations for all eleements\n\t\t// Both filter and find is used since we dont know whether the element is enclosed in some conainer like currency\n\t\tlet fieldName = fieldModel.getName();\n\t\tif (fieldModel.getType() == 'multipicklist') {\n\t\t\tfieldName = fieldName + \"[]\";\n\t\t}\n\t\tfieldSpecificUi.filter('[name=\"' + fieldName + '\"]').attr('data-value', 'value');\n\t\tfieldSpecificUi.find('[name=\"' + fieldName + '\"]').attr('data-value', 'value');\n\t\tfieldSpecificUi.filter('[name=\"valuetype\"]').removeAttr('data-validation-engine');\n\t\tfieldSpecificUi.find('[name=\"valuetype\"]').removeAttr('data-validation-engine');\n\t\t//If the workflowValueType is rawtext then only validation should happen\n\t\tconst workflowValueType = fieldSpecificUi.filter('[name=\"valuetype\"]').val();\n\t\tif (workflowValueType != 'rawtext' && typeof workflowValueType !== \"undefined\") {\n\t\t\tfieldSpecificUi.filter('[name=\"' + fieldName + '\"]').removeAttr('data-validation-engine');\n\t\t\tfieldSpecificUi.find('[name=\"' + fieldName + '\"]').removeAttr('data-validation-engine');\n\t\t}\n\t\tfieldUiHolder.html(fieldSpecificUi);\n\t\tif (fieldSpecificUi.is('input.select2') || fieldSpecificUi.is('select')) {\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(fieldSpecificUi);\n\t\t} else if (fieldSpecificUi.is('input.dateField')) {\n\t\t\tApp.Fields.Date.register(fieldSpecificUi);\n\t\t} else if (fieldSpecificUi.is('input.dateRangeField')) {\n\t\t\tApp.Fields.Date.registerRange(fieldSpecificUi, { ranges: false });\n\t\t}\n\t\treturn this;\n\t},\n\t/**\n\t * Functiont to get the field specific ui for the selected field\n\t * @prarms : fieldSelectElement - select element which will represents field list\n\t * @return : jquery object which represents the ui for the field\n\t */\n\tgetFieldSpecificUi: function (fieldSelectElement) {\n\t\tvar fieldModel = this.fieldModelInstance;\n\t\treturn $(fieldModel.getUiTypeSpecificHtml())\n\t},\n\tregisterVTCreateEventTaskEvents: function () {\n\t\tapp.registerEventForClockPicker();\n\t},\n\tregisterVTCreateEntityTaskEvents: function () {\n\t\tthis.registerChangeCreateEntityEvent();\n\t\tthis.registerVTUpdateFieldsTaskEvents();\n\t},\n\tregisterChangeCreateEntityEvent: function () {\n\t\tvar thisInstance = this;\n\t\t$('[name=\"mappingPanel\"]').on('change', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tapp.setMainParams('mappingPanel', currentTarget.val())\n\t\t\t$('#addCreateEntityContainer').html('');\n\t\t\tvar hideElementByClass = $('.' + currentTarget.data('hide'));\n\t\t\tvar showElementByClass = $('.' + currentTarget.data('show'));\n\t\t\tvar taskFields = app.getMainParams('taskFields', true);\n\t\t\thideElementByClass.addClass('d-none').find('input,select').each(function (e, n) {\n\t\t\t\tvar element = $(this);\n\t\t\t\tvar name = element.attr('name');\n\t\t\t\tif ($.inArray(name, taskFields) >= 0) {\n\t\t\t\t\tif (element.is('select')) {\n\t\t\t\t\t\telement.val('').trigger('change');\n\t\t\t\t\t}\n\t\t\t\t\telement.prop('disabled', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tshowElementByClass.removeClass('d-none').find('input,select').each(function (e, n) {\n\t\t\t\tvar element = $(this);\n\t\t\t\tvar name = element.attr('name');\n\t\t\t\tif ($.inArray(name, taskFields) >= 0) {\n\t\t\t\t\telement.prop('disabled', false);\n\t\t\t\t\tif (element.is('select')) {\n\t\t\t\t\t\telement.val('').trigger('change');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t$('.createEntityModule').on('change', function (e) {\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tview: 'CreateEntity',\n\t\t\t\tfor_workflow: $('[name=\"for_workflow\"]').val(),\n\t\t\t\tmappingPanel: app.getMainParams('mappingPanel')\n\t\t\t}\n\t\t\tvar relatedModule = $(e.currentTarget).val();\n\t\t\tif (relatedModule) {\n\t\t\t\tparams['relatedModule'] = relatedModule;\n\t\t\t}\n\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' })\n\t\t\t\tvar createEntityContainer = $('#addCreateEntityContainer');\n\t\t\t\tcreateEntityContainer.html(data);\n\t\t\t\tApp.Fields.Picklist.changeSelectElementView(createEntityContainer);\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(createEntityContainer.find('.select2'));\n\t\t\t\tthisInstance.registerAddFieldEvent();\n\t\t\t\tthisInstance.fieldValueMap = false;\n\t\t\t\tif ($('#fieldValueMapping').val() != '') {\n\t\t\t\t\tthis.fieldValueReMapping();\n\t\t\t\t}\n\t\t\t\tvar fields = $('#save_fieldvaluemapping').find('select[name=\"fieldname\"]');\n\t\t\t\t$.each(fields, function (i, field) {\n\t\t\t\t\tthisInstance.loadFieldSpecificUi($(field));\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function which will change the UI styles based on recurring type\n\t * @params - recurringType - which recurringtype is selected\n\t */\n\tchangeRecurringTypesUIStyles: function (recurringType) {\n\t\tif (recurringType == 'Daily' || recurringType == 'Yearly') {\n\t\t\t$('#repeatWeekUI').removeClass('show').addClass('d-none');\n\t\t\t$('#repeatMonthUI').removeClass('show').addClass('d-none');\n\t\t} else if (recurringType == 'Weekly') {\n\t\t\t$('#repeatWeekUI').removeClass('d-none').addClass('show');\n\t\t\t$('#repeatMonthUI').removeClass('show').addClass('d-none');\n\t\t} else if (recurringType == 'Monthly') {\n\t\t\t$('#repeatWeekUI').removeClass('show').addClass('d-none');\n\t\t\t$('#repeatMonthUI').removeClass('d-none').addClass('show');\n\t\t}\n\t},\n\tcheckHiddenStatusofCcandBcc: function () {\n\t\tvar ccLink = $('#ccLink');\n\t\tvar bccLink = $('#bccLink');\n\t\tif (ccLink.hasClass('d-none') && bccLink.hasClass('d-none')) {\n\t\t\tccLink.closest('div.row').addClass('d-none');\n\t\t}\n\t},\n\t/*\n\t * Function to register the events for bcc and cc links\n\t */\n\tregisterCcAndBccEvents: function () {\n\t\tvar thisInstance = this;\n\t\t$('#ccLink').on('click', function (e) {\n\t\t\tvar ccContainer = $('#ccContainer');\n\t\t\tccContainer.removeClass('d-none');\n\t\t\tvar taskFieldElement = ccContainer.find('select.task-fields');\n\t\t\ttaskFieldElement.addClass('select2');\n\t\t\tApp.Fields.Picklist.changeSelectElementView(taskFieldElement);\n\t\t\t$(e.currentTarget).addClass('d-none');\n\t\t\tthisInstance.checkHiddenStatusofCcandBcc();\n\t\t});\n\t\t$('#bccLink').on('click', function (e) {\n\t\t\tvar bccContainer = $('#bccContainer');\n\t\t\tbccContainer.removeClass('d-none');\n\t\t\tvar taskFieldElement = bccContainer.find('select.task-fields');\n\t\t\ttaskFieldElement.addClass('select2');\n\t\t\tApp.Fields.Picklist.changeSelectElementView(taskFieldElement);\n\t\t\t$(e.currentTarget).addClass('d-none');\n\t\t\tthisInstance.checkHiddenStatusofCcandBcc();\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tvar container = this.getContainer();\n\t\tApp.Fields.Picklist.changeSelectElementView(container);\n\t\tthis.registerEditTaskEvent();\n\t\tthis.registerTaskStatusChangeEvent();\n\t\tthis.registerTaskDeleteEvent();\n\t}\n});\n\n//http://stackoverflow.com/questions/946534/insert-text-into-textarea-with-jquery\n$.fn.extend({\n\tinsertAtCaret: function (myValue) {\n\t\treturn this.each(function (i) {\n\t\t\tif (document.selection) {\n\t\t\t\t//For browsers like Internet Explorer\n\t\t\t\tthis.focus();\n\t\t\t\tvar sel = document.selection.createRange();\n\t\t\t\tsel.text = myValue;\n\t\t\t\tthis.focus();\n\t\t\t} else if (this.selectionStart || this.selectionStart == '0') {\n\t\t\t\t//For browsers like Firefox and Webkit based\n\t\t\t\tvar startPos = this.selectionStart;\n\t\t\t\tvar endPos = this.selectionEnd;\n\t\t\t\tvar scrollTop = this.scrollTop;\n\t\t\t\tthis.value = this.value.substring(0, startPos) + myValue + this.value.substring(endPos, this.value.length);\n\t\t\t\tthis.focus();\n\t\t\t\tthis.selectionStart = startPos + myValue.length;\n\t\t\t\tthis.selectionEnd = startPos + myValue.length;\n\t\t\t\tthis.scrollTop = scrollTop;\n\t\t\t} else {\n\t\t\t\tthis.value += myValue;\n\t\t\t\tthis.focus();\n\t\t\t}\n\t\t});\n\t}\n});\n"],"names":["Settings_Workflows_Edit_Js","initialize","this","step3Container","element","container","$","is","setContainer","thisInstance","getContainer","on","e","params","currentTarget","data","progressIndicatorElement","progressIndicator","showModalWindow","mode","clipboard","App","Fields","Text","registerCopyClipboard","one","destroy","registerVTCreateTodoTaskEvents","taskType","val","functionName","apply","registerSaveTaskSubmitEvent","validationEngine","app","validationEngineOptions","registerFillTaskFieldsEvent","registerCheckSelectDateEvent","Tools","VariablesPanel","registerRefreshCompanyVariables","conditionBuilderInstance","Vtiger_ConditionBuilder_Js","find","registerEvents","removeClass","addClass","form","customValidationFunctionName","_this","result","showPnotify","vtranslate","preventDefault","preSaveActionFunctionName","formData","serializeFormData","entity_type","request","done","getTaskList","hideModalWindow","checkDuplicateFieldsSelected","selectedFieldNames","failureMessage","each","i","ele","fieldName","attr","not","length","tasktype","values","getValues","JSON","stringify","CKEDITOR","instances","getData","getConditions","fieldSelect","selectedOption","Array","fieldListFunctionName","fieldList","conditionDomElement","rowElement","fieldSelectElement","valueSelectElement","_this2","isEmptyFieldSelected","fieldType","type","rowValues","key","field","pickListValues","valuesArr","split","newValuesArr","j","push","join","value","getModuleName","getParentModuleName","html","ckEditorInstance","Editor","currentStatusElement","url","stopImmediatePropagation","message","showConfirmationBox","deleteUrl","currentElement","closest","inputElement","newValue","textarea","content","undefined","insertHtml","insertAtCaret","textAreaElement","getckEditorInstance","loadEditor","registerFillMailContentEvent","registerFillTaskFromEmailFieldEvent","registerCcAndBccEvents","registerEventForClockPicker","registerAddFieldEvent","registerDeleteConditionEvent","registerFieldChange","fieldValueMap","fieldValueReMapping","fields","loadFieldSpecificUi","getPopUp","replaceElement","newAddFieldContainer","clone","append","replaceWith","Picklist","changeSelectElementView","addField","remove","selectedElement","conditionRow","moduleNameElement","moduleName","change","prop","object","parse","fieldValueReMap","array","fieldname","fieldUiHolder","fieldInfo","fieldValueMapping","getFieldValueMapping","selectField","name","workflow_valuetype","fieldModel","Vtiger_Field_Js","getInstance","fieldModelInstance","fieldSpecificUi","getFieldSpecificUi","getName","getType","filter","removeAttr","workflowValueType","showSelect2ElementView","Date","register","registerRange","ranges","getUiTypeSpecificHtml","registerChangeCreateEntityEvent","registerVTUpdateFieldsTaskEvents","setMainParams","hideElementByClass","showElementByClass","taskFields","getMainParams","n","inArray","trigger","relatedModule","createEntityContainer","recurringType","ccLink","bccLink","hasClass","ccContainer","taskFieldElement","checkHiddenStatusofCcandBcc","bccContainer","registerEditTaskEvent","registerTaskStatusChangeEvent","registerTaskDeleteEvent","fn","extend","myValue","document","selection","focus","createRange","text","selectionStart","startPos","endPos","selectionEnd","scrollTop","substring"],"mappings":"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"}