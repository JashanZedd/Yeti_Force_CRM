{"version":3,"file":"Edit1.min.js","sources":["Edit1.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit1_Js',\n\t{},\n\t{\n\t\tinit: function() {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function() {\n\t\t\treturn this.step1Container;\n\t\t},\n\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function(element) {\n\t\t\tthis.step1Container = element;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function(container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#workflow_step1');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step1')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('#workflow_step1'));\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function() {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar form = this.getContainer();\n\t\t\tvar formData = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(formData).done(function(data) {\n\t\t\t\tform.hide();\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\tmode: 'hide'\n\t\t\t\t});\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register event for scheduled workflows UI\n\t\t */\n\t\tregisterEventForScheduledWorkflow: function() {\n\t\t\tlet container = $('.js-wf-executions-container');\n\t\t\t$('input[name=\"execution_condition\"]').on('click', function(e) {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\titemBox = element.closest('.js-wf-execution-container').find('.js-wf-execution-item');\n\t\t\t\tcontainer.find('.js-wf-execution-item').addClass('d-none');\n\t\t\t\tif (itemBox.length && element.prop('checked')) {\n\t\t\t\t\titemBox.removeClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tapp.registerEventForClockPicker($('.clockPicker'));\n\t\t\tApp.Fields.Date.register('#scheduleByDate', true);\n\t\t\tApp.Fields.DateTime.register('#scheduleByDate', true);\n\t\t\tlet newElement = App.Fields.Date.register('#annualDates', false, {\n\t\t\t\tmaxViewMode: 1,\n\t\t\t\tmultidate: true,\n\t\t\t\tautoclose: false\n\t\t\t}).on('changeDate', function(e) {\n\t\t\t\tlet values = [];\n\t\t\t\tfor (var index in e.dates) {\n\t\t\t\t\tlet date = e.dates[index];\n\t\t\t\t\tlet formated = moment(date).format(CONFIG.dateFormat.toUpperCase());\n\t\t\t\t\tvalues.push(formated);\n\t\t\t\t}\n\t\t\t\tcontainer.find('#annualDates').val(values.join(','));\n\t\t\t});\n\t\t\tnewElement\n\t\t\t\t.closest('.date')\n\t\t\t\t.find('.js-date__btn')\n\t\t\t\t.on('click', e => {\n\t\t\t\t\tnewElement.trigger('click');\n\t\t\t\t});\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofweek'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofmonth'));\n\t\t},\n\n\t\tregisterEventForChangeInScheduledType: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('#schtypeid').on('change', function(e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar value = element.val();\n\n\t\t\t\tthisInstance.hideScheduledTime();\n\t\t\t\tthisInstance.hideScheduledWeekList();\n\t\t\t\tthisInstance.hideScheduledMonthByDateList();\n\t\t\t\tthisInstance.hideScheduledSpecificDate();\n\t\t\t\tthisInstance.hideScheduledAnually();\n\n\t\t\t\tif (value == '2') {\n\t\t\t\t\t//hourly\n\t\t\t\t\tthisInstance.showScheduledTime();\n\t\t\t\t} else if (value == '3') {\n\t\t\t\t\t//weekly\n\t\t\t\t\tthisInstance.showScheduledWeekList();\n\t\t\t\t} else if (value == '4') {\n\t\t\t\t\t//specific date\n\t\t\t\t\tthisInstance.showScheduledSpecificDate();\n\t\t\t\t} else if (value == '5') {\n\t\t\t\t\t//monthly by day\n\t\t\t\t\tthisInstance.showScheduledMonthByDateList();\n\t\t\t\t} else if (value == '7') {\n\t\t\t\t\tthisInstance.showScheduledAnually();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thideScheduledTime: function() {\n\t\t\tjQuery('#scheduledTime').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledTime: function() {\n\t\t\tjQuery('#scheduledTime').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledWeekList: function() {\n\t\t\tjQuery('#scheduledWeekDay').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledWeekList: function() {\n\t\t\tjQuery('#scheduledWeekDay').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledMonthByDateList: function() {\n\t\t\tjQuery('#scheduleMonthByDates').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledMonthByDateList: function() {\n\t\t\tjQuery('#scheduleMonthByDates').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledSpecificDate: function() {\n\t\t\tjQuery('#scheduleByDate').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledSpecificDate: function() {\n\t\t\tjQuery('#scheduleByDate').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledAnually: function() {\n\t\t\tjQuery('#scheduleAnually').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledAnually: function() {\n\t\t\tjQuery('#scheduleAnually').removeClass('d-none');\n\t\t},\n\n\t\tregisterEvents: function() {\n\t\t\tvar container = this.getContainer();\n\n\t\t\t//After loading 1st step only, we will enable the Next button\n\t\t\tcontainer.find('[type=\"submit\"]').removeAttr('disabled');\n\n\t\t\tvar opts = app.validationEngineOptions;\n\t\t\t// to prevent the page reload after the validation has completed\n\t\t\topts['onValidationComplete'] = function(form, valid) {\n\t\t\t\t//returns the valid status\n\t\t\t\treturn valid;\n\t\t\t};\n\t\t\topts['promptPosition'] = 'bottomRight';\n\t\t\tcontainer.validationEngine(opts);\n\n\t\t\tthis.registerEventForScheduledWorkflow();\n\t\t\tthis.registerEventForChangeInScheduledType();\n\t\t}\n\t}\n);\n"],"names":["Settings_Workflows_Edit_Js","initialize","this","step1Container","element","container","jQuery","is","setContainer","aDeferred","Deferred","form","getContainer","formData","serializeFormData","progressIndicatorElement","progressIndicator","request","done","data","hide","resolve","promise","$","on","e","currentTarget","itemBox","closest","find","addClass","length","prop","removeClass","registerEventForClockPicker","Fields","Date","register","DateTime","newElement","App","values","index","dates","date","formated","moment","format","CONFIG","dateFormat","toUpperCase","push","val","join","trigger","Picklist","showSelect2ElementView","thisInstance","value","hideScheduledTime","hideScheduledWeekList","hideScheduledMonthByDateList","hideScheduledSpecificDate","hideScheduledAnually","showScheduledTime","showScheduledWeekList","showScheduledSpecificDate","showScheduledMonthByDateList","showScheduledAnually","removeAttr","opts","app","validationEngineOptions","valid","validationEngine","registerEventForScheduledWorkflow","registerEventForChangeInScheduledType"],"mappings":"aAUAA,2BACC,8BACA,GACA,MACO,gBACAC,2BAMQ,kBACNC,KAAKC,6BAQC,SAASC,qBACjBD,eAAiBC,QACfF,iBAMI,SAASG,gBACK,IAAdA,sBACEC,OAAO,oBAEhBD,UAAUE,GAAG,wBACXC,aAAaH,gBAEbG,aAAaF,OAAO,4BAInB,eACHG,UAAYH,OAAOI,WACnBC,KAAOT,KAAKU,eACZC,SAAWF,KAAKG,oBAChBC,yBAA2BT,OAAOU,kBAAkB,UAC7C,iBACC,UACD,yBAGEC,QAAQJ,UAAUK,MAAK,SAASC,WACvCC,gCACoBJ,kBAAkB,MACpC,mBAEGK,QAAQF,SAEZV,UAAUa,6CAMiB,eAC9BjB,UAAYkB,EAAE,iCAChB,qCAAqCC,GAAG,SAAS,SAASC,OACvDrB,QAAUmB,EAAEE,EAAEC,eACjBC,QAAUvB,QAAQwB,QAAQ,8BAA8BC,KAAK,mCACpDA,KAAK,yBAAyBC,SAAS,UAC7CH,QAAQI,QAAU3B,QAAQ4B,KAAK,oBAC1BC,YAAY,iBAIlBC,4BAA4BX,EAAE,qBAC9BY,OAAOC,KAAKC,SAAS,mBAAmB,OACxCF,OAAOG,SAASD,SAAS,mBAAmB,OAC5CE,WAAaC,IAAIL,OAAOC,KAAKC,SAAS,gBAAgB,EAAO,aACnD,aACF,aACA,IACTb,GAAG,cAAc,SAASC,OACxBgB,OAAS,OACR,IAAIC,SAASjB,EAAEkB,MAAO,KACtBC,KAAOnB,EAAEkB,MAAMD,OACfG,SAAWC,OAAOF,MAAMG,OAAOC,OAAOC,WAAWC,sBAC9CC,KAAKN,oBAEHhB,KAAK,gBAAgBuB,IAAIX,OAAOY,KAAK,oBAG9CzB,QAAQ,SACRC,KAAK,iBACLL,GAAG,SAAS,uBACD8B,QAAQ,gBAEjBnB,OAAOoB,SAASC,uBAAuBjC,EAAE,sBACzCY,OAAOoB,SAASC,uBAAuBjC,EAAE,0DAGP,eAClCkC,aAAevD,YACZ,cAAcsB,GAAG,UAAU,SAASC,OAEtCiC,MADUpD,OAAOmB,EAAEC,eACH0B,mBAEPO,iCACAC,qCACAC,4CACAC,yCACAC,uBAEA,KAATL,mBAEUM,oBACM,KAATN,mBAEGO,wBACM,KAATP,mBAEGQ,4BACM,KAATR,mBAEGS,+BACM,KAATT,oBACGU,6CAKG,kBACX,kBAAkBtC,SAAS,6BAGhB,kBACX,kBAAkBG,YAAY,iCAGf,kBACf,qBAAqBH,SAAS,iCAGf,kBACf,qBAAqBG,YAAY,wCAGX,kBACtB,yBAAyBH,SAAS,wCAGZ,kBACtB,yBAAyBG,YAAY,qCAGlB,kBACnB,mBAAmBH,SAAS,qCAGT,kBACnB,mBAAmBG,YAAY,gCAGjB,kBACd,oBAAoBH,SAAS,gCAGf,kBACd,oBAAoBG,YAAY,0BAGxB,eACX5B,UAAYH,KAAKU,yBAGXiB,KAAK,mBAAmBwC,WAAW,gBAEzCC,KAAOC,IAAIC,6BAEf,qBAA+B,SAAS7D,KAAM8D,cAEtCA,YAER,eAAyB,wBACfC,iBAAiBJ,WAEtBK,yCACAC"}