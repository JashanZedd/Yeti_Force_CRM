{"version":3,"file":"Edit1.min.js","sources":["Edit1.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit1_Js',\n\t{},\n\t{\n\t\tinit: function () {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function () {\n\t\t\treturn this.step1Container;\n\t\t},\n\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function (element) {\n\t\t\tthis.step1Container = element;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function (container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#workflow_step1');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step1')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('#workflow_step1'));\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function () {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar form = this.getContainer();\n\t\t\tvar formData = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(formData).done(function (data) {\n\t\t\t\tform.hide();\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\tmode: 'hide'\n\t\t\t\t});\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register event for scheduled workflows UI\n\t\t */\n\t\tregisterEventForScheduledWorkflow: function () {\n\t\t\tlet container = $('.js-wf-executions-container');\n\t\t\t$('input[name=\"execution_condition\"]').on('click', function (e) {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\titemBox = element.closest('.js-wf-execution-container').find('.js-wf-execution-item');\n\t\t\t\tcontainer.find('.js-wf-execution-item').addClass('d-none');\n\t\t\t\tif (itemBox.length && element.prop('checked')) {\n\t\t\t\t\titemBox.removeClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tapp.registerEventForClockPicker($('.clockPicker'));\n\t\t\tApp.Fields.Date.register('#scheduleByDate', true);\n\t\t\tApp.Fields.DateTime.register($('#scheduleByDate'));\n\t\t\tlet newElement = App.Fields.Date.register('#annualDates', false, {\n\t\t\t\tmaxViewMode: 1,\n\t\t\t\tmultidate: true,\n\t\t\t\tautoclose: false\n\t\t\t}).on('changeDate', function (e) {\n\t\t\t\tlet values = [];\n\t\t\t\tfor (var index in e.dates) {\n\t\t\t\t\tlet date = e.dates[index];\n\t\t\t\t\tlet formated = moment(date).format(CONFIG.dateFormat.toUpperCase());\n\t\t\t\t\tvalues.push(formated);\n\t\t\t\t}\n\t\t\t\tcontainer.find('#annualDates').val(values.join(','));\n\t\t\t});\n\t\t\tnewElement\n\t\t\t\t.closest('.date')\n\t\t\t\t.find('.js-date__btn')\n\t\t\t\t.on('click', (e) => {\n\t\t\t\t\tnewElement.trigger('click');\n\t\t\t\t});\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofweek'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofmonth'));\n\t\t},\n\n\t\tregisterEventForChangeInScheduledType: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('#schtypeid').on('change', function (e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar value = element.val();\n\n\t\t\t\tthisInstance.hideScheduledTime();\n\t\t\t\tthisInstance.hideScheduledWeekList();\n\t\t\t\tthisInstance.hideScheduledMonthByDateList();\n\t\t\t\tthisInstance.hideScheduledSpecificDate();\n\t\t\t\tthisInstance.hideScheduledAnually();\n\t\t\t\tif ($.inArray(value, ['2', '11', '12', '13']) != -1) {\n\t\t\t\t\t//hourly\n\t\t\t\t\tthisInstance.showScheduledTime();\n\t\t\t\t} else if (value == '3') {\n\t\t\t\t\t//weekly\n\t\t\t\t\tthisInstance.showScheduledWeekList();\n\t\t\t\t} else if (value == '4') {\n\t\t\t\t\t//specific date\n\t\t\t\t\tthisInstance.showScheduledSpecificDate();\n\t\t\t\t} else if (value == '5') {\n\t\t\t\t\t//monthly by day\n\t\t\t\t\tthisInstance.showScheduledMonthByDateList();\n\t\t\t\t} else if (value == '7') {\n\t\t\t\t\tthisInstance.showScheduledAnually();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thideScheduledTime: function () {\n\t\t\tjQuery('#scheduledTime').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledTime: function () {\n\t\t\tjQuery('#scheduledTime').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledWeekList: function () {\n\t\t\tjQuery('#scheduledWeekDay').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledWeekList: function () {\n\t\t\tjQuery('#scheduledWeekDay').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledMonthByDateList: function () {\n\t\t\tjQuery('#scheduleMonthByDates').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledMonthByDateList: function () {\n\t\t\tjQuery('#scheduleMonthByDates').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledSpecificDate: function () {\n\t\t\tjQuery('#scheduleByDate').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledSpecificDate: function () {\n\t\t\tjQuery('#scheduleByDate').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledAnually: function () {\n\t\t\tjQuery('#scheduleAnually').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledAnually: function () {\n\t\t\tjQuery('#scheduleAnually').removeClass('d-none');\n\t\t},\n\n\t\tregisterEvents: function () {\n\t\t\tvar container = this.getContainer();\n\n\t\t\t//After loading 1st step only, we will enable the Next button\n\t\t\tcontainer.find('[type=\"submit\"]').removeAttr('disabled');\n\n\t\t\tvar opts = app.validationEngineOptions;\n\t\t\t// to prevent the page reload after the validation has completed\n\t\t\topts['onValidationComplete'] = function (form, valid) {\n\t\t\t\t//returns the valid status\n\t\t\t\treturn valid;\n\t\t\t};\n\t\t\topts['promptPosition'] = 'bottomRight';\n\t\t\tcontainer.validationEngine(opts);\n\n\t\t\tthis.registerEventForScheduledWorkflow();\n\t\t\tthis.registerEventForChangeInScheduledType();\n\t\t}\n\t}\n);\n"],"names":["Settings_Workflows_Edit_Js","init","initialize","getContainer","step1Container","setContainer","element","container","jQuery","is","submit","Deferred","form","formData","serializeFormData","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","request","done","data","hide","mode","aDeferred","resolve","promise","registerEventForScheduledWorkflow","$","on","e","currentTarget","itemBox","closest","find","addClass","length","prop","removeClass","app","registerEventForClockPicker","App","Fields","Date","register","DateTime","newElement","maxViewMode","multidate","autoclose","index","dates","date","formated","moment","format","CONFIG","dateFormat","toUpperCase","values","push","val","join","trigger","Picklist","showSelect2ElementView","registerEventForChangeInScheduledType","value","thisInstance","hideScheduledTime","hideScheduledWeekList","hideScheduledMonthByDateList","hideScheduledSpecificDate","hideScheduledAnually","inArray","showScheduledWeekList","showScheduledSpecificDate","showScheduledMonthByDateList","showScheduledAnually","showScheduledTime","registerEvents","removeAttr","opts","validationEngineOptions","valid","validationEngine"],"mappings":"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"}