{"version":3,"file":"Edit1.min.js","sources":["Edit1.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit1_Js',\n\t{},\n\t{\n\t\tinit: function() {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function() {\n\t\t\treturn this.step1Container;\n\t\t},\n\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function(element) {\n\t\t\tthis.step1Container = element;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function(container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#workflow_step1');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step1')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('#workflow_step1'));\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function() {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar form = this.getContainer();\n\t\t\tvar formData = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(formData).done(function(data) {\n\t\t\t\tform.hide();\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\tmode: 'hide'\n\t\t\t\t});\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register event for scheduled workflows UI\n\t\t */\n\t\tregisterEventForScheduledWorkflow: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('input[name=\"execution_condition\"]').on('click', function(e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar scheduleBoxContainer = jQuery('#scheduleBox');\n\t\t\t\tif (element.is(':checked') && element.val() == '6') {\n\t\t\t\t\t//for scheduled workflows\n\t\t\t\t\tscheduleBoxContainer.removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tscheduleBoxContainer.addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t\tapp.registerEventForClockPicker($('.clockPicker'));\n\t\t\tApp.Fields.Date.register('#scheduleByDate', true);\n\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#annualDates'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofweek'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofmonth'));\n\n\t\t\tvar currentYear = new Date().getFullYear();\n\t\t\tvar weekStartId = jQuery('#weekStartDay').data('value');\n\n\t\t\t$('#annualDatePicker')\n\t\t\t\t.datepicker({\n\t\t\t\t\tweekStart: weekStartId,\n\t\t\t\t\tstartDate: '01/01/' + currentYear,\n\t\t\t\t\tendDate: '12/31/' + currentYear,\n\t\t\t\t\tformat: 'mm/dd/yyyy',\n\t\t\t\t\tmaxViewMode: 1,\n\t\t\t\t\ttodayBtn: 'linked',\n\t\t\t\t\tlanguage: jQuery('body').data('language'),\n\t\t\t\t\tmultidate: true,\n\t\t\t\t\ttodayHighlight: true\n\t\t\t\t})\n\t\t\t\t.on('changeDate', function(e) {\n\t\t\t\t\tvar datesInfo = [];\n\t\t\t\t\tvar values = [];\n\t\t\t\t\tvar html = '';\n\t\t\t\t\t// reset the annual dates\n\t\t\t\t\tvar annualDatesEle = jQuery('#annualDates');\n\t\t\t\t\tthisInstance.updateAnnualDates(annualDatesEle);\n\t\t\t\t\tfor (var index in e.dates) {\n\t\t\t\t\t\tvar date = e.dates[index];\n\t\t\t\t\t\tvar formated = moment(date).format('YYYY-MM-DD');\n\t\t\t\t\t\tdatesInfo.push({\n\t\t\t\t\t\t\tid: formated,\n\t\t\t\t\t\t\ttext: formated\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvalues.push(formated);\n\t\t\t\t\t\thtml += '<option selected value=' + formated + '>' + formated + '</option>';\n\t\t\t\t\t}\n\t\t\t\t\tannualDatesEle.append(html);\n\t\t\t\t\tannualDatesEle.trigger('select2:updated');\n\t\t\t\t});\n\t\t\tvar annualDatesEle = jQuery('#annualDates');\n\t\t\tthisInstance.updateAnnualDates(annualDatesEle);\n\t\t\tannualDatesEle.trigger('select2:updated');\n\t\t},\n\t\tupdateAnnualDates: function(annualDatesEle) {\n\t\t\tannualDatesEle.html('');\n\t\t\tvar annualDatesJSON = jQuery('#hiddenAnnualDates').val();\n\t\t\tif (annualDatesJSON) {\n\t\t\t\tvar hiddenDates = '';\n\t\t\t\tvar annualDates = JSON.parse(annualDatesJSON);\n\t\t\t\tfor (var j in annualDates) {\n\t\t\t\t\thiddenDates += '<option selected value=' + annualDates[j] + '>' + annualDates[j] + '</option>';\n\t\t\t\t}\n\t\t\t\tannualDatesEle.html(hiddenDates);\n\t\t\t}\n\t\t},\n\t\tregisterEventForChangeInScheduledType: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('#schtypeid').on('change', function(e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar value = element.val();\n\n\t\t\t\tthisInstance.hideScheduledTime();\n\t\t\t\tthisInstance.hideScheduledWeekList();\n\t\t\t\tthisInstance.hideScheduledMonthByDateList();\n\t\t\t\tthisInstance.hideScheduledSpecificDate();\n\t\t\t\tthisInstance.hideScheduledAnually();\n\n\t\t\t\tif (value == '2') {\n\t\t\t\t\t//hourly\n\t\t\t\t\tthisInstance.showScheduledTime();\n\t\t\t\t} else if (value == '3') {\n\t\t\t\t\t//weekly\n\t\t\t\t\tthisInstance.showScheduledWeekList();\n\t\t\t\t} else if (value == '4') {\n\t\t\t\t\t//specific date\n\t\t\t\t\tthisInstance.showScheduledSpecificDate();\n\t\t\t\t} else if (value == '5') {\n\t\t\t\t\t//monthly by day\n\t\t\t\t\tthisInstance.showScheduledMonthByDateList();\n\t\t\t\t} else if (value == '7') {\n\t\t\t\t\tthisInstance.showScheduledAnually();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thideScheduledTime: function() {\n\t\t\tjQuery('#scheduledTime').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledTime: function() {\n\t\t\tjQuery('#scheduledTime').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledWeekList: function() {\n\t\t\tjQuery('#scheduledWeekDay').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledWeekList: function() {\n\t\t\tjQuery('#scheduledWeekDay').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledMonthByDateList: function() {\n\t\t\tjQuery('#scheduleMonthByDates').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledMonthByDateList: function() {\n\t\t\tjQuery('#scheduleMonthByDates').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledSpecificDate: function() {\n\t\t\tjQuery('#scheduleByDate').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledSpecificDate: function() {\n\t\t\tjQuery('#scheduleByDate').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledAnually: function() {\n\t\t\tjQuery('#scheduleAnually').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledAnually: function() {\n\t\t\tjQuery('#scheduleAnually').removeClass('d-none');\n\t\t},\n\n\t\tregisterEvents: function() {\n\t\t\tvar container = this.getContainer();\n\n\t\t\t//After loading 1st step only, we will enable the Next button\n\t\t\tcontainer.find('[type=\"submit\"]').removeAttr('disabled');\n\n\t\t\tvar opts = app.validationEngineOptions;\n\t\t\t// to prevent the page reload after the validation has completed\n\t\t\topts['onValidationComplete'] = function(form, valid) {\n\t\t\t\t//returns the valid status\n\t\t\t\treturn valid;\n\t\t\t};\n\t\t\topts['promptPosition'] = 'bottomRight';\n\t\t\tcontainer.validationEngine(opts);\n\n\t\t\tthis.registerEventForScheduledWorkflow();\n\t\t\tthis.registerEventForChangeInScheduledType();\n\t\t}\n\t}\n);\n"],"names":["Settings_Workflows_Edit_Js","init","initialize","getContainer","step1Container","setContainer","element","container","jQuery","is","submit","Deferred","form","formData","serializeFormData","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","request","done","data","hide","mode","aDeferred","resolve","promise","registerEventForScheduledWorkflow","on","e","currentTarget","scheduleBoxContainer","val","removeClass","addClass","app","registerEventForClockPicker","$","App","Fields","Date","register","Picklist","showSelect2ElementView","getFullYear","weekStartId","datepicker","weekStart","startDate","currentYear","endDate","format","maxViewMode","todayBtn","language","multidate","todayHighlight","datesInfo","html","annualDatesEle","updateAnnualDates","dates","index","formated","moment","date","append","trigger","thisInstance","annualDatesJSON","annualDates","JSON","parse","hiddenDates","j","registerEventForChangeInScheduledType","value","hideScheduledTime","hideScheduledWeekList","hideScheduledMonthByDateList","hideScheduledSpecificDate","hideScheduledAnually","showScheduledTime","showScheduledWeekList","showScheduledSpecificDate","showScheduledMonthByDateList","showScheduledAnually","registerEvents","find","removeAttr","validationEngineOptions","opts","valid","validationEngine"],"mappings":"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"}