{"version":3,"file":"Edit1.min.js","sources":["Edit1.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit1_Js',\n\t{},\n\t{\n\t\tinit: function() {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function() {\n\t\t\treturn this.step1Container;\n\t\t},\n\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function(element) {\n\t\t\tthis.step1Container = element;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function(container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#workflow_step1');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step1')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('#workflow_step1'));\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function() {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar form = this.getContainer();\n\t\t\tvar formData = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(formData).done(function(data) {\n\t\t\t\tform.hide();\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\tmode: 'hide'\n\t\t\t\t});\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register event for scheduled workflows UI\n\t\t */\n\t\tregisterEventForScheduledWorkflow: function() {\n\t\t\tlet container = $('.js-wf-executions-container');\n\t\t\t$('input[name=\"execution_condition\"]').on('click', function(e) {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\titemBox = element.closest('.js-wf-execution-container').find('.js-wf-execution-item');\n\t\t\t\tcontainer.find('.js-wf-execution-item').addClass('d-none');\n\t\t\t\tif (itemBox.length && element.prop('checked')) {\n\t\t\t\t\titemBox.removeClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tapp.registerEventForClockPicker($('.clockPicker'));\n\t\t\tApp.Fields.Date.register('#scheduleByDate', true);\n\t\t\tApp.Fields.DateTime.register('#scheduleByDate', true);\n\t\t\tlet newElement = App.Fields.Date.register('#annualDates', false, {\n\t\t\t\tmaxViewMode: 1,\n\t\t\t\tmultidate: true,\n\t\t\t\tautoclose: false\n\t\t\t}).on('changeDate', function(e) {\n\t\t\t\tlet values = [];\n\t\t\t\tfor (var index in e.dates) {\n\t\t\t\t\tlet date = e.dates[index];\n\t\t\t\t\tlet formated = moment(date).format(CONFIG.dateFormat.toUpperCase());\n\t\t\t\t\tvalues.push(formated);\n\t\t\t\t}\n\t\t\t\tcontainer.find('#annualDates').val(values.join(','));\n\t\t\t});\n\t\t\tnewElement\n\t\t\t\t.closest('.date')\n\t\t\t\t.find('.js-date__btn')\n\t\t\t\t.on('click', e => {\n\t\t\t\t\tnewElement.trigger('click');\n\t\t\t\t});\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofweek'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofmonth'));\n\t\t},\n\n\t\tregisterEventForChangeInScheduledType: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('#schtypeid').on('change', function(e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar value = element.val();\n\n\t\t\t\tthisInstance.hideScheduledTime();\n\t\t\t\tthisInstance.hideScheduledWeekList();\n\t\t\t\tthisInstance.hideScheduledMonthByDateList();\n\t\t\t\tthisInstance.hideScheduledSpecificDate();\n\t\t\t\tthisInstance.hideScheduledAnually();\n\n\t\t\t\tif (value == '2') {\n\t\t\t\t\t//hourly\n\t\t\t\t\tthisInstance.showScheduledTime();\n\t\t\t\t} else if (value == '3') {\n\t\t\t\t\t//weekly\n\t\t\t\t\tthisInstance.showScheduledWeekList();\n\t\t\t\t} else if (value == '4') {\n\t\t\t\t\t//specific date\n\t\t\t\t\tthisInstance.showScheduledSpecificDate();\n\t\t\t\t} else if (value == '5') {\n\t\t\t\t\t//monthly by day\n\t\t\t\t\tthisInstance.showScheduledMonthByDateList();\n\t\t\t\t} else if (value == '7') {\n\t\t\t\t\tthisInstance.showScheduledAnually();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thideScheduledTime: function() {\n\t\t\tjQuery('#scheduledTime').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledTime: function() {\n\t\t\tjQuery('#scheduledTime').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledWeekList: function() {\n\t\t\tjQuery('#scheduledWeekDay').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledWeekList: function() {\n\t\t\tjQuery('#scheduledWeekDay').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledMonthByDateList: function() {\n\t\t\tjQuery('#scheduleMonthByDates').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledMonthByDateList: function() {\n\t\t\tjQuery('#scheduleMonthByDates').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledSpecificDate: function() {\n\t\t\tjQuery('#scheduleByDate').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledSpecificDate: function() {\n\t\t\tjQuery('#scheduleByDate').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledAnually: function() {\n\t\t\tjQuery('#scheduleAnually').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledAnually: function() {\n\t\t\tjQuery('#scheduleAnually').removeClass('d-none');\n\t\t},\n\n\t\tregisterEvents: function() {\n\t\t\tvar container = this.getContainer();\n\n\t\t\t//After loading 1st step only, we will enable the Next button\n\t\t\tcontainer.find('[type=\"submit\"]').removeAttr('disabled');\n\n\t\t\tvar opts = app.validationEngineOptions;\n\t\t\t// to prevent the page reload after the validation has completed\n\t\t\topts['onValidationComplete'] = function(form, valid) {\n\t\t\t\t//returns the valid status\n\t\t\t\treturn valid;\n\t\t\t};\n\t\t\topts['promptPosition'] = 'bottomRight';\n\t\t\tcontainer.validationEngine(opts);\n\n\t\t\tthis.registerEventForScheduledWorkflow();\n\t\t\tthis.registerEventForChangeInScheduledType();\n\t\t}\n\t}\n);\n"],"names":["Settings_Workflows_Edit_Js","initialize","step1Container","element","container","jQuery","is","setContainer","aDeferred","Deferred","form","getContainer","formData","serializeFormData","progressIndicatorElement","progressIndicator","request","done","data","hide","resolve","promise","$","on","e","currentTarget","itemBox","closest","find","addClass","length","prop","removeClass","registerEventForClockPicker","Fields","Date","register","DateTime","newElement","App","values","index","dates","date","formated","moment","format","CONFIG","dateFormat","toUpperCase","push","val","join","trigger","Picklist","showSelect2ElementView","thisInstance","value","hideScheduledTime","hideScheduledWeekList","hideScheduledMonthByDateList","hideScheduledSpecificDate","hideScheduledAnually","showScheduledTime","showScheduledWeekList","showScheduledSpecificDate","showScheduledMonthByDateList","showScheduledAnually","removeAttr","opts","app","validationEngineOptions","valid","validationEngine","registerEventForScheduledWorkflow","registerEventForChangeInScheduledType"],"mappings":"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"}