{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce S.A.\n *************************************************************************************/\n'use strict';\n\nSettings_Vtiger_List_Js(\n\t'Settings_Workflows_List_Js',\n\t{\n\t\ttriggerCreate: function (url) {\n\t\t\tvar selectedModule = jQuery('#moduleFilter').val();\n\t\t\tif (selectedModule.length > 0) {\n\t\t\t\turl += '&source_module=' + selectedModule;\n\t\t\t}\n\t\t\twindow.location.href = url;\n\t\t},\n\n\t\tsetChangeStatusTasks: function (e, recordId, status) {\n\t\t\tlet changeButtonType = jQuery(e);\n\t\t\tlet container = jQuery(e).closest('tr');\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('LBL_STATUS_CONFIRMATION'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tvar module = app.getModuleName();\n\t\t\t\t\tvar postData = {\n\t\t\t\t\t\tmodule: module,\n\t\t\t\t\t\taction: 'TaskAjax',\n\t\t\t\t\t\tmode: 'changeStatusAllTasks',\n\t\t\t\t\t\trecord: recordId,\n\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\tparent: app.getParentModuleName()\n\t\t\t\t\t};\n\t\t\t\t\tvar deleteMessage = app.vtranslate('JS_TASKS_STATUS_GETTING_CHANGED');\n\t\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t\tmessage: deleteMessage,\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tAppConnector.request(postData).done(function (data) {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t\t\tmode: 'hide'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\t\tvar count = data.result.count;\n\t\t\t\t\t\t\tvar element = container.find('[data-name=\"active_tasks\"]');\n\t\t\t\t\t\t\tchangeButtonType.hide();\n\t\t\t\t\t\t\tif (status) {\n\t\t\t\t\t\t\t\telement.html('&nbsp;' + count);\n\t\t\t\t\t\t\t\tchangeButtonType.closest('td').find('.deactiveTasks').show();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telement.html('&nbsp;0');\n\t\t\t\t\t\t\t\tchangeButtonType.closest('td').find('.activeTasks').show();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\t\ttext: app.vtranslate(data.error.message),\n\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tregisterFilterChangeEvent: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tthis.topMenuContainer.find('.js-workflow-module-filter').on('change', (e) => {\n\t\t\t\tthis.topMenuContainer.find('.js-workflow-sort-button').removeClass('d-none');\n\t\t\t\tjQuery('#pageNumber').val('1');\n\t\t\t\tjQuery('#pageToJump').val('1');\n\t\t\t\tjQuery('#orderBy').val('');\n\t\t\t\tjQuery('#sortOrder').val('');\n\t\t\t\tlet params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tsourceModule: jQuery(e.currentTarget).val(),\n\t\t\t\t\torderby: 'sequence'\n\t\t\t\t};\n\t\t\t\t//Make the select all count as empty\n\t\t\t\tjQuery('#recordsCount').val('');\n\t\t\t\t//Make total number of pages as empty\n\t\t\t\tjQuery('#totalPageCount').text('');\n\t\t\t\tthisInstance.getListViewRecords(params).done(function (data) {\n\t\t\t\t\tthisInstance.updatePagination();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * Function to register the list view row click event\n\t\t */\n\t\tregisterRowClickEvent: function () {\n\t\t\tthis.getListViewContentContainer().on('click', '.listViewEntries', (e) => {\n\t\t\t\tlet editUrl = $(e.currentTarget).find('.js-edit').attr('href');\n\t\t\t\tif (editUrl) {\n\t\t\t\t\twindow.location.href = editUrl;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tgetDefaultParams: function () {\n\t\t\tvar pageNumber = jQuery('#pageNumber').val();\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar parent = app.getParentModuleName();\n\t\t\tvar params = {\n\t\t\t\tmodule: module,\n\t\t\t\tparent: parent,\n\t\t\t\tpage: pageNumber,\n\t\t\t\tview: 'List',\n\t\t\t\tsourceModule: jQuery('#moduleFilter').val()\n\t\t\t};\n\t\t\treturn params;\n\t\t},\n\t\tregisterImportTemplate: function () {\n\t\t\tjQuery('#importButton').on('click', function () {\n\t\t\t\twindow.location.href = jQuery(this).data('url');\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register show sort actions modal\n\t\t */\n\t\tregisterShowSortActionsModal: function () {\n\t\t\t$('.js-workflow-sort-button').on('click', () => {\n\t\t\t\tlet sourceModule = this.topMenuContainer.find('.js-workflow-module-filter option:selected').val();\n\t\t\t\tlet url = 'index.php?module=Workflows&parent=Settings&view=SortActionsModal&sourceModule=' + sourceModule;\n\t\t\t\tapp.showModalWindow(null, url, (modalContainer) => {\n\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', (e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: this.container.find('[name=\"module\"]').length\n\t\t\t\t\t\t\t\t? this.container.find('[name=\"module\"]').val()\n\t\t\t\t\t\t\t\t: app.getModuleName(),\n\t\t\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\t\t\tsourceModule: sourceModule,\n\t\t\t\t\t\t\taction: 'SaveAjax',\n\t\t\t\t\t\t\tmode: 'sequenceActions',\n\t\t\t\t\t\t\tworkflowForSort: modalContainer.find('.js-workflow-for-sort').val(),\n\t\t\t\t\t\t\tworkflowBefore: modalContainer.find('.js-workflow-before').val()\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done((data) => {\n\t\t\t\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\tlet params = this.getDefaultParams();\n\t\t\t\t\t\t\t\t\tparams.orderby = 'sequence';\n\t\t\t\t\t\t\t\t\tthis.getListViewRecords(params);\n\t\t\t\t\t\t\t\t\tapp.showNotify({ text: data.result.message });\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.container = this.getListViewContentContainer();\n\t\t\tthis._super();\n\t\t\tthis.topMenuContainer = this.getListViewTopMenuContainer();\n\t\t\tthis.registerFilterChangeEvent();\n\t\t\tthis.registerImportTemplate();\n\t\t\tthis.registerShowSortActionsModal();\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_List_Js","triggerCreate","url","jQuery","val","selectedModule","length","window","location","href","setChangeStatusTasks","e","recordId","status","container","closest","app","showConfirmModal","title","vtranslate","confirmedCallback","getModuleName","postData","module","action","mode","record","parent","getParentModuleName","deleteMessage","progressIndicatorElement","progressIndicator","message","position","blockInfo","enabled","AppConnector","request","done","data","success","result","count","element","find","changeButtonType","hide","html","show","text","error","type","showNotify","params","registerFilterChangeEvent","thisInstance","topMenuContainer","on","removeClass","sourceModule","currentTarget","orderby","getListViewRecords","updatePagination","registerRowClickEvent","getListViewContentContainer","editUrl","$","attr","getDefaultParams","page","pageNumber","view","registerImportTemplate","registerShowSortActionsModal","showModalWindow","modalContainer","preventDefault","workflowForSort","workflowBefore","hideModalWindow","fail","err","errorLog","registerEvents","_super","getListViewTopMenuContainer"],"mappings":"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"}