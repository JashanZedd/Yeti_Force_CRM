{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce S.A.\n *************************************************************************************/\n'use strict';\n\nSettings_Vtiger_List_Js(\n\t'Settings_Workflows_List_Js',\n\t{\n\t\ttriggerCreate: function (url) {\n\t\t\tvar selectedModule = jQuery('#moduleFilter').val();\n\t\t\tif (selectedModule.length > 0) {\n\t\t\t\turl += '&source_module=' + selectedModule;\n\t\t\t}\n\t\t\twindow.location.href = url;\n\t\t},\n\n\t\tsetChangeStatusTasks: function (e, recordId, status) {\n\t\t\tlet changeButtonType = jQuery(e);\n\t\t\tlet container = jQuery(e).closest('tr');\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('LBL_STATUS_CONFIRMATION'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tvar module = app.getModuleName();\n\t\t\t\t\tvar postData = {\n\t\t\t\t\t\tmodule: module,\n\t\t\t\t\t\taction: 'TaskAjax',\n\t\t\t\t\t\tmode: 'changeStatusAllTasks',\n\t\t\t\t\t\trecord: recordId,\n\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\tparent: app.getParentModuleName()\n\t\t\t\t\t};\n\t\t\t\t\tvar deleteMessage = app.vtranslate('JS_TASKS_STATUS_GETTING_CHANGED');\n\t\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t\tmessage: deleteMessage,\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tAppConnector.request(postData).done(function (data) {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t\t\tmode: 'hide'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\t\tvar count = data.result.count;\n\t\t\t\t\t\t\tvar element = container.find('[data-name=\"active_tasks\"]');\n\t\t\t\t\t\t\tchangeButtonType.hide();\n\t\t\t\t\t\t\tif (status) {\n\t\t\t\t\t\t\t\telement.html('&nbsp;' + count);\n\t\t\t\t\t\t\t\tchangeButtonType.closest('td').find('.deactiveTasks').show();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telement.html('&nbsp;0');\n\t\t\t\t\t\t\t\tchangeButtonType.closest('td').find('.activeTasks').show();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\t\ttext: app.vtranslate(data.error.message),\n\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tregisterFilterChangeEvent: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tthis.topMenuContainer.find('.js-workflow-module-filter').on('change', (e) => {\n\t\t\t\tthis.topMenuContainer.find('.js-workflow-sort-button').removeClass('d-none');\n\t\t\t\tjQuery('#pageNumber').val('1');\n\t\t\t\tjQuery('#pageToJump').val('1');\n\t\t\t\tjQuery('#orderBy').val('');\n\t\t\t\tjQuery('#sortOrder').val('');\n\t\t\t\tlet params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tsourceModule: jQuery(e.currentTarget).val(),\n\t\t\t\t\torderby: 'sequence'\n\t\t\t\t};\n\t\t\t\t//Make the select all count as empty\n\t\t\t\tjQuery('#recordsCount').val('');\n\t\t\t\t//Make total number of pages as empty\n\t\t\t\tjQuery('#totalPageCount').text('');\n\t\t\t\tthisInstance.getListViewRecords(params).done(function (data) {\n\t\t\t\t\tthisInstance.updatePagination();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * Function to register the list view row click event\n\t\t */\n\t\tregisterRowClickEvent: function () {\n\t\t\tthis.getListViewContentContainer().on('click', '.listViewEntries', (e) => {\n\t\t\t\tlet editUrl = $(e.currentTarget).find('.js-edit').attr('href');\n\t\t\t\tif (editUrl) {\n\t\t\t\t\twindow.location.href = editUrl;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tgetDefaultParams: function () {\n\t\t\tvar pageNumber = jQuery('#pageNumber').val();\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar parent = app.getParentModuleName();\n\t\t\tvar params = {\n\t\t\t\tmodule: module,\n\t\t\t\tparent: parent,\n\t\t\t\tpage: pageNumber,\n\t\t\t\tview: 'List',\n\t\t\t\tsourceModule: jQuery('#moduleFilter').val()\n\t\t\t};\n\t\t\treturn params;\n\t\t},\n\t\tregisterImportTemplate: function () {\n\t\t\tjQuery('#importButton').on('click', function () {\n\t\t\t\twindow.location.href = jQuery(this).data('url');\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register show sort actions modal\n\t\t */\n\t\tregisterShowSortActionsModal: function () {\n\t\t\t$('.js-workflow-sort-button').on('click', () => {\n\t\t\t\tlet sourceModule = this.topMenuContainer.find('.js-workflow-module-filter option:selected').val();\n\t\t\t\tlet url = 'index.php?module=Workflows&parent=Settings&view=SortActionsModal&sourceModule=' + sourceModule;\n\t\t\t\tapp.showModalWindow(null, url, (modalContainer) => {\n\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', (e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: this.container.find('[name=\"module\"]').length\n\t\t\t\t\t\t\t\t? this.container.find('[name=\"module\"]').val()\n\t\t\t\t\t\t\t\t: app.getModuleName(),\n\t\t\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\t\t\tsourceModule: sourceModule,\n\t\t\t\t\t\t\taction: 'SaveAjax',\n\t\t\t\t\t\t\tmode: 'sequenceActions',\n\t\t\t\t\t\t\tworkflowForSort: modalContainer.find('.js-workflow-for-sort').val(),\n\t\t\t\t\t\t\tworkflowBefore: modalContainer.find('.js-workflow-before').val()\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done((data) => {\n\t\t\t\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\tlet params = this.getDefaultParams();\n\t\t\t\t\t\t\t\t\tparams.orderby = 'sequence';\n\t\t\t\t\t\t\t\t\tthis.getListViewRecords(params);\n\t\t\t\t\t\t\t\t\tapp.showNotify({ text: data.result.message });\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.container = this.getListViewContentContainer();\n\t\t\tthis._super();\n\t\t\tthis.topMenuContainer = this.getListViewTopMenuContainer();\n\t\t\tthis.registerFilterChangeEvent();\n\t\t\tthis.registerImportTemplate();\n\t\t\tthis.registerShowSortActionsModal();\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_List_Js","triggerCreate","url","selectedModule","jQuery","val","length","window","location","href","setChangeStatusTasks","e","recordId","status","changeButtonType","container","closest","app","showConfirmModal","title","vtranslate","confirmedCallback","module","getModuleName","postData","action","mode","record","parent","getParentModuleName","deleteMessage","progressIndicatorElement","progressIndicator","message","position","blockInfo","enabled","AppConnector","request","done","data","success","count","result","element","find","hide","html","show","params","text","error","type","showNotify","registerFilterChangeEvent","thisInstance","topMenuContainer","on","removeClass","sourceModule","currentTarget","orderby","getListViewRecords","updatePagination","registerRowClickEvent","getListViewContentContainer","editUrl","$","attr","getDefaultParams","pageNumber","page","view","registerImportTemplate","registerShowSortActionsModal","showModalWindow","modalContainer","preventDefault","workflowForSort","workflowBefore","hideModalWindow","fail","err","errorLog","registerEvents","_super","getListViewTopMenuContainer"],"mappings":"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"}