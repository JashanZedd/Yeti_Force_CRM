{"version":3,"file":"WidgetsManagement.min.js","sources":["WidgetsManagement.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class('Settings_WidgetsManagement_Js', {}, {\n\twidgetWithFilterUsers: [],\n\tsetWidgetWithFilterUsers: function () {\n\t\tvar thisInstance = this;\n\t\tvar element = jQuery('[name=\"filter_users\"]').val();\n\t\tif (element)\n\t\t\tthisInstance.widgetWithFilterUsers = JSON.parse(element);\n\t\telse\n\t\t\tthisInstance.widgetWithFilterUsers = [];\n\t},\n\twidgetWithFilterDate: [],\n\tsetWidgetWithFilterDate: function () {\n\t\tvar thisInstance = this;\n\t\tvar element = jQuery('[name=\"filter_date\"]').val();\n\t\tif (element)\n\t\t\tthisInstance.widgetWithFilterDate = JSON.parse(element);\n\t\telse\n\t\t\tthisInstance.widgetWithFilterDate = [];\n\t},\n\trestrictFilter: [],\n\tsetRestrictFilter: function () {\n\t\tvar thisInstance = this;\n\t\tvar element = jQuery('[name=\"filter_restrict\"]').val();\n\t\tif (element)\n\t\t\tthisInstance.restrictFilter = JSON.parse(element);\n\t\telse\n\t\t\tthisInstance.restrictFilter = [];\n\t},\n\t/**\n\t * Function to create the array of block roles list\n\t */\n\tgetAuthorization: function () {\n\t\tlet authorization = [],\n\t\t\tcontainer = jQuery('#moduleBlocks');\n\t\tcontainer.find('.editFieldsTable').each(function () {\n\t\t\tauthorization.push(jQuery(this).data('code').toString());\n\t\t});\n\t\treturn authorization;\n\t},\n\tgetAllFieldsInBlock: function (continer) {\n\t\tvar fields = [];\n\t\tcontiner.find('.blockFieldsList .editFieldsWidget').each(function () {\n\t\t\tfields.push(jQuery(this).data('linkid').toString());\n\t\t});\n\t\treturn fields;\n\t},\n\tgetCurrentDashboardId() {\n\t\treturn $('.selectDashboard li a.active').parent().data('id');\n\t},\n\tregisterAddedDashboard() {\n\t\tconst thisInstance = this;\n\t\t$('.addDashboard').on('click', () => {\n\t\t\tapp.showModalWindow({\n\t\t\t\turl: 'index.php?parent=Settings&module=' + app.getModuleName() + '&view=DashboardType',\n\t\t\t\tsendByAjaxCb: () => {\n\t\t\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\t\t\tthisInstance.getModuleLayoutEditor('Home').done((data) => {\n\t\t\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t},\n\tregisterSelectDashboard() {\n\t\tconst thisInstance = this;\n\t\t$('.selectDashboard li').on('click', (e) => {\n\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\tthisInstance.getModuleLayoutEditor($('#selectedModuleName').val(), $(e.currentTarget).data('id')).done((data) => {\n\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t});\n\t\t});\n\t},\n\tregisterDashboardAction() {\n\t\tconst thisInstance = this;\n\t\t$('.editDashboard').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\te.stopPropagation();\n\t\t\tapp.showModalWindow({\n\t\t\t\turl: 'index.php?parent=Settings&module=' + app.getModuleName() + '&view=DashboardType&dashboardId=' + currentTarget.closest('li').data('id'),\n\t\t\t\tsendByAjaxCb: () => {\n\t\t\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\t\t\tthisInstance.getModuleLayoutEditor('Home', currentTarget.closest('li').data('id')).done((data) => {\n\t\t\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t\t$('.deleteDashboard').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\te.stopPropagation();\n\t\t\tAppConnector.request({\n\t\t\t\tparent: 'Settings',\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'Dashboard',\n\t\t\t\tmode: 'delete',\n\t\t\t\tdashboardId: currentTarget.closest('li').data('id')\n\t\t\t}).done(() => {\n\t\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\t\tthisInstance.getModuleLayoutEditor('Home', 1).done((data) => {\n\t\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to register click event for add custom block button\n\t */\n\tregisterAddBlockDashBoard: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tcontents.find('.addBlockDashBoard').on('click', function (e) {\n\t\t\tvar addBlockContainer = contents.find('.addBlockDashBoardModal').clone(true, true);\n\t\t\tvar inUseAuthorization = thisInstance.getAuthorization();\n\t\t\taddBlockContainer.find('select.authorized option').each(function () {\n\t\t\t\tif (jQuery.inArray(jQuery(this).val(), inUseAuthorization) != -1)\n\t\t\t\t\tjQuery(this).remove();\n\t\t\t});\n\n\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t//register all select2 Elements\n\t\t\t\tApp.Fields.Picklist.changeSelectElementView(data.find('select'));\n\t\t\t\tvar form = data.find('.addBlockDashBoardForm');\n\t\t\t\tvar block = form.find('[name=\"authorized\"]');\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\tform.on('submit', function (e) {\n\t\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\t\tvar paramsForm = form.serializeFormData();\n\t\t\t\t\t\tparamsForm['action'] = 'addBlock';\n\t\t\t\t\t\tvar paramsBlock = {\n\t\t\t\t\t\t\tauthorized: block.val(),\n\t\t\t\t\t\t\tlabel: block.find(':selected').text()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\t\t\t\tvar params = {};\n\t\t\t\t\t\t\tvar response = data.result;\n\t\t\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\t\t\tparamsBlock['id'] = response['id'];\n\t\t\t\t\t\t\t\tthisInstance.displayNewCustomBlock(paramsBlock);\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_BLOCK_ADDED');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tparams['text'] = response['message'];\n\t\t\t\t\t\t\t\tparams['type'] = 'error';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t})\n\t\t\t}\n\t\t\tapp.showModalWindow(addBlockContainer, function (data) {\n\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t}\n\t\t\t}, { 'width': '1000px' });\n\t\t});\n\t},\n\tsave: function (form, mode) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\n\t\tvar params = {};\n\t\tparams['form'] = form;\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['sourceModule'] = jQuery('#selectedModuleName').val();\n\t\tparams['action'] = 'SaveAjax';\n\t\tparams['mode'] = mode;\n\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.reject(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tdisplayNewCustomBlock: function (result) {\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tvar newBlockCloneCopy = contents.find('.newCustomBlockCopy').clone(true, true);\n\t\tnewBlockCloneCopy.data('block-id', result['id']).find('.blockLabel span').append(jQuery('<strong>' + result['label'] + '</strong>'));\n\t\tnewBlockCloneCopy.find('.addCustomField').removeClass('d-none').show();\n\t\tnewBlockCloneCopy.find('.specialWidget').data('block-id', result['id']);\n\t\tcontents.find('#moduleBlocks').append(newBlockCloneCopy.removeClass('newCustomBlockCopy d-none').addClass('editFieldsTable block_' + result['id']).data('code', result['authorized']));\n\t},\n\t/*\n\t * Function to add clickoutside event on the element - By using outside events plugin\n\t * @params element---On which element you want to apply the click outside event\n\t * @params callbackFunction---This function will contain the actions triggered after clickoutside event\n\t */\n\taddClickOutSideEvent: function (element, callbackFunction) {\n\t\telement.one('clickoutside', callbackFunction);\n\t},\n\tregisterAddCustomFieldEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tcontents.find('.addCustomField').on('click', function (e) {\n\t\t\tvar continer = jQuery(e.currentTarget).closest('.editFieldsTable');\n\t\t\tvar blockId = continer.data('block-id');\n\t\t\tvar addFieldContainer = contents.find('.createFieldModal').clone(true, true);\n\t\t\tvar allFieldsInBlock = thisInstance.getAllFieldsInBlock(continer);\n\t\t\tvar selectWidgets = addFieldContainer.find('select.widgets');\n\t\t\tselectWidgets.find('option').each(function () {\n\t\t\t\tif (jQuery.inArray(jQuery(this).val(), allFieldsInBlock) != -1) {\n\t\t\t\t\tjQuery(this).remove();\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar name = selectWidgets.find(':first-child').data('name');\n\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterUsers) != -1) {\n\t\t\t\taddFieldContainer.find('.widgetFilter').removeClass('d-none').find('select').removeAttr('disabled').show();\n\t\t\t\tvar restrictFilter = thisInstance.restrictFilter[name];\n\t\t\t\tif (restrictFilter) {\n\t\t\t\t\tfor (var i in restrictFilter) {\n\t\t\t\t\t\taddFieldContainer.find('.widgetFilter select option[value=\"' + restrictFilter[i] + '\"]').remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterDate) != -1) {\n\t\t\t\taddFieldContainer.find('.widgetFilterDate').removeClass('d-none').find('select').removeAttr('disabled').show();\n\t\t\t}\n\n\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t//register all select2 Elements\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(data.find('select'));\n\t\t\t\tdata.find('select.widgets').on('change', function () {\n\t\t\t\t\tdata.find('.widgetFilter').remove();\n\t\t\t\t\tdata.find('.widgetFilterDate').remove();\n\t\t\t\t\tvar elementsToFilter = contents.find('.createFieldModal .widgetFilter').clone(true, true);\n\t\t\t\t\tvar elementsToFilterDate = contents.find('.createFieldModal .widgetFilterDate').clone(true, true);\n\n\t\t\t\t\tdata.find('.modal-body').append(elementsToFilter);\n\t\t\t\t\tdata.find('.modal-body').append(elementsToFilterDate);\n\t\t\t\t\tvar name = jQuery(this).find(':selected').data('name');\n\t\t\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterUsers) != -1) {\n\t\t\t\t\t\telementsToFilter.removeClass('d-none').find('select').prop('disabled', false);\n\t\t\t\t\t\tvar restrictFilter = thisInstance.restrictFilter[name];\n\t\t\t\t\t\tif (restrictFilter) {\n\t\t\t\t\t\t\tfor (var i in restrictFilter) {\n\t\t\t\t\t\t\t\taddFieldContainer.find('.widgetFilter select option[value=\"' + restrictFilter[i] + '\"]').remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(elementsToFilter.find('select'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\telementsToFilter.addClass('d-none').find('select').prop('disabled', true);\n\t\t\t\t\t}\n\t\t\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterDate) != -1) {\n\t\t\t\t\t\telementsToFilterDate.removeClass('d-none').find('select').prop('disabled', false);\n\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(elementsToFilterDate.find('select'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\telementsToFilterDate.addClass('d-none').find('select').prop('disabled', true);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvar form = data.find('.createCustomFieldForm');\n\t\t\t\tform.attr('id', 'createFieldForm');\n\t\t\t\tvar widgets = form.find('[name=\"widgets\"]');\n\t\t\t\tform.validationEngine($.extend(true, {\n\t\t\t\t\tonValidationComplete: function (form, valid) {\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tif (widgets.val()) {\n\t\t\t\t\t\t\t\tlet saveButton = form.find(':submit'),\n\t\t\t\t\t\t\t\t\tfield = form.find('[name=\"widgets\"]');\n\t\t\t\t\t\t\t\tsaveButton.attr('disabled', 'disabled');\n\n\t\t\t\t\t\t\t\tlet paramsForm = form.serializeFormData();\n\t\t\t\t\t\t\t\tparamsForm['action'] = 'addWidget';\n\t\t\t\t\t\t\t\tparamsForm['blockid'] = blockId;\n\t\t\t\t\t\t\t\tparamsForm['linkid'] = field.val();\n\t\t\t\t\t\t\t\tparamsForm['label'] = field.find(':selected').text();\n\t\t\t\t\t\t\t\tparamsForm['name'] = field.find(':selected').data('name');\n\t\t\t\t\t\t\t\tparamsForm['height'] = form.find('[name=\"height\"]').val();\n\t\t\t\t\t\t\t\tparamsForm['width'] = form.find('[name=\"width\"]').val();\n\t\t\t\t\t\t\t\tif (form.find('[name=\"isdefault\"]').prop(\"checked\"))\n\t\t\t\t\t\t\t\t\tparamsForm['isdefault'] = 1;\n\t\t\t\t\t\t\t\tif (form.find('[name=\"cache\"]').prop(\"checked\"))\n\t\t\t\t\t\t\t\t\tparamsForm['cache'] = 1;\n\t\t\t\t\t\t\t\tif (paramsForm['default_owner'] && typeof paramsForm['owners_all'] === \"undefined\") {\n\t\t\t\t\t\t\t\t\tform.find('select[name=\"owners_all\"]')\n\t\t\t\t\t\t\t\t\t\t.prev('div')\n\t\t\t\t\t\t\t\t\t\t.validationEngine('showPrompt', app.vtranslate('JS_FIELD_EMPTY'), 'error', 'bottomLeft', true);\n\t\t\t\t\t\t\t\t\tsaveButton.removeAttr('disabled');\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\t\t\t\t\t\tlet result = data['result'],\n\t\t\t\t\t\t\t\t\t\tparams = {};\n\t\t\t\t\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t\tparamsForm['id'] = result['id']\n\t\t\t\t\t\t\t\t\t\tparamsForm['status'] = result['status']\n\t\t\t\t\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\t\t\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tlet message = data['error']['message'],\n\t\t\t\t\t\t\t\t\t\t\terrorField;\n\t\t\t\t\t\t\t\t\t\tif (data['error']['code'] != 513) {\n\t\t\t\t\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldName\"]');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldLabel\"]');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\terrorField.validationEngine('showPrompt', message, 'error', 'topLeft', true);\n\t\t\t\t\t\t\t\t\t\tsaveButton.removeAttr('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidgets.prev('div').validationEngine('showPrompt', app.vtranslate('JS_FIELD_EMPTY'), 'error', 'topLeft', true);\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//To prevent form submit\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, app.validationEngineOptions));\n\t\t\t};\n\t\t\tapp.showModalWindow(addFieldContainer, function (data) {\n\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t}\n\t\t\t}, { 'width': '1000px' });\n\t\t});\n\t},\n\t/**\n\t * Function to add new custom field ui to the list\n\t */\n\tshowCustomField: function (result) {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tvar relatedBlock = contents.find('.block_' + result['blockid']);\n\t\tvar fieldCopy = contents.find('.newCustomFieldCopy').clone(true, true);\n\t\tvar fieldContainer = fieldCopy.find('.js-custom-field');\n\t\tfieldContainer.addClass('opacity editFieldsWidget').attr('data-field-id', result['id']).attr('data-block-id', result['blockid']).attr('data-linkid', result['linkid']);\n\t\tfieldContainer.find('.deleteCustomField, .saveFieldDetails').attr('data-field-id', result['id']);\n\t\tif (result['title']) {\n\t\t\tfieldContainer.find('.fieldLabel').html(result['title']);\n\t\t} else {\n\t\t\tfieldContainer.find('.fieldLabel').html(result['label']);\n\t\t}\n\t\tif (!result['status'])\n\t\t\tfieldContainer.find('input[name=\"limit\"]').closest('div.limit').remove();\n\t\tif (typeof result['default_owner'] !== \"undefined\")\n\t\t\tfieldContainer.find('.widgetFilterAll').removeClass('d-none').show();\n\n\t\tvar block = relatedBlock.find('.blockFieldsList');\n\t\tvar sortable1 = block.find('ul[name=sortable1]');\n\t\tvar length1 = sortable1.children().length;\n\t\tvar sortable2 = block.find('ul[name=sortable2]');\n\t\tvar length2 = sortable2.children().length;\n\n\t\t// Deciding where to add the new field\n\t\tif (length1 > length2) {\n\t\t\tsortable2.append(fieldCopy.removeClass('d-none newCustomFieldCopy'));\n\t\t} else {\n\t\t\tsortable1.append(fieldCopy.removeClass('d-none newCustomFieldCopy'));\n\t\t}\n\t\tvar form = fieldCopy.find('form.fieldDetailsForm');\n\t\tthisInstance.setFieldDetails(result, form);\n\t},\n\t/**\n\t * Function to set the field info for edit field actions\n\t */\n\tsetFieldDetails: function (result, form) {\n\t\tform.find('.modal-header').html($('<h5 class=\"modal-title\">' + result['label'] + '</h5><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'));\n\t\tif (result['isdefault']) {\n\t\t\tform.find('[name=\"isdefault\"]').filter(':checkbox').attr('checked', true);\n\t\t}\n\t\tif (result['cache']) {\n\t\t\tform.find('[name=\"cache\"]').filter(':checkbox').attr('checked', true);\n\t\t}\n\t\tif (result['width']) {\n\t\t\tform.find('select[name=\"width\"]').find('option').removeAttr('selected');\n\t\t\tform.find('select[name=\"width\"]').find('option[value=\"' + result['width'] + '\"]').attr('selected', 'selected');\n\t\t}\n\t\tif (result['height']) {\n\t\t\tform.find('select[name=\"height\"]').find('option').removeAttr('selected');\n\t\t\tform.find('select[name=\"height\"]').find('option[value=\"' + result['height'] + '\"]').attr('selected', 'selected');\n\t\t}\n\t\tif (result['default_owner']) {\n\t\t\tform.find('select[name=\"default_owner\"]').find('option').removeAttr('selected');\n\t\t\tform.find('select[name=\"default_owner\"]').find('option[value=\"' + result['default_owner'] + '\"]').attr('selected', 'selected');\n\t\t}\n\t\tif (result['owners_all']) {\n\t\t\tform.find('select[name=\"owners_all\"]').find('option').removeAttr('selected');\n\t\t\tvar selectedvalue = result['owners_all'];\n\t\t\tif (typeof (selectedvalue) != 'string') {\n\t\t\t\tfor (var i = 0; i < selectedvalue.length; i++) {\n\t\t\t\t\tvar encodedSelectedValue = selectedvalue[i].replace(/\"/g, '\\\\\"');\n\t\t\t\t\tform.find('select[name=\"owners_all\"]').find('option[value=\"' + encodedSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tform.find('select[name=\"owners_all\"]').find('option[value=\"' + selectedvalue + '\"]').attr('selected', 'selected');\n\t\t\t}\n\t\t}\n\t},\n\tregisterEditFieldDetailsClick: function (contents = null) {\n\t\tconst thisInstance = this;\n\t\tif (!contents) {\n\t\t\tcontents = jQuery('#layoutDashBoards');\n\t\t}\n\t\tcontents.find('.editFieldDetails').on('click', function (e) {\n\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\tconst fieldRow = currentTarget.closest('div.editFieldsWidget');\n\t\t\tfieldRow.removeClass('opacity');\n\t\t\tconst basicDropDown = fieldRow.find('.basicFieldOperations');\n\t\t\tconst dropDownContainer = currentTarget.closest('.btn-group');\n\t\t\tdropDownContainer.find('.dropdown-menu').remove();\n\t\t\tconst dropDown = basicDropDown.clone().removeClass('basicFieldOperations d-none').addClass('dropdown-menu p-0');\n\t\t\tdropDownContainer.append(dropDown);\n\t\t\tconst dropDownMenu = dropDownContainer.find('.dropdown-menu');\n\t\t\tdropDownContainer.dropdown('dispose').dropdown('toggle');\n\t\t\tdropDownMenu.find('form').validationEngine($.extend(true, {\n\t\t\t\tbinded: false,\n\t\t\t\tonValidationComplete: function (form, valid) {\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tif (form === undefined) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet paramsForm = form.serializeFormData();\n\t\t\t\t\t\tif (form.find('[name=\"isdefault\"]').prop(\"checked\"))\n\t\t\t\t\t\t\tparamsForm['isdefault'] = 1;\n\t\t\t\t\t\tif (form.find('[name=\"cache\"]').prop(\"checked\"))\n\t\t\t\t\t\t\tparamsForm['cache'] = 1;\n\t\t\t\t\t\tlet id = form.find('.saveFieldDetails').data('field-id');\n\t\t\t\t\t\tparamsForm['action'] = 'saveDetails';\n\t\t\t\t\t\tparamsForm['id'] = id;\n\t\t\t\t\t\tif (typeof paramsForm['customMultiFilter'] !== \"undefined\" && !$.isArray(paramsForm['customMultiFilter'])) {\n\t\t\t\t\t\t\tparamsForm['customMultiFilter'] = [paramsForm['customMultiFilter']];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (paramsForm['default_owner'] && typeof paramsForm['owners_all'] === \"undefined\") {\n\t\t\t\t\t\t\tlet params = {};\n\t\t\t\t\t\t\tparams['type'] = 'error';\n\t\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_FILTERS_AVAILABLE') + ': ' + app.vtranslate('JS_FIELD_EMPTY');\n\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisInstance.save(paramsForm, 'save');\n\t\t\t\t\t\tthisInstance.registerSaveFieldDetailsEvent(form);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, app.getvalidationEngineOptions(true)));\n\t\t\tlet selectElements = basicDropDown.find('select[name=\"owners_all\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"owners_all\"]'));\n\t\t\t}\n\t\t\tselectElements = basicDropDown.find('select[name=\"default_date\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"default_date\"]'));\n\t\t\t}\n\t\t\tselectElements = basicDropDown.find('select[name=\"customMultiFilter\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"customMultiFilter\"]'));\n\t\t\t}\n\t\t\tselectElements = basicDropDown.find('select[name=\"defaultFilter\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"defaultFilter\"]'));\n\t\t\t}\n\t\t\tthisInstance.avoidDropDownClick(dropDownContainer);\n\t\t\tdropDownMenu.on('change', ':checkbox', function (e) {\n\t\t\t\tlet currentTarget = jQuery(e.currentTarget);\n\t\t\t\tif (currentTarget.attr('readonly') === 'readonly') {\n\t\t\t\t\tlet status = jQuery(e.currentTarget).is(':checked');\n\t\t\t\t\tif (!status) {\n\t\t\t\t\t\t$(e.currentTarget).attr('checked', 'checked')\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(e.currentTarget).removeAttr('checked');\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst callbackFunction = function () {\n\t\t\t\tfieldRow.addClass('opacity');\n\t\t\t\tdropDown.remove();\n\t\t\t};\n\t\t\tthisInstance.addClickOutSideEvent(dropDown, callbackFunction);\n\t\t\t$('.cancel,.close').on('click', callbackFunction);\n\t\t});\n\t},\n\t/**\n\t * Function to register the click event for save button after edit field details\n\t */\n\tregisterSaveFieldDetailsEvent: function (form) {\n\t\tlet submitButtton = form.find('.saveFieldDetails'),\n\t\t\tfieldRow = submitButtton.closest('.editFieldsWidget'),\n\t\t\tdropDownMenu = form.closest('.dropdown-menu');\n\t\t//close the drop down\n\t\tsubmitButtton.closest('.btn-group').removeClass('open');\n\t\t//adding class opacity to fieldRow - to give opacity to the actions of the fields\n\t\tfieldRow.addClass('opacity');\n\t\tform.find('select').each(function () {\n\t\t\tlet selectedValue = $(this).val(),\n\t\t\t\tencodedSelectedValue;\n\t\t\t$(this).find('option').removeAttr('selected');\n\t\t\tif (typeof ($(this).attr('multiple')) === \"undefined\") {\n\t\t\t\tencodedSelectedValue = selectedValue.replace(/\"/g, '\\\\\"');\n\t\t\t\t$(this).find('[value=\"' + encodedSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t} else {\n\t\t\t\tfor (let i = 0; i < selectedValue.length; i++) {\n\t\t\t\t\tencodedSelectedValue = selectedValue[i].replace(/\"/g, '\\\\\"');\n\t\t\t\t\t$(this).find('[value=\"' + encodedSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tform.closest('.editFieldsWidget').find('.basicFieldOperations').html(form);\n\t\tdropDownMenu.remove();\n\t},\n\t/**\n\t * Function to register click event for drop-downs in fields list\n\t */\n\tavoidDropDownClick: function (dropDownContainer) {\n\t\tdropDownContainer.find('.dropdown-menu').on('click', function (e) {\n\t\t\te.stopPropagation();\n\t\t});\n\t},\n\tregisterSpecialWidget: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('#layoutDashBoards');\n\t\tcontainer.find('.addNotebook').on('click', function (e) {\n\t\t\tthisInstance.addNoteBookWidget(this, jQuery(this).data('url'));\n\t\t});\n\t\tcontainer.find('.addMiniList').on('click', function (e) {\n\t\t\tthisInstance.addMiniListWidget(this, jQuery(this).data('url'));\n\t\t});\n\t\tcontainer.find('.addChartFilter').on('click', function (e) {\n\t\t\tthisInstance.addChartFilterWidget(this, jQuery(this).data('url'));\n\t\t});\n\t\tcontainer.find('.addRss').on('click', function (e) {\n\t\t\tthisInstance.addRssWidget($(e.currentTarget), jQuery(this).data('url'));\n\t\t});\n\t},\n\taddRssWidget: function (element, url) {\n\t\tvar thisInstance = this;\n\t\tvar objectToShowModal = {\n\t\t\turl: 'index.php?module=' + app.getModuleName() + '&parent=' + app.getParentModuleName() + '&view=AddRss',\n\t\t\tcb: function (container) {\n\t\t\t\tcontainer.find('.removeChannel').on('click', function (e) {\n\t\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\t\tvar row = currentTarget.closest('.form-group');\n\t\t\t\t\trow.remove();\n\t\t\t\t});\n\t\t\t\tcontainer.find('.addChannel').on('click', function (e) {\n\t\t\t\t\tvar newRow = container.find('.newChannel').clone();\n\t\t\t\t\tvar formContainer = container.find('.formContainer');\n\t\t\t\t\tformContainer.append(newRow);\n\t\t\t\t\tnewRow.removeClass('d-none');\n\t\t\t\t\tnewRow.removeClass('newChannel');\n\t\t\t\t\tnewRow.find('input').removeAttr('disabled');\n\t\t\t\t\tnewRow.find('.removeChannel').on('click', function (e) {\n\t\t\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\t\t\tvar row = currentTarget.closest('.form-group');\n\t\t\t\t\t\trow.remove();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tcontainer.find('[name=\"blockid\"]').val(element.data('blockId'));\n\t\t\t\tcontainer.find('[name=\"linkid\"]').val(element.data('linkid'));\n\t\t\t\tvar form = container.find('form');\n\t\t\t\tvar submit = form.find('[type=\"submit\"]');\n\t\t\t\tsubmit.on('click', function (e) {\n\t\t\t\t\tvar channels = [];\n\t\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\t\tform.find('.channelRss:not(:disabled)').each(function () {\n\t\t\t\t\t\t\tchannels.push(jQuery(this).val());\n\t\t\t\t\t\t})\n\t\t\t\t\t\tvar paramsForm = form.serializeFormData();\n\t\t\t\t\t\tparamsForm.data = JSON.stringify({ channels: channels });\n\t\t\t\t\t\tthisInstance.save(paramsForm, 'save').done(\n\t\t\t\t\t\t\tfunction (data) {\n\t\t\t\t\t\t\t\tparamsForm.label = paramsForm.title;\n\t\t\t\t\t\t\t\tthisInstance.saveAfterInfo(data, paramsForm)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t})\n\t\t\t},\n\t\t};\n\t\tapp.showModalWindow(objectToShowModal);\n\t},\n\tsaveAfterInfo: function (data, paramsForm) {\n\t\tvar thisInstance = this;\n\t\tvar result = data['result'];\n\t\tvar params = {};\n\t\tif (data['success']) {\n\t\t\tapp.hideModalWindow();\n\t\t\tparamsForm['id'] = result['id'];\n\t\t\tparamsForm['status'] = result['status'];\n\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t}\n\t},\n\taddChartFilterWidget: function (element) {\n\t\tvar thisInstance = this;\n\t\telement = jQuery(element);\n\t\tapp.showModalWindow(null, \"index.php?module=Home&view=ChartFilter&step=step1\", function (wizardContainer) {\n\t\t\tvar form = jQuery('form', wizardContainer);\n\t\t\tvar chartType = jQuery('select[name=\"chartType\"]', wizardContainer);\n\t\t\tvar moduleNameSelectDOM = jQuery('select[name=\"module\"]', wizardContainer);\n\t\t\tvar moduleNameSelect2 = App.Fields.Picklist.showSelect2ElementView(moduleNameSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_SELECT_MODULE')\n\t\t\t});\n\t\t\tvar step1 = jQuery('.step1', wizardContainer);\n\t\t\tvar step2 = jQuery('.step2', wizardContainer);\n\t\t\tvar step3 = jQuery('.step3', wizardContainer);\n\t\t\tvar footer = jQuery('.modal-footer', wizardContainer);\n\t\t\tstep2.remove();\n\t\t\tstep3.remove();\n\t\t\tfooter.hide();\n\t\t\tchartType.on('change', function (e) {\n\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\tvar value = currentTarget.val();\n\t\t\t\tif (value == 'Barchat' || value == 'Horizontal') {\n\t\t\t\t\tform.find('.isColorContainer').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tform.find('.isColorContainer').addClass('d-none');\n\t\t\t\t}\n\t\t\t\tif (wizardContainer.find('#widgetStep').val() == 4) {\n\t\t\t\t\twizardContainer.find('.step3 .groupField').trigger('change');\n\t\t\t\t}\n\t\t\t});\n\t\t\tmoduleNameSelect2.on('change', function () {\n\t\t\t\tif (!moduleNameSelect2.val())\n\t\t\t\t\treturn;\n\t\t\t\tfooter.hide();\n\t\t\t\twizardContainer.find('.step2').remove();\n\t\t\t\twizardContainer.find('.step3').remove();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\tview: 'ChartFilter',\n\t\t\t\t\tstep: 'step2',\n\t\t\t\t\tchartType: chartType.val(),\n\t\t\t\t\tselectedModule: moduleNameSelect2.val()\n\t\t\t\t}).done(function (step2Response) {\n\t\t\t\t\tstep1.after(step2Response);\n\t\t\t\t\twizardContainer.find('#widgetStep').val(2);\n\t\t\t\t\tconst step2 = wizardContainer.find('.step2');\n\t\t\t\t\tfooter.hide();\n\t\t\t\t\tconst filtersIdElement = step2.find('.filtersId');\n\t\t\t\t\tconst valueTypeElement = step2.find('.valueType');\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(filtersIdElement);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(valueTypeElement);\n\t\t\t\t\tstep2.find('.filtersId, .valueType').on('change', function () {\n\t\t\t\t\t\twizardContainer.find('.step3').remove();\n\t\t\t\t\t\twizardContainer.find('.step4').remove();\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\t\t\tview: 'ChartFilter',\n\t\t\t\t\t\t\tstep: 'step3',\n\t\t\t\t\t\t\tselectedModule: moduleNameSelect2.val(),\n\t\t\t\t\t\t\tchartType: chartType.val(),\n\t\t\t\t\t\t\tfiltersId: filtersIdElement.val(),\n\t\t\t\t\t\t\tvalueType: valueTypeElement.val(),\n\t\t\t\t\t\t}).done(function (step3Response) {\n\t\t\t\t\t\t\tstep2.last().after(step3Response);\n\t\t\t\t\t\t\twizardContainer.find('#widgetStep').val(3);\n\t\t\t\t\t\t\tvar step3 = wizardContainer.find('.step3');\n\t\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(step3.find('select'));\n\t\t\t\t\t\t\tfooter.hide();\n\t\t\t\t\t\t\tstep3.find('.groupField').on('change', function () {\n\t\t\t\t\t\t\t\twizardContainer.find('.step4').remove();\n\t\t\t\t\t\t\t\tvar groupField = $(this);\n\t\t\t\t\t\t\t\tif (!groupField.val())\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tfooter.show();\n\t\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\t\t\t\t\tview: 'ChartFilter',\n\t\t\t\t\t\t\t\t\tstep: 'step4',\n\t\t\t\t\t\t\t\t\tselectedModule: moduleNameSelect2.val(),\n\t\t\t\t\t\t\t\t\tfiltersId: filtersIdElement.val(),\n\t\t\t\t\t\t\t\t\tgroupField: groupField.val(),\n\t\t\t\t\t\t\t\t\tchartType: chartType.val()\n\t\t\t\t\t\t\t\t}).done(function (step4Response) {\n\t\t\t\t\t\t\t\t\tstep3.last().after(step4Response);\n\t\t\t\t\t\t\t\t\twizardContainer.find('#widgetStep').val(4);\n\t\t\t\t\t\t\t\t\tvar step4 = wizardContainer.find('.step4');\n\t\t\t\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(step4.find('select'));\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst selectedModule = moduleNameSelect2.val();\n\t\t\t\tconst selectedModuleLabel = moduleNameSelect2.find(':selected').text();\n\t\t\t\tconst selectedFilterId = form.find('.filtersId').val();\n\t\t\t\tconst selectedFieldLabel = form.find('.groupField').find(':selected').text();\n\t\t\t\tconst data = {\n\t\t\t\t\tmodule: selectedModule,\n\t\t\t\t\tgroupField: form.find('.groupField').val(),\n\t\t\t\t\tchartType: chartType.val(),\n\t\t\t\t};\n\t\t\t\tform.find('.saveParam').each(function (index, element) {\n\t\t\t\t\telement = $(element);\n\t\t\t\t\tif (!(element.is('input') && element.prop('type') === 'checkbox' && !element.prop('checked'))) {\n\t\t\t\t\t\tdata[element.attr('name')] = element.val();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfinializeAddChart(selectedModuleLabel, selectedFilterId, null, selectedFieldLabel, data, form);\n\t\t\t});\n\t\t});\n\n\t\tfunction finializeAddChart(moduleNameLabel, filterid, filterLabel, fieldLabel, data, form) {\n\t\t\tlet paramsForm = {};\n\t\t\tparamsForm['data'] = JSON.stringify(data);\n\t\t\tparamsForm['action'] = 'addWidget';\n\t\t\tparamsForm['blockid'] = element.data('block-id');\n\t\t\tparamsForm['linkid'] = element.data('linkid');\n\t\t\tparamsForm['label'] = moduleNameLabel;\n\t\t\tif (typeof filterLabel !== 'undefined' && filterLabel !== null && filterLabel !== '') {\n\t\t\t\tparamsForm['label'] += ' - ' + filterLabel;\n\t\t\t}\n\t\t\tif (typeof fieldLabel !== 'undefined' && fieldLabel !== null && fieldLabel !== '') {\n\t\t\t\tparamsForm['label'] += ' - ' + fieldLabel;\n\t\t\t}\n\t\t\tparamsForm['name'] = 'ChartFilter';\n\t\t\tif (Array.isArray(filterid)) {\n\t\t\t\tfilterid = filterid.join(',');\n\t\t\t}\n\t\t\tparamsForm['filterid'] = filterid;\n\t\t\tparamsForm['title'] = form.find('[name=\"widgetTitle\"]').val();\n\t\t\tparamsForm['isdefault'] = 0;\n\t\t\tparamsForm['cache'] = 0;\n\t\t\tparamsForm['height'] = 4;\n\t\t\tparamsForm['width'] = 4;\n\t\t\tparamsForm['owners_all'] = [\"mine\", \"all\", \"users\", \"groups\"];\n\t\t\tparamsForm['default_owner'] = 'mine';\n\n\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\tlet result = data['result'],\n\t\t\t\t\tparams = {};\n\t\t\t\tif (data['success']) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tparamsForm['id'] = result['id'];\n\t\t\t\t\tparamsForm['status'] = result['status'];\n\t\t\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t\t\t} else {\n\t\t\t\t\tlet message = data['error']['message'],\n\t\t\t\t\t\terrorField;\n\t\t\t\t\tif (data['error']['code'] != 513) {\n\t\t\t\t\t\terrorField = form.find('[name=\"fieldName\"]');\n\t\t\t\t\t} else {\n\t\t\t\t\t\terrorField = form.find('[name=\"fieldLabel\"]');\n\t\t\t\t\t}\n\t\t\t\t\terrorField.validationEngine('showPrompt', message, 'error', 'topLeft', true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\taddNoteBookWidget: function (element, url) {\n\t\tvar thisInstance = this;\n\t\telement = jQuery(element);\n\t\tapp.showModalWindow(null, \"index.php?module=Home&view=AddNotePad\", function (wizardContainer) {\n\t\t\tvar form = jQuery('form', wizardContainer);\n\t\t\tform.validationEngine($.extend(true, {\n\t\t\t\tonValidationComplete: function (form, valid) {\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t//To prevent multiple click on save\n\t\t\t\t\t\tjQuery(\"[name='saveButton']\", wizardContainer).attr('disabled', 'disabled');\n\t\t\t\t\t\tvar notePadName = form.find('[name=\"notePadName\"]').val();\n\t\t\t\t\t\tvar notePadContent = form.find('[name=\"notePadContent\"]').val();\n\t\t\t\t\t\tvar isDefault = 0;\n\t\t\t\t\t\tvar linkId = element.data('linkid');\n\t\t\t\t\t\tvar blockId = element.data('block-id');\n\t\t\t\t\t\tvar noteBookParams = {\n\t\t\t\t\t\t\t'module': jQuery('#selectedModuleName').val(),\n\t\t\t\t\t\t\t'action': 'NoteBook',\n\t\t\t\t\t\t\t'mode': 'noteBookCreate',\n\t\t\t\t\t\t\t'notePadName': notePadName,\n\t\t\t\t\t\t\t'notePadContent': notePadContent,\n\t\t\t\t\t\t\t'blockid': blockId,\n\t\t\t\t\t\t\t'linkId': linkId,\n\t\t\t\t\t\t\t'isdefault': isDefault,\n\t\t\t\t\t\t\t'width': 4,\n\t\t\t\t\t\t\t'height': 3\n\t\t\t\t\t\t}\n\t\t\t\t\t\tAppConnector.request(noteBookParams).done(function (data) {\n\t\t\t\t\t\t\tif (data.result.success) {\n\t\t\t\t\t\t\t\tvar widgetId = data.result.widgetId;\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\tnoteBookParams['id'] = widgetId;\n\t\t\t\t\t\t\t\tnoteBookParams['label'] = notePadName;\n\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage({ text: app.vtranslate('JS_WIDGET_ADDED') });\n\t\t\t\t\t\t\t\tthisInstance.showCustomField(noteBookParams);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, app.validationEngineOptions));\n\t\t});\n\t},\n\taddMiniListWidget: function (element, url) {\n\t\t// 1. Show popup window for selection (module, filter, fields)\n\t\t// 2. Compute the dynamic mini-list widget url\n\t\t// 3. Add widget with URL to the page.\n\t\tvar thisInstance = this;\n\t\telement = jQuery(element);\n\n\t\tapp.showModalWindow(null, \"index.php?module=Home&view=MiniListWizard&step=step1\", function (wizardContainer) {\n\t\t\tvar form = jQuery('form', wizardContainer);\n\n\t\t\tvar moduleNameSelectDOM = jQuery('select[name=\"module\"]', wizardContainer);\n\t\t\tvar filteridSelectDOM = jQuery('select[name=\"filterid\"]', wizardContainer);\n\t\t\tvar fieldsSelectDOM = jQuery('select[name=\"fields\"]', wizardContainer);\n\t\t\tvar filterFieldsSelectDOM = jQuery('select[name=\"filter_fields\"]', wizardContainer);\n\n\t\t\tvar moduleNameSelect2 = App.Fields.Picklist.showSelect2ElementView(moduleNameSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_SELECT_MODULE')\n\t\t\t});\n\t\t\tvar filteridSelect2 = App.Fields.Picklist.showSelect2ElementView(filteridSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION')\n\t\t\t});\n\t\t\tvar fieldsSelect2 = App.Fields.Picklist.showSelect2ElementView(fieldsSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION'),\n\t\t\t\tcloseOnSelect: true,\n\t\t\t\tmaximumSelectionLength: 6\n\t\t\t});\n\t\t\tvar filterFieldsSelect2 = App.Fields.Picklist.showSelect2ElementView(filterFieldsSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION')\n\t\t\t});\n\t\t\tvar footer = jQuery('.modal-footer', wizardContainer);\n\n\t\t\tfilteridSelectDOM.closest('tr').hide();\n\t\t\tfieldsSelectDOM.closest('tr').hide();\n\t\t\tfilterFieldsSelectDOM.closest('tr').hide();\n\t\t\tfooter.hide();\n\n\t\t\tmoduleNameSelect2.on('change', function () {\n\t\t\t\tif (!moduleNameSelect2.val())\n\t\t\t\t\treturn;\n\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\tview: 'MiniListWizard',\n\t\t\t\t\tstep: 'step2',\n\t\t\t\t\tselectedModule: moduleNameSelect2.val()\n\t\t\t\t}).done(function (res) {\n\t\t\t\t\tfilteridSelectDOM.empty().html(res).trigger('change');\n\t\t\t\t\tfilteridSelect2.closest('tr').show();\n\t\t\t\t\tfieldsSelectDOM.closest('tr').hide();\n\t\t\t\t\tfilterFieldsSelectDOM.closest('tr').hide();\n\t\t\t\t});\n\t\t\t});\n\t\t\tfilteridSelect2.on('change', function () {\n\t\t\t\tif (!filteridSelect2.val())\n\t\t\t\t\treturn;\n\t\t\t\tfooter.hide();\n\t\t\t\tfieldsSelectDOM.closest('tr').hide();\n\t\t\t\tfilterFieldsSelectDOM.closest('tr').hide();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\tview: 'MiniListWizard',\n\t\t\t\t\tstep: 'step3',\n\t\t\t\t\tselectedModule: moduleNameSelect2.val(),\n\t\t\t\t\tfilterid: filteridSelect2.val()\n\t\t\t\t}).done(function (res) {\n\t\t\t\t\tres = $(res);\n\t\t\t\t\tfieldsSelectDOM.empty().html(res.find('select[name=\"fields\"]').html()).trigger('change');\n\t\t\t\t\tfilterFieldsSelectDOM.empty().html(res.find('select[name=\"filter_fields\"]').html()).trigger('change');\n\t\t\t\t\tfieldsSelect2.closest('tr').show();\n\t\t\t\t\tfilterFieldsSelect2.closest('tr').show();\n\t\t\t\t\tfieldsSelect2.data('select2').$selection.find('.select2-search__field').parent().css('width', '100%');\n\t\t\t\t\tfilterFieldsSelect2.data('select2').$selection.find('.select2-search__field').parent().css('width', '100%');\n\t\t\t\t});\n\t\t\t});\n\t\t\tfieldsSelect2.on('change', function () {\n\t\t\t\tif (!fieldsSelect2.val()) {\n\t\t\t\t\tfooter.hide();\n\t\t\t\t} else {\n\t\t\t\t\tfooter.show();\n\t\t\t\t}\n\t\t\t});\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tlet selectedFields = [];\n\t\t\t\tfieldsSelect2.select2('data').map(function (obj) {\n\t\t\t\t\tselectedFields.push(obj.id);\n\t\t\t\t});\n\t\t\t\tlet data = {\n\t\t\t\t\tmodule: moduleNameSelect2.val()\n\t\t\t\t};\n\t\t\t\tdata['fields'] = selectedFields;\n\t\t\t\tdata['filterFields'] = filterFieldsSelect2.val();\n\t\t\t\tlet paramsForm = {\n\t\t\t\t\tdata: JSON.stringify(data),\n\t\t\t\t\taction: 'addWidget',\n\t\t\t\t\tblockid: element.data('block-id'),\n\t\t\t\t\ttitle: form.find('[name=\"widgetTitle\"]').val(),\n\t\t\t\t\tlinkid: element.data('linkid'),\n\t\t\t\t\tlabel: moduleNameSelect2.find(':selected').text() + ' - ' + filteridSelect2.find(':selected').text(),\n\t\t\t\t\tname: 'Mini List',\n\t\t\t\t\tfilterid: filteridSelect2.val(),\n\t\t\t\t\tisdefault: 0,\n\t\t\t\t\tcache: 0,\n\t\t\t\t\theight: 4,\n\t\t\t\t\twidth: 4,\n\t\t\t\t\towners_all: [\"mine\", \"all\", \"users\", \"groups\"],\n\t\t\t\t\tdefault_owner: 'mine'\n\t\t\t\t};\n\t\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\t\tlet result = data['result'],\n\t\t\t\t\t\tparams = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tparamsForm['id'] = result['id'];\n\t\t\t\t\t\tparamsForm['status'] = result['status'];\n\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet message = data['error']['message'],\n\t\t\t\t\t\t\terrorField;\n\t\t\t\t\t\tif (data['error']['code'] !== 513) {\n\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldName\"]');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldLabel\"]');\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorField.validationEngine('showPrompt', message, 'error', 'topLeft', true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to register the click event for delete custom field\n\t */\n\tregisterDeleteCustomFieldEvent: function (contents) {\n\t\tvar thisInstance = this;\n\t\tif (typeof contents === \"undefined\") {\n\t\t\tcontents = jQuery('#layoutDashBoards');\n\t\t}\n\t\tcontents.find('a.deleteCustomField').on('click', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar fieldId = currentTarget.data('field-id');\n\t\t\tvar paramsForm = {}\n\t\t\tparamsForm['action'] = 'removeWidget';\n\t\t\tparamsForm['id'] = fieldId;\n\t\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ 'message': message }).done(function (e) {\n\t\t\t\tthisInstance.save(paramsForm, 'delete').done(function (data) {\n\t\t\t\t\tvar field = currentTarget.closest('div.editFieldsWidget');\n\t\t\t\t\tvar blockId = field.data('block-id');\n\t\t\t\t\tfield.parent().fadeOut('slow').remove();\n\t\t\t\t\tvar block = jQuery('#block_' + blockId);\n\t\t\t\t\tthisInstance.reArrangeBlockFields(block);\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tparams['text'] = app.vtranslate('JS_CUSTOM_FIELD_DELETED');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function that rearranges fields in the block when the fields are moved\n\t * @param <jQuery object> block\n\t */\n\treArrangeBlockFields: function (block) {\n\t\t// 1.get the containers, 2.compare the length, 3.if uneven then move the last element\n\t\tvar leftSideContainer = block.find('ul[name=sortable1]');\n\t\tvar rightSideContainer = block.find('ul[name=sortable2]');\n\t\tif (leftSideContainer.children().length < rightSideContainer.children().length) {\n\t\t\tvar lastElementInRightContainer = rightSideContainer.children(':last');\n\t\t\tleftSideContainer.append(lastElementInRightContainer);\n\t\t} else if (leftSideContainer.children().length > rightSideContainer.children().length + 1) {\t//greater than 1\n\t\t\tvar lastElementInLeftContainer = leftSideContainer.children(':last');\n\t\t\trightSideContainer.append(lastElementInLeftContainer);\n\t\t}\n\t},\n\t/**\n\t * Function to register the click event for delete custom block\n\t */\n\tregisterDeleteCustomBlockEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tcontents.on('click', '.js-delete-custom-block-btn', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar table = currentTarget.closest('div.editFieldsTable');\n\t\t\tvar blockId = table.data('block-id');\n\t\t\tvar paramsFrom = {};\n\t\t\tparamsFrom['blockid'] = blockId;\n\t\t\tparamsFrom['action'] = 'removeBlock';\n\t\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ 'message': message }).done(function (e) {\n\t\t\t\tthisInstance.save(paramsFrom, 'delete').done(function (data) {\n\t\t\t\t\tthisInstance.removeDeletedBlock(blockId, 'delete');\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tparams['text'] = app.vtranslate('JS_CUSTOM_BLOCK_DELETED');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to remove the deleted custom block from the ui\n\t */\n\tremoveDeletedBlock: function (blockId) {\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tvar deletedTable = contents.find('.block_' + blockId);\n\t\tdeletedTable.fadeOut('slow').remove();\n\t},\n\t/**\n\t * Function to register the change event for layout editor modules list\n\t */\n\tregisterModulesChangeEvent() {\n\t\tconst thisInstance = this;\n\t\tlet container = $('#widgetsManagementEditorContainer');\n\t\tlet contentsDiv = container.closest('.contentsDiv');\n\t\tApp.Fields.Picklist.changeSelectElementView(container.find('[name=\"widgetsManagementEditorModules\"]'));\n\t\tcontainer.on('change', '[name=\"widgetsManagementEditorModules\"]', (e) => {\n\t\t\tthisInstance.getModuleLayoutEditor($(e.currentTarget).val(), thisInstance.getCurrentDashboardId()).done((data) => {\n\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Update contents div and register events.\n\t * @param {jQuery} contentsDiv\n\t * @param {HTMLElement} data\n\t */\n\tupdateContentsDiv(contentsDiv, data) {\n\t\tcontentsDiv.html(data);\n\t\tApp.Fields.Picklist.showSelect2ElementView(contentsDiv.find('.select2'));\n\t\tthis.registerEvents();\n\t},\n\t/**\n\t * Function to get the respective module layout editor through pjax\n\t */\n\tgetModuleLayoutEditor: function (selectedModule, selectedDashboard) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['view'] = 'Configuration';\n\t\tparams['sourceModule'] = selectedModule;\n\t\tparams['dashboardId'] = selectedDashboard;\n\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * register events for layout editor\n\t */\n\tregisterEvents: function () {\n\t\tvar thisInstance = this;\n\n\t\tthisInstance.registerAddBlockDashBoard();\n\t\tthisInstance.registerAddCustomFieldEvent();\n\t\tthisInstance.registerEditFieldDetailsClick();\n\t\tthisInstance.registerSpecialWidget();\n\t\tthisInstance.registerDeleteCustomFieldEvent();\n\t\tthisInstance.registerDeleteCustomBlockEvent();\n\t\tthisInstance.registerModulesChangeEvent();\n\t\tthisInstance.setWidgetWithFilterUsers();\n\t\tthisInstance.setRestrictFilter();\n\t\tthisInstance.setWidgetWithFilterDate();\n\t\tthisInstance.registerAddedDashboard();\n\t\tthisInstance.registerSelectDashboard();\n\t\tthisInstance.registerDashboardAction();\n\t}\n\n});\n\njQuery(document).ready(function () {\n\tvar instance = new Settings_WidgetsManagement_Js();\n\tinstance.registerEvents();\n})\n"],"names":["jQuery","Class","element","val","this","widgetWithFilterUsers","JSON","parse","widgetWithFilterDate","restrictFilter","authorization","find","each","push","data","toString","continer","fields","$","parent","thisInstance","on","showModalWindow","app","getModuleName","contentsDiv","getModuleLayoutEditor","done","updateContentsDiv","e","currentTarget","stopPropagation","closest","request","contents","addBlockContainer","clone","inUseAuthorization","getAuthorization","inArray","remove","callBackFunction","Fields","Picklist","changeSelectElementView","form","block","validationEngine","validationEngineOptions","paramsForm","serializeFormData","paramsBlock","text","save","params","response","result","displayNewCustomBlock","hideModalWindow","vtranslate","showMessage","location","reload","preventDefault","width","mode","aDeferred","Deferred","progressIndicatorElement","progressIndicator","getParentModuleName","resolve","fail","error","reject","promise","newBlockCloneCopy","append","removeClass","show","addClass","callbackFunction","one","blockId","addFieldContainer","allFieldsInBlock","getAllFieldsInBlock","selectWidgets","name","removeAttr","i","showSelect2ElementView","elementsToFilter","elementsToFilterDate","prop","attr","widgets","extend","valid","prev","saveButton","field","showCustomField","message","relatedBlock","fieldCopy","fieldContainer","html","sortable1","length1","children","length","sortable2","setFieldDetails","filter","selectedvalue","encodedSelectedValue","replace","fieldRow","basicDropDown","dropDownContainer","dropDown","dropDownMenu","dropdown","undefined","id","isArray","registerSaveFieldDetailsEvent","getvalidationEngineOptions","selectElements","avoidDropDownClick","is","addClickOutSideEvent","submitButtton","selectedValue","container","addNoteBookWidget","addMiniListWidget","addChartFilterWidget","addRssWidget","url","objectToShowModal","newRow","channels","stringify","label","title","saveAfterInfo","wizardContainer","chartType","moduleNameSelectDOM","moduleNameSelect2","App","step1","step2","step3","footer","hide","value","trigger","step2Response","after","filtersIdElement","valueTypeElement","step3Response","last","groupField","step4Response","step4","selectedModule","selectedModuleLabel","selectedFilterId","selectedFieldLabel","index","moduleNameLabel","filterid","filterLabel","fieldLabel","Array","join","notePadName","notePadContent","linkId","noteBookParams","success","widgetId","filteridSelectDOM","fieldsSelectDOM","filterFieldsSelectDOM","filteridSelect2","fieldsSelect2","filterFieldsSelect2","res","empty","$selection","css","selectedFields","select2","map","obj","fieldId","showConfirmationBox","fadeOut","reArrangeBlockFields","leftSideContainer","rightSideContainer","lastElementInRightContainer","lastElementInLeftContainer","paramsFrom","removeDeletedBlock","getCurrentDashboardId","registerEvents","selectedDashboard","requestPjax","registerAddBlockDashBoard","registerAddCustomFieldEvent","registerEditFieldDetailsClick","registerSpecialWidget","registerDeleteCustomFieldEvent","registerDeleteCustomBlockEvent","registerModulesChangeEvent","setWidgetWithFilterUsers","setRestrictFilter","setWidgetWithFilterDate","registerAddedDashboard","registerSelectDashboard","registerDashboardAction","document","ready","Settings_WidgetsManagement_Js"],"mappings":"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"}