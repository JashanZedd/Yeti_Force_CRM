{"version":3,"file":"WidgetsManagement.min.js","sources":["WidgetsManagement.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class('Settings_WidgetsManagement_Js', {}, {\n\twidgetWithFilterUsers: [],\n\tsetWidgetWithFilterUsers: function () {\n\t\tvar thisInstance = this;\n\t\tvar element = jQuery('[name=\"filter_users\"]').val();\n\t\tif (element)\n\t\t\tthisInstance.widgetWithFilterUsers = JSON.parse(element);\n\t\telse\n\t\t\tthisInstance.widgetWithFilterUsers = [];\n\t},\n\twidgetWithFilterDate: [],\n\tsetWidgetWithFilterDate: function () {\n\t\tvar thisInstance = this;\n\t\tvar element = jQuery('[name=\"filter_date\"]').val();\n\t\tif (element)\n\t\t\tthisInstance.widgetWithFilterDate = JSON.parse(element);\n\t\telse\n\t\t\tthisInstance.widgetWithFilterDate = [];\n\t},\n\trestrictFilter: [],\n\tsetRestrictFilter: function () {\n\t\tvar thisInstance = this;\n\t\tvar element = jQuery('[name=\"filter_restrict\"]').val();\n\t\tif (element)\n\t\t\tthisInstance.restrictFilter = JSON.parse(element);\n\t\telse\n\t\t\tthisInstance.restrictFilter = [];\n\t},\n\t/**\n\t * Function to create the array of block roles list\n\t */\n\tgetAuthorization: function () {\n\t\tlet authorization = [],\n\t\t\tcontainer = jQuery('#moduleBlocks');\n\t\tcontainer.find('.editFieldsTable').each(function () {\n\t\t\tauthorization.push(jQuery(this).data('code').toString());\n\t\t});\n\t\treturn authorization;\n\t},\n\tgetAllFieldsInBlock: function (continer) {\n\t\tvar fields = [];\n\t\tcontiner.find('.blockFieldsList .editFieldsWidget').each(function () {\n\t\t\tfields.push(jQuery(this).data('linkid').toString());\n\t\t});\n\t\treturn fields;\n\t},\n\tgetCurrentDashboardId() {\n\t\treturn $('.selectDashboard li a.active').parent().data('id');\n\t},\n\tregisterAddedDashboard() {\n\t\tconst thisInstance = this;\n\t\t$('.addDashboard').on('click', () => {\n\t\t\tapp.showModalWindow({\n\t\t\t\turl: 'index.php?parent=Settings&module=' + app.getModuleName() + '&view=DashboardType',\n\t\t\t\tsendByAjaxCb: () => {\n\t\t\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\t\t\tthisInstance.getModuleLayoutEditor('Home').done((data) => {\n\t\t\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t},\n\tregisterSelectDashboard() {\n\t\tconst thisInstance = this;\n\t\t$('.selectDashboard li').on('click', (e) => {\n\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\tthisInstance.getModuleLayoutEditor($('#selectedModuleName').val(), $(e.currentTarget).data('id')).done((data) => {\n\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t});\n\t\t});\n\t},\n\tregisterDashboardAction() {\n\t\tconst thisInstance = this;\n\t\t$('.editDashboard').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\te.stopPropagation();\n\t\t\tapp.showModalWindow({\n\t\t\t\turl: 'index.php?parent=Settings&module=' + app.getModuleName() + '&view=DashboardType&dashboardId=' + currentTarget.closest('li').data('id'),\n\t\t\t\tsendByAjaxCb: () => {\n\t\t\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\t\t\tthisInstance.getModuleLayoutEditor('Home', currentTarget.closest('li').data('id')).done((data) => {\n\t\t\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t\t$('.deleteDashboard').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\te.stopPropagation();\n\t\t\tAppConnector.request({\n\t\t\t\tparent: 'Settings',\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'Dashboard',\n\t\t\t\tmode: 'delete',\n\t\t\t\tdashboardId: currentTarget.closest('li').data('id')\n\t\t\t}).done(() => {\n\t\t\t\tlet contentsDiv = $('.contentsDiv');\n\t\t\t\tthisInstance.getModuleLayoutEditor('Home', 1).done((data) => {\n\t\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to register click event for add custom block button\n\t */\n\tregisterAddBlockDashBoard: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tcontents.find('.addBlockDashBoard').on('click', function (e) {\n\t\t\tvar addBlockContainer = contents.find('.addBlockDashBoardModal').clone(true, true);\n\t\t\tvar inUseAuthorization = thisInstance.getAuthorization();\n\t\t\taddBlockContainer.find('select.authorized option').each(function () {\n\t\t\t\tif (jQuery.inArray(jQuery(this).val(), inUseAuthorization) != -1)\n\t\t\t\t\tjQuery(this).remove();\n\t\t\t});\n\n\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t//register all select2 Elements\n\t\t\t\tApp.Fields.Picklist.changeSelectElementView(data.find('select'));\n\t\t\t\tvar form = data.find('.addBlockDashBoardForm');\n\t\t\t\tvar block = form.find('[name=\"authorized\"]');\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\tform.on('submit', function (e) {\n\t\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\t\tvar paramsForm = form.serializeFormData();\n\t\t\t\t\t\tparamsForm['action'] = 'addBlock';\n\t\t\t\t\t\tvar paramsBlock = {\n\t\t\t\t\t\t\tauthorized: block.val(),\n\t\t\t\t\t\t\tlabel: block.find(':selected').text()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\t\t\t\tvar params = {};\n\t\t\t\t\t\t\tvar response = data.result;\n\t\t\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\t\t\tparamsBlock['id'] = response['id'];\n\t\t\t\t\t\t\t\tthisInstance.displayNewCustomBlock(paramsBlock);\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_BLOCK_ADDED');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tparams['text'] = response['message'];\n\t\t\t\t\t\t\t\tparams['type'] = 'error';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t})\n\t\t\t}\n\t\t\tapp.showModalWindow(addBlockContainer, function (data) {\n\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t}\n\t\t\t}, { 'width': '1000px' });\n\t\t});\n\t},\n\tsave: function (form, mode) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\n\t\tvar params = {};\n\t\tparams['form'] = form;\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['sourceModule'] = jQuery('#selectedModuleName').val();\n\t\tparams['action'] = 'SaveAjax';\n\t\tparams['mode'] = mode;\n\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.reject(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tdisplayNewCustomBlock: function (result) {\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tvar newBlockCloneCopy = contents.find('.newCustomBlockCopy').clone(true, true);\n\t\tnewBlockCloneCopy.data('block-id', result['id']).find('.blockLabel span').append(jQuery('<strong>' + result['label'] + '</strong>'));\n\t\tnewBlockCloneCopy.find('.addCustomField').removeClass('d-none').show();\n\t\tnewBlockCloneCopy.find('.specialWidget').data('block-id', result['id']);\n\t\tcontents.find('#moduleBlocks').append(newBlockCloneCopy.removeClass('newCustomBlockCopy d-none').addClass('editFieldsTable block_' + result['id']).data('code', result['authorized']));\n\t},\n\t/*\n\t * Function to add clickoutside event on the element - By using outside events plugin\n\t * @params element---On which element you want to apply the click outside event\n\t * @params callbackFunction---This function will contain the actions triggered after clickoutside event\n\t */\n\taddClickOutSideEvent: function (element, callbackFunction) {\n\t\telement.one('clickoutside', callbackFunction);\n\t},\n\tregisterAddCustomFieldEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tcontents.find('.addCustomField').on('click', function (e) {\n\t\t\tvar continer = jQuery(e.currentTarget).closest('.editFieldsTable');\n\t\t\tvar blockId = continer.data('block-id');\n\t\t\tvar addFieldContainer = contents.find('.createFieldModal').clone(true, true);\n\t\t\tvar allFieldsInBlock = thisInstance.getAllFieldsInBlock(continer);\n\t\t\tvar selectWidgets = addFieldContainer.find('select.widgets');\n\t\t\tselectWidgets.find('option').each(function () {\n\t\t\t\tif (jQuery.inArray(jQuery(this).val(), allFieldsInBlock) != -1) {\n\t\t\t\t\tjQuery(this).remove();\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar name = selectWidgets.find(':first-child').data('name');\n\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterUsers) != -1) {\n\t\t\t\taddFieldContainer.find('.widgetFilter').removeClass('d-none').find('select').removeAttr('disabled').show();\n\t\t\t\tvar restrictFilter = thisInstance.restrictFilter[name];\n\t\t\t\tif (restrictFilter) {\n\t\t\t\t\tfor (var i in restrictFilter) {\n\t\t\t\t\t\taddFieldContainer.find('.widgetFilter select option[value=\"' + restrictFilter[i] + '\"]').remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterDate) != -1) {\n\t\t\t\taddFieldContainer.find('.widgetFilterDate').removeClass('d-none').find('select').removeAttr('disabled').show();\n\t\t\t}\n\n\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t//register all select2 Elements\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(data.find('select'));\n\t\t\t\tdata.find('select.widgets').on('change', function () {\n\t\t\t\t\tdata.find('.widgetFilter').remove();\n\t\t\t\t\tdata.find('.widgetFilterDate').remove();\n\t\t\t\t\tvar elementsToFilter = contents.find('.createFieldModal .widgetFilter').clone(true, true);\n\t\t\t\t\tvar elementsToFilterDate = contents.find('.createFieldModal .widgetFilterDate').clone(true, true);\n\n\t\t\t\t\tdata.find('.modal-body').append(elementsToFilter);\n\t\t\t\t\tdata.find('.modal-body').append(elementsToFilterDate);\n\t\t\t\t\tvar name = jQuery(this).find(':selected').data('name');\n\t\t\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterUsers) != -1) {\n\t\t\t\t\t\telementsToFilter.removeClass('d-none').find('select').prop('disabled', false);\n\t\t\t\t\t\tvar restrictFilter = thisInstance.restrictFilter[name];\n\t\t\t\t\t\tif (restrictFilter) {\n\t\t\t\t\t\t\tfor (var i in restrictFilter) {\n\t\t\t\t\t\t\t\taddFieldContainer.find('.widgetFilter select option[value=\"' + restrictFilter[i] + '\"]').remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(elementsToFilter.find('select'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\telementsToFilter.addClass('d-none').find('select').prop('disabled', true);\n\t\t\t\t\t}\n\t\t\t\t\tif (jQuery.inArray(name, thisInstance.widgetWithFilterDate) != -1) {\n\t\t\t\t\t\telementsToFilterDate.removeClass('d-none').find('select').prop('disabled', false);\n\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(elementsToFilterDate.find('select'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\telementsToFilterDate.addClass('d-none').find('select').prop('disabled', true);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvar form = data.find('.createCustomFieldForm');\n\t\t\t\tform.attr('id', 'createFieldForm');\n\t\t\t\tvar widgets = form.find('[name=\"widgets\"]');\n\t\t\t\tform.validationEngine($.extend(true, {\n\t\t\t\t\tonValidationComplete: function (form, valid) {\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tif (widgets.val()) {\n\t\t\t\t\t\t\t\tlet saveButton = form.find(':submit'),\n\t\t\t\t\t\t\t\t\tfield = form.find('[name=\"widgets\"]');\n\t\t\t\t\t\t\t\tsaveButton.attr('disabled', 'disabled');\n\n\t\t\t\t\t\t\t\tlet paramsForm = form.serializeFormData();\n\t\t\t\t\t\t\t\tparamsForm['action'] = 'addWidget';\n\t\t\t\t\t\t\t\tparamsForm['blockid'] = blockId;\n\t\t\t\t\t\t\t\tparamsForm['linkid'] = field.val();\n\t\t\t\t\t\t\t\tparamsForm['label'] = field.find(':selected').text();\n\t\t\t\t\t\t\t\tparamsForm['name'] = field.find(':selected').data('name');\n\t\t\t\t\t\t\t\tparamsForm['height'] = form.find('[name=\"height\"]').val();\n\t\t\t\t\t\t\t\tparamsForm['width'] = form.find('[name=\"width\"]').val();\n\t\t\t\t\t\t\t\tif (form.find('[name=\"isdefault\"]').prop(\"checked\"))\n\t\t\t\t\t\t\t\t\tparamsForm['isdefault'] = 1;\n\t\t\t\t\t\t\t\tif (form.find('[name=\"cache\"]').prop(\"checked\"))\n\t\t\t\t\t\t\t\t\tparamsForm['cache'] = 1;\n\t\t\t\t\t\t\t\tif (paramsForm['default_owner'] && typeof paramsForm['owners_all'] === \"undefined\") {\n\t\t\t\t\t\t\t\t\tform.find('select[name=\"owners_all\"]')\n\t\t\t\t\t\t\t\t\t\t.prev('div')\n\t\t\t\t\t\t\t\t\t\t.validationEngine('showPrompt', app.vtranslate('JS_FIELD_EMPTY'), 'error', 'bottomLeft', true);\n\t\t\t\t\t\t\t\t\tsaveButton.removeAttr('disabled');\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\t\t\t\t\t\tlet result = data['result'],\n\t\t\t\t\t\t\t\t\t\tparams = {};\n\t\t\t\t\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t\tparamsForm['id'] = result['id']\n\t\t\t\t\t\t\t\t\t\tparamsForm['status'] = result['status']\n\t\t\t\t\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\t\t\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tlet message = data['error']['message'],\n\t\t\t\t\t\t\t\t\t\t\terrorField;\n\t\t\t\t\t\t\t\t\t\tif (data['error']['code'] != 513) {\n\t\t\t\t\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldName\"]');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldLabel\"]');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\terrorField.validationEngine('showPrompt', message, 'error', 'topLeft', true);\n\t\t\t\t\t\t\t\t\t\tsaveButton.removeAttr('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidgets.prev('div').validationEngine('showPrompt', app.vtranslate('JS_FIELD_EMPTY'), 'error', 'topLeft', true);\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//To prevent form submit\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, app.validationEngineOptions));\n\t\t\t};\n\t\t\tapp.showModalWindow(addFieldContainer, function (data) {\n\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t}\n\t\t\t}, { 'width': '1000px' });\n\t\t});\n\t},\n\t/**\n\t * Function to add new custom field ui to the list\n\t */\n\tshowCustomField: function (result) {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tvar relatedBlock = contents.find('.block_' + result['blockid']);\n\t\tvar fieldCopy = contents.find('.newCustomFieldCopy').clone(true, true);\n\t\tvar fieldContainer = fieldCopy.find('.js-custom-field');\n\t\tfieldContainer.addClass('opacity editFieldsWidget').attr('data-field-id', result['id']).attr('data-block-id', result['blockid']).attr('data-linkid', result['linkid']);\n\t\tfieldContainer.find('.deleteCustomField, .saveFieldDetails').attr('data-field-id', result['id']);\n\t\tif (result['title']) {\n\t\t\tfieldContainer.find('.fieldLabel').html(result['title']);\n\t\t} else {\n\t\t\tfieldContainer.find('.fieldLabel').html(result['label']);\n\t\t}\n\t\tif (!result['status'])\n\t\t\tfieldContainer.find('input[name=\"limit\"]').closest('div.limit').remove();\n\t\tif (typeof result['default_owner'] !== \"undefined\")\n\t\t\tfieldContainer.find('.widgetFilterAll').removeClass('d-none').show();\n\n\t\tvar block = relatedBlock.find('.blockFieldsList');\n\t\tvar sortable1 = block.find('ul[name=sortable1]');\n\t\tvar length1 = sortable1.children().length;\n\t\tvar sortable2 = block.find('ul[name=sortable2]');\n\t\tvar length2 = sortable2.children().length;\n\n\t\t// Deciding where to add the new field\n\t\tif (length1 > length2) {\n\t\t\tsortable2.append(fieldCopy.removeClass('d-none newCustomFieldCopy'));\n\t\t} else {\n\t\t\tsortable1.append(fieldCopy.removeClass('d-none newCustomFieldCopy'));\n\t\t}\n\t\tvar form = fieldCopy.find('form.fieldDetailsForm');\n\t\tthisInstance.setFieldDetails(result, form);\n\t},\n\t/**\n\t * Function to set the field info for edit field actions\n\t */\n\tsetFieldDetails: function (result, form) {\n\t\tform.find('.modal-header').html($('<h5 class=\"modal-title\">' + result['label'] + '</h5><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'));\n\t\tif (result['isdefault']) {\n\t\t\tform.find('[name=\"isdefault\"]').filter(':checkbox').attr('checked', true);\n\t\t}\n\t\tif (result['cache']) {\n\t\t\tform.find('[name=\"cache\"]').filter(':checkbox').attr('checked', true);\n\t\t}\n\t\tif (result['width']) {\n\t\t\tform.find('select[name=\"width\"]').find('option').removeAttr('selected');\n\t\t\tform.find('select[name=\"width\"]').find('option[value=\"' + result['width'] + '\"]').attr('selected', 'selected');\n\t\t}\n\t\tif (result['height']) {\n\t\t\tform.find('select[name=\"height\"]').find('option').removeAttr('selected');\n\t\t\tform.find('select[name=\"height\"]').find('option[value=\"' + result['height'] + '\"]').attr('selected', 'selected');\n\t\t}\n\t\tif (result['default_owner']) {\n\t\t\tform.find('select[name=\"default_owner\"]').find('option').removeAttr('selected');\n\t\t\tform.find('select[name=\"default_owner\"]').find('option[value=\"' + result['default_owner'] + '\"]').attr('selected', 'selected');\n\t\t}\n\t\tif (result['owners_all']) {\n\t\t\tform.find('select[name=\"owners_all\"]').find('option').removeAttr('selected');\n\t\t\tvar selectedvalue = result['owners_all'];\n\t\t\tif (typeof (selectedvalue) != 'string') {\n\t\t\t\tfor (var i = 0; i < selectedvalue.length; i++) {\n\t\t\t\t\tvar encodedSelectedValue = selectedvalue[i].replace(/\"/g, '\\\\\"');\n\t\t\t\t\tform.find('select[name=\"owners_all\"]').find('option[value=\"' + encodedSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tform.find('select[name=\"owners_all\"]').find('option[value=\"' + selectedvalue + '\"]').attr('selected', 'selected');\n\t\t\t}\n\t\t}\n\t},\n\tregisterEditFieldDetailsClick: function (contents = null) {\n\t\tconst thisInstance = this;\n\t\tif (!contents) {\n\t\t\tcontents = jQuery('#layoutDashBoards');\n\t\t}\n\t\tcontents.find('.editFieldDetails').on('click', function (e) {\n\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\tconst fieldRow = currentTarget.closest('div.editFieldsWidget');\n\t\t\tfieldRow.removeClass('opacity');\n\t\t\tconst basicDropDown = fieldRow.find('.basicFieldOperations');\n\t\t\tconst dropDownContainer = currentTarget.closest('.btn-group');\n\t\t\tdropDownContainer.find('.dropdown-menu').remove();\n\t\t\tconst dropDown = basicDropDown.clone().removeClass('basicFieldOperations d-none').addClass('dropdown-menu p-0');\n\t\t\tdropDownContainer.append(dropDown);\n\t\t\tconst dropDownMenu = dropDownContainer.find('.dropdown-menu');\n\t\t\tdropDownContainer.dropdown('dispose').dropdown('toggle');\n\t\t\tdropDownMenu.find('form').validationEngine($.extend(true, {\n\t\t\t\tbinded: false,\n\t\t\t\tonValidationComplete: function (form, valid) {\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tif (form === undefined) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet paramsForm = form.serializeFormData();\n\t\t\t\t\t\tif (form.find('[name=\"isdefault\"]').prop(\"checked\"))\n\t\t\t\t\t\t\tparamsForm['isdefault'] = 1;\n\t\t\t\t\t\tif (form.find('[name=\"cache\"]').prop(\"checked\"))\n\t\t\t\t\t\t\tparamsForm['cache'] = 1;\n\t\t\t\t\t\tlet id = form.find('.saveFieldDetails').data('field-id');\n\t\t\t\t\t\tparamsForm['action'] = 'saveDetails';\n\t\t\t\t\t\tparamsForm['id'] = id;\n\t\t\t\t\t\tif (typeof paramsForm['customMultiFilter'] !== \"undefined\" && !$.isArray(paramsForm['customMultiFilter'])) {\n\t\t\t\t\t\t\tparamsForm['customMultiFilter'] = [paramsForm['customMultiFilter']];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (paramsForm['default_owner'] && typeof paramsForm['owners_all'] === \"undefined\") {\n\t\t\t\t\t\t\tlet params = {};\n\t\t\t\t\t\t\tparams['type'] = 'error';\n\t\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_FILTERS_AVAILABLE') + ': ' + app.vtranslate('JS_FIELD_EMPTY');\n\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisInstance.save(paramsForm, 'save');\n\t\t\t\t\t\tthisInstance.registerSaveFieldDetailsEvent(form);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, app.getvalidationEngineOptions(true)));\n\t\t\tlet selectElements = basicDropDown.find('select[name=\"owners_all\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"owners_all\"]'));\n\t\t\t}\n\t\t\tselectElements = basicDropDown.find('select[name=\"default_date\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"default_date\"]'));\n\t\t\t}\n\t\t\tselectElements = basicDropDown.find('select[name=\"customMultiFilter\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"customMultiFilter\"]'));\n\t\t\t}\n\t\t\tselectElements = basicDropDown.find('select[name=\"defaultFilter\"]');\n\t\t\tif (selectElements.length > 0) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(dropDownMenu.find('select[name=\"defaultFilter\"]'));\n\t\t\t}\n\t\t\tthisInstance.avoidDropDownClick(dropDownContainer);\n\t\t\tdropDownMenu.on('change', ':checkbox', function (e) {\n\t\t\t\tlet currentTarget = jQuery(e.currentTarget);\n\t\t\t\tif (currentTarget.attr('readonly') === 'readonly') {\n\t\t\t\t\tlet status = jQuery(e.currentTarget).is(':checked');\n\t\t\t\t\tif (!status) {\n\t\t\t\t\t\t$(e.currentTarget).attr('checked', 'checked')\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(e.currentTarget).removeAttr('checked');\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst callbackFunction = function () {\n\t\t\t\tfieldRow.addClass('opacity');\n\t\t\t\tdropDown.remove();\n\t\t\t};\n\t\t\tthisInstance.addClickOutSideEvent(dropDown, callbackFunction);\n\t\t\t$('.cancel,.close').on('click', callbackFunction);\n\t\t});\n\t},\n\t/**\n\t * Function to register the click event for save button after edit field details\n\t */\n\tregisterSaveFieldDetailsEvent: function (form) {\n\t\tlet submitButtton = form.find('.saveFieldDetails'),\n\t\t\tfieldRow = submitButtton.closest('.editFieldsWidget'),\n\t\t\tdropDownMenu = form.closest('.dropdown-menu');\n\t\t//close the drop down\n\t\tsubmitButtton.closest('.btn-group').removeClass('open');\n\t\t//adding class opacity to fieldRow - to give opacity to the actions of the fields\n\t\tfieldRow.addClass('opacity');\n\t\tform.find('select').each(function () {\n\t\t\tlet selectedValue = $(this).val(),\n\t\t\t\tencodedSelectedValue;\n\t\t\t$(this).find('option').removeAttr('selected');\n\t\t\tif (typeof ($(this).attr('multiple')) === \"undefined\") {\n\t\t\t\tencodedSelectedValue = selectedValue.replace(/\"/g, '\\\\\"');\n\t\t\t\t$(this).find('[value=\"' + encodedSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t} else {\n\t\t\t\tfor (let i = 0; i < selectedValue.length; i++) {\n\t\t\t\t\tencodedSelectedValue = selectedValue[i].replace(/\"/g, '\\\\\"');\n\t\t\t\t\t$(this).find('[value=\"' + encodedSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tform.closest('.editFieldsWidget').find('.basicFieldOperations').html(form);\n\t\tdropDownMenu.remove();\n\t},\n\t/**\n\t * Function to register click event for drop-downs in fields list\n\t */\n\tavoidDropDownClick: function (dropDownContainer) {\n\t\tdropDownContainer.find('.dropdown-menu').on('click', function (e) {\n\t\t\te.stopPropagation();\n\t\t});\n\t},\n\tregisterSpecialWidget: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('#layoutDashBoards');\n\t\tcontainer.find('.addNotebook').on('click', function (e) {\n\t\t\tthisInstance.addNoteBookWidget(this, jQuery(this).data('url'));\n\t\t});\n\t\tcontainer.find('.addMiniList').on('click', function (e) {\n\t\t\tthisInstance.addMiniListWidget(this, jQuery(this).data('url'));\n\t\t});\n\t\tcontainer.find('.addChartFilter').on('click', function (e) {\n\t\t\tthisInstance.addChartFilterWidget(this, jQuery(this).data('url'));\n\t\t});\n\t\tcontainer.find('.addRss').on('click', function (e) {\n\t\t\tthisInstance.addRssWidget($(e.currentTarget), jQuery(this).data('url'));\n\t\t});\n\t},\n\taddRssWidget: function (element, url) {\n\t\tvar thisInstance = this;\n\t\tvar objectToShowModal = {\n\t\t\turl: 'index.php?module=' + app.getModuleName() + '&parent=' + app.getParentModuleName() + '&view=AddRss',\n\t\t\tcb: function (container) {\n\t\t\t\tcontainer.find('.removeChannel').on('click', function (e) {\n\t\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\t\tvar row = currentTarget.closest('.form-group');\n\t\t\t\t\trow.remove();\n\t\t\t\t});\n\t\t\t\tcontainer.find('.addChannel').on('click', function (e) {\n\t\t\t\t\tvar newRow = container.find('.newChannel').clone();\n\t\t\t\t\tvar formContainer = container.find('.formContainer');\n\t\t\t\t\tformContainer.append(newRow);\n\t\t\t\t\tnewRow.removeClass('d-none');\n\t\t\t\t\tnewRow.removeClass('newChannel');\n\t\t\t\t\tnewRow.find('input').removeAttr('disabled');\n\t\t\t\t\tnewRow.find('.removeChannel').on('click', function (e) {\n\t\t\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\t\t\tvar row = currentTarget.closest('.form-group');\n\t\t\t\t\t\trow.remove();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tcontainer.find('[name=\"blockid\"]').val(element.data('blockId'));\n\t\t\t\tcontainer.find('[name=\"linkid\"]').val(element.data('linkid'));\n\t\t\t\tvar form = container.find('form');\n\t\t\t\tvar submit = form.find('[type=\"submit\"]');\n\t\t\t\tsubmit.on('click', function (e) {\n\t\t\t\t\tvar channels = [];\n\t\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\t\tform.find('.channelRss:not(:disabled)').each(function () {\n\t\t\t\t\t\t\tchannels.push(jQuery(this).val());\n\t\t\t\t\t\t})\n\t\t\t\t\t\tvar paramsForm = form.serializeFormData();\n\t\t\t\t\t\tparamsForm.data = JSON.stringify({ channels: channels });\n\t\t\t\t\t\tthisInstance.save(paramsForm, 'save').done(\n\t\t\t\t\t\t\tfunction (data) {\n\t\t\t\t\t\t\t\tparamsForm.label = paramsForm.title;\n\t\t\t\t\t\t\t\tthisInstance.saveAfterInfo(data, paramsForm)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t})\n\t\t\t},\n\t\t};\n\t\tapp.showModalWindow(objectToShowModal);\n\t},\n\tsaveAfterInfo: function (data, paramsForm) {\n\t\tvar thisInstance = this;\n\t\tvar result = data['result'];\n\t\tvar params = {};\n\t\tif (data['success']) {\n\t\t\tapp.hideModalWindow();\n\t\t\tparamsForm['id'] = result['id'];\n\t\t\tparamsForm['status'] = result['status'];\n\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t}\n\t},\n\taddChartFilterWidget: function (element) {\n\t\tvar thisInstance = this;\n\t\telement = jQuery(element);\n\t\tapp.showModalWindow(null, \"index.php?module=Home&view=ChartFilter&step=step1\", function (wizardContainer) {\n\t\t\tvar form = jQuery('form', wizardContainer);\n\t\t\tvar chartType = jQuery('select[name=\"chartType\"]', wizardContainer);\n\t\t\tvar moduleNameSelectDOM = jQuery('select[name=\"module\"]', wizardContainer);\n\t\t\tvar moduleNameSelect2 = App.Fields.Picklist.showSelect2ElementView(moduleNameSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_SELECT_MODULE')\n\t\t\t});\n\t\t\tvar step1 = jQuery('.step1', wizardContainer);\n\t\t\tvar step2 = jQuery('.step2', wizardContainer);\n\t\t\tvar step3 = jQuery('.step3', wizardContainer);\n\t\t\tvar footer = jQuery('.modal-footer', wizardContainer);\n\t\t\tstep2.remove();\n\t\t\tstep3.remove();\n\t\t\tfooter.hide();\n\t\t\tchartType.on('change', function (e) {\n\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\tvar value = currentTarget.val();\n\t\t\t\tif (value == 'Barchat' || value == 'Horizontal') {\n\t\t\t\t\tform.find('.isColorContainer').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tform.find('.isColorContainer').addClass('d-none');\n\t\t\t\t}\n\t\t\t\tif (wizardContainer.find('#widgetStep').val() == 4) {\n\t\t\t\t\twizardContainer.find('.step3 .groupField').trigger('change');\n\t\t\t\t}\n\t\t\t});\n\t\t\tmoduleNameSelect2.on('change', function () {\n\t\t\t\tif (!moduleNameSelect2.val())\n\t\t\t\t\treturn;\n\t\t\t\tfooter.hide();\n\t\t\t\twizardContainer.find('.step2').remove();\n\t\t\t\twizardContainer.find('.step3').remove();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\tview: 'ChartFilter',\n\t\t\t\t\tstep: 'step2',\n\t\t\t\t\tchartType: chartType.val(),\n\t\t\t\t\tselectedModule: moduleNameSelect2.val()\n\t\t\t\t}).done(function (step2Response) {\n\t\t\t\t\tstep1.after(step2Response);\n\t\t\t\t\twizardContainer.find('#widgetStep').val(2);\n\t\t\t\t\tconst step2 = wizardContainer.find('.step2');\n\t\t\t\t\tfooter.hide();\n\t\t\t\t\tconst filtersIdElement = step2.find('.filtersId');\n\t\t\t\t\tconst valueTypeElement = step2.find('.valueType');\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(filtersIdElement);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(valueTypeElement);\n\t\t\t\t\tstep2.find('.filtersId, .valueType').on('change', function () {\n\t\t\t\t\t\twizardContainer.find('.step3').remove();\n\t\t\t\t\t\twizardContainer.find('.step4').remove();\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\t\t\tview: 'ChartFilter',\n\t\t\t\t\t\t\tstep: 'step3',\n\t\t\t\t\t\t\tselectedModule: moduleNameSelect2.val(),\n\t\t\t\t\t\t\tchartType: chartType.val(),\n\t\t\t\t\t\t\tfiltersId: filtersIdElement.val(),\n\t\t\t\t\t\t\tvalueType: valueTypeElement.val(),\n\t\t\t\t\t\t}).done(function (step3Response) {\n\t\t\t\t\t\t\tstep2.last().after(step3Response);\n\t\t\t\t\t\t\twizardContainer.find('#widgetStep').val(3);\n\t\t\t\t\t\t\tvar step3 = wizardContainer.find('.step3');\n\t\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(step3.find('select'));\n\t\t\t\t\t\t\tfooter.hide();\n\t\t\t\t\t\t\tstep3.find('.groupField').on('change', function () {\n\t\t\t\t\t\t\t\twizardContainer.find('.step4').remove();\n\t\t\t\t\t\t\t\tvar groupField = $(this);\n\t\t\t\t\t\t\t\tif (!groupField.val())\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tfooter.show();\n\t\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\t\t\t\t\tview: 'ChartFilter',\n\t\t\t\t\t\t\t\t\tstep: 'step4',\n\t\t\t\t\t\t\t\t\tselectedModule: moduleNameSelect2.val(),\n\t\t\t\t\t\t\t\t\tfiltersId: filtersIdElement.val(),\n\t\t\t\t\t\t\t\t\tgroupField: groupField.val(),\n\t\t\t\t\t\t\t\t\tchartType: chartType.val()\n\t\t\t\t\t\t\t\t}).done(function (step4Response) {\n\t\t\t\t\t\t\t\t\tstep3.last().after(step4Response);\n\t\t\t\t\t\t\t\t\twizardContainer.find('#widgetStep').val(4);\n\t\t\t\t\t\t\t\t\tvar step4 = wizardContainer.find('.step4');\n\t\t\t\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(step4.find('select'));\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst selectedModule = moduleNameSelect2.val();\n\t\t\t\tconst selectedModuleLabel = moduleNameSelect2.find(':selected').text();\n\t\t\t\tconst selectedFilterId = form.find('.filtersId').val();\n\t\t\t\tconst selectedFieldLabel = form.find('.groupField').find(':selected').text();\n\t\t\t\tconst data = {\n\t\t\t\t\tmodule: selectedModule,\n\t\t\t\t\tgroupField: form.find('.groupField').val(),\n\t\t\t\t\tchartType: chartType.val(),\n\t\t\t\t};\n\t\t\t\tform.find('.saveParam').each(function (index, element) {\n\t\t\t\t\telement = $(element);\n\t\t\t\t\tif (!(element.is('input') && element.prop('type') === 'checkbox' && !element.prop('checked'))) {\n\t\t\t\t\t\tdata[element.attr('name')] = element.val();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfinializeAddChart(selectedModuleLabel, selectedFilterId, null, selectedFieldLabel, data, form);\n\t\t\t});\n\t\t});\n\n\t\tfunction finializeAddChart(moduleNameLabel, filterid, filterLabel, fieldLabel, data, form) {\n\t\t\tlet paramsForm = {};\n\t\t\tparamsForm['data'] = JSON.stringify(data);\n\t\t\tparamsForm['action'] = 'addWidget';\n\t\t\tparamsForm['blockid'] = element.data('block-id');\n\t\t\tparamsForm['linkid'] = element.data('linkid');\n\t\t\tparamsForm['label'] = moduleNameLabel;\n\t\t\tif (typeof filterLabel !== 'undefined' && filterLabel !== null && filterLabel !== '') {\n\t\t\t\tparamsForm['label'] += ' - ' + filterLabel;\n\t\t\t}\n\t\t\tif (typeof fieldLabel !== 'undefined' && fieldLabel !== null && fieldLabel !== '') {\n\t\t\t\tparamsForm['label'] += ' - ' + fieldLabel;\n\t\t\t}\n\t\t\tparamsForm['name'] = 'ChartFilter';\n\t\t\tif (Array.isArray(filterid)) {\n\t\t\t\tfilterid = filterid.join(',');\n\t\t\t}\n\t\t\tparamsForm['filterid'] = filterid;\n\t\t\tparamsForm['title'] = form.find('[name=\"widgetTitle\"]').val();\n\t\t\tparamsForm['isdefault'] = 0;\n\t\t\tparamsForm['cache'] = 0;\n\t\t\tparamsForm['height'] = 4;\n\t\t\tparamsForm['width'] = 4;\n\t\t\tparamsForm['owners_all'] = [\"mine\", \"all\", \"users\", \"groups\"];\n\t\t\tparamsForm['default_owner'] = 'mine';\n\n\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\tlet result = data['result'],\n\t\t\t\t\tparams = {};\n\t\t\t\tif (data['success']) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tparamsForm['id'] = result['id'];\n\t\t\t\t\tparamsForm['status'] = result['status'];\n\t\t\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t\t\t} else {\n\t\t\t\t\tlet message = data['error']['message'],\n\t\t\t\t\t\terrorField;\n\t\t\t\t\tif (data['error']['code'] != 513) {\n\t\t\t\t\t\terrorField = form.find('[name=\"fieldName\"]');\n\t\t\t\t\t} else {\n\t\t\t\t\t\terrorField = form.find('[name=\"fieldLabel\"]');\n\t\t\t\t\t}\n\t\t\t\t\terrorField.validationEngine('showPrompt', message, 'error', 'topLeft', true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\taddNoteBookWidget: function (element, url) {\n\t\tvar thisInstance = this;\n\t\telement = jQuery(element);\n\t\tapp.showModalWindow(null, \"index.php?module=Home&view=AddNotePad\", function (wizardContainer) {\n\t\t\tvar form = jQuery('form', wizardContainer);\n\t\t\tform.validationEngine($.extend(true, {\n\t\t\t\tonValidationComplete: function (form, valid) {\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t//To prevent multiple click on save\n\t\t\t\t\t\tjQuery(\"[name='saveButton']\", wizardContainer).attr('disabled', 'disabled');\n\t\t\t\t\t\tvar notePadName = form.find('[name=\"notePadName\"]').val();\n\t\t\t\t\t\tvar notePadContent = form.find('[name=\"notePadContent\"]').val();\n\t\t\t\t\t\tvar isDefault = 0;\n\t\t\t\t\t\tvar linkId = element.data('linkid');\n\t\t\t\t\t\tvar blockId = element.data('block-id');\n\t\t\t\t\t\tvar noteBookParams = {\n\t\t\t\t\t\t\t'module': jQuery('#selectedModuleName').val(),\n\t\t\t\t\t\t\t'action': 'NoteBook',\n\t\t\t\t\t\t\t'mode': 'noteBookCreate',\n\t\t\t\t\t\t\t'notePadName': notePadName,\n\t\t\t\t\t\t\t'notePadContent': notePadContent,\n\t\t\t\t\t\t\t'blockid': blockId,\n\t\t\t\t\t\t\t'linkId': linkId,\n\t\t\t\t\t\t\t'isdefault': isDefault,\n\t\t\t\t\t\t\t'width': 4,\n\t\t\t\t\t\t\t'height': 3\n\t\t\t\t\t\t}\n\t\t\t\t\t\tAppConnector.request(noteBookParams).done(function (data) {\n\t\t\t\t\t\t\tif (data.result.success) {\n\t\t\t\t\t\t\t\tvar widgetId = data.result.widgetId;\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\tnoteBookParams['id'] = widgetId;\n\t\t\t\t\t\t\t\tnoteBookParams['label'] = notePadName;\n\t\t\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage({ text: app.vtranslate('JS_WIDGET_ADDED') });\n\t\t\t\t\t\t\t\tthisInstance.showCustomField(noteBookParams);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, app.validationEngineOptions));\n\t\t});\n\t},\n\taddMiniListWidget: function (element, url) {\n\t\t// 1. Show popup window for selection (module, filter, fields)\n\t\t// 2. Compute the dynamic mini-list widget url\n\t\t// 3. Add widget with URL to the page.\n\t\tvar thisInstance = this;\n\t\telement = jQuery(element);\n\n\t\tapp.showModalWindow(null, \"index.php?module=Home&view=MiniListWizard&step=step1\", function (wizardContainer) {\n\t\t\tvar form = jQuery('form', wizardContainer);\n\n\t\t\tvar moduleNameSelectDOM = jQuery('select[name=\"module\"]', wizardContainer);\n\t\t\tvar filteridSelectDOM = jQuery('select[name=\"filterid\"]', wizardContainer);\n\t\t\tvar fieldsSelectDOM = jQuery('select[name=\"fields\"]', wizardContainer);\n\t\t\tvar filterFieldsSelectDOM = jQuery('select[name=\"filter_fields\"]', wizardContainer);\n\n\t\t\tvar moduleNameSelect2 = App.Fields.Picklist.showSelect2ElementView(moduleNameSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_SELECT_MODULE')\n\t\t\t});\n\t\t\tvar filteridSelect2 = App.Fields.Picklist.showSelect2ElementView(filteridSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION')\n\t\t\t});\n\t\t\tvar fieldsSelect2 = App.Fields.Picklist.showSelect2ElementView(fieldsSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION'),\n\t\t\t\tcloseOnSelect: true,\n\t\t\t\tmaximumSelectionLength: 6\n\t\t\t});\n\t\t\tvar filterFieldsSelect2 = App.Fields.Picklist.showSelect2ElementView(filterFieldsSelectDOM, {\n\t\t\t\tplaceholder: app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION')\n\t\t\t});\n\t\t\tvar footer = jQuery('.modal-footer', wizardContainer);\n\n\t\t\tfilteridSelectDOM.closest('tr').hide();\n\t\t\tfieldsSelectDOM.closest('tr').hide();\n\t\t\tfilterFieldsSelectDOM.closest('tr').hide();\n\t\t\tfooter.hide();\n\n\t\t\tmoduleNameSelect2.on('change', function () {\n\t\t\t\tif (!moduleNameSelect2.val())\n\t\t\t\t\treturn;\n\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\tview: 'MiniListWizard',\n\t\t\t\t\tstep: 'step2',\n\t\t\t\t\tselectedModule: moduleNameSelect2.val()\n\t\t\t\t}).done(function (res) {\n\t\t\t\t\tfilteridSelectDOM.empty().html(res).trigger('change');\n\t\t\t\t\tfilteridSelect2.closest('tr').show();\n\t\t\t\t\tfieldsSelectDOM.closest('tr').hide();\n\t\t\t\t\tfilterFieldsSelectDOM.closest('tr').hide();\n\t\t\t\t});\n\t\t\t});\n\t\t\tfilteridSelect2.on('change', function () {\n\t\t\t\tif (!filteridSelect2.val())\n\t\t\t\t\treturn;\n\t\t\t\tfooter.hide();\n\t\t\t\tfieldsSelectDOM.closest('tr').hide();\n\t\t\t\tfilterFieldsSelectDOM.closest('tr').hide();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'Home',\n\t\t\t\t\tview: 'MiniListWizard',\n\t\t\t\t\tstep: 'step3',\n\t\t\t\t\tselectedModule: moduleNameSelect2.val(),\n\t\t\t\t\tfilterid: filteridSelect2.val()\n\t\t\t\t}).done(function (res) {\n\t\t\t\t\tres = $(res);\n\t\t\t\t\tfieldsSelectDOM.empty().html(res.find('select[name=\"fields\"]').html()).trigger('change');\n\t\t\t\t\tfilterFieldsSelectDOM.empty().html(res.find('select[name=\"filter_fields\"]').html()).trigger('change');\n\t\t\t\t\tfieldsSelect2.closest('tr').show();\n\t\t\t\t\tfilterFieldsSelect2.closest('tr').show();\n\t\t\t\t\tfieldsSelect2.data('select2').$selection.find('.select2-search__field').parent().css('width', '100%');\n\t\t\t\t\tfilterFieldsSelect2.data('select2').$selection.find('.select2-search__field').parent().css('width', '100%');\n\t\t\t\t});\n\t\t\t});\n\t\t\tfieldsSelect2.on('change', function () {\n\t\t\t\tif (!fieldsSelect2.val()) {\n\t\t\t\t\tfooter.hide();\n\t\t\t\t} else {\n\t\t\t\t\tfooter.show();\n\t\t\t\t}\n\t\t\t});\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tlet selectedFields = [];\n\t\t\t\tfieldsSelect2.select2('data').map(function (obj) {\n\t\t\t\t\tselectedFields.push(obj.id);\n\t\t\t\t});\n\t\t\t\tlet data = {\n\t\t\t\t\tmodule: moduleNameSelect2.val()\n\t\t\t\t};\n\t\t\t\tdata['fields'] = selectedFields;\n\t\t\t\tdata['filterFields'] = filterFieldsSelect2.val();\n\t\t\t\tlet paramsForm = {\n\t\t\t\t\tdata: JSON.stringify(data),\n\t\t\t\t\taction: 'addWidget',\n\t\t\t\t\tblockid: element.data('block-id'),\n\t\t\t\t\ttitle: form.find('[name=\"widgetTitle\"]').val(),\n\t\t\t\t\tlinkid: element.data('linkid'),\n\t\t\t\t\tlabel: moduleNameSelect2.find(':selected').text() + ' - ' + filteridSelect2.find(':selected').text(),\n\t\t\t\t\tname: 'Mini List',\n\t\t\t\t\tfilterid: filteridSelect2.val(),\n\t\t\t\t\tisdefault: 0,\n\t\t\t\t\tcache: 0,\n\t\t\t\t\theight: 4,\n\t\t\t\t\twidth: 4,\n\t\t\t\t\towners_all: [\"mine\", \"all\", \"users\", \"groups\"],\n\t\t\t\t\tdefault_owner: 'mine'\n\t\t\t\t};\n\t\t\t\tthisInstance.save(paramsForm, 'save').done(function (data) {\n\t\t\t\t\tlet result = data['result'],\n\t\t\t\t\t\tparams = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tparamsForm['id'] = result['id'];\n\t\t\t\t\t\tparamsForm['status'] = result['status'];\n\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_WIDGET_ADDED');\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\tthisInstance.showCustomField(paramsForm);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet message = data['error']['message'],\n\t\t\t\t\t\t\terrorField;\n\t\t\t\t\t\tif (data['error']['code'] !== 513) {\n\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldName\"]');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\terrorField = form.find('[name=\"fieldLabel\"]');\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorField.validationEngine('showPrompt', message, 'error', 'topLeft', true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to register the click event for delete custom field\n\t */\n\tregisterDeleteCustomFieldEvent: function (contents) {\n\t\tvar thisInstance = this;\n\t\tif (typeof contents === \"undefined\") {\n\t\t\tcontents = jQuery('#layoutDashBoards');\n\t\t}\n\t\tcontents.find('a.deleteCustomField').on('click', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar fieldId = currentTarget.data('field-id');\n\t\t\tvar paramsForm = {}\n\t\t\tparamsForm['action'] = 'removeWidget';\n\t\t\tparamsForm['id'] = fieldId;\n\t\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ 'message': message }).done(function (e) {\n\t\t\t\tthisInstance.save(paramsForm, 'delete').done(function (data) {\n\t\t\t\t\tvar field = currentTarget.closest('div.editFieldsWidget');\n\t\t\t\t\tvar blockId = field.data('block-id');\n\t\t\t\t\tfield.parent().fadeOut('slow').remove();\n\t\t\t\t\tvar block = jQuery('#block_' + blockId);\n\t\t\t\t\tthisInstance.reArrangeBlockFields(block);\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tparams['text'] = app.vtranslate('JS_CUSTOM_FIELD_DELETED');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function that rearranges fields in the block when the fields are moved\n\t * @param <jQuery object> block\n\t */\n\treArrangeBlockFields: function (block) {\n\t\t// 1.get the containers, 2.compare the length, 3.if uneven then move the last element\n\t\tvar leftSideContainer = block.find('ul[name=sortable1]');\n\t\tvar rightSideContainer = block.find('ul[name=sortable2]');\n\t\tif (leftSideContainer.children().length < rightSideContainer.children().length) {\n\t\t\tvar lastElementInRightContainer = rightSideContainer.children(':last');\n\t\t\tleftSideContainer.append(lastElementInRightContainer);\n\t\t} else if (leftSideContainer.children().length > rightSideContainer.children().length + 1) {\t//greater than 1\n\t\t\tvar lastElementInLeftContainer = leftSideContainer.children(':last');\n\t\t\trightSideContainer.append(lastElementInLeftContainer);\n\t\t}\n\t},\n\t/**\n\t * Function to register the click event for delete custom block\n\t */\n\tregisterDeleteCustomBlockEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tcontents.on('click', '.js-delete-custom-block-btn', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar table = currentTarget.closest('div.editFieldsTable');\n\t\t\tvar blockId = table.data('block-id');\n\t\t\tvar paramsFrom = {};\n\t\t\tparamsFrom['blockid'] = blockId;\n\t\t\tparamsFrom['action'] = 'removeBlock';\n\t\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ 'message': message }).done(function (e) {\n\t\t\t\tthisInstance.save(paramsFrom, 'delete').done(function (data) {\n\t\t\t\t\tthisInstance.removeDeletedBlock(blockId, 'delete');\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tparams['text'] = app.vtranslate('JS_CUSTOM_BLOCK_DELETED');\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to remove the deleted custom block from the ui\n\t */\n\tremoveDeletedBlock: function (blockId) {\n\t\tvar contents = jQuery('#layoutDashBoards');\n\t\tvar deletedTable = contents.find('.block_' + blockId);\n\t\tdeletedTable.fadeOut('slow').remove();\n\t},\n\t/**\n\t * Function to register the change event for layout editor modules list\n\t */\n\tregisterModulesChangeEvent() {\n\t\tconst thisInstance = this;\n\t\tlet container = $('#widgetsManagementEditorContainer');\n\t\tlet contentsDiv = container.closest('.contentsDiv');\n\t\tApp.Fields.Picklist.changeSelectElementView(container.find('[name=\"widgetsManagementEditorModules\"]'));\n\t\tcontainer.on('change', '[name=\"widgetsManagementEditorModules\"]', (e) => {\n\t\t\tthisInstance.getModuleLayoutEditor($(e.currentTarget).val(), thisInstance.getCurrentDashboardId()).done((data) => {\n\t\t\t\tthisInstance.updateContentsDiv(contentsDiv, data);\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Update contents div and register events.\n\t * @param {jQuery} contentsDiv\n\t * @param {HTMLElement} data\n\t */\n\tupdateContentsDiv(contentsDiv, data) {\n\t\tcontentsDiv.html(data);\n\t\tApp.Fields.Picklist.showSelect2ElementView(contentsDiv.find('.select2'));\n\t\tthis.registerEvents();\n\t},\n\t/**\n\t * Function to get the respective module layout editor through pjax\n\t */\n\tgetModuleLayoutEditor: function (selectedModule, selectedDashboard) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['view'] = 'Configuration';\n\t\tparams['sourceModule'] = selectedModule;\n\t\tparams['dashboardId'] = selectedDashboard;\n\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({ 'mode': 'hide' });\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * register events for layout editor\n\t */\n\tregisterEvents: function () {\n\t\tvar thisInstance = this;\n\n\t\tthisInstance.registerAddBlockDashBoard();\n\t\tthisInstance.registerAddCustomFieldEvent();\n\t\tthisInstance.registerEditFieldDetailsClick();\n\t\tthisInstance.registerSpecialWidget();\n\t\tthisInstance.registerDeleteCustomFieldEvent();\n\t\tthisInstance.registerDeleteCustomBlockEvent();\n\t\tthisInstance.registerModulesChangeEvent();\n\t\tthisInstance.setWidgetWithFilterUsers();\n\t\tthisInstance.setRestrictFilter();\n\t\tthisInstance.setWidgetWithFilterDate();\n\t\tthisInstance.registerAddedDashboard();\n\t\tthisInstance.registerSelectDashboard();\n\t\tthisInstance.registerDashboardAction();\n\t}\n\n});\n\njQuery(document).ready(function () {\n\tvar instance = new Settings_WidgetsManagement_Js();\n\tinstance.registerEvents();\n})\n"],"names":["jQuery","Class","thisInstance","element","val","widgetWithFilterUsers","JSON","parse","widgetWithFilterDate","restrictFilter","authorization","container","find","each","push","data","toString","continer","fields","$","parent","on","showModalWindow","app","getModuleName","contentsDiv","getModuleLayoutEditor","done","updateContentsDiv","e","currentTarget","stopPropagation","closest","request","contents","addBlockContainer","clone","inUseAuthorization","getAuthorization","inArray","remove","callBackFunction","Fields","Picklist","changeSelectElementView","form","block","validationEngine","validationEngineOptions","paramsForm","serializeFormData","paramsBlock","text","save","params","response","result","displayNewCustomBlock","hideModalWindow","vtranslate","showMessage","location","reload","preventDefault","mode","aDeferred","Deferred","progressIndicatorElement","progressIndicator","getParentModuleName","resolve","fail","error","reject","promise","newBlockCloneCopy","append","removeClass","show","addClass","callbackFunction","one","blockId","addFieldContainer","allFieldsInBlock","getAllFieldsInBlock","selectWidgets","name","removeAttr","i","showSelect2ElementView","elementsToFilter","elementsToFilterDate","prop","attr","widgets","extend","valid","saveButton","field","prev","showCustomField","message","errorField","relatedBlock","fieldCopy","fieldContainer","html","sortable1","length1","children","length","sortable2","length2","setFieldDetails","filter","selectedvalue","encodedSelectedValue","replace","fieldRow","basicDropDown","dropDownContainer","dropDown","dropDownMenu","dropdown","undefined","id","isArray","registerSaveFieldDetailsEvent","getvalidationEngineOptions","selectElements","avoidDropDownClick","status","is","addClickOutSideEvent","submitButtton","selectedValue","addNoteBookWidget","addMiniListWidget","addChartFilterWidget","addRssWidget","url","objectToShowModal","row","newRow","formContainer","submit","channels","stringify","label","title","saveAfterInfo","wizardContainer","chartType","moduleNameSelectDOM","moduleNameSelect2","App","step1","step2","step3","footer","hide","value","trigger","step2Response","after","filtersIdElement","valueTypeElement","step3Response","last","groupField","step4Response","step4","selectedModule","selectedModuleLabel","selectedFilterId","selectedFieldLabel","index","finializeAddChart","moduleNameLabel","filterid","filterLabel","fieldLabel","Array","join","notePadName","notePadContent","isDefault","linkId","noteBookParams","success","widgetId","filteridSelectDOM","fieldsSelectDOM","filterFieldsSelectDOM","filteridSelect2","fieldsSelect2","filterFieldsSelect2","res","empty","$selection","css","selectedFields","select2","map","obj","fieldId","showConfirmationBox","fadeOut","reArrangeBlockFields","leftSideContainer","rightSideContainer","lastElementInRightContainer","lastElementInLeftContainer","table","paramsFrom","removeDeletedBlock","deletedTable","getCurrentDashboardId","registerEvents","selectedDashboard","requestPjax","registerAddBlockDashBoard","registerAddCustomFieldEvent","registerEditFieldDetailsClick","registerSpecialWidget","registerDeleteCustomFieldEvent","registerDeleteCustomBlockEvent","registerModulesChangeEvent","setWidgetWithFilterUsers","setRestrictFilter","setWidgetWithFilterDate","registerAddedDashboard","registerSelectDashboard","registerDashboardAction","document","ready","instance","Settings_WidgetsManagement_Js"],"mappings":"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"}