'use strict';

Settings_Vtiger_Index_Js('Settings_PBXManager_Index_Js',{},{saveAsteriskServerDetails:function saveAsteriskServerDetails(form){var thisInstance=this,data=form.serializeFormData(),progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});'undefined'===data&&(data={}),data.module=app.getModuleName(),data.parent=app.getParentModuleName(),data.action='SaveAjax',AppConnector.request(data).done(function(data){if(data.success){var OutgoingServerDetailUrl=form.data('detailUrl');thisInstance.loadContents(OutgoingServerDetailUrl).done(function(){progressIndicatorElement.progressIndicator({mode:'hide'}),thisInstance.registerDetailViewEvents();}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});}else progressIndicatorElement.progressIndicator({mode:'hide'}),jQuery('.errorMessage',form).removeClass('d-none');});},registerEditViewEvents:function registerEditViewEvents(){var thisInstance=this,form=jQuery('#MyModal'),cancelLink=jQuery('.cancelLink',form);AppConnector.request('index.php?module=PBXManager&parent=Settings&action=Gateway&mode=getSecretKey').done(function(data){jQuery('input[name=\'vtigersecretkey\']').attr('value',data.result);});var params=app.validationEngineOptions;params.onValidationComplete=function(form,valid){if(valid)return thisInstance.saveAsteriskServerDetails(form),valid},form.validationEngine(params),form.on('submit',function(e){e.preventDefault();}),cancelLink.on('click',function(){var OutgoingServerDetailUrl=form.data('detailUrl'),progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});thisInstance.loadContents(OutgoingServerDetailUrl).done(function(){progressIndicatorElement.progressIndicator({mode:'hide'}),thisInstance.registerDetailViewEvents();}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});});},registerDetailViewEvents:function registerDetailViewEvents(){var thisInstance=this,container=jQuery('#AsteriskServerDetails'),editButton=jQuery('.editButton',container);editButton.on('click',function(e){var url=jQuery(e.currentTarget).data('url'),progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});thisInstance.loadContents(url).done(function(){thisInstance.registerEditViewEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});});},loadContents:function loadContents(url){var aDeferred=jQuery.Deferred();return AppConnector.requestPjax(url).done(function(data){jQuery('.contentsDiv').html(data),aDeferred.resolve(data);}).fail(function(){aDeferred.reject();}),aDeferred.promise()},registerEvents:function registerEvents(){var thisInstance=this;thisInstance.registerDetailViewEvents();}}),jQuery(document).ready(function(){var instance=new Settings_Vtiger_Index_Js;instance.registerEvents();});
//# sourceMappingURL=Index.min.js.map
