{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nSettings_Vtiger_Index_Js(\n\t'Settings_Kanban_Index_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Register add modal\n\t\t */\n\t\tregisterAddModal() {\n\t\t\t$('.js-add-board').on('click', (e) => {\n\t\t\t\tapp.showModalWindow(\n\t\t\t\t\tnull,\n\t\t\t\t\t'index.php?module=Kanban&parent=Settings&view=AddModal&sourceModule=' + this.module,\n\t\t\t\t\t(modalContainer) => {\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', function (e) {\n\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\t\t\t\taction: 'Save',\n\t\t\t\t\t\t\t\tmode: 'add',\n\t\t\t\t\t\t\t\tfield: modalContainer.find('.js-system-fields').val()\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register delete event\n\t\t */\n\t\tregisterDeleteEvent() {\n\t\t\tthis.container.find('.js-delete').on('click', (e) => {\n\t\t\t\tlet board = $(e.currentTarget).closest('.js-board');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\taction: 'Save',\n\t\t\t\t\tmode: 'delete',\n\t\t\t\t\tboard: board.data('id')\n\t\t\t\t})\n\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register add modal\n\t\t */\n\t\tregisterFieldsEvents() {\n\t\t\tlet fields = this.container.find('.js-sortable-fields');\n\t\t\tfields.on('sortable:change', (e) => {\n\t\t\t\tthis.saveField($(e.currentTarget));\n\t\t\t});\n\t\t\tfields.on('change', (e) => {\n\t\t\t\tthis.saveField($(e.currentTarget));\n\t\t\t});\n\t\t\tlet boards = this.container.find('.js-boards');\n\t\t\tboards.sortable({\n\t\t\t\tcontainment: boards,\n\t\t\t\titems: boards.find('.js-board'),\n\t\t\t\thandle: '.js-drag',\n\t\t\t\trevert: true,\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\tcursor: 'move',\n\t\t\t\tupdate: () => {\n\t\t\t\t\tthis.saveSequence();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Save field\n\t\t */\n\t\tsaveField: function (element) {\n\t\t\tlet board = element.closest('.js-board');\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'Save',\n\t\t\t\tmode: 'update',\n\t\t\t\tboard: board.data('id'),\n\t\t\t\ttype: element.data('type'),\n\t\t\t\tvalue: element.val()\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\tapp.showNotify(data.result.message);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttitle: app.vtranslate('JS_UNEXPECTED_ERROR'),\n\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Save sequence\n\t\t */\n\t\tsaveSequence: function () {\n\t\t\tlet boards = [];\n\t\t\tthis.container.find('.js-board').each(function (index) {\n\t\t\t\tboards[index] = $(this).data('id');\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'Save',\n\t\t\t\tmode: 'sequence',\n\t\t\t\tboards: boards\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\tapp.showNotify(data.result.message);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttitle: app.vtranslate('JS_UNEXPECTED_ERROR'),\n\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register module change\n\t\t */\n\t\tregisterModuleEvents: function () {\n\t\t\t$('.js-module-list').on('change', (e) => {\n\t\t\t\twindow.location.href =\n\t\t\t\t\t'index.php?module=Kanban&parent=Settings&view=Index&sourceModule=' + $(e.currentTarget).val();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis._super();\n\t\t\tthis.module = $('#js-module-name').val();\n\t\t\tthis.container = $('.js-fields-list');\n\t\t\tthis.registerAddModal();\n\t\t\tthis.registerDeleteEvent();\n\t\t\tthis.registerFieldsEvents();\n\t\t\tthis.registerModuleEvents();\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_Index_Js","registerAddModal","$","on","app","showModalWindow","module","modalContainer","find","AppConnector","request","getModuleName","parent","getParentModuleName","action","mode","field","val","done","data","result","message","hideModalWindow","window","location","reload","fail","error","err","errorLog","registerDeleteEvent","container","e","currentTarget","closest","board","registerFieldsEvents","fields","saveField","boards","sortable","containment","items","handle","revert","tolerance","cursor","update","saveSequence","element","type","value","showNotify","title","vtranslate","text","each","index","registerModuleEvents","href","registerEvents","_super"],"mappings":"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"}