"use strict";Vtiger_AdvanceFilter_Js("HideBlocks_AdvanceFilter_Js",{},{validationSupportedFieldConditionMap:{email:["e","n"],date:["is"],datetime:["is"]},allConditionValidationNeededFieldList:["double","integer"],comparatorsWithNoValueBoxMap:["has changed","is empty","is not empty","is added"],getFieldSpecificType:function(fieldSelected){return fieldSelected.data("fieldinfo").type},getModuleName:function(){return app.getModuleName()},addNewCondition:function(conditionGroupElement){var newRowElement=jQuery(".basic",conditionGroupElement).find(".js-conditions-row").clone(!0,!0);return jQuery("select",newRowElement).addClass("select2"),jQuery(".conditionList",conditionGroupElement).append(newRowElement),App.Fields.Picklist.changeSelectElementView(newRowElement),newRowElement.find('[name="columnname"]').find("optgroup:first option:first").attr("selected","selected").trigger("change"),this},loadConditions:function(fieldSelect){var row=fieldSelect.closest("div.js-conditions-row"),conditionSelectElement=row.find('select[name="comparator"]'),conditionSelected=row.find('[name="comparatorValue"]').val(),fieldSelected=fieldSelect.find("option:selected"),match=fieldSelected.val().match(/\((\w+)\) (\w+)/),fieldSpecificType=this.getFieldSpecificType(fieldSelected),conditionList=this.getConditionListFromType(fieldSpecificType);void 0===conditionList&&((conditionList={}).none="None");var options="";for(var key in conditionList)if(conditionList.hasOwnProperty(key)){var conditionValue=conditionList[key],conditionLabel=this.getConditionLabel(conditionValue);null!=match?"has changed"!=conditionValue&&(options+='<option value="'+conditionValue+'"',conditionValue==conditionSelected&&(options+=' selected="selected" '),options+=">"+conditionLabel+"</option>"):(options+='<option value="'+conditionValue+'"',conditionValue==conditionSelected&&(options+=' selected="selected" '),options+=">"+conditionLabel+"</option>")}return conditionSelectElement.empty().html(options).trigger("change"),conditionSelectElement},getValues:function(){var thisInstance=this,filterContainer=this.getFilterContainer(),fieldList=new Array("columnname","comparator","value","valuetype","column_condition"),values={},columnIndex=0,conditionGroups=jQuery(".conditionGroup",filterContainer);return conditionGroups.each((function(index,domElement){var groupElement=jQuery(domElement),conditions=jQuery(".conditionList .js-conditions-row",groupElement);if(conditions.length<=0)return!0;var iterationValues={};conditions.each((function(i,conditionDomElement){var rowElement=jQuery(conditionDomElement),fieldSelectElement=jQuery('[name="columnname"]',rowElement),valueSelectElement=jQuery('[data-value="value"]',rowElement);if(thisInstance.isEmptyFieldSelected(fieldSelectElement))return!0;var fieldType=fieldSelectElement.find("option:selected").data("fieldinfo").type,rowValues={},key=void 0,field=void 0;if("picklist"==fieldType||"multipicklist"==fieldType)for(key in fieldList)if("value"==(field=fieldList[key])&&valueSelectElement.is("input")){var commaSeperatedValues=valueSelectElement.val(),pickListValues=valueSelectElement.data("picklistvalues"),valuesArr=commaSeperatedValues.split(","),newValuesArr=[];for(i=0;i<valuesArr.length;i++)void 0!==pickListValues[valuesArr[i]]?newValuesArr.push(pickListValues[valuesArr[i]]):newValuesArr.push(valuesArr[i]);var reconstructedCommaSeperatedValues=newValuesArr.join(",");rowValues[field]=reconstructedCommaSeperatedValues}else if("value"==field&&valueSelectElement.is("select")&&"picklist"==fieldType)rowValues[field]=valueSelectElement.val();else if("value"==field&&valueSelectElement.is("select")&&"multipicklist"==fieldType){var value=valueSelectElement.val();rowValues[field]=null==value?value:value.join(",")}else rowValues[field]=jQuery('[name="'+field+'"]',rowElement).val();else for(key in fieldList)rowValues[field=fieldList[key]]="value"==field?valueSelectElement.val():jQuery('[name="'+field+'"]',rowElement).val();"false"!=jQuery('[name="valuetype"]',rowElement).val()&&0!=jQuery('[name="valuetype"]',rowElement).length||(rowValues.valuetype="rawtext"),rowValues.groupid="0"==index?"0":"1",rowElement.is(":last-child")&&(rowValues.column_condition=""),iterationValues[columnIndex]=rowValues,columnIndex++})),jQuery.isEmptyObject(iterationValues)||(values[index+1]={},values[index+1].columns=iterationValues),groupElement.find("div.groupCondition").length>0&&!jQuery.isEmptyObject(values[index+1])&&(values[index+1].condition=conditionGroups.find('div.groupCondition [name="condition"]').val())})),values},getFieldSpecificUi:function(fieldSelectElement){var fieldInfo=fieldSelectElement.find("option:selected").data("fieldinfo");return-1!=jQuery.inArray(fieldInfo.comparatorElementVal,this.comparatorsWithNoValueBoxMap)?jQuery(""):this._super(fieldSelectElement)}}),Vtiger_Field_Js("Workflows_Field_Js",{},{getUiTypeSpecificHtml:function(){return this.getUiTypeModel().getUi()},getModuleName:function(){return app.getModuleName()},getUi:function(){var html='<input type="text" class="getPopupUi" name="'+this.getName()+'"  /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />';return(html=jQuery(html)).filter(".getPopupUi").val(app.htmlDecode(this.getValue())),this.addValidationToElement(html)}}),Vtiger_Date_Field_Js("Workflows_Date_Field_Js",{},{getDateFormat:function(){return this.get("date-format")},getUi:function(){var comparatorSelectedOptionVal=this.get("comparatorElementVal"),dateSpecificConditions=this.get("dateSpecificConditions"),html=void 0,element=void 0;if(!(comparatorSelectedOptionVal.length>0))return html='<input type="text" class="getPopupUi form-control date" name="'+this.getName()+'"  data-date-format="'+this.getDateFormat()+'"  value="'+this.getValue()+'" /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html),this.addValidationToElement(element);if("between"==comparatorSelectedOptionVal||"custom"==comparatorSelectedOptionVal)return html='<div class="date"><input class="dateRangeField form-control"data-calendar-type="range" name="'+this.getName()+'" data-date-format="'+this.getDateFormat()+'" type="text" ReadOnly="true" value="'+this.getValue()+'"></div>',element=jQuery(html),this.addValidationToElement(element);if(this._specialDateComparator(comparatorSelectedOptionVal))return html='<input name="'+this.getName()+'" class="form-control" type="text" value="'+this.getValue()+'" data-validation-engine="validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]" data-validator="[{"name":"PositiveNumber"}]"><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',jQuery(html);if(comparatorSelectedOptionVal in dateSpecificConditions){var startValue=dateSpecificConditions[comparatorSelectedOptionVal].startdate,endValue=dateSpecificConditions[comparatorSelectedOptionVal].enddate;return html='<input name="'+this.getName()+'" class="form-control" type="text" ReadOnly="true" value="'+startValue+","+endValue+'">',jQuery(html)}return"is today"!=comparatorSelectedOptionVal?this._super():void 0},_specialDateComparator:function(comp){var specialComparators=["less than days ago","more than days ago","in less than","in more than","days ago","days later"];for(var index in specialComparators)if(comp==specialComparators[index])return!0;return!1}}),Vtiger_Date_Field_Js("Workflows_Datetime_Field_Js",{},{getDateFormat:function(){return this.get("date-format")},getUi:function(){var html=void 0,element=void 0;return this._specialDateTimeComparator(this.get("comparatorElementVal"))?(html='<input name="'+this.getName()+'" type="text" value="'+this.getValue()+'" data-validator="[{name:PositiveNumber}]"><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html)):(html='<input type="text" class="getPopupUi date" name="'+this.getName()+'"  data-date-format="'+this.getDateFormat()+'"  value="'+this.getValue()+'" /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html)),element},_specialDateTimeComparator:function(comp){var specialComparators=["less than hours before","less than hours later","more than hours later","more than hours before"];for(var index in specialComparators)if(comp==specialComparators[index])return!0;return!1}}),Vtiger_Currency_Field_Js("Workflows_Currency_Field_Js",{},{getUi:function(){var html='<input type="text" class="getPopupUi marginLeftZero" name="'+this.getName()+'" value="'+this.getValue()+'"  /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html);return this.addValidationToElement(element)}}),Vtiger_Time_Field_Js("Workflows_Time_Field_Js",{},{getUi:function(){var html='<input type="text" class="getPopupUi time" name="'+this.getName()+'"  value="'+this.getValue()+'" /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html);return this.addValidationToElement(element)}}),Vtiger_Field_Js("Vtiger_Percentage_Field_Js",{},{getUi:function(){var html='<input type="text" class="getPopupUi" name="'+this.getName()+'" value="'+this.getValue()+'" /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html);return this.addValidationToElement(element)}}),Vtiger_Field_Js("Vtiger_Text_Field_Js",{},{getUi:function(){var html='<input type="text" class="getPopupUi" name="'+this.getName()+'" value="'+this.getValue()+'" /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html);return this.addValidationToElement(element)}}),Vtiger_Field_Js("Vtiger_Boolean_Field_Js",{},{getUi:function(){var html='<input type="text" class="getPopupUi boolean" name="'+this.getName()+'" value="'+this.getValue()+'" /><input type="hidden" name="valuetype" value="'+this.get("workflow_valuetype")+'" />',element=jQuery(html);return this.addValidationToElement(element)}}),Vtiger_Owner_Field_Js("Workflows_Owner_Field_Js",{},{getUi:function(){var html='<select class="select2" name="'+this.getName()+'">',pickListValues=this.getPickListValues(),selectedOption=this.getValue();for(var optGroup in pickListValues){html+='<optgroup label="'+optGroup+'">';var optionGroupValues=pickListValues[optGroup];for(var option in optionGroupValues)html+='<option value="'+option+'" ',option==selectedOption&&(html+=" selected "),html+=">"+optionGroupValues[option]+"</option>";html+="</optgroup>"}html+="</select>";var selectContainer=jQuery(html);return this.addValidationToElement(selectContainer),selectContainer}}),Vtiger_Picklist_Field_Js("Workflows_Picklist_Field_Js",{},{getUi:function(){var selectedOption=app.htmlDecode(this.getValue()),pickListValues=this.getPickListValues(),tagsArray=[];jQuery.map(pickListValues,(function(val,i){tagsArray.push(val)}));var pickListValuesArrayFlip={};for(var key in pickListValues){pickListValuesArrayFlip[pickListValues[key]]=key}var html='<input type="hidden" class="row select2" name="'+this.getName()+'">',selectContainer=jQuery(html).val(pickListValues[selectedOption]);return selectContainer.data("tags",tagsArray).data("picklistvalues",pickListValuesArrayFlip),this.addValidationToElement(selectContainer),App.Fields.Picklist.showSelect2ElementView(selectContainer,{placeholder:app.vtranslate("JS_PLEASE_SELECT_ATLEAST_ONE_OPTION"),closeOnSelect:!0,maximumSelectionLength:1}),selectContainer}});
//# sourceMappingURL=AdvanceFilter.min.js.map
