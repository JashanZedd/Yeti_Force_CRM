'use strict';

/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */

jQuery.Class('Settings_SocialMedia_Index_Js', {}, {
	/**
  * Container (Form)
  */
	container: null,
	/**
  * Get Container (Form)
  * @returns {Object}
  */
	getContainer: function getContainer() {
		if (this.container === null) {
			this.container = $('.js-social-media-container');
		}
		return this.container;
	},

	/**
  * Submit form
  * @param {jQuery} form
  */
	saveForm: function saveForm(form) {
		form.validationEngine(app.validationEngineOptions);
		if (form.validationEngine('validate')) {
			var progressIndicatorElement = jQuery.progressIndicator({
				position: 'html',
				blockInfo: {
					enabled: true
				}
			});
			var dataForm = form.serializeFormData();
			dataForm.module = app.getModuleName();
			dataForm.parent = app.getParentModuleName();
			dataForm.action = 'SaveAjax';
			AppConnector.request(dataForm).done(function (response) {
				progressIndicatorElement.progressIndicator({ mode: 'hide' });
				Vtiger_Helper_Js.showPnotify({
					text: response.result.message,
					type: 'info'
				});
			}).fail(function (textStatus, errorThrown) {
				progressIndicatorElement.progressIndicator({ mode: 'hide' });
				Vtiger_Helper_Js.showMessage({
					type: 'error',
					text: app.vtranslate('JS_ERROR')
				});
			});
		}
	},

	/**
  * Register events for form
  */
	registerForm: function registerForm(form) {
		var thisInstance = this;
		form.on('change', function (event) {
			event.preventDefault();
			thisInstance.saveForm(form);
		});
		//Executed when the enter key is pressed.
		form.on('submit', function (event) {
			event.preventDefault();
			thisInstance.saveForm(form);
		});
	},

	/**
  * Register all events in view
  */
	registerEvents: function registerEvents() {
		var _this = this;

		this.getContainer().find('form').each(function (index, form) {
			_this.registerForm($(form));
		});
	}
});
//# sourceMappingURL=Index.min.js.map
