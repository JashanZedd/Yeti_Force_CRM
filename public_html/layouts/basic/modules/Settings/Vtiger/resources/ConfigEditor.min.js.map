{"version":3,"file":"ConfigEditor.min.js","sources":["ConfigEditor.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\"Settings_Vtiger_ConfigEditor_Js\", {}, {\n\n\t/*\n\t * Function to save the Configuration Editor content\n\t */\n\tsaveConfigEditor: function (form) {\n\t\tvar aDeferred = jQuery.Deferred();\n\n\t\tvar data = form.serializeFormData();\n\t\tvar updatedFields = {};\n\t\tjQuery.each(data, function (key, value) {\n\t\t\tif (key === '__vtrftk') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tupdatedFields[key] = value;\n\t\t})\n\n\t\tvar params = {\n\t\t\t'module': app.getModuleName(),\n\t\t\t'parent': app.getParentModuleName(),\n\t\t\t'action': 'ConfigEditorSaveAjax',\n\t\t\t'updatedFields': JSON.stringify(updatedFields)\n\t\t}\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject(error, err);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/*\n\t * Function to load the contents from the url through pjax\n\t */\n\tloadContents: function (url) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tAppConnector.requestPjax(url).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/*\n\t * function to register the events in editView\n\t */\n\tregisterEditViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#ConfigEditorForm');\n\t\tvar detailUrl = form.data('detailUrl');\n\n\t\t//register all select2 Elements\n\t\tApp.Fields.Picklist.showSelect2ElementView(form.find('select.select2'), {dropdownCss: {'z-index': 0}});\n\n\t\t//register validation engine\n\t\tvar params = app.validationEngineOptions;\n\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\tif (valid) {\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t'position': 'html',\n\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.saveConfigEditor(form).done(function (data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_CONFIGURATION_DETAILS_SAVED');\n\t\t\t\t\t\tthisInstance.loadContents(detailUrl).done(function (data) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\tparams['text'] = data['error']['message'];\n\t\t\t\t\t\tparams['type'] = 'error';\n\t\t\t\t\t}\n\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t});\n\t\t\t\treturn valid;\n\t\t\t}\n\t\t}\n\t\tform.validationEngine(params);\n\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t})\n\n\t\t//Register click event for cancel link\n\t\tvar cancelLink = form.find('.cancelLink');\n\t\tcancelLink.on('click', function () {\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.loadContents(detailUrl).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'})\n\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t * function to register the events in DetailView\n\t */\n\tregisterDetailViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('#ConfigEditorDetails');\n\t\tvar editButton = container.find('.editButton');\n\n\t\t//Register click event for edit button\n\t\teditButton.on('click', function () {\n\t\t\tvar url = editButton.data('url');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.loadContents(url).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\tthisInstance.registerEditViewEvents();\n\t\t\t}).fail(function (error, err) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\n\tregisterEvents: function () {\n\t\tif (jQuery('#ConfigEditorDetails').length > 0) {\n\t\t\tthis.registerDetailViewEvents();\n\t\t} else {\n\t\t\tthis.registerEditViewEvents();\n\t\t}\n\t}\n\n});\n\njQuery(document).ready(function (e) {\n\tvar tacInstance = new Settings_Vtiger_ConfigEditor_Js();\n\ttacInstance.registerEvents();\n})\n\nVtiger_WholeNumberGreaterThanZero_Validator_Js(\"Vtiger_NumberRange5_Validator_Js\", {\n\n\t/**\n\t *Function which invokes field validation\n\t *@param accepts field element as parameter\n\t * @return error if validation fails true on success\n\t */\n\tinvokeValidation: function (field, rules, i, options) {\n\t\tvar rangeInstance = new Vtiger_NumberRange5_Validator_Js();\n\t\trangeInstance.setElement(field);\n\t\tvar response = rangeInstance.validate();\n\t\tif (response != true) {\n\t\t\treturn rangeInstance.getError();\n\t\t}\n\t}\n\n}, {\n\t/**\n\t * Function to validate the percentage field data\n\t * @return true if validation is successfull\n\t * @return false if validation error occurs\n\t */\n\tvalidate: function () {\n\t\tvar response = this._super();\n\t\tif (response != true) {\n\t\t\treturn response;\n\t\t} else {\n\t\t\tvar fieldValue = this.getFieldValue();\n\t\t\tif (fieldValue < 1 || fieldValue > 5) {\n\t\t\t\tvar errorInfo = app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_1TO5');\n\t\t\t\tthis.setError(errorInfo);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n});\n\nVtiger_WholeNumberGreaterThanZero_Validator_Js(\"Vtiger_NumberRange2_Validator_Js\", {\n\n\t/**\n\t *Function which invokes field validation\n\t *@param accepts field element as parameter\n\t * @return error if validation fails true on success\n\t */\n\tinvokeValidation: function (field, rules, i, options) {\n\t\tvar rangeInstance = new Vtiger_NumberRange5_Validator_Js();\n\t\trangeInstance.setElement(field);\n\t\tvar response = rangeInstance.validate();\n\t\tif (response != true) {\n\t\t\treturn rangeInstance.getError();\n\t\t}\n\t}\n\n}, {\n\t/**\n\t * Function to validate the percentage field data\n\t * @return true if validation is successfull\n\t * @return false if validation error occurs\n\t */\n\tvalidate: function () {\n\t\tvar response = this._super();\n\t\tif (response != true) {\n\t\t\treturn response;\n\t\t} else {\n\t\t\tvar fieldValue = this.getFieldValue();\n\t\t\tif (fieldValue < 1 || fieldValue > 2) {\n\t\t\t\tvar errorInfo = app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_1TO2');\n\t\t\t\tthis.setError(errorInfo);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n});\n\nVtiger_WholeNumberGreaterThanZero_Validator_Js(\"Vtiger_NumberRange100_Validator_Js\", {\n\n\t/**\n\t *Function which invokes field validation\n\t *@param accepts field element as parameter\n\t * @return error if validation fails true on success\n\t */\n\tinvokeValidation: function (field, rules, i, options) {\n\t\tvar rangeInstance = new Vtiger_NumberRange100_Validator_Js();\n\t\trangeInstance.setElement(field);\n\t\tvar response = rangeInstance.validate();\n\t\tif (response != true) {\n\t\t\treturn rangeInstance.getError();\n\t\t}\n\t}\n\n}, {\n\t/**\n\t * Function to validate the percentage field data\n\t * @return true if validation is successfull\n\t * @return false if validation error occurs\n\t */\n\tvalidate: function () {\n\t\tvar response = this._super();\n\t\tif (response != true) {\n\t\t\treturn response;\n\t\t} else {\n\t\t\tvar fieldValue = this.getFieldValue();\n\t\t\tif (fieldValue < 1 || fieldValue > 100) {\n\t\t\t\tvar errorInfo = app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_1TO100');\n\t\t\t\tthis.setError(errorInfo);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\n})\n"],"names":["jQuery","Class","saveConfigEditor","form","Deferred","data","serializeFormData","updatedFields","each","key","value","app","getModuleName","getParentModuleName","JSON","stringify","request","params","done","aDeferred","resolve","fail","error","err","reject","promise","loadContents","url","requestPjax","registerEditViewEvents","detailUrl","App","Fields","Picklist","showSelect2ElementView","find","dropdownCss","validationEngineOptions","onValidationComplete","valid","progressIndicator","vtranslate","thisInstance","progressIndicatorElement","html","registerDetailViewEvents","Settings_Vtiger_Index_Js","showMessage","validationEngine","on","e","preventDefault","cancelLink","container","editButton","registerEvents","length","document","ready","tacInstance","Vtiger_WholeNumberGreaterThanZero_Validator_Js","invokeValidation","field","rangeInstance","setElement","validate","getError","_super","getFieldValue","setError","errorInfo"],"mappings":"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"}