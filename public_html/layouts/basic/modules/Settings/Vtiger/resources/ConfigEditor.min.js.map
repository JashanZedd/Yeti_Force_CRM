{"version":3,"file":"ConfigEditor.min.js","sources":["ConfigEditor.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\"Settings_Vtiger_ConfigEditor_Js\", {}, {\n\n\t/*\n\t * Function to save the Configuration Editor content\n\t */\n\tsaveConfigEditor: function (form) {\n\t\tvar aDeferred = jQuery.Deferred();\n\n\t\tlet params = form.serializeFormData();\n\t\tparams.module = app.getModuleName();\n\t\tparams.parent = app.getParentModuleName();\n\t\tparams.action = 'ConfigEditorSaveAjax';\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject(error, err);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/*\n\t * Function to load the contents from the url through pjax\n\t */\n\tloadContents: function (url) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tAppConnector.requestPjax(url).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/*\n\t * function to register the events in editView\n\t */\n\tregisterEditViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#ConfigEditorForm');\n\t\tvar detailUrl = form.data('detailUrl');\n\n\t\t//register all select2 Elements\n\t\tApp.Fields.Picklist.showSelect2ElementView(form.find('select.select2'), {dropdownCss: {'z-index': 0}});\n\n\t\t//register validation engine\n\t\tvar params = app.validationEngineOptions;\n\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\tif (valid) {\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t'position': 'html',\n\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.saveConfigEditor(form).done(function (data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tparams['text'] = app.vtranslate('JS_CONFIGURATION_DETAILS_SAVED');\n\t\t\t\t\t\tthisInstance.loadContents(detailUrl).done(function (data) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t}\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t});\n\t\t\t\treturn valid;\n\t\t\t}\n\t\t}\n\t\tform.validationEngine(params);\n\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t})\n\n\t\t//Register click event for cancel link\n\t\tvar cancelLink = form.find('.cancelLink');\n\t\tcancelLink.on('click', function () {\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.loadContents(detailUrl).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'})\n\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t * function to register the events in DetailView\n\t */\n\tregisterDetailViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('#ConfigEditorDetails');\n\t\tvar editButton = container.find('.editButton');\n\n\t\t//Register click event for edit button\n\t\teditButton.on('click', function () {\n\t\t\tvar url = editButton.data('url');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.loadContents(url).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\t\tthisInstance.registerEditViewEvents();\n\t\t\t}).fail(function (error, err) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\n\tregisterEvents: function () {\n\t\tif (jQuery('#ConfigEditorDetails').length > 0) {\n\t\t\tthis.registerDetailViewEvents();\n\t\t} else {\n\t\t\tthis.registerEditViewEvents();\n\t\t}\n\t}\n\n});\n\njQuery(document).ready(function (e) {\n\tvar tacInstance = new Settings_Vtiger_ConfigEditor_Js();\n\ttacInstance.registerEvents();\n})\nVtiger_WholeNumberGreaterThanZero_Validator_Js(\"Vtiger_NumberRange100_Validator_Js\", {\n\n\t/**\n\t *Function which invokes field validation\n\t *@param accepts field element as parameter\n\t * @return error if validation fails true on success\n\t */\n\tinvokeValidation: function (field, rules, i, options) {\n\t\tvar rangeInstance = new Vtiger_NumberRange100_Validator_Js();\n\t\trangeInstance.setElement(field);\n\t\tvar response = rangeInstance.validate();\n\t\tif (response != true) {\n\t\t\treturn rangeInstance.getError();\n\t\t}\n\t}\n\n}, {\n\t/**\n\t * Function to validate the percentage field data\n\t * @return true if validation is successfull\n\t * @return false if validation error occurs\n\t */\n\tvalidate: function () {\n\t\tvar response = this._super();\n\t\tif (response != true) {\n\t\t\treturn response;\n\t\t} else {\n\t\t\tvar fieldValue = this.getFieldValue();\n\t\t\tif (fieldValue < 1 || fieldValue > 100) {\n\t\t\t\tvar errorInfo = app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_1TO100');\n\t\t\t\tthis.setError(errorInfo);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\n})\n"],"names":["jQuery","Class","form","aDeferred","Deferred","params","serializeFormData","module","app","getModuleName","parent","getParentModuleName","action","request","done","data","resolve","fail","error","err","reject","promise","url","requestPjax","thisInstance","detailUrl","Fields","Picklist","showSelect2ElementView","find","dropdownCss","validationEngineOptions","onValidationComplete","valid","progressIndicatorElement","progressIndicator","saveConfigEditor","vtranslate","loadContents","html","registerDetailViewEvents","showMessage","validationEngine","on","e","preventDefault","cancelLink","container","editButton","registerEditViewEvents","length","document","ready","tacInstance","Settings_Vtiger_ConfigEditor_Js","registerEvents","Vtiger_WholeNumberGreaterThanZero_Validator_Js","field","rules","i","options","rangeInstance","Vtiger_NumberRange100_Validator_Js","setElement","response","validate","getError","_super","fieldValue","getFieldValue","errorInfo","setError"],"mappings":"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"}