{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_List_Js(\n\t'Settings_Vtiger_List_Js',\n\t{\n\t\ttriggerDelete: function(event, url) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar instance = Vtiger_List_Js.getInstance();\n\t\t\tinstance.DeleteRecord(url);\n\t\t},\n\t\t/**\n\t\t * Make delete request\n\t\t *\n\t\t * @param   {object}  params\n\t\t * @param   {jQuery.Deferred}  aDeferred\n\t\t * @param   {Vtiger_List_Js}  instance\n\t\t */\n\t\tmakeDeleteRequest(params, aDeferred, instance) {\n\t\t\tAppConnector.request(params).done(data => {\n\t\t\t\tlet response = data.result;\n\t\t\t\tif (response && response.success) {\n\t\t\t\t\t$('#recordsCount').val('');\n\t\t\t\t\t$('#totalPageCount').text('');\n\t\t\t\t\tinstance.getListViewRecords().done(() => {\n\t\t\t\t\t\tinstance.updatePagination();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: response.message\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Delete by id\n\t\t *\n\t\t * @param   {number}  id\n\t\t * @param   {bool}  showConfirmation\n\t\t *\n\t\t * @return  {jQuery.Deferred}\n\t\t */\n\t\tdeleteById(id, showConfirmation = true) {\n\t\t\tconst aDeferred = jQuery.Deferred();\n\t\t\tconst instance = Vtiger_List_Js.getInstance();\n\t\t\tconst params = $.extend(instance.getDeleteParams(), {\n\t\t\t\trecord: id\n\t\t\t});\n\t\t\tif (showConfirmation) {\n\t\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t\tmessage: app.vtranslate('JS_DELETE_RECORD_CONFIRMATION')\n\t\t\t\t}).done(e => {\n\t\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t},\n\t{\n\t\tgetDeleteParams: function() {\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'DeleteAjax'\n\t\t\t};\n\t\t},\n\t\t/*\n\t\t * Function to register the list view container\n\t\t */\n\t\tgetListViewContainer() {\n\t\t\tif (this.listViewContainer == false) {\n\t\t\t\tthis.listViewContainer = $('div.listViewPageDiv');\n\t\t\t}\n\t\t\treturn this.listViewContainer;\n\t\t},\n\n\t\t/*\n\t\t * Function to register the list view delete record click event\n\t\t */\n\t\tDeleteRecord: function(url) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tapp.showModalWindow(data, function(container) {\n\t\t\t\t\t\tthisInstance.postDeleteAction(container);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to load list view after deletion of record from list view\n\t\t */\n\t\tpostDeleteAction: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar deleteConfirmForm = jQuery(container).find('#DeleteModal');\n\t\t\tdeleteConfirmForm.on('submit', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar deleteActionUrl = deleteConfirmForm.serializeFormData();\n\t\t\t\tAppConnector.request(deleteActionUrl)\n\t\t\t\t\t.done(function() {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_RECORD_DELETED_SUCCESSFULLY')\n\t\t\t\t\t\t};\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\tjQuery('#recordsCount').val('');\n\t\t\t\t\t\tjQuery('#totalPageCount').text('');\n\t\t\t\t\t\tthisInstance.getListViewRecords().done(function() {\n\t\t\t\t\t\t\tthisInstance.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to get Page Jump Params\n\t\t */\n\t\tgetPageJumpParams: function() {\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar cvId = this.getCurrentCvId();\n\t\t\tvar pageCountParams = {\n\t\t\t\tmodule: module,\n\t\t\t\tparent: 'Settings',\n\t\t\t\taction: 'ListAjax',\n\t\t\t\tmode: 'getPageCount',\n\t\t\t\tviewname: cvId\n\t\t\t};\n\t\t\tvar sourceModule = jQuery('#moduleFilter').val();\n\t\t\tif (typeof sourceModule !== 'undefined') {\n\t\t\t\tpageCountParams['sourceModule'] = sourceModule;\n\t\t\t}\n\t\t\treturn pageCountParams;\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\t//this.triggerDisplayTypeEvent();\n\t\t\tthis.registerRowClickEvent();\n\t\t\tthis.registerCheckBoxClickEvent();\n\t\t\tthis.registerHeadersClickEvent();\n\t\t\tthis.registerPageNavigationEvents();\n\t\t\tthis.registerEventForTotalRecordsCount();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","event","url","stopPropagation","instance","getInstance","DeleteRecord","params","aDeferred","request","done","response","data","result","success","val","text","getListViewRecords","updatePagination","showPnotify","message","resolve","id","showConfirmation","jQuery","Deferred","$","extend","getDeleteParams","showConfirmationBox","app","vtranslate","makeDeleteRequest","promise","getModuleName","getParentModuleName","listViewContainer","thisInstance","showModalWindow","container","postDeleteAction","deleteConfirmForm","find","on","e","preventDefault","deleteActionUrl","serializeFormData","hideModalWindow","showMessage","fail","error","err","module","cvId","getCurrentCvId","pageCountParams","sourceModule","registerRowClickEvent","registerCheckBoxClickEvent","registerHeadersClickEvent","registerPageNavigationEvents","registerEventForTotalRecordsCount"],"mappings":"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"}