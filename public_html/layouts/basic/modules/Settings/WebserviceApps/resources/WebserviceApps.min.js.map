{"version":3,"file":"WebserviceApps.min.js","sources":["WebserviceApps.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class('Settings_WebserviceApps_Index_Js', {}, {\n\t/**\n\t * Get container\n\t *\n\t * @returns {HTMLElement|jQuery}\n\t */\n\tgetContainer() {\n\t\treturn this.container;\n\t},\n\t/**\n\t * Register actions for record\n\t */\n\tregisterTableEvents: function () {\n\t\tvar thisInstance = this;\n\t\tconst container = this.container = $('.configContainer');\n\t\tcontainer.find('.edit').on('click', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar trRow = currentTarget.closest('tr');\n\t\t\tthisInstance.showFormToEditKey(trRow.data('id'));\n\t\t});\n\t\tcontainer.find('.remove').on('click', function (e) {\n\t\t\tvar removeButton = jQuery(e.currentTarget);\n\t\t\tvar currentTrElement = removeButton.closest('tr');\n\t\t\tvar message = app.vtranslate('JS_DELETE_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ 'message': message }).done(function (e) {\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\taction: 'Delete',\n\t\t\t\t\tid: currentTrElement.data('id')\n\t\t\t\t};\n\t\t\t\tvar progress = jQuery.progressIndicator();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tprogress.progressIndicator({ 'mode': 'hide' });\n\t\t\t\t\tthisInstance.loadTable();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Refresh tables with records\n\t */\n\tloadTable: function () {\n\t\tvar thisInstance = this;\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'Index',\n\t\t};\n\t\tvar progress = jQuery.progressIndicator();\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogress.progressIndicator({ 'mode': 'hide' });\n\t\t\t$('.configContainer').html(data);\n\t\t\tthisInstance.registerTableEvents();\n\t\t});\n\t},\n\t/**\n\t * Show forms to edit or create record\n\t * @param {int} id\n\t */\n\tshowFormToEditKey: function (id) {\n\t\tvar thisInstance = this;\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'CreateApp',\n\t\t};\n\t\tif (id != '') {\n\t\t\tparams['record'] = id;\n\t\t}\n\t\tvar progress = jQuery.progressIndicator();\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogress.progressIndicator({ 'mode': 'hide' });\n\t\t\tapp.showModalWindow(data, function (container) {\n\t\t\t\tconst prevButton = container.find('.previewPassword');\n\t\t\t\tconst password = container.find('[name=\"pass\"]');\n\t\t\t\tprevButton.on('mousedown', function (e) {\n\t\t\t\t\tpassword.attr('type', 'text');\n\t\t\t\t});\n\t\t\t\tprevButton.on('mouseup', function (e) {\n\t\t\t\t\tpassword.attr('type', 'password');\n\t\t\t\t});\n\t\t\t\tprevButton.on('mouseout', function (e) {\n\t\t\t\t\tpassword.attr('type', 'password');\n\t\t\t\t});\n\t\t\t\tconst clipboard = App.Fields.Text.registerCopyClipboard(container, '.copyPassword');\n\t\t\t\tcontainer.one('hidden.bs.modal', function () {\n\t\t\t\t\tclipboard.destroy();\n\t\t\t\t});\n\t\t\t\tvar form = container.find('form');\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\tcontainer.find('[name=\"saveButton\"]').on('click', function () {\n\t\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\t\t\taction: 'SaveAjax',\n\t\t\t\t\t\t\tname: container.find('[name=\"name\"]').val(),\n\t\t\t\t\t\t\turl: container.find('[name=\"addressUrl\"]').val(),\n\t\t\t\t\t\t\tstatus: container.find('[name=\"status\"]').is(':checked'),\n\t\t\t\t\t\t\ttype: container.find('.typeServer').val(),\n\t\t\t\t\t\t\tpass: password.val(),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (id != '') {\n\t\t\t\t\t\t\tparams['id'] = id;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\t\tif (data.result === true) {\n\t\t\t\t\t\t\t\tthisInstance.loadTable();\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t} else if (typeof data.result.error !== 'undefined') {\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(data.result.error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register button to create record\n\t */\n\tregisterAddButton: function () {\n\t\tvar thisInstance = this\n\t\t$('.createKey').on('click', function () {\n\t\t\tthisInstance.showFormToEditKey();\n\t\t});\n\t},\n\t/**\n\t * Main function\n\t */\n\tregisterEvents: function () {\n\t\tthis.registerAddButton();\n\t\tthis.registerTableEvents();\n\t\tApp.Fields.Text.registerCopyClipboard(this.getContainer());\n\t}\n})\n"],"names":["$","Class","container","thisInstance","find","on","e","currentTarget","trRow","closest","showFormToEditKey","data","removeButton","jQuery","currentTrElement","message","app","vtranslate","showConfirmationBox","done","params","getModuleName","getParentModuleName","progress","progressIndicator","request","loadTable","html","registerTableEvents","id","showModalWindow","prevButton","password","attr","clipboard","App","Fields","Text","registerCopyClipboard","one","destroy","form","validationEngine","validationEngineOptions","val","is","result","hideModalWindow","error","showPnotify","registerAddButton","getContainer"],"mappings":"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"}