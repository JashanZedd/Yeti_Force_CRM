{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"Settings_MarketingProcesses_Index_Js\", {}, {\n\tregisterChangeVal: function (content) {\n\t\tcontent.find('.configField').on('change', function (e) {\n\t\t\tvar target = $(e.currentTarget);\n\t\t\tvar val;\n\t\t\tif (target.attr('type') === 'checkbox') {\n\t\t\t\tval = this.checked;\n\t\t\t} else {\n\t\t\t\tval = target.val() != null ? target.val() : '';\n\t\t\t}\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'SaveAjax',\n\t\t\t\tmode: 'updateConfig',\n\t\t\t\ttype: target.data('type'),\n\t\t\t\tparam: target.attr('name'),\n\t\t\t\tvalue: val\n\t\t\t}).done(function (data) {\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage({type: 'success', text: data.result.message});\n\t\t\t});\n\t\t});\n\t},\n\tregisterSaveMapping: function (content) {\n\t\tvar thisInstance = this;\n\t\tcontent.find('button.saveMapping').on('click', function () {\n\t\t\tvar mapping = [];\n\t\t\tjQuery('#convertLeadMapping tr.listViewEntries:not(.d-none)').each(function () {\n\t\t\t\tvar leadName = jQuery(this).find('select.leadsFields').val();\n\t\t\t\tvar accountName = jQuery(this).find('select.accountsFields').val();\n\t\t\t\tvar relations = [];\n\t\t\t\trelations[leadName] = accountName;\n\t\t\t\trelations = jQuery.extend({}, relations);\n\t\t\t\tif (thisInstance.uniqueReduce(mapping, relations)) {\n\t\t\t\t\tmapping.push(relations);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (mapping.length) {\n\t\t\t\tjQuery('[name=\"mapping\"]').val(JSON.stringify(mapping)).change();\n\t\t\t} else {\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage({type: 'info', text: app.vtranslate('JS_NO_CONDITIONS')});\n\t\t\t}\n\t\t});\n\t},\n\tuniqueReduce: function (mapping, relations) {\n\t\tfor (var key in mapping) {\n\t\t\tif (JSON.stringify(mapping[key]) === JSON.stringify(relations)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\tregisterEventToDeleteMapping: function (content) {\n\t\tcontent.find('.deleteMapping').on('click', function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tvar trContainer = element.closest('tr');\n\t\t\ttrContainer.remove();\n\t\t});\n\t},\n\tregisterMapping: function (content) {\n\t\tcontent.find('[name=\"create_always\"]').on('change', function (e) {\n\t\t\tvar mappingTable = jQuery('.mappingTable');\n\t\t\tif (this.checked) {\n\t\t\t\tmappingTable.removeClass('d-none');\n\t\t\t} else {\n\t\t\t\tmappingTable.addClass('d-none');\n\t\t\t}\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tvar content = $('#supportProcessesContainer');\n\t\tthis.registerChangeVal(content);\n\t\tthis.registerSaveMapping(content);\n\t\tthis.registerMapping(content);\n\t\tthis.registerEventToDeleteMapping(content);\n\t\tvar instance = new Settings_LeadMapping_Js();\n\t\tinstance.registerEventForAddingNewMapping();\n\t}\n});\n\n"],"names":["jQuery","Class","content","find","on","e","target","$","currentTarget","val","attr","checked","request","app","getModuleName","getParentModuleName","data","done","showMessage","type","text","result","message","thisInstance","mapping","each","leadName","accountName","relations","extend","uniqueReduce","push","length","JSON","stringify","change","vtranslate","key","element","trContainer","closest","remove","mappingTable","removeClass","addClass","registerChangeVal","registerSaveMapping","registerMapping","registerEventToDeleteMapping","instance","Settings_LeadMapping_Js","registerEventForAddingNewMapping"],"mappings":"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"}