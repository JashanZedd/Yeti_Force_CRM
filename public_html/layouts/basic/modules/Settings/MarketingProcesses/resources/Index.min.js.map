{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"Settings_MarketingProcesses_Index_Js\", {}, {\n\tregisterChangeVal: function (content) {\n\t\tcontent.find('.configField').on('change', function (e) {\n\t\t\tvar target = $(e.currentTarget);\n\t\t\tvar val;\n\t\t\tif (target.attr('type') === 'checkbox') {\n\t\t\t\tval = this.checked;\n\t\t\t} else {\n\t\t\t\tval = target.val() != null ? target.val() : '';\n\t\t\t}\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'SaveAjax',\n\t\t\t\tmode: 'updateConfig',\n\t\t\t\ttype: target.data('type'),\n\t\t\t\tparam: target.attr('name'),\n\t\t\t\tvalue: val\n\t\t\t}).done(function (data) {\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage({type: 'success', text: data.result.message});\n\t\t\t});\n\t\t});\n\t},\n\tregisterSaveMapping: function (content) {\n\t\tvar thisInstance = this;\n\t\tcontent.find('button.saveMapping').on('click', function () {\n\t\t\tvar mapping = [];\n\t\t\tjQuery('#convertLeadMapping tr.listViewEntries:not(.d-none)').each(function () {\n\t\t\t\tvar leadName = jQuery(this).find('select.leadsFields').val();\n\t\t\t\tvar accountName = jQuery(this).find('select.accountsFields').val();\n\t\t\t\tvar relations = [];\n\t\t\t\trelations[leadName] = accountName;\n\t\t\t\trelations = jQuery.extend({}, relations);\n\t\t\t\tif (thisInstance.uniqueReduce(mapping, relations)) {\n\t\t\t\t\tmapping.push(relations);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (mapping.length) {\n\t\t\t\tjQuery('[name=\"mapping\"]').val(JSON.stringify(mapping)).change();\n\t\t\t} else {\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage({type: 'info', text: app.vtranslate('JS_NO_CONDITIONS')});\n\t\t\t}\n\t\t});\n\t},\n\tuniqueReduce: function (mapping, relations) {\n\t\tfor (var key in mapping) {\n\t\t\tif (JSON.stringify(mapping[key]) === JSON.stringify(relations)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\tregisterEventToDeleteMapping: function (content) {\n\t\tcontent.find('.deleteMapping').on('click', function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tvar trContainer = element.closest('tr');\n\t\t\ttrContainer.remove();\n\t\t});\n\t},\n\tregisterMapping: function (content) {\n\t\tcontent.find('[name=\"create_always\"]').on('change', function (e) {\n\t\t\tvar mappingTable = jQuery('.mappingTable');\n\t\t\tif (this.checked) {\n\t\t\t\tmappingTable.removeClass('d-none');\n\t\t\t} else {\n\t\t\t\tmappingTable.addClass('d-none');\n\t\t\t}\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tvar content = $('#supportProcessesContainer');\n\t\tthis.registerChangeVal(content);\n\t\tthis.registerSaveMapping(content);\n\t\tthis.registerMapping(content);\n\t\tthis.registerEventToDeleteMapping(content);\n\t\tvar instance = new Settings_LeadMapping_Js();\n\t\tinstance.registerEventForAddingNewMapping();\n\t}\n});\n\n"],"names":["jQuery","Class","content","find","on","e","val","target","$","currentTarget","attr","this","checked","request","app","getModuleName","getParentModuleName","data","done","showMessage","type","text","result","message","thisInstance","mapping","each","leadName","accountName","relations","extend","uniqueReduce","push","length","JSON","stringify","change","vtranslate","key","closest","remove","mappingTable","removeClass","addClass","registerChangeVal","registerSaveMapping","registerMapping","registerEventToDeleteMapping","Settings_LeadMapping_Js","registerEventForAddingNewMapping"],"mappings":"aAGAA,OAAOC,MAAM,uCAAwC,GAAI,mBACrC,SAAUC,iBACpBC,KAAK,gBAAgBC,GAAG,UAAU,SAAUC,OAE/CC,IADAC,OAASC,EAAEH,EAAEI,mBAEW,aAAxBF,OAAOG,KAAK,QACTC,KAAKC,QAEW,MAAhBL,OAAOD,MAAgBC,OAAOD,MAAQ,gBAEhCO,QAAQ,QACZC,IAAIC,uBACJD,IAAIE,6BACJ,gBACF,oBACAT,OAAOU,KAAK,cACXV,OAAOG,KAAK,cACZJ,MACLY,MAAK,SAAUD,+BACQE,YAAY,CAACC,KAAM,UAAWC,KAAMJ,KAAKK,OAAOC,qCAIvD,SAAUrB,aAC1BsB,aAAeb,aACXR,KAAK,sBAAsBC,GAAG,SAAS,eAC1CqB,QAAU,UACP,uDAAuDC,MAAK,eAC9DC,SAAW3B,OAAOW,MAAMR,KAAK,sBAAsBG,MACnDsB,YAAc5B,OAAOW,MAAMR,KAAK,yBAAyBG,MACzDuB,UAAY,aACNF,UAAYC,sBACV5B,OAAO8B,OAAO,GAAID,WAC1BL,aAAaO,aAAaN,QAASI,oBAC9BG,KAAKH,cAGXJ,QAAQQ,cACJ,oBAAoB3B,IAAI4B,KAAKC,UAAUV,UAAUW,kCAE/BjB,YAAY,CAACC,KAAM,OAAQC,KAAMP,IAAIuB,WAAW,uCAI9D,SAAUZ,QAASI,eAC3B,IAAIS,OAAOb,WACXS,KAAKC,UAAUV,QAAQa,QAAUJ,KAAKC,UAAUN,kBAC5C,SAGF,gCAEsB,SAAU3B,iBAC/BC,KAAK,kBAAkBC,GAAG,SAAS,SAAUC,GACtCL,OAAOK,EAAEI,eACG8B,QAAQ,MACtBC,6BAGG,SAAUtC,iBAClBC,KAAK,0BAA0BC,GAAG,UAAU,SAAUC,OACzDoC,aAAezC,OAAO,iBACtBW,KAAKC,qBACK8B,YAAY,uBAEZC,SAAS,6BAIT,eACXzC,QAAUM,EAAE,mCACXoC,kBAAkB1C,cAClB2C,oBAAoB3C,cACpB4C,gBAAgB5C,cAChB6C,6BAA6B7C,UACnB,IAAI8C,yBACVC"}