"use strict";jQuery.Class("Settings_MarketingProcesses_Index_Js",{},{registerChangeVal:function(content){content.find(".configField").on("change",(function(e){var val,target=$(e.currentTarget);val="checkbox"===target.attr("type")?this.checked:null!=target.val()?target.val():"",AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updateConfig",type:target.data("type"),param:target.attr("name"),value:val}).done((function(data){Settings_Vtiger_Index_Js.showMessage({type:"success",text:data.result.message})}))}))},registerSaveMapping:function(content){var thisInstance=this;content.find("button.saveMapping").on("click",(function(){var mapping=[];jQuery("#convertLeadMapping tr.listViewEntries:not(.d-none)").each((function(){var leadName=jQuery(this).find("select.leadsFields").val(),accountName=jQuery(this).find("select.accountsFields").val(),relations=[];relations[leadName]=accountName,relations=jQuery.extend({},relations),thisInstance.uniqueReduce(mapping,relations)&&mapping.push(relations)})),mapping.length?jQuery('[name="mapping"]').val(JSON.stringify(mapping)).change():Settings_Vtiger_Index_Js.showMessage({type:"info",text:app.vtranslate("JS_NO_CONDITIONS")})}))},uniqueReduce:function(mapping,relations){for(var key in mapping)if(JSON.stringify(mapping[key])===JSON.stringify(relations))return!1;return!0},registerEventToDeleteMapping:function(content){content.find(".deleteMapping").on("click",(function(e){jQuery(e.currentTarget).closest("tr").remove()}))},registerMapping:function(content){content.find('[name="create_always"]').on("change",(function(e){var mappingTable=jQuery(".mappingTable");this.checked?mappingTable.removeClass("d-none"):mappingTable.addClass("d-none")}))},registerEvents:function(){var content=$("#supportProcessesContainer");this.registerChangeVal(content),this.registerSaveMapping(content),this.registerMapping(content),this.registerEventToDeleteMapping(content),(new Settings_LeadMapping_Js).registerEventForAddingNewMapping()}});
//# sourceMappingURL=Index.min.js.map
