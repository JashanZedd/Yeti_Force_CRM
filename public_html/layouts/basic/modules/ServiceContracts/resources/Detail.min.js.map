{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/**\n * InRelation SlaPolicy\n *\n * @description InRelation scripts for SlaPolicy module\n * @license     YetiForce Public License 3.0\n * @author      Mariusz Krzaczkowski <m.krzaczkowski@yetiforce.com>\n */\n'use strict';\n\nVtiger_Detail_Js(\n\t'ServiceContracts_Detail_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Hide all settings\n\t\t *\n\t\t * @return  {self}\n\t\t */\n\t\thideAll() {\n\t\t\tthis.container.find('.js-sla-policy-template, .js-sla-policy-custom').addClass('d-none');\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Show template settings\n\t\t *\n\t\t * @return  {self}\n\t\t */\n\t\tshowTemplateSettings() {\n\t\t\tthis.container.find('.js-sla-policy-template').removeClass('d-none');\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Show custom settings\n\t\t *\n\t\t * @return  {self}\n\t\t */\n\t\tshowCustomSettings() {\n\t\t\tthis.container.find('.js-sla-policy-custom').removeClass('d-none');\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Get template table\n\t\t * @param {Array} rows\n\t\t *\n\t\t * @returns {String} HTML\n\t\t */\n\t\tgetTemplateTableHtml(rows) {\n\t\t\tlet somethingChecked = false;\n\t\t\trows.each((i, row) => {\n\t\t\t\tif (row.checked) {\n\t\t\t\t\tsomethingChecked = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!somethingChecked && typeof rows[0] !== 'undefined') {\n\t\t\t\trows[0].checked = true;\n\t\t\t}\n\t\t\treturn `<div class=\"col-12\"><table class=\"table js-sla-policy-template-table\">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th></th>\n\t\t\t\t<th>${app.vtranslate('JS_POLICY_NAME')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_OPERATIONAL_HOURS')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_REACTION_TIME')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_IDLE_TIME')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_RESOLVE_TIME')}</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t${rows\n\t\t\t.map(row => {\n\t\t\t\treturn `<tr>\n\t\t\t\t<td><input type=\"radio\" name=\"policy_id\" value=\"${row.id}\"${row.checked ? 'checked=\"checked\"' : ''}></td>\n\t\t\t\t<td>${row.name}</td>\n\t\t\t\t<td>${row.operational_hours}</td>\n\t\t\t\t<td>${row.reaction_time}</td>\n\t\t\t\t<td>${row.idle_time}</td>\n\t\t\t\t<td>${row.resolve_time}</td>\n\t\t\t</tr>`;\n\t\t\t})\n\t\t\t.join('')}\n\t\t</tbody>\n\t\t</table>\n\t\t</div>`;\n\t\t},\n\n\t\t/**\n\t\t * Load predefined sla policy templates\n\t\t */\n\t\tloadTemplates() {\n\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'ServiceContracts',\n\t\t\t\taction: 'PolicyTemplatesAjax',\n\t\t\t\ttargetModule: this.targetModule,\n\t\t\t\trecord: Number($('#recordId').val())\n\t\t\t}).done(data => {\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\tif (data.success) {\n\t\t\t\t\tthis.container\n\t\t\t\t\t\t.find('.js-sla-policy-template--container')\n\t\t\t\t\t\t.html(this.getTemplateTableHtml(data.result));\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * On policy type change event handler\n\t\t */\n\t\tonPolicyTypeChange() {\n\t\t\tthis.policyType = Number(this.container.find('[name=\"policy_type\"]:checked').val());\n\t\t\tif (this.policyType === 1) {\n\t\t\t\tthis.hideAll()\n\t\t\t\t\t.showTemplateSettings()\n\t\t\t\t\t.loadTemplates();\n\t\t\t} else if (this.policyType === 2) {\n\t\t\t\tthis.hideAll().showCustomSettings();\n\t\t\t} else {\n\t\t\t\tthis.hideAll();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * On submit event handler\n\t\t *\n\t\t * @param {Event} ev\n\t\t */\n\t\tonSubmit(ev) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t\tthis.container.validationEngine(app.validationEngineOptions);\n\t\t\tconst policyType = Number(this.container.find('[name=\"policy_type\"]:checked').val());\n\t\t\tconst policyId = Number(this.container.find('[name=\"policy_id\"]:checked').val());\n\t\t\tif (policyType === 2 && !this.container.validationEngine('validate')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (policyType === 2 && !this.container.find('.js-custom-row').length) {\n\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\ttext: app.vtranslate('JS_NO_ITEM_SELECTED'),\n\t\t\t\t\ttype: 'notice',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (policyType === 1 && isNaN(policyId)) {\n\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\ttext: app.vtranslate('JS_NO_ITEM_SELECTED'),\n\t\t\t\t\ttype: 'notice',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst params = this.container.serializeFormData();\n\t\t\tparams.module = 'ServiceContracts';\n\t\t\tparams.action = 'PolicySaveAjax';\n\t\t\tparams.targetModule = this.targetModule;\n\t\t\tparams.record = $('#recordId').val();\n\t\t\tparams.policyType = policyType;\n\t\t\tparams.policyId = policyId;\n\t\t\tAppConnector.request({ data: params }).done(data => {\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\tif (Array.isArray(data.result)) {\n\t\t\t\t\tdata.result.forEach((row, index) => {\n\t\t\t\t\t\tconst rowElem = this.container.find('.js-custom-row').eq(index);\n\t\t\t\t\t\trowElem.data('id', row.id);\n\t\t\t\t\t\trowElem.find('.js-custom-row-id').val(row.id);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$.each(this.container.find('.js-custom-row'), (index, rowElem) => {\n\t\t\t\t\t\trowElem = $(rowElem);\n\t\t\t\t\t\trowElem.data('id', 0);\n\t\t\t\t\t\trowElem.find('.js-custom-row-id').val(0);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register add record button click\n\t\t */\n\t\tregisterAddRecordBtnClick() {\n\t\t\tthis.container.find('.js-sla-policy-add-record-btn').on('click', e => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst index = this.container.find('.js-custom-row').length;\n\t\t\t\tconst row = $(`<div class=\"card js-custom-row shadow-sm mb-2\" data-id=\"0\" data-js=\"container\">\n\t\t\t<div class=\"card-body\">\n\t\t\t\t<div class=\"d-flex\">\n\t\t\t\t\t<div class=\"d-block\" style=\"flex-grow:1\">\n\t\t\t\t\t\t<div class=\"row no-gutters\">\n\t\t\t\t\t\t\t<div class=\"col-5 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_BUSINESS_HOURS')}</label>\n\t\t\t\t\t\t\t\t<select class=\"select2\" name=\"business_hours[${index}][]\" multiple data-validation-engine=\"validate[required,funcCall[Vtiger_Base_Validator_Js.invokeValidation]]\">\n\t\t\t\t\t\t\t\t${this.businessHours\n\t\t\t\t\t\t\t\t\t.map(businessHours => {\n\t\t\t\t\t\t\t\t\t\treturn `<option value=\"${businessHours.id}\">${businessHours.name}</option>`;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.join('')}\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_REACTION_TIME')}</label>\n\t\t\t\t\t\t\t\t<div class=\"input-group time\">\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"reaction_time[${index}]\" class=\"c-time-period\" value=\"1:d\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_IDLE_TIME')}</label>\n\t\t\t\t\t\t\t\t<div class=\"input-group time\">\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"idle_time[${index}]\" class=\"c-time-period\" value=\"1:d\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_RESOLVE_TIME')}</label>\n\t\t\t\t\t\t\t\t<div class=\"input-group time\">\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"resolve_time[${index}]\" class=\"c-time-period\" value=\"1:d\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row mt-2\">\n\t\t\t\t\t\t\t<div class=\"js-conditions-col col\">\n\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"rowid[${index}]\" value=\"0\" class=\"js-custom-row-id\" />\n\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"conditions[${index}]\" class=\"js-conditions-value\" value=\"{}\" data-js=\"container\">\n\t\t\t\t\t\t\t\t${this.container.find('.js-conditions-template').html()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"d-inline-flex text-right border-left\" style=\"flex-grow:0\">\n\t\t\t\t\t\t<div class=\"d-inline-block align-center\" style=\"margin:auto 0;\">\n\t\t\t\t\t\t\t<a href class=\"btn btn-danger ml-4 js-delete-row-action\"><span class=\"fas fa-trash-alt\"></span></a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`);\n\t\t\t\tApp.Fields.TimePeriod.register(row);\n\t\t\t\tthis.registerDelBtnClick(row);\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(row.find('.select2'));\n\t\t\t\tthis.registerConditionBuilder(\n\t\t\t\t\trow.find('.js-condition-builder').eq(0),\n\t\t\t\t\tthis.container.find('.js-conditions-col').length\n\t\t\t\t);\n\t\t\t\tthis.container.find('.js-custom-conditions').append(row);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register delete button click\n\t\t *\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterDelBtnClick(container) {\n\t\t\tcontainer.find('.js-delete-row-action').on('click', e => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst row = $(e.target).closest('.js-custom-row');\n\t\t\t\tconst rowId = Number(row.data('id'));\n\t\t\t\tif (!rowId) {\n\t\t\t\t\trow.remove();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'ServiceContracts',\n\t\t\t\t\taction: 'PolicyDeleteAjax',\n\t\t\t\t\ttargetModule: this.targetModule,\n\t\t\t\t\trecord: rowId\n\t\t\t\t}).done(data => {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t$(e.target)\n\t\t\t\t\t\t.closest('.card')\n\t\t\t\t\t\t.remove();\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * On condition change event\n\t\t *\n\t\t * @param   {Vtiger_ConditionBuilder_Js}  instance\n\t\t */\n\t\tonConditionsChange(instance) {\n\t\t\tconst index = this.conditionBuilders.indexOf(instance);\n\t\t\tthis.conditionsBuildersContainers[index]\n\t\t\t\t.parent()\n\t\t\t\t.find('.js-conditions-value')\n\t\t\t\t.val(JSON.stringify(instance.getConditions()));\n\t\t},\n\n\t\t/**\n\t\t * Register condition builder\n\t\t *\n\t\t * @param {jQuery} container\n\t\t * @param {Number} index\n\t\t */\n\t\tregisterConditionBuilder(container, index) {\n\t\t\tthis.conditionBuilders[index] = new Vtiger_ConditionBuilder_Js(\n\t\t\t\tcontainer,\n\t\t\t\tthis.targetModule,\n\t\t\t\tthis.onConditionsChange.bind(this)\n\t\t\t);\n\t\t\tthis.conditionBuilders[index].registerEvents();\n\t\t\tthis.conditionsBuildersContainers[index] = container;\n\t\t},\n\n\t\t/**\n\t\t * Init sla policy events\n\t\t */\n\t\tinitSlaPolicy() {\n\t\t\tthis.container = this.getForm();\n\t\t\tthis.policyType = Number(this.container.find('[name=\"policy_type\"]:checked').val());\n\t\t\tthis.targetModule = this.container.find('[name=\"target\"]').val();\n\t\t\tthis.businessHours = JSON.parse(this.container.find('.js-all-business-hours').val());\n\t\t\tthis.conditionBuilders = [];\n\t\t\tthis.conditionsBuildersContainers = [];\n\t\t\tthis.container.off('submit').on('submit', this.onSubmit.bind(this));\n\t\t\tthis.container.find('.js-sla-policy-type-radio').on('click', e => this.onPolicyTypeChange());\n\t\t\tthis.onPolicyTypeChange();\n\t\t\tApp.Fields.TimePeriod.register(this.container);\n\t\t\tthis.registerAddRecordBtnClick();\n\t\t\tthis.registerDelBtnClick(this.container);\n\t\t\t$.each(this.container.find('.js-custom-conditions .js-condition-builder'), (index, col) => {\n\t\t\t\tthis.registerConditionBuilder($(col), index);\n\t\t\t});\n\t\t},\n\n\t\tregisterEvents: function() {\n\t\t\tthis._super();\n\t\t\tlet detailViewForm = this.getForm();\n\t\t\tif (detailViewForm.find('.js-sla-policy').length) {\n\t\t\t\tthis.initSlaPolicy();\n\t\t\t}\n\t\t\tapp.event.on('DetailView.Tab.AfterLoad', (event, data, instance) => {\n\t\t\t\tif (instance.getForm().find('.js-sla-policy').length) {\n\t\t\t\t\tinstance.initSlaPolicy();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","container","find","addClass","removeClass","rows","somethingChecked","each","i","row","checked","app","vtranslate","map","id","name","operational_hours","reaction_time","idle_time","resolve_time","join","progress","jQuery","progressIndicator","request","targetModule","Number","$","val","done","mode","data","success","html","getTemplateTableHtml","result","policyType","hideAll","showTemplateSettings","loadTemplates","showCustomSettings","ev","preventDefault","stopPropagation","validationEngine","validationEngineOptions","policyId","length","showPnotify","isNaN","params","serializeFormData","module","action","record","Array","isArray","forEach","index","rowElem","eq","on","businessHours","Fields","TimePeriod","register","registerDelBtnClick","Picklist","showSelect2ElementView","registerConditionBuilder","append","e","target","closest","rowId","remove","instance","conditionBuilders","indexOf","conditionsBuildersContainers","parent","JSON","stringify","getConditions","Vtiger_ConditionBuilder_Js","onConditionsChange","bind","registerEvents","getForm","parse","off","onSubmit","onPolicyTypeChange","registerAddRecordBtnClick","col","_super","detailViewForm","initSlaPolicy","event"],"mappings":"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"}