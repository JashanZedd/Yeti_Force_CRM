{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_List_Js(\"Portal_List_Js\", {\n\n\tgetDefaultParams: function () {\n\t\tvar params = {\n\t\t\t'module': app.getModuleName(),\n\t\t\t'view': 'List',\n\t\t\t'page': jQuery('#pageNumber').val(),\n\t\t\t'orderby': jQuery('#orderBy').val(),\n\t\t\t'sortorder': jQuery('#sortOrder').val(),\n\t\t\t'search_value': jQuery('#alphabetValue').val()\n\t\t};\n\t\treturn params;\n\t},\n\n\teditBookmark: function (params) {\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tvar callBackFunction = function (data) {\n\t\t\t\tPortal_List_Js.saveBookmark();\n\t\t\t};\n\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\tsaveBookmark: function () {\n\t\tjQuery('#saveBookmark').on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t\tvar form = jQuery(e.currentTarget);\n\t\t\tvar params = form.serializeFormData();\n\t\t\tif (params.bookmarkName == '' || params.bookmarkUrl == '') {\n\t\t\t\tvar data = {\n\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\ttext: app.vtranslate('JS_ENTER_MANDATORY_FIELD'),\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showPnotify(data);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\tmassDeleteRecords: function () {\n\t\tvar listInstance = Vtiger_List_Js.getInstance();\n\t\tvar validationResult = listInstance.checkListRecordSelected();\n\t\tif (validationResult != true) {\n\t\t\tvar selectedIds = listInstance.readSelectedIds(true);\n\t\t\tvar excludedIds = listInstance.readExcludedIds(true);\n\t\t\tvar message = app.vtranslate('LBL_MASS_DELETE_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(function (e) {\n\t\t\t\tvar deleteURL = 'index.php?module=' + app.getModuleName() + '&action=MassDelete';\n\t\t\t\tdeleteURL += '&selected_ids=' + selectedIds + '&excluded_ids=' + excludedIds;\n\t\t\t\tvar searchValue = listInstance.getAlphabetSearchValue();\n\n\t\t\t\tif ((typeof searchValue !== \"undefined\") && (searchValue.length > 0)) {\n\t\t\t\t\tdeleteURL += '&search_value=' + searchValue;\n\t\t\t\t}\n\t\t\t\tAppConnector.request(deleteURL).done(function (data) {\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\t\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tlistInstance.noRecordSelectedAlert();\n\t\t}\n\t},\n\n\tloadListViewContent: function (url) {\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tAppConnector.requestPjax(url).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t'mode': 'hide'\n\t\t\t});\n\t\t\tjQuery('#listViewContents').html(data);\n\t\t\tPortal_List_Js.updatePagination();\n\t\t});\n\t},\n\n\tupdatePagination: function () {\n\t\tvar previousPageExist = jQuery('#previousPageExist').val();\n\t\tvar nextPageExist = jQuery('#nextPageExist').val();\n\t\tvar previousPageButton = jQuery('#previousPageButton');\n\t\tvar nextPageButton = jQuery('#nextPageButton');\n\t\tvar listViewEntriesCount = parseInt(jQuery('#noOfEntries').val());\n\t\tvar pageStartRange = parseInt(jQuery('#pageStartRange').val());\n\t\tvar pageEndRange = parseInt(jQuery('#pageEndRange').val());\n\t\tvar pages = jQuery('#totalPageCount').text();\n\t\tvar totalNumberOfRecords = jQuery('.totalNumberOfRecords');\n\t\tvar pageNumbersTextElem = jQuery('.pageNumbersText');\n\t\tvar currentPage = parseInt(jQuery('#pageNumber').val());\n\n\t\tjQuery('#pageToJump').val(currentPage);\n\t\tif (previousPageExist != \"\") {\n\t\t\tpreviousPageButton.removeAttr('disabled');\n\t\t} else if (previousPageExist == \"\") {\n\t\t\tpreviousPageButton.attr(\"disabled\", \"disabled\");\n\t\t}\n\t\tif ((nextPageExist != \"\") && (pages > 1)) {\n\t\t\tnextPageButton.removeAttr('disabled');\n\t\t} else if ((nextPageExist == \"\") || (pages == 1)) {\n\t\t\tnextPageButton.attr(\"disabled\", \"disabled\");\n\t\t}\n\t\tif (listViewEntriesCount != 0) {\n\t\t\tvar pageNumberText = pageStartRange + \" (\" + pageEndRange + \")\";\n\t\t\tpageNumbersTextElem.html(pageNumberText);\n\t\t\ttotalNumberOfRecords.removeClass('d-none');\n\t\t} else {\n\t\t\tpageNumbersTextElem.html(\"<span>&nbsp;</span>\");\n\t\t\tif (!totalNumberOfRecords.hasClass('d-none')) {\n\t\t\t\ttotalNumberOfRecords.addClass('d-none');\n\t\t\t}\n\t\t}\n\t}\n}, {\n\n\tregisterAddBookmark: function () {\n\t\tjQuery('.addBookmark').on('click', function () {\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'parent': app.getParentModuleName(),\n\t\t\t\t'view': 'EditAjax'\n\t\t\t};\n\t\t\tPortal_List_Js.editBookmark(params);\n\t\t});\n\t},\n\n\tregisterEditBookmark: function () {\n\t\tjQuery('.editRecord').on('click', function (e) {\n\t\t\te.stopPropagation();\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar id = currentTarget.closest('.listViewEntries').data('id');\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'parent': app.getParentModuleName(),\n\t\t\t\t'view': 'EditAjax',\n\t\t\t\t'record': id\n\t\t\t};\n\t\t\tPortal_List_Js.editBookmark(params);\n\t\t});\n\t},\n\n\tregisterDeleteBookmark: function () {\n\t\tjQuery('.deleteRecord').on('click', function (e) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar id = currentTarget.closest('.listViewEntries').data('id');\n\t\t\tvar message = app.vtranslate('LBL_DELETE_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t'message': message\n\t\t\t}).done(function (e) {\n\t\t\t\tvar params = {\n\t\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t\t'parent': app.getParentModuleName(),\n\t\t\t\t\t'action': 'DeleteAjax',\n\t\t\t\t\t'record': id\n\t\t\t\t};\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\t\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n\tregisterAlphabetSearch: function () {\n\t\tjQuery('.portalAlphabetSearch').on('click', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar searchValue = currentTarget.find('a').attr('id');\n\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\turl['search_value'] = searchValue;\n\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t});\n\t},\n\n\tregisterSortingEvent: function () {\n\t\tjQuery('.portalListViewHeader').on('click', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar orderBy = currentTarget.attr('id');\n\t\t\tvar sortOrder = currentTarget.data('nextsortorderval');\n\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\turl['orderby'] = orderBy;\n\t\t\turl['sortorder'] = sortOrder;\n\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t});\n\t},\n\n\tregisterPreviousPageEvent: function () {\n\t\tjQuery('#previousPageButton').on('click', function (e) {\n\t\t\tvar currentPage = jQuery('#pageNumber').val();\n\t\t\tvar previousPage = parseInt(currentPage) - 1;\n\t\t\tif (previousPage < 1)\n\t\t\t\treturn false;\n\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\turl['page'] = previousPage;\n\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t});\n\t},\n\n\tregisterNextPageEvent: function () {\n\t\tjQuery('#nextPageButton').on('click', function (e) {\n\t\t\tvar currentPage = jQuery('#pageNumber').val();\n\t\t\tvar nextPage = parseInt(currentPage) + 1;\n\t\t\tvar totalPages = parseInt(jQuery('#totalPageCount').text());\n\t\t\tif (nextPage > totalPages)\n\t\t\t\treturn false;\n\t\t\tvar url = Portal_List_Js.getDefaultParams();\n\t\t\turl['page'] = nextPage;\n\t\t\tPortal_List_Js.loadListViewContent(url);\n\t\t});\n\t},\n\n\tregisterRowClickEvent: function () {\n\t\tjQuery('.listViewEntries').on('click', function (e) {\n\t\t\tif (jQuery(e.target, jQuery(e.currentTarget)).is('td:first-child'))\n\t\t\t\treturn;\n\t\t\tif (jQuery(e.target).is('input[type=\"checkbox\"]'))\n\t\t\t\treturn;\n\t\t\tvar elem = jQuery(e.currentTarget);\n\t\t\tvar recordUrl = elem.data('recordurl');\n\t\t\tif (typeof recordUrl === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twindow.location.href = recordUrl;\n\t\t});\n\t},\n\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tthis.registerAddBookmark();\n\t\tthis.registerEditBookmark();\n\t\tthis.registerDeleteBookmark();\n\t\tthis.registerAlphabetSearch();\n\t\tthis.registerSortingEvent();\n\t\tthis.registerPreviousPageEvent();\n\t\tthis.registerNextPageEvent();\n\t\tthis.registerRowClickEvent();\n\t}\n});\n"],"names":["Vtiger_List_Js","app","getModuleName","jQuery","val","params","request","done","data","callBackFunction","saveBookmark","showModalWindow","on","e","preventDefault","currentTarget","serializeFormData","bookmarkName","bookmarkUrl","vtranslate","showPnotify","success","result","message","url","Portal_List_Js","getDefaultParams","loadListViewContent","hideModalWindow","listInstance","getInstance","checkListRecordSelected","selectedIds","readSelectedIds","excludedIds","readExcludedIds","showConfirmationBox","deleteURL","searchValue","getAlphabetSearchValue","length","noRecordSelectedAlert","progressIndicatorElement","progressIndicator","requestPjax","html","updatePagination","previousPageExist","nextPageExist","previousPageButton","nextPageButton","listViewEntriesCount","parseInt","pageStartRange","pageEndRange","pages","text","totalNumberOfRecords","pageNumbersTextElem","currentPage","removeAttr","attr","pageNumberText","removeClass","hasClass","addClass","getParentModuleName","editBookmark","stopPropagation","id","closest","find","orderBy","sortOrder","previousPage","nextPage","target","is","recordUrl","location","href","_super","registerAddBookmark","registerEditBookmark","registerDeleteBookmark","registerAlphabetSearch","registerSortingEvent","registerPreviousPageEvent","registerNextPageEvent","registerRowClickEvent"],"mappings":"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"}