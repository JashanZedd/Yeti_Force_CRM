{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\n\t'RecycleBin_List_Js',\n\t{\n\t\t/**\n\t\t * Mass activation trigerred on the list\n\t\t */\n\t\tmassActivation: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE'),\n\t\t\t\ttext: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.state = 'Active';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.action = 'MassState';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Mass delete trigerred on the list\n\t\t */\n\t\tmassDelete: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_DELETE'),\n\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\t\t\tparams.action = 'MassDelete';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.viewname = 'undefined';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t/**\n\t\t * Register module select\n\t\t */\n\t\tregisterModuleFilter: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\t\tself\n\t\t\t\t\t.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t\t\t})\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', 0);\n\t\t\t\t\t\t\tself.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to update pagination page numer\n\t\t * @param {boolean} force\n\t\t */\n\t\tupdatePaginationAjax(force = false) {\n\t\t\tconst self = this,\n\t\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\t\tlet params = self.getDefaultParams(),\n\t\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\t\ttype: 'info'\n\t\t\t});\n\t\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\t\tparams.totalCount = '-1';\n\t\t\t\tparams.view = 'Pagination';\n\t\t\t\tparams.mode = 'getPagination';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tcontainer.html(data);\n\t\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register empty recycle button\n\t\t */\n\t\tregisterEmptyRecycle: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD'),\n\t\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\t\t\tsourceView: 'List'\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tlet result = {\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Get record list of actual selected module\n\t\t * @param {string} urlParams\n\t\t * @returns {*|jQuery}\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tlet overrideUrlParams = {},\n\t\t\t\taDeferred = $.Deferred();\n\t\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\t\tthis._super(urlParams)\n\t\t\t\t.done(function () {\n\t\t\t\t\taDeferred.resolve();\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetDefaultParams: function () {\n\t\t\tlet params = this._super();\n\t\t\tparams.module = $('.js-source-module').val();\n\t\t\tparams.entityState = 'Trash';\n\t\t\treturn params;\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerModuleFilter();\n\t\t\tthis.registerEmptyRecycle();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","massActivation","self","app","showConfirmModal","title","vtranslate","text","confirmedCallback","params","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","module","find","val","state","entityState","action","AppConnector","request","done","data","result","notify","Vtiger_Helper_Js","showMessage","getListViewRecords","getModuleName","view","sourceModule","massDelete","viewname","registerModuleFilter","filterSelectElement","on","e","args","id","calculatePages","updatePagination","updatePaginationAjax","force","listViewPageDiv","getDefaultParams","type","totalCount","mode","html","registerPageNavigationEvents","registerEmptyRecycle","progressIndicatorElement","$","progressIndicator","sourceView","fail","urlParams","overrideUrlParams","aDeferred","Deferred","extend","_super","resolve","textStatus","errorThrown","reject","promise","registerEvents"],"mappings":"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"}