{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\"RecycleBin_List_Js\", {\n\t/**\n\t * Mass activation trigerred on the list\n\t */\n\tmassActivation: function () {\n\t\tconst self = this;\n\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\tmessage: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE')\n\t\t}).done(function (e) {\n\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\tparams.state = 'Active';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.action = 'MassState';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t}\n\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'List',\n\t\t\t\t\tparent: app.getModuleName(),\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Mass delete trigerred on the list\n\t */\n\tmassDelete: function () {\n\t\tconst self = this;\n\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\ttitle: app.vtranslate('JS_MASS_DELETE')\n\t\t}).done(function (e) {\n\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\tparams.action = 'MassDelete';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.viewname = 'undefined';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t}\n\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'List',\n\t\t\t\t\tparent: app.getModuleName(),\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n}, {\n\t/**\n\t * Register module select\n\t */\n\tregisterModuleFilter: function () {\n\t\tconst self = this,\n\t\t\tcontainer = this.getListViewContainer();\n\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\tself.getListViewRecords({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'List',\n\t\t\t\tparent: app.getModuleName(),\n\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t}).done(function () {\n\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', '');\n\t\t\t\t\tself.updatePagination();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to update pagination page numer\n\t * @param {boolean} force\n\t */\n\tupdatePaginationAjax(force = false) {\n\t\tconst self = this,\n\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\tlet params = self.getDefaultParams(),\n\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\tVtiger_Helper_Js.showMessage({\n\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\ttype: 'info',\n\t\t});\n\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\tparams.totalCount = '-1';\n\t\t\tparams.view = 'Pagination';\n\t\t\tparams.mode = 'getPagination';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tcontainer.html(data);\n\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Register empty recycle button\n\t */\n\tregisterEmptyRecycle: function () {\n\t\tconst self = this,\n\t\t\tcontainer = this.getListViewContainer();\n\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD')\n\t\t\t}).done(function (e) {\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\tsourceView: 'List'\n\t\t\t\t}).done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\t\tlet result = {\n\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t};\n\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Get record list of actual selected module\n\t * @param {string} urlParams\n\t * @returns {*|jQuery}\n\t */\n\tgetListViewRecords: function (urlParams) {\n\t\tlet overrideUrlParams = {},\n\t\t\taDeferred = $.Deferred();\n\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\tthis._super(urlParams).done(function () {\n\t\t\taDeferred.resolve();\n\t\t}).fail(function (textStatus, errorThrown) {\n\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tthis.registerModuleFilter();\n\t\tthis.registerEmptyRecycle();\n\t}\n});\n"],"names":["Vtiger_List_Js","self","showConfirmationBox","app","vtranslate","done","e","params","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","module","find","val","state","entityState","action","request","data","result","notify","showMessage","getListViewRecords","getModuleName","sourceModule","viewname","filterSelectElement","on","args","id","calculatePages","updatePagination","force","listViewPageDiv","getDefaultParams","totalCount","view","mode","html","registerPageNavigationEvents","progressIndicatorElement","$","progressIndicator","fail","error","err","urlParams","overrideUrlParams","aDeferred","Deferred","extend","_super","resolve","textStatus","errorThrown","reject","promise","registerModuleFilter","registerEmptyRecycle"],"mappings":"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"}