{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\n\t'RecycleBin_List_Js',\n\t{\n\t\t/**\n\t\t * Mass activation trigerred on the list\n\t\t */\n\t\tmassActivation: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE'),\n\t\t\t\ttext: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.state = 'Active';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.action = 'MassState';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Mass delete trigerred on the list\n\t\t */\n\t\tmassDelete: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_DELETE'),\n\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\t\t\tparams.action = 'MassDelete';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.viewname = 'undefined';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t/**\n\t\t * Register module select\n\t\t */\n\t\tregisterModuleFilter: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\t\tself\n\t\t\t\t\t.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t\t\t})\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', 0);\n\t\t\t\t\t\t\tself.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to update pagination page numer\n\t\t * @param {boolean} force\n\t\t */\n\t\tupdatePaginationAjax(force = false) {\n\t\t\tconst self = this,\n\t\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\t\tlet params = self.getDefaultParams(),\n\t\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\t\ttype: 'info'\n\t\t\t});\n\t\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\t\tparams.totalCount = '-1';\n\t\t\t\tparams.view = 'Pagination';\n\t\t\t\tparams.mode = 'getPagination';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tcontainer.html(data);\n\t\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register empty recycle button\n\t\t */\n\t\tregisterEmptyRecycle: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD'),\n\t\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\t\t\tsourceView: 'List'\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tlet result = {\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Get record list of actual selected module\n\t\t * @param {string} urlParams\n\t\t * @returns {*|jQuery}\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tlet overrideUrlParams = {},\n\t\t\t\taDeferred = $.Deferred();\n\t\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\t\tthis._super(urlParams)\n\t\t\t\t.done(function () {\n\t\t\t\t\taDeferred.resolve();\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetDefaultParams: function () {\n\t\t\tlet params = this._super();\n\t\t\tparams.module = $('.js-source-module').val();\n\t\t\tparams.entityState = 'Trash';\n\t\t\treturn params;\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerModuleFilter();\n\t\t\tthis.registerEmptyRecycle();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","massActivation","app","showConfirmModal","title","vtranslate","text","confirmedCallback","self","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","params","module","find","val","state","entityState","action","AppConnector","request","done","data","result","notify","Vtiger_Helper_Js","showMessage","getListViewRecords","getModuleName","view","sourceModule","massDelete","viewname","registerModuleFilter","filterSelectElement","on","e","args","id","calculatePages","updatePagination","updatePaginationAjax","force","listViewPageDiv","getDefaultParams","type","totalCount","mode","html","registerPageNavigationEvents","registerEmptyRecycle","$","progressIndicator","sourceView","progressIndicatorElement","fail","urlParams","aDeferred","Deferred","extend","overrideUrlParams","_super","resolve","textStatus","errorThrown","reject","promise","registerEvents"],"mappings":"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"}