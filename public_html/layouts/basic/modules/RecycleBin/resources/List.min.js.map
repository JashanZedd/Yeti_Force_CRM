{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\"RecycleBin_List_Js\", {\n\t/**\n\t * Mass activation trigerred on the list\n\t */\n\tmassActivation: function () {\n\t\tconst self = this;\n\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\tmessage: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE')\n\t\t}).done(function (e) {\n\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\tparams.state = 'Active';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.action = 'MassState';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t}\n\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'List',\n\t\t\t\t\tparent: app.getModuleName(),\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Mass delete trigerred on the list\n\t */\n\tmassDelete: function () {\n\t\tconst self = this;\n\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\ttitle: app.vtranslate('JS_MASS_DELETE')\n\t\t}).done(function (e) {\n\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\tparams.action = 'MassDelete';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.viewname = 'undefined';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t}\n\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'List',\n\t\t\t\t\tparent: app.getModuleName(),\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n}, {\n\t/**\n\t * Register module select\n\t */\n\tregisterModuleFilter: function () {\n\t\tconst self = this,\n\t\t\tcontainer = this.getListViewContainer();\n\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\tself.getListViewRecords({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'List',\n\t\t\t\tparent: app.getModuleName(),\n\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t}).done(function () {\n\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', '');\n\t\t\t\t\tself.updatePagination();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to update pagination page numer\n\t * @param {boolean} force\n\t */\n\tupdatePaginationAjax(force = false) {\n\t\tconst self = this,\n\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\tlet params = self.getDefaultParams(),\n\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\tVtiger_Helper_Js.showMessage({\n\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\ttype: 'info',\n\t\t});\n\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\tparams.totalCount = '-1';\n\t\t\tparams.view = 'Pagination';\n\t\t\tparams.mode = 'getPagination';\n\t\t\tparams.entityState = 'Trash';\n\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tcontainer.html(data);\n\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Register empty recycle button\n\t */\n\tregisterEmptyRecycle: function () {\n\t\tconst self = this,\n\t\t\tcontainer = this.getListViewContainer();\n\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD')\n\t\t\t}).done(function (e) {\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\tsourceView: 'List'\n\t\t\t\t}).done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\t\tlet result = {\n\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t};\n\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Get record list of actual selected module\n\t * @param {string} urlParams\n\t * @returns {*|jQuery}\n\t */\n\tgetListViewRecords: function (urlParams) {\n\t\tlet overrideUrlParams = {},\n\t\t\taDeferred = $.Deferred();\n\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\tthis._super(urlParams).done(function () {\n\t\t\taDeferred.resolve();\n\t\t}).fail(function (textStatus, errorThrown) {\n\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tthis.registerModuleFilter();\n\t\tthis.registerEmptyRecycle();\n\t}\n});\n"],"names":["Vtiger_List_Js","self","this","showConfirmationBox","app","vtranslate","done","e","params","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","module","find","val","state","entityState","action","request","data","result","notify","showMessage","getListViewRecords","getModuleName","sourceModule","viewname","on","args","id","calculatePages","updatePagination","force","listViewPageDiv","getDefaultParams","totalCount","view","mode","html","registerPageNavigationEvents","progressIndicatorElement","$","progressIndicator","fail","error","err","urlParams","overrideUrlParams","aDeferred","Deferred","extend","_super","resolve","textStatus","errorThrown","reject","promise","registerModuleFilter","registerEmptyRecycle"],"mappings":"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"}