{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Detail_Js(\"HelpDesk_Detail_Js\", {\n\tsetAccountsReference: function () {\n\t\tapp.showRecordsList({\n\t\t\tmodule: \"Accounts\",\n\t\t\tsrc_module: \"HelpDesk\",\n\t\t\tsrc_record: app.getRecordId()\n\t\t}, (modal, instance) => {\n\t\t\tinstance.setSelectEvent((responseData) => {\n\t\t\t\tVtiger_Detail_Js.getInstance().saveFieldValues({\n\t\t\t\t\tfield: \"parent_id\",\n\t\t\t\t\tvalue: responseData.id\n\t\t\t\t}).done(function (response) {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n}, {\n\tregisterSetServiceContracts: function () {\n\t\tvar thisInstance = this;\n\t\t$('.selectServiceContracts').on('click', 'ul li', function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tthisInstance.saveFieldValues({\n\t\t\t\tsetRelatedFields: true,\n\t\t\t\tfield: \"servicecontractsid\",\n\t\t\t\tvalue: element.data('id')\n\t\t\t}).done(function (response) {\n\t\t\t\tlocation.reload();\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function to get response from hierarchy\n\t * @param {array} params\n\t * @returns {jQuery}\n\t */\n\tgetHierarchyResponseData: function (params) {\n\t\tlet thisInstance = this,\n\t\t\taDeferred = $.Deferred();\n\t\tif (!($.isEmptyObject(thisInstance.hierarchyResponseCache))) {\n\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t} else {\n\t\t\tAppConnector.request(params).then(\n\t\t\t\tfunction (data) {\n\t\t\t\t\tthisInstance.hierarchyResponseCache = data;\n\t\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function to display the hierarchy response data\n\t * @param {array} data\n\t */\n\tdisplayHierarchyResponseData: function (data) {\n\t\tconst thisInstance = this;\n\t\tlet callbackFunction = function () {\n\t\t\tapp.showScrollBar($('#hierarchyScroll'), {\n\t\t\t\theight: '300px',\n\t\t\t\trailVisible: true,\n\t\t\t\tsize: '6px'\n\t\t\t});\n\t\t};\n\t\tapp.showModalWindow(data, function (modal) {\n\t\t\tthisInstance.registerChangeStatusInHierarchy(modal);\n\t\t\tif (typeof callbackFunction == 'function' && $(\"#hierarchyScroll\").height() > 300) {\n\t\t\t\tcallbackFunction();\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Registers read count of hierarchy if it is possible\n\t */\n\tregisterHierarchyRecordCount: function () {\n\t\tlet hierarchyButton = $('.js-detail-hierarchy'),\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'RelationAjax',\n\t\t\t\trecord: app.getRecordId(),\n\t\t\t\tmode: 'getHierarchyCount'\n\t\t\t};\n\t\tif (hierarchyButton.length) {\n\t\t\tAppConnector.request(params).then(function (response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\t$('.hierarchy .badge').html(response.result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Shows hierarchy\n\t */\n\tregisterShowHierarchy: function () {\n\t\tlet thisInstance = this,\n\t\t\thierarchyButton = $('.detailViewTitle'),\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'Hierarchy',\n\t\t\t\trecord: app.getRecordId()\n\t\t\t};\n\t\thierarchyButton.on('click', '.js-detail-hierarchy', function () {\n\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.getHierarchyResponseData(params).then(function (data) {\n\t\t\t\tthisInstance.displayHierarchyResponseData(data);\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Function to register events on update hierarchy button\n\t *\n\t * @param {jQuery} container\n\t */\n\tregisterChangeStatusInHierarchy: function(container) {\n\t\tcontainer.find('.js-update-hierarchy').on('click',function(){\n\t\t\tlet params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'ChangeStatus',\n\t\t\t\trecordsType: container.find('.js-selected-records').val(),\n\t\t\t\tstatus: container.find('.js-status').val(),\n\t\t\t\trecord: app.getRecordId()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({text: data.result.data, type: 'success'});\n\t\t\t\t}\n\t\t\t\tapp.hideModalWindow();\n\t\t\t});\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tthis.registerSetServiceContracts();\n\t\tthis.registerHierarchyRecordCount();\n\t\tthis.registerShowHierarchy();\n\t}\n});\n"],"names":["Vtiger_Detail_Js","setAccountsReference","app","showRecordsList","module","src_module","src_record","getRecordId","modal","instance","setSelectEvent","responseData","getInstance","saveFieldValues","field","value","id","done","location","reload","registerSetServiceContracts","$","on","e","jQuery","currentTarget","thisInstance","setRelatedFields","element","data","getHierarchyResponseData","params","aDeferred","Deferred","isEmptyObject","hierarchyResponseCache","AppConnector","request","then","resolve","promise","displayHierarchyResponseData","callbackFunction","showScrollBar","height","railVisible","size","showModalWindow","registerChangeStatusInHierarchy","registerHierarchyRecordCount","getModuleName","action","record","mode","hierarchyButton","length","response","success","html","result","registerShowHierarchy","view","progressIndicator","progressIndicatorElement","container","find","recordsType","val","status","Vtiger_Helper_Js","showPnotify","text","type","hideModalWindow","registerEvents","_super"],"mappings":"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"}