'use strict';

Vtiger_Detail_Js("HelpDesk_Detail_Js",{setAccountsReference:function setAccountsReference(){app.showRecordsList({module:"Accounts",src_module:"HelpDesk",src_record:app.getRecordId()},function(modal,instance){instance.setSelectEvent(function(responseData){Vtiger_Detail_Js.getInstance().saveFieldValues({field:"parent_id",value:responseData.id}).done(function(){location.reload();});});});}},{registerSetServiceContracts:function registerSetServiceContracts(){var thisInstance=this;$(".selectServiceContracts").on("click","ul li",function(e){var element=jQuery(e.currentTarget);thisInstance.saveFieldValues({setRelatedFields:!0,field:"servicecontractsid",value:element.data("id")}).done(function(){location.reload();});});},getHierarchyResponseData:function getHierarchyResponseData(params){var thisInstance=this,aDeferred=$.Deferred();return $.isEmptyObject(thisInstance.hierarchyResponseCache)?AppConnector.request(params).then(function(data){thisInstance.hierarchyResponseCache=data,aDeferred.resolve(thisInstance.hierarchyResponseCache);}):aDeferred.resolve(thisInstance.hierarchyResponseCache),aDeferred.promise()},displayHierarchyResponseData:function displayHierarchyResponseData(data){var thisInstance=this,callbackFunction=function(){app.showScrollBar($("#hierarchyScroll"),{height:"300px",railVisible:!0,size:"6px"});};app.showModalWindow(data,function(modal){thisInstance.registerChangeStatusInHierarchy(modal),"function"==typeof callbackFunction&&300<$("#hierarchyScroll").height()&&callbackFunction();});},registerHierarchyRecordCount:function registerHierarchyRecordCount(){var hierarchyButton=$(".js-detail-hierarchy"),params={module:app.getModuleName(),action:"RelationAjax",record:app.getRecordId(),mode:"getHierarchyCount"};hierarchyButton.length&&AppConnector.request(params).then(function(response){response.success&&$(".hierarchy .badge").html(response.result);});},registerShowHierarchy:function registerShowHierarchy(){var thisInstance=this,hierarchyButton=$(".detailViewTitle"),params={module:app.getModuleName(),view:"Hierarchy",record:app.getRecordId()};hierarchyButton.on("click",".js-detail-hierarchy",function(){var progressIndicatorElement=$.progressIndicator({position:"html",blockInfo:{enabled:!0}});thisInstance.getHierarchyResponseData(params).then(function(data){thisInstance.displayHierarchyResponseData(data),progressIndicatorElement.progressIndicator({mode:"hide"});});});},registerChangeStatusInHierarchy:function registerChangeStatusInHierarchy(container){container.find(".js-update-hierarchy").on("click",function(){var params={module:app.getModuleName(),action:"ChangeStatus",recordsType:container.find(".js-selected-records").val(),status:container.find(".js-status").val(),record:app.getRecordId()};AppConnector.request(params).done(function(data){data.success&&Vtiger_Helper_Js.showPnotify({text:data.result.data,type:"success"}),app.hideModalWindow();});});},registerEvents:function registerEvents(){this._super(),this.registerSetServiceContracts(),this.registerHierarchyRecordCount(),this.registerShowHierarchy();}});
//# sourceMappingURL=Detail.min.js.map
