{"version":3,"file":"RelatedList.min.js","sources":["RelatedList.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_RelatedList_Js(\n\t'PriceBooks_RelatedList_Js',\n\t{\n\t\ttriggerMassMargin: function () {\n\t\t\tconst self = Vtiger_RelatedList_Js.relatedListInstance;\n\t\t\tlet selected_ids = self.readSelectedIds(true),\n\t\t\t\texcluded_ids = self.readExcludedIds(true);\n\t\t\tif (self.checkListRecordSelected() !== true) {\n\t\t\t\tapp.showModalWindow({\n\t\t\t\t\turl: 'index.php?module=PriceBooks&view=SpecifyMargin',\n\t\t\t\t\tcb: modalContainer => {\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', e => {\n\t\t\t\t\t\t\tlet element = modalContainer.find('.js-margin');\n\t\t\t\t\t\t\tlet resultOfValidation = Vtiger_NumberUserFormat_Validator_Js.invokeValidation(element);\n\t\t\t\t\t\t\tif (typeof resultOfValidation !== 'undefined') {\n\t\t\t\t\t\t\t\telement.validationEngine('showPrompt', resultOfValidation, '', 'topLeft', true);\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telement.validationEngine('hideAll');\n\t\t\t\t\t\t\t\tlet postData = self.getCompleteParams();\n\t\t\t\t\t\t\t\tdelete postData.view;\n\t\t\t\t\t\t\t\tpostData.selected_ids = selected_ids;\n\t\t\t\t\t\t\t\tpostData.excluded_ids = excluded_ids;\n\t\t\t\t\t\t\t\tpostData.mode = 'specifyMargin';\n\t\t\t\t\t\t\t\tpostData.action = 'RelationAjax';\n\t\t\t\t\t\t\t\tpostData.relatedModule = self.moduleName;\n\t\t\t\t\t\t\t\tpostData.record = self.getParentId();\n\t\t\t\t\t\t\t\tpostData.margin = element.val();\n\t\t\t\t\t\t\t\tAppConnector.request(postData).done(response => {\n\t\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\t\tVtiger_Detail_Js.reloadRelatedList();\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.noRecordSelectedAlert();\n\t\t\t}\n\t\t}\n\t},\n\t{\n\t\tregisterEditListPrice: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet element = this.content.find('.js-edit-listprice');\n\t\t\telement.validationEngine(app.validationEngineOptions);\n\t\t\telement.on('change', e => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tif (!element.validationEngine('validate')) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: thisInstance.parentModuleName,\n\t\t\t\t\t\trecord: element.closest('.js-list__row').data('id'),\n\t\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\t\tmode: 'addListPrice',\n\t\t\t\t\t\tsrc_record: thisInstance.parentRecordId,\n\t\t\t\t\t\trelated_module: thisInstance.moduleName,\n\t\t\t\t\t\tprice: element.val()\n\t\t\t\t\t}).done(function (responseData) {\n\t\t\t\t\t\tif (responseData.result) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({ text: app.vtranslate('JS_SAVE_NOTIFY_OK'), type: 'success' });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterPostLoadEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerEditListPrice();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_RelatedList_Js","self","relatedListInstance","selected_ids","readSelectedIds","excluded_ids","readExcludedIds","checkListRecordSelected","showModalWindow","find","on","element","modalContainer","resultOfValidation","Vtiger_NumberUserFormat_Validator_Js","invokeValidation","validationEngine","preventDefault","postData","getCompleteParams","view","mode","action","relatedModule","moduleName","record","getParentId","margin","val","request","done","response","success","reloadRelatedList","hideModalWindow","noRecordSelectedAlert","thisInstance","content","app","validationEngineOptions","stopPropagation","$","e","currentTarget","formatNumber","parentModuleName","closest","data","parentRecordId","responseData","result","showPnotify","text","vtranslate","type","_super","registerEditListPrice"],"mappings":";;AAAA;AACA;AAEAA,sBACC,2BADD,EAEC;oBACoB,6BAAY;MACxBC,OAAOD,sBAAsBE,mBAAnC;MACIC,eAAeF,KAAKG,eAAL,CAAqB,IAArB,CAAnB;MACCC,eAAeJ,KAAKK,eAAL,CAAqB,IAArB,CADhB;MAEIL,KAAKM,uBAAL,OAAmC,IAAvC,EAA6C;OACxCC,eAAJ,CAAoB;SACd,gDADc;QAEf,4BAAkB;oBACNC,IAAf,CAAoB,iBAApB,EAAuCC,EAAvC,CAA0C,OAA1C,EAAmD,aAAK;UACnDC,UAAUC,eAAeH,IAAf,CAAoB,YAApB,CAAd;UACII,qBAAqBC,qCAAqCC,gBAArC,CAAsDJ,OAAtD,CAAzB;UACI,OAAOE,kBAAP,KAA8B,WAAlC,EAA+C;eACtCG,gBAAR,CAAyB,YAAzB,EAAuCH,kBAAvC,EAA2D,EAA3D,EAA+D,SAA/D,EAA0E,IAA1E;SACEI,cAAF;OAFD,MAGO;eACED,gBAAR,CAAyB,SAAzB;WACIE,WAAWjB,KAAKkB,iBAAL,EAAf;cACOD,SAASE,IAAhB;gBACSjB,YAAT,GAAwBA,YAAxB;gBACSE,YAAT,GAAwBA,YAAxB;gBACSgB,IAAT,GAAgB,eAAhB;gBACSC,MAAT,GAAkB,cAAlB;gBACSC,aAAT,GAAyBtB,KAAKuB,UAA9B;gBACSC,MAAT,GAAkBxB,KAAKyB,WAAL,EAAlB;gBACSC,MAAT,GAAkBhB,QAAQiB,GAAR,EAAlB;oBACaC,OAAb,CAAqBX,QAArB,EAA+BY,IAA/B,CAAoC,oBAAY;YAC3CC,SAASC,OAAb,EAAsB;0BACJC,iBAAjB;aACIC,eAAJ;;QAHF;;aAOM,KAAP;MAxBD;;IAHF;GADD,MAgCO;QACDC,qBAAL;;;CAxCJ,EA4CC;wBACwB,iCAAY;MAC9BC,eAAe,IAAnB;MACIzB,UAAU,KAAK0B,OAAL,CAAa5B,IAAb,CAAkB,oBAAlB,CAAd;UACQO,gBAAR,CAAyBsB,IAAIC,uBAA7B;UACQ7B,EAAR,CAAW,QAAX,EAAqB,aAAK;KACvB8B,eAAF;OACI7B,UAAU8B,EAAEC,EAAEC,aAAJ,CAAd;WACQC,YAAR;OACI,CAACjC,QAAQK,gBAAR,CAAyB,UAAzB,CAAL,EAA2C;iBAC7Ba,OAAb,CAAqB;aACZO,aAAaS,gBADD;aAEZlC,QAAQmC,OAAR,CAAgB,eAAhB,EAAiCC,IAAjC,CAAsC,IAAtC,CAFY;aAGZ,cAHY;WAId,cAJc;iBAKRX,aAAaY,cALL;qBAMJZ,aAAaZ,UANT;YAObb,QAAQiB,GAAR;KAPR,EAQGE,IARH,CAQQ,UAAUmB,YAAV,EAAwB;SAC3BA,aAAaC,MAAjB,EAAyB;uBACPC,WAAjB,CAA6B,EAAEC,MAAMd,IAAIe,UAAJ,CAAe,mBAAf,CAAR,EAA6CC,MAAM,SAAnD,EAA7B;;KAVF;;GALF;EALF;yBA0ByB,kCAAY;OAC9BC,MAAL;OACKC,qBAAL;;CAxEH"}