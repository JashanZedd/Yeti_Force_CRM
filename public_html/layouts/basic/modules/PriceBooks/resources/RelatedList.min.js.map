{"version":3,"file":"RelatedList.min.js","sources":["RelatedList.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_RelatedList_Js(\n\t'PriceBooks_RelatedList_Js',\n\t{\n\t\ttriggerMassMargin: function() {\n\t\t\tconst self = Vtiger_RelatedList_Js.relatedListInstance;\n\t\t\tif (self.checkListRecordSelected() !== true) {\n\t\t\t\tlet selectedIds = self.readSelectedIds(true);\n\t\t\t\tapp.showModalWindow({\n\t\t\t\t\turl: 'index.php?module=PriceBooks&view=SpecifyMargin',\n\t\t\t\t\tcb: modalContainer => {\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', e => {\n\t\t\t\t\t\t\tlet element = modalContainer.find('.js-margin');\n\t\t\t\t\t\t\tlet resultOfValidation = Vtiger_NumberUserFormat_Validator_Js.invokeValidation(element);\n\t\t\t\t\t\t\tif (typeof resultOfValidation !== 'undefined') {\n\t\t\t\t\t\t\t\telement.validationEngine('showPrompt', resultOfValidation, '', 'topLeft', true);\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telement.validationEngine('hideAll');\n\t\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\t\t\t\t\tmode: 'specifyMargin',\n\t\t\t\t\t\t\t\t\trelatedModule: self.moduleName,\n\t\t\t\t\t\t\t\t\tselected_ids: selectedIds,\n\t\t\t\t\t\t\t\t\trecord: self.getParentId(),\n\t\t\t\t\t\t\t\t\tmargin: element.val()\n\t\t\t\t\t\t\t\t}).done(response => {\n\t\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\t\tVtiger_Detail_Js.reloadRelatedList();\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.noRecordSelectedAlert();\n\t\t\t}\n\t\t}\n\t},\n\t{\n\t\tregisterEditListPrice: function() {\n\t\t\tlet thisInstance = this;\n\t\t\tlet element = this.content.find('.js-edit-listprice');\n\t\t\telement.validationEngine(app.validationEngineOptions);\n\t\t\telement.on('change', e => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tlet element = $(this);\n\t\t\t\telement.formatNumber();\n\t\t\t\tif (!element.validationEngine('validate')) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: thisInstance.parentModuleName,\n\t\t\t\t\t\trecord: element.closest('.js-list__row').data('id'),\n\t\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\t\tmode: 'addListPrice',\n\t\t\t\t\t\tsrc_record: thisInstance.parentRecordId,\n\t\t\t\t\t\trelated_module: thisInstance.moduleName,\n\t\t\t\t\t\tprice: element.val()\n\t\t\t\t\t}).done(function(responseData) {\n\t\t\t\t\t\tif (responseData.result) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({ text: app.vtranslate('JS_SAVE_NOTIFY_OK'), type: 'success' });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterPostLoadEvents: function() {\n\t\t\tthis._super();\n\t\t\tthis.registerEditListPrice();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_RelatedList_Js","triggerMassMargin","relatedListInstance","checkListRecordSelected","self","readSelectedIds","app","showModalWindow","url","cb","modalContainer","find","on","resultOfValidation","Vtiger_NumberUserFormat_Validator_Js","invokeValidation","element","validationEngine","AppConnector","request","module","getModuleName","action","mode","relatedModule","moduleName","selected_ids","selectedIds","record","getParentId","margin","val","done","response","success","Vtiger_Detail_Js","reloadRelatedList","hideModalWindow","e","preventDefault","noRecordSelectedAlert","registerEditListPrice","thisInstance","content","validationEngineOptions","stopPropagation","$","formatNumber","parentModuleName","closest","data","src_record","parentRecordId","related_module","price","responseData","result","Vtiger_Helper_Js","showPnotify","text","vtranslate","type","registerPostLoadEvents","_super"],"mappings":";;AAGAA,sBACC,2BADD,CAEC,CACCC,kBAAmB,4BAAW,CAC7B,SAAaD,sBAAsBE,mBAAnC,CACA,GAAI,UAAKC,uBAAL,EAAJ,CAA6C,CAC5C,gBAAkBC,KAAKC,eAAL,IAAlB,CACAC,IAAIC,eAAJ,CAAoB,CACnBC,IAAK,gDADc,CAEnBC,GAAI,2BAAkB,CACrBC,eAAeC,IAAf,CAAoB,iBAApB,EAAuCC,EAAvC,CAA0C,OAA1C,CAAmD,WAAK,aACzCF,eAAeC,IAAf,CAAoB,YAApB,CADyC,CAEnDE,mBAAqBC,qCAAqCC,gBAArC,CAAsDC,OAAtD,CAF8B,CAuBvD,OApBkC,WAA9B,2BAoBJ,EAhBCA,QAAQC,gBAAR,CAAyB,SAAzB,CAgBD,CAfCC,aAAaC,OAAb,CAAqB,CACpBC,OAAQd,IAAIe,aAAJ,EADY,CAEpBC,OAAQ,cAFY,CAGpBC,KAAM,eAHc,CAIpBC,cAAepB,KAAKqB,UAJA,CAKpBC,aAAcC,WALM,CAMpBC,OAAQxB,KAAKyB,WAAL,EANY,CAOpBC,OAAQd,QAAQe,GAAR,EAPY,CAArB,EAQGC,IARH,CAQQ,kBAAY,CACfC,SAASC,OADM,GAElBC,iBAAiBC,iBAAjB,EAFkB,CAGlB9B,IAAI+B,eAAJ,EAHkB,EAKnB,CAbD,CAeD,GAnBCrB,QAAQC,gBAAR,CAAyB,YAAzB,CAAuCJ,kBAAvC,CAA2D,EAA3D,CAA+D,SAA/D,IAmBD,CAlBCyB,EAAEC,cAAF,EAkBD,IACA,CAxBD,EAyBA,CA5BkB,CAApB,EA8BA,CAhCD,UAiCMC,qBAAL,GAED,CAtCF,CAFD,CA0CC,CACCC,sBAAuB,gCAAW,gBAC7BC,aAAe,IADc,CAE7B1B,QAAU,KAAK2B,OAAL,CAAahC,IAAb,CAAkB,oBAAlB,CAFmB,CAGjCK,QAAQC,gBAAR,CAAyBX,IAAIsC,uBAA7B,CAHiC,CAIjC5B,QAAQJ,EAAR,CAAW,QAAX,CAAqB,WAAK,CACzB0B,EAAEO,eAAF,EADyB,CAEzB,YAAcC,EAAE,KAAF,CAAd,CACA9B,QAAQ+B,YAAR,EAHyB,CAIpB/B,QAAQC,gBAAR,CAAyB,UAAzB,CAJoB,EAKxBC,aAAaC,OAAb,CAAqB,CACpBC,OAAQsB,aAAaM,gBADD,CAEpBpB,OAAQZ,QAAQiC,OAAR,CAAgB,eAAhB,EAAiCC,IAAjC,CAAsC,IAAtC,CAFY,CAGpB5B,OAAQ,cAHY,CAIpBC,KAAM,cAJc,CAKpB4B,WAAYT,aAAaU,cALL,CAMpBC,eAAgBX,aAAajB,UANT,CAOpB6B,MAAOtC,QAAQe,GAAR,EAPa,CAArB,EAQGC,IARH,CAQQ,SAASuB,YAAT,CAAuB,CAC1BA,aAAaC,MADa,EAE7BC,iBAAiBC,WAAjB,CAA6B,CAAEC,KAAMrD,IAAIsD,UAAJ,CAAe,mBAAf,CAAR,CAA6CC,KAAM,SAAnD,CAA7B,EAED,CAZD,EAcD,CAnBD,EAoBA,CAzBF,CA0BCC,uBAAwB,iCAAW,CAClC,KAAKC,MAAL,EADkC,CAElC,KAAKtB,qBAAL,GACA,CA7BF,CA1CD"}