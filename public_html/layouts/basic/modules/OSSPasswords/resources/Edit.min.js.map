{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\"OSSPasswords_Edit_Js\", {}, {\n\t/**\n\t * Function to register recordpresave event\n\t */\n\tregisterRecordPreSaveEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tif (typeof form === \"undefined\") {\n\t\t\tform = this.getForm();\n\t\t}\n\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\tvar password = form.find('[name=\"password\"]').val();\n\t\t\tvar id = form.find('[name=\"record\"]').val();\n\t\t\tvar params = {};\n\t\t\tif (password === '**********') {\n\t\t\t\tparams = {};\n\t\t\t\tparams.data = {\n\t\t\t\t\tmodule: \"OSSPasswords\",\n\t\t\t\t\taction: \"GetPass\",\n\t\t\t\t\trecord: id\n\t\t\t\t};\n\t\t\t\tparams.async = false;\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tvar response = data['result'];\n\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\tvar el = document.getElementById(\"OSSPasswords_editView_fieldName_password\");\n\t\t\t\t\t\tel.value = response['password'];\n\t\t\t\t\t\tel.onchange();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// validate password\n\t\t\t\tPasswordHelper.passwordStrength('', '');\n\t\t\t}\n\t\t\tpassword = form.find('[name=\"password\"]').val();\n\t\t\tparams = {};\n\t\t\tparams.data = {module: 'OSSPasswords', action: 'CheckPass', 'password': password, 'id': id};\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.result.success === false) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\tsticker: false,\n\t\t\t\t\t\tsticker_hover: false,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\tthisInstance.sending = false;\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t} else if (data.result.success === true && (thisInstance.sending === undefined || !thisInstance.sending)) {\n\t\t\t\t\tthisInstance.sending = true;\n\t\t\t\t} else if (thisInstance.sending) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\n\t\t\t});\n\t\t});\n\t},\n\tgeneratePassword: function (e) {\n\t\tvar element = jQuery(e.currentTarget);\n\t\tvar form = element.closest('form');\n\t\tvar min = parseInt(jQuery('#minChars').val());\n\t\tvar max = parseInt(jQuery('#maxChars').val());\n\t\tvar allowedChars = jQuery('#allowedLetters').val();\n\t\tvar password = '';   // variable holding new password\n\t\t// array of allowed characters that will consist of password\n\t\t// if there there is something wrong build the password from only exclamation marks\n\t\tif (typeof (allowedChars) === \"undefined\")\n\t\t\tallowedChars = '!';\n\t\tvar chArray = allowedChars.split(',');\n\t\t// min length of a password\n\t\tif (typeof (min) === \"undefined\")\n\t\t\tmin = 10;   // default 10\n\t\t// max length of a password\n\t\tif (typeof (max) === \"undefined\")\n\t\t\tmax = 15;   // default 15\n\t\t// get the password length\n\t\tvar passlength = parseInt(Math.random() * (max - min) + min);\n\t\tvar i = 0;    // index for the loop\n\t\t// loop to get random string with *pass_length* characters\n\t\tfor (i = 0; i <= passlength; i++) {\n\t\t\tvar charIndex = parseInt(Math.random() * chArray.length);\n\t\t\tpassword += chArray[charIndex];\n\t\t}\n\t\t// get desired text field\n\t\tvar passForm = form.find('[name =\"password\"]');\n\t\t// change its value to the generated password\n\t\tpassForm.val(password);\n\t\tpassForm.trigger('change');\n\t},\n\tregisterButtonsEvents: function () {\n\t\tvar thisInstance = this;\n\t\t$('.js-generatePass').on('click', function (e) {\n\t\t\tthisInstance.generatePassword(e);\n\t\t});\n\t},\n\tregisterBasicEvents: function (container) {\n\t\tthis._super(container);\n\t\tthis.registerButtonsEvents();\n\t\tthis.registerRecordPreSaveEvent(container);\n\t}\n});\n"],"names":["Vtiger_Edit_Js","form","thisInstance","getForm","on","recordPreSave","e","data","password","find","val","id","params","async","request","done","response","el","document","getElementById","value","onchange","passwordStrength","module","action","dataType","result","success","message","showPnotify","sending","preventDefault","stopPropagation","undefined","element","jQuery","currentTarget","closest","min","parseInt","max","allowedChars","chArray","split","passlength","Math","random","i","charIndex","length","passForm","trigger","generatePassword","container","_super","registerButtonsEvents","registerRecordPreSaveEvent"],"mappings":"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"}