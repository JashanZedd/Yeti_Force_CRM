{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\"OSSPasswords_Edit_Js\", {}, {\n\t/**\n\t * Function to register recordpresave event\n\t */\n\tregisterRecordPreSaveEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tif (typeof form === \"undefined\") {\n\t\t\tform = this.getForm();\n\t\t}\n\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\tvar password = form.find('[name=\"password\"]').val();\n\t\t\tvar id = form.find('[name=\"record\"]').val();\n\t\t\tvar params = {};\n\t\t\tif (password === '**********') {\n\t\t\t\tparams = {};\n\t\t\t\tparams.data = {\n\t\t\t\t\tmodule: \"OSSPasswords\",\n\t\t\t\t\taction: \"GetPass\",\n\t\t\t\t\trecord: id\n\t\t\t\t};\n\t\t\t\tparams.async = false;\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tvar response = data['result'];\n\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\tvar el = document.getElementById(\"OSSPasswords_editView_fieldName_password\");\n\t\t\t\t\t\tel.value = response['password'];\n\t\t\t\t\t\tel.onchange();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// validate password\n\t\t\t\tPasswordHelper.passwordStrength('', '');\n\t\t\t}\n\t\t\tpassword = form.find('[name=\"password\"]').val();\n\t\t\tparams = {};\n\t\t\tparams.data = {module: 'OSSPasswords', action: 'CheckPass', 'password': password, 'id': id};\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.result.success === false) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\tsticker: false,\n\t\t\t\t\t\tsticker_hover: false,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\tthisInstance.sending = false;\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t} else if (data.result.success === true && (thisInstance.sending === undefined || !thisInstance.sending)) {\n\t\t\t\t\tthisInstance.sending = true;\n\t\t\t\t} else if (thisInstance.sending) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\n\t\t\t});\n\t\t});\n\t},\n\tgeneratePassword: function (e) {\n\t\tvar element = jQuery(e.currentTarget);\n\t\tvar form = element.closest('form');\n\t\tvar min = parseInt(jQuery('#minChars').val());\n\t\tvar max = parseInt(jQuery('#maxChars').val());\n\t\tvar allowedChars = jQuery('#allowedLetters').val();\n\t\tvar password = '';   // variable holding new password\n\t\t// array of allowed characters that will consist of password\n\t\t// if there there is something wrong build the password from only exclamation marks\n\t\tif (typeof (allowedChars) === \"undefined\")\n\t\t\tallowedChars = '!';\n\t\tvar chArray = allowedChars.split(',');\n\t\t// min length of a password\n\t\tif (typeof (min) === \"undefined\")\n\t\t\tmin = 10;   // default 10\n\t\t// max length of a password\n\t\tif (typeof (max) === \"undefined\")\n\t\t\tmax = 15;   // default 15\n\t\t// get the password length\n\t\tvar passlength = parseInt(Math.random() * (max - min) + min);\n\t\tvar i = 0;    // index for the loop\n\t\t// loop to get random string with *pass_length* characters\n\t\tfor (i = 0; i <= passlength; i++) {\n\t\t\tvar charIndex = parseInt(Math.random() * chArray.length);\n\t\t\tpassword += chArray[charIndex];\n\t\t}\n\t\t// get desired text field\n\t\tvar passForm = form.find('[name =\"password\"]');\n\t\t// change its value to the generated password\n\t\tpassForm.val(password);\n\t\tpassForm.trigger('change');\n\t},\n\tregisterButtonsEvents: function () {\n\t\tvar thisInstance = this;\n\t\t$('.js-generatePass').on('click', function (e) {\n\t\t\tthisInstance.generatePassword(e);\n\t\t});\n\t},\n\tregisterBasicEvents: function (container) {\n\t\tthis._super(container);\n\t\tthis.registerButtonsEvents();\n\t\tthis.registerRecordPreSaveEvent(container);\n\t}\n});\n"],"names":["Vtiger_Edit_Js","form","thisInstance","this","getForm","on","recordPreSave","e","data","password","find","val","id","params","async","request","done","response","el","document","getElementById","value","onchange","passwordStrength","module","action","dataType","result","success","message","showPnotify","sending","preventDefault","stopPropagation","undefined","jQuery","currentTarget","closest","min","parseInt","max","allowedChars","chArray","split","passlength","Math","random","i","length","passForm","trigger","generatePassword","container","_super","registerButtonsEvents","registerRecordPreSaveEvent"],"mappings":"aAGAA,eAAe,uBAAwB,GAAI,4BAId,SAAUC,UACjCC,aAAeC,UACC,IAATF,YACHE,KAAKC,gBAERC,GAAGL,eAAeM,eAAe,SAAUC,EAAGC,UAC9CC,SAAWR,KAAKS,KAAK,qBAAqBC,MAC1CC,GAAKX,KAAKS,KAAK,mBAAmBC,MAClCE,OAAS,GACI,eAAbJ,mBACM,IACFD,KAAO,QACL,sBACA,iBACAI,WAEFE,OAAQ,eACFC,QAAQF,QAAQG,MAAK,SAAUR,UACvCS,SAAWT,KAAA,UACXS,SAAA,QAAqB,KACpBC,GAAKC,SAASC,eAAe,+CAC9BC,MAAQJ,SAAA,YACRK,8BAIUC,iBAAiB,GAAI,cAE1BtB,KAAKS,KAAK,qBAAqBC,cACjC,IACFH,KAAO,CAACgB,OAAQ,eAAgBC,OAAQ,YAAahB,SAAYA,SAAUG,GAAMA,WACjFE,OAAQ,SACRY,SAAW,oBACLX,QAAQF,QAAQG,MAAK,SAAUR,UACf,IAAxBA,KAAKmB,OAAOC,QAAmB,KAC9Bf,OAAS,MACNL,KAAKmB,OAAOE,iBACT,iBACM,OACT,0BAEUC,YAAYjB,qBAChBkB,SAAU,IACrBC,mBACAC,uBACgC,IAAxBzB,KAAKmB,OAAOC,cAA8CM,IAAzBhC,aAAa6B,SAA0B7B,aAAa6B,QAErF7B,aAAa6B,YACrBC,mBACAC,gCAHWF,SAAU,0BAST,SAAUxB,OAEvBN,KADUkC,OAAO5B,EAAE6B,eACJC,QAAQ,QACvBC,IAAMC,SAASJ,OAAO,aAAaxB,OACnC6B,IAAMD,SAASJ,OAAO,aAAaxB,OACnC8B,aAAeN,OAAO,mBAAmBxB,MACzCF,SAAW,QAGe,IAAlBgC,eACXA,aAAe,SACZC,QAAUD,aAAaE,MAAM,UAEZ,IAATL,MACXA,IAAM,SAEc,IAATE,MACXA,IAAM,QAEHI,WAAaL,SAASM,KAAKC,UAAYN,IAAMF,KAAOA,KACpDS,EAAI,MAEHA,EAAI,EAAGA,GAAKH,WAAYG,IAAK,WAErBL,QADIH,SAASM,KAAKC,SAAWJ,QAAQM,aAI9CC,SAAWhD,KAAKS,KAAK,+BAEhBC,IAAIF,mBACJyC,QAAQ,iCAEK,eAClBhD,aAAeC,OACjB,oBAAoBE,GAAG,SAAS,SAAUE,gBAC9B4C,iBAAiB5C,2BAGX,SAAU6C,gBACzBC,OAAOD,gBACPE,6BACAC,2BAA2BH"}