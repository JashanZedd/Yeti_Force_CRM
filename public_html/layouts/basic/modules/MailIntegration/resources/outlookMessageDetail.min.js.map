{"version":3,"file":"outlookMessageDetail.min.js","sources":["outlookMessageDetail.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\nconst MailIntegration_Start = {\n\tiframe: {},\n\t/**\n\t * Set iframe element.\n\t */\n\tsetIframe() {\n\t\tthis.iframe = $('#js-iframe');\n\t},\n\t/**\n\t * Show detail view.\n\t *\n\t * @param   {object}  mailItem  Office mailbox.item\n\t */\n\tshowDetailView(mailItem) {\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\tview: 'Iframe',\n\t\t\t\t\tmailFrom: mailItem.from.emailAddress,\n\t\t\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\t\t\tmailSubject: mailItem.subject,\n\t\t\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t\t\t},\n\t\t\t\twindow.PanelParams\n\t\t\t)\n\t\t)\n\t\t\t.done(responseData => {\n\t\t\t\t$('#page').html(responseData);\n\t\t\t\tthis.registerLogoutEvents();\n\t\t\t})\n\t\t\t.fail(_ => {\n\t\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\t\ttype: 'errorMessage',\n\t\t\t\t\tmessage: app.vtranslate('JS_ERROR')\n\t\t\t\t});\n\t\t\t});\n\t},\n\t/**\n\t * Register logout events\n\t */\n\tregisterLogoutEvents() {\n\t\tthis.setIframe();\n\t\tlet reloadPanelAfterLogout = () => {\n\t\t\tif (!this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogout);\n\t},\n\t/**\n\t * Register login events.\n\t */\n\tregisterLoginEvents() {\n\t\tlet loader;\n\t\tlet reloadPanelAfterLogin = () => {\n\t\t\tif (this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t}\n\t\t};\n\t\tlet showLoader = () => {\n\t\t\tloader = $.progressIndicator({\n\t\t\t\tblockInfo: { enabled: true },\n\t\t\t\tmessage: false,\n\t\t\t\tblockOverlayCSS: {\n\t\t\t\t\t'background-color': 'white',\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogin);\n\t\t$(this.iframe[0].contentWindow).on('unload', showLoader);\n\t},\n\t/**\n\t * Is user logged in.\n\t *\n\t * @return  {boolean}\n\t */\n\tisUserLoggedIn() {\n\t\tlet iframeCONFIG = this.iframe[0].contentWindow.CONFIG;\n\t\treturn iframeCONFIG && iframeCONFIG.userId;\n\t},\n\t/**\n\t * Register events.\n\t *\n\t * @param   {object}  mailbox  Office mailbox\n\t */\n\tregisterEvents(mailbox) {\n\t\tif (!$('.js-exception-error').length) {\n\t\t\tthis.setIframe();\n\t\t\tif (this.iframe.data('view') === 'login') {\n\t\t\t\tthis.registerLoginEvents();\n\t\t\t} else {\n\t\t\t\tthis.showDetailView(mailbox.item);\n\t\t\t}\n\t\t}\n\t}\n};\nOffice.onReady(info => {\n\twindow.PanelParams = {\n\t\tsource: 'Outlook',\n\t\tdevice: Office.context.mailbox.diagnostics.hostName\n\t};\n\tif (info.host === Office.HostType.Outlook) {\n\t\tMailIntegration_Start.registerEvents(Office.context.mailbox);\n\t}\n});\n"],"names":["MailIntegration_Start","iframe","$","mailItem","request","extend","from","emailAddress","sender","subject","normalizedSubject","internetMessageId","dateTimeCreated","toISOString","window","PanelParams","done","html","responseData","registerLogoutEvents","fail","context","mailbox","item","notificationMessages","replaceAsync","app","vtranslate","setIframe","on","_this2","isUserLoggedIn","location","reload","loader","_this3","progressIndicator","mode","this","contentWindow","enabled","iframeCONFIG","CONFIG","userId","length","data","registerLoginEvents","showDetailView","Office","onReady","diagnostics","hostName","info","host","HostType","Outlook","registerEvents"],"mappings":"aAEA,IAAMA,sBAAwB,QACrB,6BAKFC,OAASC,EAAE,uCAOFC,sCACDC,QACZF,EAAEG,OACD,QACS,uBACF,kBACIF,SAASG,KAAKC,wBACZJ,SAASK,OAAOD,yBACfJ,SAASM,8BACCN,SAASO,gCACjBP,SAASQ,sCACHR,SAASS,gBAAgBC,eAE/CC,OAAOC,cAGPC,MAAK,yBACH,SAASC,KAAKC,oBACXC,0BAELC,MAAK,mBACEC,QAAQC,QAAQC,KAAKC,qBAAqBC,aAAa,QAAS,MAChE,uBACGC,IAAIC,WAAW,uEAQtBC,iBAMA3B,OAAO4B,GAAG,QALc,WACvBC,OAAKC,yBACFC,SAASC,4DASdC,mBAkBCjC,OAAO4B,GAAG,QAjBa,WACvBM,OAAKJ,wBACDC,SAASC,gBAETG,kBAAkB,CAAEC,KAAM,cAcjCC,KAAKrC,OAAO,GAAGsC,eAAeV,GAAG,UAXlB,kBACP3B,EAAEkC,kBAAkB,WACjB,CAAEI,SAAS,YACb,kBACQ,oBACI,gBACX,uCAaRC,aAAeH,KAAKrC,OAAO,GAAGsC,cAAcG,cACzCD,cAAgBA,aAAaE,gCAOtBrB,SACTpB,EAAE,uBAAuB0C,cACxBhB,YAC4B,UAA7BU,KAAKrC,OAAO4C,KAAK,aACfC,2BAEAC,eAAezB,QAAQC,SAKhCyB,OAAOC,SAAQ,sBACPlC,YAAc,QACZ,iBACAiC,OAAO3B,QAAQC,QAAQ4B,YAAYC,UAExCC,KAAKC,OAASL,OAAOM,SAASC,+BACXC,eAAeR,OAAO3B,QAAQC"}