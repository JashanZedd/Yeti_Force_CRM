{"version":3,"file":"outlookMessageDetail.min.js","sources":["outlookMessageDetail.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\nconst MailIntegration_Start = {\n\tiframe: {},\n\t/**\n\t * Set iframe element.\n\t */\n\tsetIframe() {\n\t\tthis.iframe = $('#js-iframe');\n\t},\n\t/**\n\t * Show detail view.\n\t *\n\t * @param   {object}  mailItem  Office mailbox.item\n\t */\n\tshowDetailView(mailItem) {\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\tview: 'Iframe',\n\t\t\t\t\tmailFrom: mailItem.from.emailAddress,\n\t\t\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\t\t\tmailSubject: mailItem.subject,\n\t\t\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t\t\t},\n\t\t\t\twindow.PanelParams\n\t\t\t)\n\t\t)\n\t\t\t.done(responseData => {\n\t\t\t\t$('#page').html(responseData);\n\t\t\t\tthis.registerLogoutEvents();\n\t\t\t})\n\t\t\t.fail(_ => {\n\t\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\t\ttype: 'errorMessage',\n\t\t\t\t\tmessage: app.vtranslate('JS_ERROR')\n\t\t\t\t});\n\t\t\t});\n\t},\n\t/**\n\t * Register logout events\n\t */\n\tregisterLogoutEvents() {\n\t\tthis.setIframe();\n\t\tlet reloadPanelAfterLogout = () => {\n\t\t\tif (!this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogout);\n\t},\n\t/**\n\t * Register login events.\n\t */\n\tregisterLoginEvents() {\n\t\tlet loader;\n\t\tlet reloadPanelAfterLogin = () => {\n\t\t\tif (this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t}\n\t\t};\n\t\tlet showLoader = () => {\n\t\t\tloader = $.progressIndicator({\n\t\t\t\tblockInfo: { enabled: true },\n\t\t\t\tmessage: false,\n\t\t\t\tblockOverlayCSS: {\n\t\t\t\t\t'background-color': 'white',\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogin);\n\t\t$(this.iframe[0].contentWindow).on('unload', showLoader);\n\t},\n\t/**\n\t * Is user logged in.\n\t *\n\t * @return  {boolean}\n\t */\n\tisUserLoggedIn() {\n\t\tlet iframeCONFIG = this.iframe[0].contentWindow.CONFIG;\n\t\treturn iframeCONFIG && iframeCONFIG.userId;\n\t},\n\t/**\n\t * Register events.\n\t *\n\t * @param   {object}  mailbox  Office mailbox\n\t */\n\tregisterEvents(mailbox) {\n\t\tif (!$('.js-exception-error').length) {\n\t\t\tthis.setIframe();\n\t\t\tif (this.iframe.data('view') === 'login') {\n\t\t\t\tthis.registerLoginEvents();\n\t\t\t} else {\n\t\t\t\tthis.showDetailView(mailbox.item);\n\t\t\t}\n\t\t}\n\t}\n};\nOffice.onReady(info => {\n\twindow.PanelParams = {\n\t\tsource: 'Outlook',\n\t\tdevice: Office.context.mailbox.diagnostics.hostName\n\t};\n\tif (info.host === Office.HostType.Outlook) {\n\t\tMailIntegration_Start.registerEvents(Office.context.mailbox);\n\t}\n});\n"],"names":["MailIntegration_Start","iframe","$","mailItem","request","extend","from","emailAddress","sender","subject","normalizedSubject","internetMessageId","dateTimeCreated","toISOString","window","PanelParams","done","html","responseData","registerLogoutEvents","fail","context","mailbox","item","notificationMessages","replaceAsync","app","vtranslate","setIframe","reloadPanelAfterLogout","isUserLoggedIn","location","reload","on","loader","reloadPanelAfterLogin","progressIndicator","mode","showLoader","enabled","contentWindow","iframeCONFIG","CONFIG","userId","length","data","registerLoginEvents","showDetailView","Office","onReady","diagnostics","hostName","info","host","HostType","Outlook","registerEvents"],"mappings":";;AAAA;;AAEA,IAAMA,wBAAwB;SACrB,EADqB;;;;UAAA,uBAKjB;OACNC,MAAL,GAAcC,EAAE,YAAF,CAAd;EAN4B;;;;;;;eAAA,0BAadC,QAbc,EAaJ;;;eACXC,OAAb,CACCF,EAAEG,MAAF,CACC;WACS,iBADT;SAEO,QAFP;aAGWF,SAASG,IAAT,CAAcC,YAHzB;eAIaJ,SAASK,MAAT,CAAgBD,YAJ7B;gBAKcJ,SAASM,OALvB;0BAMwBN,SAASO,iBANjC;kBAOgBP,SAASQ,iBAPzB;wBAQsBR,SAASS,eAAT,CAAyBC,WAAzB;GATvB,EAWCC,OAAOC,WAXR,CADD,EAeEC,IAfF,CAeO,wBAAgB;KACnB,OAAF,EAAWC,IAAX,CAAgBC,YAAhB;SACKC,oBAAL;GAjBF,EAmBEC,IAnBF,CAmBO,aAAK;UACHC,OAAP,CAAeC,OAAf,CAAuBC,IAAvB,CAA4BC,oBAA5B,CAAiDC,YAAjD,CAA8D,OAA9D,EAAuE;UAChE,cADgE;aAE7DC,IAAIC,UAAJ,CAAe,UAAf;IAFV;GApBF;EAd4B;;;;;qBAAA,kCA2CN;;;OACjBC,SAAL;MACIC,yBAAyB,SAAzBA,sBAAyB,GAAM;OAC9B,CAAC,OAAKC,cAAL,EAAL,EAA4B;WACpBC,QAAP,CAAgBC,MAAhB;;GAFF;OAKK/B,MAAL,CAAYgC,EAAZ,CAAe,MAAf,EAAuBJ,sBAAvB;EAlD4B;;;;;oBAAA,iCAuDP;;;MACjBK,eAAJ;MACIC,wBAAwB,SAAxBA,qBAAwB,GAAM;OAC7B,OAAKL,cAAL,EAAJ,EAA2B;WACnBC,QAAP,CAAgBC,MAAhB;IADD,MAEO;WACCI,iBAAP,CAAyB,EAAEC,MAAM,MAAR,EAAzB;;GAJF;MAOIC,aAAa,SAAbA,UAAa,GAAM;YACbpC,EAAEkC,iBAAF,CAAoB;eACjB,EAAEG,SAAS,IAAX,EADiB;aAEnB,KAFmB;qBAGX;yBACI,OADJ;cAEP;;IALF,CAAT;GADD;OAUKtC,MAAL,CAAYgC,EAAZ,CAAe,MAAf,EAAuBE,qBAAvB;IACE,KAAKlC,MAAL,CAAY,CAAZ,EAAeuC,aAAjB,EAAgCP,EAAhC,CAAmC,QAAnC,EAA6CK,UAA7C;EA3E4B;;;;;;;eAAA,4BAkFZ;MACZG,eAAe,KAAKxC,MAAL,CAAY,CAAZ,EAAeuC,aAAf,CAA6BE,MAAhD;SACOD,gBAAgBA,aAAaE,MAApC;EApF4B;;;;;;;eAAA,0BA2FdrB,OA3Fc,EA2FL;MACnB,CAACpB,EAAE,qBAAF,EAAyB0C,MAA9B,EAAsC;QAChChB,SAAL;OACI,KAAK3B,MAAL,CAAY4C,IAAZ,CAAiB,MAAjB,MAA6B,OAAjC,EAA0C;SACpCC,mBAAL;IADD,MAEO;SACDC,cAAL,CAAoBzB,QAAQC,IAA5B;;;;CAjGJ;AAsGAyB,OAAOC,OAAP,CAAe,gBAAQ;QACflC,WAAP,GAAqB;UACZ,SADY;UAEZiC,OAAO3B,OAAP,CAAeC,OAAf,CAAuB4B,WAAvB,CAAmCC;EAF5C;KAIIC,KAAKC,IAAL,KAAcL,OAAOM,QAAP,CAAgBC,OAAlC,EAA2C;wBACpBC,cAAtB,CAAqCR,OAAO3B,OAAP,CAAeC,OAApD;;CANF"}