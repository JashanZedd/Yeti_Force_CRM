{"version":3,"file":"outlookMessageDetail.min.js","sources":["outlookMessageDetail.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\nwindow.MailIntegration_Start = {\n\tiframe: {},\n\t/**\n\t * Set iframe element.\n\t */\n\tsetIframe() {\n\t\tthis.iframe = $('#js-iframe');\n\t},\n\t/**\n\t * Show detail view.\n\t *\n\t * @param   {object}  mailItem  Office mailbox.item\n\t */\n\tshowDetailView(mailItem) {\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\tview: 'Iframe',\n\t\t\t\t\tmailFrom: mailItem.from.emailAddress,\n\t\t\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\t\t\tmailSubject: mailItem.subject,\n\t\t\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t\t\t},\n\t\t\t\twindow.PanelParams\n\t\t\t)\n\t\t)\n\t\t\t.done((responseData) => {\n\t\t\t\t$('#page').html(responseData);\n\t\t\t\tthis.registerLogoutEvents();\n\t\t\t})\n\t\t\t.fail((_) => {\n\t\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\t\ttype: 'errorMessage',\n\t\t\t\t\tmessage: app.vtranslate('JS_ERROR')\n\t\t\t\t});\n\t\t\t});\n\t},\n\t/**\n\t * Register logout events\n\t */\n\tregisterLogoutEvents() {\n\t\tthis.setIframe();\n\t\tlet reloadPanelAfterLogout = () => {\n\t\t\tif (!this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogout);\n\t},\n\t/**\n\t * Register login events.\n\t */\n\tregisterLoginEvents() {\n\t\tlet loader;\n\t\tlet reloadPanelAfterLogin = () => {\n\t\t\tif (this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t}\n\t\t};\n\t\tlet showLoader = () => {\n\t\t\tloader = $.progressIndicator({\n\t\t\t\tblockInfo: { enabled: true },\n\t\t\t\tmessage: false,\n\t\t\t\tblockOverlayCSS: {\n\t\t\t\t\t'background-color': 'white',\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogin);\n\t\t$(this.iframe[0].contentWindow).on('unload', showLoader);\n\t\tlet src = this.iframe[0].getAttribute('src-a');\n\t\tif (src && this.iframe[0].getAttribute('src') == undefined) {\n\t\t\tthis.iframe[0].removeAttribute('src-a');\n\t\t\tthis.iframe[0].setAttribute('src', src);\n\t\t}\n\t},\n\t/**\n\t * Is user logged in.\n\t *\n\t * @return  {boolean}\n\t */\n\tisUserLoggedIn() {\n\t\treturn !(\n\t\t\tthis.iframe[0].contentWindow.document.body.dataset.module == 'Users' &&\n\t\t\tthis.iframe[0].contentWindow.document.body.dataset.view == 'Login'\n\t\t);\n\t},\n\tshowConsole() {\n\t\tlet s = '';\n\t\tlet x = '';\n\t\tfor (var p in navigator) {\n\t\t\ts += p + ' : ' + navigator[p] + '<br>';\n\t\t\tx += p + ' : ' + navigator[p] + '\\n';\n\t\t}\n\t\tconsole.log(x);\n\t\tdocument.body.innerHTML +=\n\t\t\t'<div style=\"position:absolute;width:100%;height:100%;z-index:100;background:#fff;left: 0px; top: 50%;overflow-y: auto;\">' +\n\t\t\ts +\n\t\t\t'</div>';\n\t},\n\t/**\n\t * Register events.\n\t *\n\t * @param   {object}  mailbox  Office mailbox\n\t */\n\tregisterEvents(mailbox) {\n\t\t//this.showConsole();\n\t\tif (!$('.js-exception-error').length) {\n\t\t\tthis.setIframe();\n\t\t\tif (this.iframe.data('view') === 'login') {\n\t\t\t\tthis.registerLoginEvents();\n\t\t\t} else {\n\t\t\t\tthis.showDetailView(mailbox.item);\n\t\t\t}\n\t\t}\n\t},\n\treloadView(data) {\n\t\twindow.MailIntegration_Start.showDetailView(Office.context.mailbox.item);\n\t}\n};\nif (typeof Office === 'undefined') {\n\tapp.showNotify({\n\t\ttitle: app.vtranslate('JS_ERROR'),\n\t\ttype: 'error'\n\t});\n} else {\n\tOffice.onReady((info) => {\n\t\twindow.PanelParams = {\n\t\t\tsource: 'Outlook',\n\t\t\tdevice: Office.context.mailbox.diagnostics.hostName\n\t\t};\n\t\tif (info.host === Office.HostType.Outlook) {\n\t\t\twindow.MailIntegration_Start.registerEvents(Office.context.mailbox);\n\t\t\tOffice.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, window.MailIntegration_Start.reloadView);\n\t\t}\n\t});\n}\n"],"names":["window","MailIntegration_Start","iframe","setIframe","$","showDetailView","mailItem","AppConnector","request","extend","module","view","mailFrom","from","emailAddress","mailSender","sender","mailSubject","subject","mailNormalizedSubject","normalizedSubject","mailMessageId","internetMessageId","mailDateTimeCreated","dateTimeCreated","toISOString","PanelParams","done","responseData","html","registerLogoutEvents","fail","Office","context","mailbox","item","notificationMessages","replaceAsync","type","message","app","vtranslate","on","isUserLoggedIn","location","reload","registerLoginEvents","loader","reloadPanelAfterLogin","progressIndicator","mode","contentWindow","showLoader","blockInfo","enabled","blockOverlayCSS","opacity","getAttribute","src","removeAttribute","setAttribute","document","body","dataset","showConsole","x","s","p","navigator","console","log","innerHTML","registerEvents","length","data","reloadView","showNotify","title","onReady","info","source","device","diagnostics","hostName","host","HostType","Outlook","addHandlerAsync","EventType","ItemChanged"],"mappings":"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"}