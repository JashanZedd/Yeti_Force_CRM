'use strict';

var MailIntegration_Compose={connector:function connector(request){var _this=this;return AppConnector.request(request).fail(function(){_this.showResponseMessage(!1);})},showResponseMessage:function showResponseMessage(success){var message=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'';success?Office.context.mailbox.item.notificationMessages.replaceAsync('information',{type:'informationalMessage',message:message,icon:'iconid',persistent:!1}):Office.context.mailbox.item.notificationMessages.replaceAsync('error',{type:'errorMessage',message:app.vtranslate('JS_ERROR')+' '+message});},registerAutocompleteTemplate:function registerAutocompleteTemplate(){$.widget('ui.autocomplete',$.ui.autocomplete,{_renderItem:function _renderItem(ul,item){return $(function listItemTemplate(user){return '\n\t\t\t\t\t\t\t<li class="c-search-item js-search-item">\n\t\t\t\t\t\t\t\t<div class="d-flex flex-nowrap">\n\t\t\t\t\t\t\t\t\t<div class="d-flex flex-wrap">\n\t\t\t\t\t\t\t\t\t\t<div class="u-font-size-14px">\n\t\t\t\t\t\t\t\t\t\t\t'+user.name+'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="c-search-item__mail small">\n\t\t\t\t\t\t\t\t\t\t\t'+user.mail+'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn-group flex-nowrap align-items-center">\n\t\t\t\t\t\t\t\t\t\t<button class="c-search-item__btn btn btn-xs btn-outline-primary" data-copy-target="cc">\n\t\t\t\t\t\t\t\t\t\t\t'+app.vtranslate('JS_CC')+'\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t<button class="c-search-item__btn btn btn-xs btn-outline-primary" data-copy-target="bcc">\n\t\t\t\t\t\t\t\t\t\t\t'+app.vtranslate('JS_BCC')+'\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>'}(item)).appendTo(ul)}});},registerAutocomplete:function registerAutocomplete(){return this.container.find('.js-search-input').autocomplete({delay:'600',minLength:'3',classes:{"ui-autocomplete":'mobile'},source:this.findEmail.bind(this),select:this.onSelectRecipient.bind(this)})},findEmail:function findEmail(request,callBack){this.connector({module:'MailIntegration',action:'Mail',mode:'findEmail',search:request.term}).done(function(responseData){var data=responseData.result.map(function(user){var userData=user.split(' <'),name=userData[0],mail=userData[1].slice(0,-1);return {name:name,mail:mail}});callBack(data);});},onSelectRecipient:function onSelectRecipient(_ref,_ref2){var toElement=_ref.toElement,item=_ref2.item,newRecipient=[{displayName:item.name,emailAddress:item.mail}],recipientsField=toElement.dataset.copyTarget?toElement.dataset.copyTarget:'to';this.copyRecipient(recipientsField,newRecipient);},copyRecipient:function copyRecipient(recipientsField,newRecipient){Office.context.mailbox.item[recipientsField].addAsync(newRecipient,function(result){result.error&&Office.context.mailbox.item.notificationMessages.replaceAsync('error',{type:'errorMessage',message:app.vtranslate('JS_ERROR')+' '+result.error});});},registerEvents:function registerEvents(){this.container=$('#page'),this.registerAutocompleteTemplate(),this.registerAutocomplete();}};(function(){Office.onReady(function(info){info.host===Office.HostType.Outlook&&MailIntegration_Compose.registerEvents();});})($);
//# sourceMappingURL=outlookMessageCompose.min.js.map
