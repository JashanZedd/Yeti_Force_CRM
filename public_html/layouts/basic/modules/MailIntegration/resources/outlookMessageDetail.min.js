'use strict';

Office.onReady(function(info){window.PanelParams={source:'Outlook',device:Office.context.mailbox.diagnostics.hostName},info.host===Office.HostType.Outlook&&MailIntegration_Start.registerEvents(Office.context.mailbox);});var MailIntegration_Start={iframe:{},setIframe:function setIframe(){this.iframe=$('#js-iframe');},showDetailView:function showDetailView(mailItem){var _this=this;AppConnector.request($.extend({module:'MailIntegration',view:'Iframe',mailFrom:mailItem.from.emailAddress,mailSender:mailItem.sender.emailAddress,mailSubject:mailItem.subject,mailNormalizedSubject:mailItem.normalizedSubject,mailMessageId:mailItem.internetMessageId,mailDateTimeCreated:mailItem.dateTimeCreated.toISOString()},window.PanelParams)).done(function(responseData){$('#page').html(responseData),_this.registerLogoutEvents();}).fail(function(){Office.context.mailbox.item.notificationMessages.replaceAsync('error',{type:'errorMessage',message:app.vtranslate('JS_ERROR')});});},registerLogoutEvents:function registerLogoutEvents(){var _this2=this;this.setIframe();this.iframe.on('load',function reloadPanelAfterLogout(){_this2.isUserLoggedIn()||window.location.reload();});},registerLoginEvents:function registerLoginEvents(){var _this3=this,loader=void 0,reloadPanelAfterLogin=function(){_this3.isUserLoggedIn()?window.location.reload():loader.progressIndicator({mode:'hide'});};this.iframe.on('load',reloadPanelAfterLogin),$(this.iframe[0].contentWindow).on('unload',function showLoader(){loader=$.progressIndicator({blockInfo:{enabled:!0},message:!1,blockOverlayCSS:{"background-color":'white',opacity:1}});});},isUserLoggedIn:function isUserLoggedIn(){var iframeCONFIG=this.iframe[0].contentWindow.CONFIG;return iframeCONFIG&&iframeCONFIG.userId},registerEvents:function registerEvents(mailbox){this.setIframe(),'login'===this.iframe.data('view')?this.registerLoginEvents():this.showDetailView(mailbox.item);}};
//# sourceMappingURL=outlookMessageDetail.min.js.map
