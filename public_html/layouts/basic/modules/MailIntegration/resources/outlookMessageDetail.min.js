"use strict";var MailIntegration_Start={iframe:{},setIframe:function(){this.iframe=$("#js-iframe")},showDetailView:function(mailItem){var _this=this;AppConnector.request($.extend({module:"MailIntegration",view:"Iframe",mailFrom:mailItem.from.emailAddress,mailSender:mailItem.sender.emailAddress,mailSubject:mailItem.subject,mailNormalizedSubject:mailItem.normalizedSubject,mailMessageId:mailItem.internetMessageId,mailDateTimeCreated:mailItem.dateTimeCreated.toISOString()},window.PanelParams)).done((function(responseData){$("#page").html(responseData),_this.registerLogoutEvents()})).fail((function(_){Office.context.mailbox.item.notificationMessages.replaceAsync("error",{type:"errorMessage",message:app.vtranslate("JS_ERROR")})}))},registerLogoutEvents:function(){var _this2=this;this.setIframe();this.iframe.on("load",(function(){_this2.isUserLoggedIn()||window.location.reload()}))},registerLoginEvents:function(){var _this3=this,loader=void 0;this.iframe.on("load",(function(){_this3.isUserLoggedIn()?window.location.reload():loader.progressIndicator({mode:"hide"})})),$(this.iframe[0].contentWindow).on("unload",(function(){loader=$.progressIndicator({blockInfo:{enabled:!0},message:!1,blockOverlayCSS:{"background-color":"white",opacity:1}})}))},isUserLoggedIn:function(){var iframeCONFIG=this.iframe[0].contentWindow.CONFIG;return iframeCONFIG&&iframeCONFIG.userId},registerEvents:function(mailbox){$(".js-exception-error").length||(this.setIframe(),"login"===this.iframe.data("view")?this.registerLoginEvents():this.showDetailView(mailbox.item))}};Office.onReady((function(info){window.PanelParams={source:"Outlook",device:Office.context.mailbox.diagnostics.hostName},info.host===Office.HostType.Outlook&&MailIntegration_Start.registerEvents(Office.context.mailbox)}));
//# sourceMappingURL=outlookMessageDetail.min.js.map
