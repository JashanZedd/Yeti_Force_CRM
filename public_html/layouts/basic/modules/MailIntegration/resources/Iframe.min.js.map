{"version":3,"file":"Iframe.min.js","sources":["Iframe.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\"use strict\";\n\nconst MailIntegration_Iframe = {\n\tmailId: 0,\n\tcontainer: {},\n\tiframe: {},\n\tiframeWindow: {},\n\tmoduleSelect: {},\n\taddRecordBtn: {},\n\tloaderParams: {\n\t\tblockInfo: { enabled: true },\n\t\tmessage: false\n\t},\n\t/**\n\t * AppConnector wrapper\n\t *\n\t * @param   {object}  request\n\t *\n\t * @return  {object}           AppConnector object with done method\n\t */\n\tconnector(request) {\n\t\treturn AppConnector.request(request).fail(error => {\n\t\t\tthis.hideIframeLoader();\n\t\t\tthis.showResponseMessage(false);\n\t\t});\n\t},\n\t/**\n\t * Show response message\n\t *\n\t * @param   {boolean}  success\n\t * @param   {string}  message\n\t */\n\tshowResponseMessage(success, message = \"\") {\n\t\tif (success) {\n\t\t\tthis.mailItem.notificationMessages.replaceAsync(\"information\", {\n\t\t\t\ttype: \"informationalMessage\",\n\t\t\t\tmessage: message,\n\t\t\t\ticon: \"iconid\",\n\t\t\t\tpersistent: false\n\t\t\t});\n\t\t} else {\n\t\t\tthis.mailItem.notificationMessages.replaceAsync(\"error\", {\n\t\t\t\ttype: \"errorMessage\",\n\t\t\t\tmessage: app.vtranslate(\"JS_ERROR\") + \" \" + message\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Register list item events\n\t */\n\tregisterListItemEvents() {\n\t\tthis.container.on(\"click\", \".js-list-item-click\", this.onClickListItem.bind(this));\n\t\t$(document).on(\"click\", \".popover a\", this.onClickLink.bind(this));\n\t\tthis.container.on(\"click\", \".js-add-related-record\", this.onClickQuickCreateBtn.bind(this));\n\t\tthis.container.on(\"click\", \".js-remove-record\", this.onClickDeleteRelation.bind(this));\n\t},\n\t/**\n\t * On ListItem click actions\n\t *\n\t * @param   {[type]}  event  [event description]\n\t *\n\t * @return  {[type]}         [return description]\n\t */\n\tonClickListItem(event) {\n\t\tlet currentTarget = $(event.currentTarget);\n\t\tthis.toggleActiveListItems(currentTarget);\n\t\tthis.onClickLink(event, currentTarget.find(\".js-record-link\").attr(\"href\"));\n\t},\n\t/**\n\t * On link click\n\t *\n\t * @param   {object}  event  click event object\n\t * @param   {string}  url\n\t */\n\tonClickLink(event, url) {\n\t\tevent.preventDefault();\n\t\tif (!url) {\n\t\t\turl = $(event.currentTarget).attr(\"href\");\n\t\t}\n\t\tthis.changeIframeSource(url);\n\t},\n\t/**\n\t * On delete relation click\n\t *\n\t * @param   {object}  event  click event\n\t */\n\tonClickDeleteRelation(event) {\n\t\tevent.stopPropagation();\n\t\tconst currentTarget = $(event.currentTarget);\n\t\tconst recordData = currentTarget.closest(\".js-list-item-click\").data();\n\t\tthis.connector({\n\t\t\tmodule: \"MailIntegration\",\n\t\t\taction: \"Mail\",\n\t\t\tmode: \"deleteRelation\",\n\t\t\tmailId: this.mailId,\n\t\t\trecord: recordData.id,\n\t\t\trecordModule: recordData.module\n\t\t}).done(response => {\n\t\t\tthis.showResponseMessage(response[\"success\"], app.vtranslate(\"JS_REMOVED_RELATION_SUCCESSFULLY\"));\n\t\t\tthis.reloadView(response[\"success\"]);\n\t\t});\n\t},\n\t/**\n\t * On quick create btn click\n\t *\n\t * @param   {object}  event  click event\n\t */\n\tonClickQuickCreateBtn(event) {\n\t\tevent.stopPropagation();\n\t\tconst currentTarget = $(event.currentTarget);\n\t\tconst recordData = currentTarget.closest(\".js-list-item-click\").data();\n\t\tconst callbackFunction = () => {\n\t\t\tthis.iframeWindow.location.reload();\n\t\t};\n\t\tlet newRecordData = {\n\t\t\tsourceModule: recordData.module,\n\t\t\tsourceRecord: recordData.id\n\t\t};\n\t\tthis.showQuickCreateForm(event.currentTarget.dataset.module, {\n\t\t\tdata: newRecordData,\n\t\t\tcallbackFunction\n\t\t});\n\t},\n\t/**\n\t * Fill new record data in quick create form\n\t *\n\t * @param   {string}  moduleName  [moduleName description]\n\t *\n\t * @return  {object}              call asyncGetMailBody which returns Promise\n\t */\n\tfillNewRecordData(moduleName) {\n\t\tconst data = {\n\t\t\temail: this.mailItem.from.emailAddress,\n\t\t\temail1: this.mailItem.from.emailAddress,\n\t\t\trelationOperation: true,\n\t\t\trelatedRecords: $.map(this.container.find(\".js-list-item-click\"), record => {\n\t\t\t\treturn { module: record.dataset.module, id: record.dataset.id };\n\t\t\t})\n\t\t};\n\t\tconst fillNameFields = () => {\n\t\t\tconst nameData = this.mailItem.from.displayName.split(\" \");\n\t\t\tconst firstName = nameData.shift();\n\t\t\tconst lastName = nameData.join(\" \");\n\t\t\tdata.firstname = firstName;\n\t\t\tdata.lastname = lastName;\n\t\t};\n\t\tswitch (moduleName) {\n\t\t\tcase \"Leads\":\n\t\t\t\tdata.company = this.mailItem.from.displayName;\n\t\t\t\tfillNameFields();\n\t\t\t\tbreak;\n\t\t\tcase \"Contacts\":\n\t\t\t\tfillNameFields();\n\t\t\t\tbreak;\n\t\t\tcase \"Project\":\n\t\t\t\tdata.projectname = this.mailItem.subject;\n\t\t\t\tbreak;\n\t\t\tcase \"HelpDesk\":\n\t\t\t\tdata.ticket_title = this.mailItem.subject;\n\t\t\t\tbreak;\n\t\t\tcase \"Products\":\n\t\t\t\tdata.productname = this.mailItem.subject;\n\t\t\t\tbreak;\n\t\t\tcase \"Services\":\n\t\t\t\tdata.servicename = this.mailItem.subject;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\tconst mailBodyCallback = body => {\n\t\t\tdata.description = body;\n\t\t\treturn data;\n\t\t};\n\t\treturn this.asyncGetMailBody(mailBodyCallback);\n\t},\n\t/**\n\t * Toggle active list items\n\t *\n\t * @param   {object}  targetListItem  jQuery\n\t */\n\ttoggleActiveListItems(targetListItem) {\n\t\ttargetListItem.siblings().removeClass(\"active\");\n\t\ttargetListItem.addClass(\"active\");\n\t},\n\t/**\n\t * Change iframe source\n\t *\n\t * @param   {string}  url\n\t */\n\tchangeIframeSource(url) {\n\t\tthis.iframe.attr(\"src\", url);\n\t\tthis.showIframeLoader();\n\t},\n\t/**\n\t * Add relation\n\t *\n\t * @param   {number}  recordId\n\t * @param   {string}  moduleName\n\t */\n\taddRelation(recordId, moduleName) {\n\t\tthis.connector({\n\t\t\tmodule: \"MailIntegration\",\n\t\t\taction: \"Mail\",\n\t\t\tmode: \"addRelation\",\n\t\t\tmailId: this.mailId,\n\t\t\trecord: recordId,\n\t\t\trecordModule: moduleName\n\t\t}).done(response => {\n\t\t\tthis.showResponseMessage(response[\"success\"], app.vtranslate(\"JS_ADDED_RELATION_SUCCESSFULLY\"));\n\t\t\tthis.reloadView(response[\"success\"]);\n\t\t});\n\t},\n\t/**\n\t * Show quick create form\n\t *\n\t * @param   {string}  moduleName\n\t * @param   {object}  quickCreateParams\n\t */\n\tshowQuickCreateForm(moduleName, quickCreateParams = {}) {\n\t\tquickCreateParams = Object.assign({ noCache: true, data: {} }, quickCreateParams);\n\t\tthis.fillNewRecordData(moduleName).then(data => {\n\t\t\tquickCreateParams.data = Object.assign(data, quickCreateParams.data);\n\t\t\tApp.Components.QuickCreate.createRecord(moduleName, quickCreateParams);\n\t\t});\n\t},\n\t/**\n\t * Register iframe events\n\t */\n\tregisterIframeEvents() {\n\t\tconst link = this.container.find(\".js-list-item-click\").first();\n\t\tthis.initIframeLoader();\n\t\tif (link.length) {\n\t\t\tlink.addClass(\"active\");\n\t\t\tthis.iframe.attr(\"src\", link.find(\".js-record-link\").attr(\"href\"));\n\t\t\tthis.iframe.on(\"load\", () => {\n\t\t\t\tthis.hideIframeLoader();\n\t\t\t});\n\t\t} else {\n\t\t\tthis.hideIframeLoader();\n\t\t}\n\t},\n\t/**\n\t * Register import click\n\t */\n\tregisterImportClick() {\n\t\tthis.container.on(\"click\", \".js-import-mail\", e => {\n\t\t\tthis.showIframeLoader();\n\t\t\tthis.getMailDetails().then(mails => {\n\t\t\t\tthis.connector(\n\t\t\t\t\tObject.assign(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmodule: \"MailIntegration\",\n\t\t\t\t\t\t\taction: \"Import\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmails,\n\t\t\t\t\t\twindow.PanelParams\n\t\t\t\t\t)\n\t\t\t\t).done(response => {\n\t\t\t\t\tthis.hideIframeLoader();\n\t\t\t\t\tthis.showResponseMessage(response[\"success\"], app.vtranslate(\"JS_IMPORT\"));\n\t\t\t\t\tthis.reloadView(response[\"success\"]);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Get mail details\n\t *\n\t * @return  {object}  Promise\n\t */\n\tgetMailDetails() {\n\t\tlet mailItem = this.mailItem;\n\t\tif (mailItem.attachments.length > 0) {\n\t\t\tlet outputString = \"\";\n\t\t\tfor (let i = 0; i < mailItem.attachments.length; i++) {\n\t\t\t\tlet attachment = mailItem.attachments[i];\n\t\t\t\toutputString += \"<BR>\" + i + \". Name: \";\n\t\t\t\toutputString += attachment.name;\n\t\t\t\toutputString += \"<BR>ID: \" + attachment.id;\n\t\t\t\toutputString += \"<BR>contentType: \" + attachment.contentType;\n\t\t\t\toutputString += \"<BR>size: \" + attachment.size;\n\t\t\t\toutputString += \"<BR>attachmentType: \" + attachment.attachmentType;\n\t\t\t\toutputString += \"<BR>isInline: \" + attachment.isInline;\n\t\t\t}\n\t\t}\n\t\tconst mailDetails = {\n\t\t\tmailFrom: this.parseEmailAddressDetails(mailItem.from),\n\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\tmailTo: this.parseEmailAddressDetails(mailItem.to),\n\t\t\tmailCc: this.parseEmailAddressDetails(mailItem.cc),\n\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\tmailSubject: mailItem.subject,\n\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t};\n\t\tconst mailBodyCallback = body => {\n\t\t\tmailDetails.mailBody = body;\n\t\t\treturn mailDetails;\n\t\t};\n\t\treturn this.asyncGetMailBody(mailBodyCallback);\n\t},\n\t/**\n\t * Get mail body async function\n\t *\n\t * @param   {function}  callback\n\t *\n\t * @return  {object}            Promise\n\t */\n\tasyncGetMailBody(callback) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.mailItem.body.getAsync(Office.CoercionType.Html, body => {\n\t\t\t\tif (body.status === \"succeeded\") {\n\t\t\t\t\tresolve(callback(body.value));\n\t\t\t\t} else {\n\t\t\t\t\treject(body);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Parse email address details\n\t *\n\t * @param   {object}  data\n\t *\n\t * @return  {string}        e-mail address\n\t */\n\tparseEmailAddressDetails(data) {\n\t\tlet fn = function(row) {\n\t\t\treturn row.emailAddress;\n\t\t};\n\t\tif ($.isArray(data)) {\n\t\t\tlet rows = [];\n\t\t\t$.each(data, function(index, value) {\n\t\t\t\trows[index] = fn(value);\n\t\t\t});\n\t\t\treturn rows;\n\t\t} else {\n\t\t\treturn fn(data);\n\t\t}\n\t},\n\t/**\n\t * Set iframe height\n\t */\n\tsetIframeHeight() {\n\t\tthis.iframe.height($(window).height() - this.iframe.offset().top);\n\t},\n\t/**\n\t * Show iframe loader\n\t */\n\tshowIframeLoader() {\n\t\tthis.iframeLoader.progressIndicator(this.loaderParams);\n\t},\n\t/**\n\t * Hide iframe loader\n\t */\n\thideIframeLoader() {\n\t\tthis.iframeLoader.progressIndicator({ mode: \"hide\" });\n\t},\n\t/**\n\t * Init iframe loader\n\t */\n\tinitIframeLoader() {\n\t\tthis.iframeLoader = $.progressIndicator(this.loaderParams);\n\t},\n\t/**\n\t * Register modules select\n\t */\n\tregisterModulesSelect() {\n\t\tthis.moduleSelect = App.Fields.Picklist.showSelect2ElementView(this.container.find(\".js-modules\"));\n\t\tthis.moduleSelect.on(\"change\", this.registerModulesSelectChange.bind(this));\n\t\tthis.container.find(\".js-select-record\").on(\"click\", e => {\n\t\t\tconst params = {\n\t\t\t\tmodule: this.moduleSelect[0].value,\n\t\t\t\tsrc_module: \"OSSMailView\"\n\t\t\t};\n\t\t\tapp.showRecordsList(params, (modal, instance) => {\n\t\t\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\t\t\tthis.addRelation(responseData.id, params.module);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register modules select change\n\t */\n\tregisterModulesSelectChange() {\n\t\tif (this.moduleSelect.select2(\"data\")[0].element.dataset.addRecord) {\n\t\t\tthis.addRecordBtn.removeClass(\"d-none\");\n\t\t} else {\n\t\t\tthis.addRecordBtn.addClass(\"d-none\");\n\t\t}\n\t},\n\t/**\n\t * Register add record\n\t */\n\tregisterAddRecord() {\n\t\tthis.addRecordBtn.on(\"click\", e => {\n\t\t\tconst moduleName = this.moduleSelect[0].value;\n\t\t\tconst callbackFunction = ({ result }) => {\n\t\t\t\tthis.addRelation(result._recordId, moduleName);\n\t\t\t};\n\t\t\tconst quickCreateParams = { callbackFunction };\n\t\t\tthis.showQuickCreateForm(moduleName, quickCreateParams);\n\t\t});\n\t},\n\t/**\n\t * Reload view\n\t */\n\treloadView(condition) {\n\t\tif (condition) {\n\t\t\twindow.location.reload();\n\t\t}\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tthis.container = $(\"#page\");\n\t\tthis.iframe = $(\"#js-iframe\");\n\t\tthis.iframeWindow = this.iframe[0].contentWindow;\n\t\tthis.addRecordBtn = this.container.find(\".js-add-record\");\n\t\tthis.mailId = this.container.find(\".js-iframe-container\").data(\"mailId\");\n\t\tthis.mailItem = Office.context.mailbox.item;\n\t\tif (this.iframe.length) {\n\t\t\tthis.registerListItemEvents();\n\t\t\tthis.registerIframeEvents();\n\t\t\tthis.setIframeHeight();\n\t\t\tif (this.mailId) {\n\t\t\t\tthis.registerModulesSelect();\n\t\t\t\tthis.registerAddRecord();\n\t\t\t} else {\n\t\t\t\tthis.registerImportClick();\n\t\t\t}\n\t\t}\n\t}\n};\n\n(function($) {\n\tMailIntegration_Iframe.registerEvents();\n})($);\n"],"names":["MailIntegration_Iframe","enabled","request","AppConnector","fail","hideIframeLoader","showResponseMessage","success","message","mailItem","notificationMessages","replaceAsync","app","vtranslate","container","on","onClickListItem","bind","document","onClickLink","onClickQuickCreateBtn","onClickDeleteRelation","event","currentTarget","$","toggleActiveListItems","find","attr","url","preventDefault","changeIframeSource","stopPropagation","recordData","closest","data","connector","mailId","id","module","done","response","reloadView","callbackFunction","iframeWindow","location","reload","newRecordData","showQuickCreateForm","dataset","moduleName","from","emailAddress","map","record","fillNameFields","nameData","displayName","split","firstName","shift","lastName","join","firstname","lastname","company","projectname","subject","ticket_title","productname","servicename","mailBodyCallback","description","body","asyncGetMailBody","targetListItem","siblings","removeClass","addClass","iframe","showIframeLoader","recordId","quickCreateParams","Object","assign","noCache","fillNewRecordData","then","Components","QuickCreate","createRecord","link","first","initIframeLoader","length","getMailDetails","mails","window","PanelParams","attachments","outputString","i","attachment","name","contentType","size","attachmentType","isInline","mailDetails","parseEmailAddressDetails","sender","to","cc","internetMessageId","normalizedSubject","dateTimeCreated","toISOString","mailBody","callback","Promise","resolve","reject","getAsync","Office","CoercionType","Html","status","value","fn","row","isArray","rows","each","index","height","offset","top","iframeLoader","progressIndicator","loaderParams","mode","moduleSelect","App","Fields","Picklist","showSelect2ElementView","registerModulesSelectChange","params","showRecordsList","modal","instance","setSelectEvent","responseData","e","addRelation","select2","element","addRecord","addRecordBtn","result","_recordId","condition","contentWindow","context","mailbox","item","registerListItemEvents","registerIframeEvents","setIframeHeight","registerModulesSelect","registerAddRecord","registerImportClick","registerEvents"],"mappings":"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"}