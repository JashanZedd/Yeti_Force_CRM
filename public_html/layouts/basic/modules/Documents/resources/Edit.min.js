"use strict";Vtiger_Edit_Js("Documents_Edit_Js",{},{INTERNAL_FILE_LOCATION_TYPE:"I",EXTERNAL_FILE_LOCATION_TYPE:"E",getMaxiumFileUploadingSize:function(container){return container.find(".maxUploadSize").data("value")},isFileLocationInternalType:function(fileLocationElement){return fileLocationElement.val()==this.INTERNAL_FILE_LOCATION_TYPE},isFileLocationExternalType:function(fileLocationElement){return fileLocationElement.val()==this.EXTERNAL_FILE_LOCATION_TYPE},convertFileSizeInToDisplayFormat:function(fileSizeInBytes){var i=-1;do{fileSizeInBytes/=1024,i++}while(fileSizeInBytes>1024);return Math.max(fileSizeInBytes,.1).toFixed(1)+[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"][i]},registerFileLocationTypeChangeEvent:function(container){var thisInstance=this;container.on("change",'select[name="filelocationtype"]',(function(e){var newFileNameElement,fileLocationTypeElement=container.find('[name="filelocationtype"]'),fileNameElement=container.find('[name="filename"]');newFileNameElement=thisInstance.isFileLocationInternalType(fileLocationTypeElement)?jQuery('<input type="file"/>'):jQuery('<input type="text" />');for(var oldElementAttributeList=fileNameElement.get(0).attributes,index=0;index<oldElementAttributeList.length;index++){var attributeObject=oldElementAttributeList[index];if("type"!=attributeObject.name&&"value"!=attributeObject.name&&"class"!=attributeObject.name){var value=attributeObject.value,className="";"data-fieldinfo"==attributeObject.name&&(value=JSON.parse(value),thisInstance.isFileLocationExternalType(fileLocationTypeElement)?(value.type="url",className="form-control"):value.type="file",value=JSON.stringify(value)),newFileNameElement.attr(attributeObject.name,value),newFileNameElement.addClass(className)}}fileNameElement.replaceWith(newFileNameElement);var uploadFileDetails=newFileNameElement.closest(".fieldValue").find(".uploadedFileDetails");thisInstance.isFileLocationExternalType(fileLocationTypeElement)?uploadFileDetails.addClass("d-none").removeClass("show"):uploadFileDetails.addClass("show").removeClass("d-none")}))},registerFileChangeEvent:function(container){var thisInstance=this;container.on("change",'input[name="filename"]',(function(e){if("text"===e.target.type)return!1;var element=container.find('[name="filename"]');if("file"===element.attr("type")){var uploadFileSizeHolder=element.closest(".fileUploadContainer").find(".uploadedFileSize"),fileSize=element.get(0).files[0].size;fileSize>thisInstance.getMaxiumFileUploadingSize(container)?(app.showAlert(app.vtranslate("JS_EXCEEDS_MAX_UPLOAD_SIZE")),element.val(""),uploadFileSizeHolder.text("")):uploadFileSizeHolder.text(thisInstance.convertFileSizeInToDisplayFormat(fileSize))}}))},quickCreateSave:function(form){var aDeferred=jQuery.Deferred(),formData=new FormData(form[0]),params=(form.find('[name="filelocationtype"]'),{url:"index.php",type:"POST",data:formData,processData:!1,contentType:!1});return AppConnector.request(params).done((function(data){aDeferred.resolve(data)})).fail((function(textStatus,errorThrown){aDeferred.reject(textStatus,errorThrown)})),aDeferred.promise()},registerBasicEvents:function(container){this._super(container),this.registerFileLocationTypeChangeEvent(container),this.registerFileChangeEvent(container)},registerEvents:function(){this._super()}});
//# sourceMappingURL=Edit.min.js.map
