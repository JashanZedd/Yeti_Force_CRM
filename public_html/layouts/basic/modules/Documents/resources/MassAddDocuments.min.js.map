{"version":3,"file":"MassAddDocuments.min.js","sources":["MassAddDocuments.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/**\n * Class Documents_MassAddDocuments_Js.\n * @type {window.Documents_MassAddDocuments_Js}\n */\nwindow.Documents_MassAddDocuments_Js = class Documents_MassAddDocuments_Js {\n\t/**\n\t * Create a class object\n\t * @param {jQuery} modal\n\t * @param {jQuery.Event} e\n\t */\n\tstatic register(modal, e) {\n\t\tconst self = new window[this.name]();\n\t\tself.registerEvents(modal, e);\n\t}\n\tregisterSubmit() {\n\t\tconst uploadButton = this.modal.find('#filesToUpload'),\n\t\t\ttemplate = this.modal.find('.fileContainer'),\n\t\t\tuploadContainer = this.modal.find('.uploadFileContainer');\n\t\tuploadButton.on('change', function () {\n\t\t\tuploadContainer.find('.fileItem').remove();\n\t\t\tlet files = uploadButton[0].files;\n\t\t\tfor (let file of files) {\n\t\t\t\tuploadContainer.append(template.html());\n\t\t\t\tuploadContainer.find('[name=\"nameFile[]\"]:last').val(file.name);\n\t\t\t}\n\t\t});\n\t\tthis.form.on('submit', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.submit();\n\t\t});\n\t}\n\t/**\n\t * Submit\n\t */\n\tsubmit() {\n\t\tlet moduleName = app.getModuleName(),\n\t\t\trecordId = app.getRecordId();\n\t\tif (this.modal.find('[name=\"sourceModule\"]').length > 0) {\n\t\t\tmoduleName = this.modal.find('[name=\"sourceModule\"]').val();\n\t\t}\n\t\tif (this.modal.find('[name=\"sourceRecord\"]').length > 0) {\n\t\t\trecordId = this.modal.find('[name=\"sourceRecord\"]').val();\n\t\t}\n\t\tapp.removeEmptyFilesInput(this.form[0]);\n\t\tlet formData = new FormData(this.form[0]);\n\t\tif (this.button.data('view') === 'Detail') {\n\t\t\tformData.append('createmode', 'link');\n\t\t\tformData.append('return_module', moduleName);\n\t\t\tformData.append('return_id', recordId);\n\t\t}\n\t\tconst progressIndicatorElement = $.progressIndicator({\n\t\t\tblockInfo: { enabled: true }\n\t\t});\n\t\tAppConnector.request({\n\t\t\turl: 'index.php',\n\t\t\ttype: 'POST',\n\t\t\tdata: formData,\n\t\t\tprocessData: false,\n\t\t\tcontentType: false\n\t\t}).done((response) => {\n\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\tapp.hideModalWindow(null, this.modal.parent().attr('id'));\n\t\t\tswitch (this.button.data('view')) {\n\t\t\t\tcase 'Detail':\n\t\t\t\t\tconst detailView = Vtiger_Detail_Js.getInstance(),\n\t\t\t\t\t\tselectedTabElement = detailView.getSelectedTab();\n\t\t\t\t\tif (selectedTabElement.data('reference') === 'Documents') {\n\t\t\t\t\t\tdetailView.reloadTabContent();\n\t\t\t\t\t} else if (detailView.getContentHolder().find('.detailViewBlockLink').data('reference') === 'Documents') {\n\t\t\t\t\t\tVtiger_RelatedList_Js.getInstance(\n\t\t\t\t\t\t\tdetailView.getRecordId(),\n\t\t\t\t\t\t\tapp.getModuleName(),\n\t\t\t\t\t\t\tselectedTabElement,\n\t\t\t\t\t\t\t'Documents'\n\t\t\t\t\t\t).loadRelatedList();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst updatesWidget = this.button.closest('.widgetContentBlock');\n\t\t\t\t\t\tif (updatesWidget.length > 0) {\n\t\t\t\t\t\t\tdetailView.loadWidget(updatesWidget, detailView.getFiltersData(updatesWidget)['params']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'List':\n\t\t\t\t\tconst listInstance = Vtiger_List_Js.getInstance();\n\t\t\t\t\tlistInstance.getListViewRecords().done(function () {\n\t\t\t\t\t\tlistInstance.calculatePages().done(function () {\n\t\t\t\t\t\t\tlistInstance.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Edit':\n\t\t\t\t\tif (response['result']) {\n\t\t\t\t\t\tconst fieldBlock = this.button.closest('.js-field-block-column'),\n\t\t\t\t\t\t\tfield = fieldBlock.find('[name=\"' + fieldBlock.data('field') + '[]\"]');\n\t\t\t\t\t\tApp.Fields.Utils.setValue(field, response['result'], { extend: true }, false);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\t/**\n\t * Register events.\n\t * @param {jQuery} modal\n\t * @param {jQuery.Event} e\n\t */\n\tregisterEvents(modal, e) {\n\t\tthis.modal = modal;\n\t\tthis.form = modal.find('form');\n\t\tthis.button = $(e.currentTarget);\n\t\tthis.registerSubmit();\n\t}\n};\n"],"names":["window","Documents_MassAddDocuments_Js","uploadButton","modal","find","template","uploadContainer","on","remove","files","file","append","html","val","name","form","e","preventDefault","submit","moduleName","app","getModuleName","recordId","getRecordId","length","removeEmptyFilesInput","formData","FormData","button","data","$","progressIndicator","blockInfo","enabled","AppConnector","request","url","type","processData","contentType","done","response","progressIndicatorElement","mode","hideModalWindow","parent","attr","detailView","Vtiger_Detail_Js","getInstance","selectedTabElement","getSelectedTab","reloadTabContent","getContentHolder","Vtiger_RelatedList_Js","loadRelatedList","updatesWidget","closest","loadWidget","getFiltersData","listInstance","Vtiger_List_Js","getListViewRecords","calculatePages","updatePagination","fieldBlock","field","App","Fields","Utils","setValue","extend","currentTarget","registerSubmit","self","registerEvents"],"mappings":"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"}