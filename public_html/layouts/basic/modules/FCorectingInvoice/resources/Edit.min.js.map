{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\nVtiger_Edit_Js(\n\t'FCorectingInvoice_Edit_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Load correcting invoice data to before block\n\t\t * @param {int} recordId\n\t\t */\n\t\tloadInvoiceData(recordId = false) {\n\t\t\tif (!recordId) {\n\t\t\t\trecordId = parseInt(\n\t\t\t\t\tthis.getForm()\n\t\t\t\t\t\t.find('input[name=\"finvoiceid\"]')\n\t\t\t\t\t\t.val()\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (recordId) {\n\t\t\t\tconst form = this.getForm();\n\t\t\t\tconst progressLoader = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'FInvoice',\n\t\t\t\t\trecord: recordId,\n\t\t\t\t\tmode: 'showInventoryDetails',\n\t\t\t\t\tview: 'Detail'\n\t\t\t\t})\n\t\t\t\t\t.done(response => {\n\t\t\t\t\t\tform.find('.js-before-inventory').html(response);\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t})\n\t\t\t\t\t.fail(() => {\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * register reference fields events\n\t\t */\n\t\tregisterReferenceFieldsEvents() {\n\t\t\tapp.event.on('EditView.SelectReference', (e, params) => {\n\t\t\t\tif (params.source_module === 'FInvoice') {\n\t\t\t\t\tthis.loadInvoiceData(params.record);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst form = this.getForm();\n\t\t\tapp.event.on('EditView.ClearField', (e, params) => {\n\t\t\t\tif (params.fieldName === 'finvoiceid') {\n\t\t\t\t\tconst invoiceidInput = form.find('[name=\"finvoiceid\"]');\n\t\t\t\t\tif (invoiceidInput.length) {\n\t\t\t\t\t\tform\n\t\t\t\t\t\t\t.find('.js-before-inventory')\n\t\t\t\t\t\t\t.html('<div class=\"text-center\">' + app.vtranslate('JS_FCORECTINGINVOICE_CHOOSE_INVOICE') + '</div>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Action for copy from correcting invoice button - load data before positions to position in data after block\n\t\t */\n\t\tregisterCopyFromInvoice() {\n\t\t\tconst form = this.getForm();\n\t\t\tconst thisInstance = this;\n\t\t\tform.find('.js-copy-from-invoice').on('click', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst finvoiceidInput = form.find('input[name=\"finvoiceid\"]');\n\t\t\t\tif (!finvoiceidInput.length) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst finvoiceid = finvoiceidInput.val();\n\t\t\t\tif (!finvoiceid) {\n\t\t\t\t\treturn Vtiger_Helper_Js.showMessage({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\ttext: app.vtranslate('JS_FCORECTINGINVOICE_CHOOSE_INVOICE')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthisInstance.inventoryController.loadInventoryData(finvoiceid, 'FInvoice');\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * registerEvents override\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis._super();\n\t\t\tthis.registerCopyFromInvoice();\n\t\t\tthis.registerReferenceFieldsEvents();\n\t\t\tthis.loadInvoiceData();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Edit_Js","recordId","parseInt","getForm","find","val","form","progressLoader","$","progressIndicator","blockInfo","enabled","request","done","html","response","mode","fail","event","on","e","params","source_module","loadInvoiceData","record","fieldName","invoiceidInput","length","app","vtranslate","thisInstance","preventDefault","stopPropagation","finvoiceidInput","finvoiceid","Vtiger_Helper_Js","showMessage","inventoryController","loadInventoryData","_super","registerCopyFromInvoice","registerReferenceFieldsEvents"],"mappings":";;AAAA;;AAEAA,eACC,2BADD,EAEC,EAFD,EAGC;;;;;gBAAA,6BAKmC;MAAlBC,QAAkB,uEAAP,KAAO;;MAC7B,CAACA,QAAL,EAAe;cACHC,SACV,KAAKC,OAAL,GACEC,IADF,CACO,0BADP,EAEEC,GAFF,EADU,CAAX;;MAMGJ,QAAJ,EAAc;OACPK,OAAO,KAAKH,OAAL,EAAb;OACMI,iBAAiBC,EAAEC,iBAAF,CAAoB,EAAEC,WAAW,EAAEC,SAAS,IAAX,EAAb,EAApB,CAAvB;gBACaC,OAAb,CAAqB;YACZ,UADY;YAEZX,QAFY;UAGd,sBAHc;UAId;IAJP,EAMEY,IANF,CAMO,oBAAY;SACZT,IAAL,CAAU,sBAAV,EAAkCU,IAAlC,CAAuCC,QAAvC;mBACeN,iBAAf,CAAiC,EAAEO,MAAM,MAAR,EAAjC;IARF,EAUEC,IAVF,CAUO,YAAM;mBACIR,iBAAf,CAAiC,EAAEO,MAAM,MAAR,EAAjC;IAXF;;EAhBH;;;;;8BAAA,2CAkCiC;;;MAC3BE,KAAJ,CAAUC,EAAV,CAAa,0BAAb,EAAyC,UAACC,CAAD,EAAIC,MAAJ,EAAe;OACnDA,OAAOC,aAAP,KAAyB,UAA7B,EAAyC;UACnCC,eAAL,CAAqBF,OAAOG,MAA5B;;GAFF;MAKMlB,OAAO,KAAKH,OAAL,EAAb;MACIe,KAAJ,CAAUC,EAAV,CAAa,qBAAb,EAAoC,UAACC,CAAD,EAAIC,MAAJ,EAAe;OAC9CA,OAAOI,SAAP,KAAqB,YAAzB,EAAuC;QAChCC,iBAAiBpB,KAAKF,IAAL,CAAU,qBAAV,CAAvB;QACIsB,eAAeC,MAAnB,EAA2B;UAExBvB,IADF,CACO,sBADP,EAEEU,IAFF,CAEO,8BAA8Bc,IAAIC,UAAJ,CAAe,qCAAf,CAA9B,GAAsF,QAF7F;;;GAJH;EAzCF;;;;;wBAAA,qCAuD2B;MACnBvB,OAAO,KAAKH,OAAL,EAAb;MACM2B,eAAe,IAArB;OACK1B,IAAL,CAAU,uBAAV,EAAmCe,EAAnC,CAAsC,OAAtC,EAA+C,UAASC,CAAT,EAAY;KACxDW,cAAF;KACEC,eAAF;OACMC,kBAAkB3B,KAAKF,IAAL,CAAU,0BAAV,CAAxB;OACI,CAAC6B,gBAAgBN,MAArB,EAA6B;WACrB,KAAP;;OAEKO,aAAaD,gBAAgB5B,GAAhB,EAAnB;OACI,CAAC6B,UAAL,EAAiB;WACTC,iBAAiBC,WAAjB,CAA6B;WAC7B,OAD6B;WAE7BR,IAAIC,UAAJ,CAAe,qCAAf;KAFA,CAAP;;gBAKYQ,mBAAb,CAAiCC,iBAAjC,CAAmDJ,UAAnD,EAA+D,UAA/D;GAdD;EA1DF;;;;;eAAA,4BA8EkB;OACXK,MAAL;OACKC,uBAAL;OACKC,6BAAL;OACKlB,eAAL;;CArFH"}