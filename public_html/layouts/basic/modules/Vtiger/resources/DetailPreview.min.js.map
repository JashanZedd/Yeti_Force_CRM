{"version":3,"file":"DetailPreview.min.js","sources":["DetailPreview.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Vtiger_DetailPreview_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Redirects to the clicked link from the iframe.\n\t\t */\n\t\tregisterLinkEvent: function() {\n\t\t\t$('#page').on('click', 'a', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar target = $(this);\n\t\t\t\tif (!target.closest('div').hasClass('fieldValue') || target.hasClass('showReferenceTooltip')) {\n\t\t\t\t\tif (target.attr('href') && target.attr('href') != '#') {\n\t\t\t\t\t\ttop.location.href = target.attr('href');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Redirects to the current iframe parent.\n\t\t */\n\t\tupdateParentFrame: function() {\n\t\t\tparent.app.getPageController().updateWindowHeight($('.mainContainer').height(), $(window.frameElement));\n\t\t},\n\t\t/**\n\t\t * Function sets the correct iframe size.\n\t\t * @param {jQuery} currentHeight - ifrmae body height to be set.\n\t\t * @param {jQuery} frame - ifrmae height to be changed.\n\t\t */\n\t\tupdateWindowHeight: function(currentHeight, frame) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar relatedContents = frame.closest('.relatedContents');\n\t\t\tvar fixedListHeight = relatedContents.find('.js-list-preview--scroll').height();\n\t\t\tframe.height(currentHeight);\n\t\t\tif (fixedListHeight > currentHeight) {\n\t\t\t\tcurrentHeight = fixedListHeight;\n\t\t\t}\n\t\t\trelatedContents\n\t\t\t\t.find('.gutter, .js-list-preview, .js-side-block, .js-list-detail, .recordsListPreview')\n\t\t\t\t.height(currentHeight);\n\n\t\t\tif (window.frameElement) {\n\t\t\t\tthisInstance.updateParentFrame();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Creates ResizeSensor, which detects size changes.\n\t\t */\n\t\tregisterSizeEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tnew ResizeSensor($('.mainContainer'), function() {\n\t\t\t\tthisInstance.updateParentFrame();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register detail events\n\t\t */\n\t\tregisterDetailEvent: function() {\n\t\t\tlet moduleClassName = app.getModuleName() + '_Detail_Js',\n\t\t\t\tparent = false;\n\t\t\tif (typeof window[moduleClassName] === 'undefined') {\n\t\t\t\tmoduleClassName = 'Vtiger_Detail_Js';\n\t\t\t}\n\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\tif (typeof window[moduleClassName] === 'function') {\n\t\t\t\t\tparent = new window[moduleClassName]();\n\t\t\t\t}\n\t\t\t\tif (typeof window[moduleClassName] === 'object') {\n\t\t\t\t\tparent = window[moduleClassName];\n\t\t\t\t}\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.registerEvents();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tupdateChatConfig() {\n\t\t\tif (window.parent.vuexStore) {\n\t\t\t\twindow.parent.vuexStore.commit('Chat/setDetailPreview', {\n\t\t\t\t\tid: window.app.getRecordId(),\n\t\t\t\t\tmodule: window.app.getModuleName()\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Registers DetailPreview events.\n\t\t */\n\t\tregisterEvents: function() {\n\t\t\tthis.registerDetailEvent();\n\t\t\tthis.registerLinkEvent();\n\t\t\tthis.registerSizeEvent();\n\t\t\tthis.updateChatConfig();\n\t\t}\n\t}\n);\n"],"names":["$","Class","on","e","preventDefault","target","closest","hasClass","attr","location","href","app","getPageController","updateWindowHeight","height","window","frameElement","currentHeight","frame","thisInstance","relatedContents","fixedListHeight","find","updateParentFrame","ResizeSensor","moduleClassName","getModuleName","parent","babelHelpers.typeof","registerEvents","vuexStore","commit","getRecordId","registerDetailEvent","registerLinkEvent","registerSizeEvent","updateChatConfig"],"mappings":";;;;;;;;AAAA;AACA;AAEAA,EAAEC,KAAF,CACC,yBADD,EAEC,EAFD,EAGC;;;;oBAIoB,6BAAW;IAC3B,OAAF,EAAWC,EAAX,CAAc,OAAd,EAAuB,GAAvB,EAA4B,UAASC,CAAT,EAAY;KACrCC,cAAF;OACIC,SAASL,EAAE,IAAF,CAAb;OACI,CAACK,OAAOC,OAAP,CAAe,KAAf,EAAsBC,QAAtB,CAA+B,YAA/B,CAAD,IAAiDF,OAAOE,QAAP,CAAgB,sBAAhB,CAArD,EAA8F;QACzFF,OAAOG,IAAP,CAAY,MAAZ,KAAuBH,OAAOG,IAAP,CAAY,MAAZ,KAAuB,GAAlD,EAAuD;SAClDC,QAAJ,CAAaC,IAAb,GAAoBL,OAAOG,IAAP,CAAY,MAAZ,CAApB;;;GALH;EALF;;;;oBAkBoB,6BAAW;SACtBG,GAAP,CAAWC,iBAAX,GAA+BC,kBAA/B,CAAkDb,EAAE,gBAAF,EAAoBc,MAApB,EAAlD,EAAgFd,EAAEe,OAAOC,YAAT,CAAhF;EAnBF;;;;;;qBA0BqB,4BAASC,aAAT,EAAwBC,KAAxB,EAA+B;MAC9CC,eAAe,IAAnB;MACIC,kBAAkBF,MAAMZ,OAAN,CAAc,kBAAd,CAAtB;MACIe,kBAAkBD,gBAAgBE,IAAhB,CAAqB,0BAArB,EAAiDR,MAAjD,EAAtB;QACMA,MAAN,CAAaG,aAAb;MACII,kBAAkBJ,aAAtB,EAAqC;mBACpBI,eAAhB;;kBAGCC,IADF,CACO,iFADP,EAEER,MAFF,CAESG,aAFT;;MAIIF,OAAOC,YAAX,EAAyB;gBACXO,iBAAb;;EAvCH;;;;oBA6CoB,6BAAW;MACzBJ,eAAe,IAAnB;MACIK,YAAJ,CAAiBxB,EAAE,gBAAF,CAAjB,EAAsC,YAAW;gBACnCuB,iBAAb;GADD;EA/CF;;;;sBAsDsB,+BAAW;MAC3BE,kBAAkBd,IAAIe,aAAJ,KAAsB,YAA5C;MACCC,SAAS,KADV;MAEI,OAAOZ,OAAOU,eAAP,CAAP,KAAmC,WAAvC,EAAoD;qBACjC,kBAAlB;;MAEG,OAAOV,OAAOU,eAAP,CAAP,KAAmC,WAAvC,EAAoD;OAC/C,OAAOV,OAAOU,eAAP,CAAP,KAAmC,UAAvC,EAAmD;aACzC,IAAIV,OAAOU,eAAP,CAAJ,EAAT;;OAEGG,QAAOb,OAAOU,eAAP,CAAP,MAAmC,QAAvC,EAAiD;aACvCV,OAAOU,eAAP,CAAT;;OAEGE,MAAJ,EAAY;WACJE,cAAP;;;EApEJ;iBAAA,8BAwEoB;MACdd,OAAOY,MAAP,CAAcG,SAAlB,EAA6B;UACrBH,MAAP,CAAcG,SAAd,CAAwBC,MAAxB,CAA+B,uBAA/B,EAAwD;QACnDhB,OAAOJ,GAAP,CAAWqB,WAAX,EADmD;YAE/CjB,OAAOJ,GAAP,CAAWe,aAAX;IAFT;;EA1EH;;;;;iBAmFiB,0BAAW;OACrBO,mBAAL;OACKC,iBAAL;OACKC,iBAAL;OACKC,gBAAL;;CA1FH"}