{"version":3,"file":"RelatedList.min.js","sources":["RelatedList.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Vtiger_RelatedList_Js',\n\t{\n\t\trelatedListInstance: false,\n\t\tgetInstance: function(parentId, parentModule, selectedRelatedTabElement, relatedModuleName) {\n\t\t\tif (\n\t\t\t\tVtiger_RelatedList_Js.relatedListInstance === false ||\n\t\t\t\tVtiger_RelatedList_Js.relatedListInstance.moduleName !== relatedModuleName\n\t\t\t) {\n\t\t\t\tlet moduleClassName = app.getModuleName() + '_RelatedList_Js',\n\t\t\t\t\tfallbackClassName = Vtiger_RelatedList_Js,\n\t\t\t\t\tinstance;\n\t\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\t\tinstance = new window[moduleClassName]();\n\t\t\t\t} else {\n\t\t\t\t\tinstance = new fallbackClassName();\n\t\t\t\t}\n\t\t\t\tinstance.parentRecordId = parentId;\n\t\t\t\tinstance.parentModuleName = parentModule;\n\t\t\t\tinstance.selectedRelatedTabElement = selectedRelatedTabElement;\n\t\t\t\tinstance.moduleName = relatedModuleName;\n\t\t\t\tinstance.relatedTabsContainer = selectedRelatedTabElement.closest('div.related');\n\t\t\t\tinstance.content = $('div.contents', instance.relatedTabsContainer.closest('div.detailViewContainer'));\n\t\t\t\tinstance.relatedView = instance.content.find('input.relatedView').val();\n\t\t\t\tVtiger_RelatedList_Js.relatedListInstance = instance;\n\t\t\t}\n\t\t\treturn Vtiger_RelatedList_Js.relatedListInstance;\n\t\t},\n\t\ttriggerMassAction: function(massActionUrl, type) {\n\t\t\tconst self = this.relatedListInstance;\n\t\t\tlet validationResult = self.checkListRecordSelected();\n\t\t\tif (validationResult != true) {\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator(),\n\t\t\t\t\tselectedIds = self.readSelectedIds(true),\n\t\t\t\t\texcludedIds = self.readExcludedIds(true),\n\t\t\t\t\tcvId = self.getCurrentCvId(),\n\t\t\t\t\tpostData = self.getCompleteParams();\n\t\t\t\tdelete postData.mode;\n\t\t\t\tdelete postData.view;\n\t\t\t\tpostData.viewname = cvId;\n\t\t\t\tpostData.selected_ids = selectedIds;\n\t\t\t\tpostData.excluded_ids = excludedIds;\n\t\t\t\tlet actionParams = {\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\turl: massActionUrl,\n\t\t\t\t\tdata: postData\n\t\t\t\t};\n\t\t\t\tif (type === 'sendByForm') {\n\t\t\t\t\tapp.openUrlMethodPost(massActionUrl, postData);\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t} else {\n\t\t\t\t\tAppConnector.request(actionParams)\n\t\t\t\t\t\t.done(function(responseData) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\tif (responseData && responseData.result !== null) {\n\t\t\t\t\t\t\t\tif (responseData.result.notify) {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(responseData.result.notify);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (responseData.result.reloadList) {\n\t\t\t\t\t\t\t\t\tVtiger_Detail_Js.reloadRelatedList();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (responseData.result.procesStop) {\n\t\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tself.noRecordSelectedAlert();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Method to verify if selected files exist\n\t\t * @param {int} selectedIds\n\t\t * @return boolean\n\t\t */\n\t\tverifyFileExist: function(selectedIds) {\n\t\t\tlet aDeferred = jQuery.Deferred();\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'Documents',\n\t\t\t\taction: 'CheckFileIntegrity',\n\t\t\t\tmode: 'multiple',\n\t\t\t\trecord: selectedIds\n\t\t\t}).done(function(responseData) {\n\t\t\t\tif (responseData && responseData.result !== null) {\n\t\t\t\t\tif (responseData.result.message) {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({ text: responseData.result.message });\n\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\taDeferred.resolve(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Method to trigger mass download action\n\t\t * @param massActionUrl\n\t\t * @param type\n\t\t */\n\t\ttriggerMassDownload: function(massActionUrl, type) {\n\t\t\tconst self = this.relatedListInstance,\n\t\t\t\tthisInstance = this;\n\t\t\tthis.verifyFileExist(self.readSelectedIds(true)).done(function(data) {\n\t\t\t\tif (true === data) {\n\t\t\t\t\tthisInstance.triggerMassAction(\n\t\t\t\t\t\tmassActionUrl.substring(0, massActionUrl.indexOf('&mode=multiple')),\n\t\t\t\t\t\ttype\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tselectedRelatedTabElement: false,\n\t\tparentRecordId: false,\n\t\tparentModuleName: false,\n\t\tmoduleName: false,\n\t\trelatedTabsContainer: false,\n\t\tcontent: false,\n\t\tlistSearchInstance: false,\n\t\tdetailViewContentHolder: false,\n\t\trelatedView: false,\n\t\tframeProgress: false,\n\t\tnoEventsListSearch: false,\n\t\tlistViewContainer: false,\n\t\tsetSelectedTabElement: function(tabElement) {\n\t\t\tthis.selectedRelatedTabElement = tabElement;\n\t\t},\n\t\tgetSelectedTabElement: function() {\n\t\t\treturn this.selectedRelatedTabElement;\n\t\t},\n\t\tgetParentId: function() {\n\t\t\treturn this.parentRecordId;\n\t\t},\n\t\tgetRelatedContainer: function() {\n\t\t\treturn this.content;\n\t\t},\n\t\tsetRelatedContainer: function(container) {\n\t\t\tthis.content = container;\n\t\t\tthis.relatedView = container.find('input.relatedView').val();\n\t\t},\n\t\tgetContentHolder: function() {\n\t\t\tif (this.detailViewContentHolder == false) {\n\t\t\t\tthis.detailViewContentHolder = $('div.details div.contents');\n\t\t\t}\n\t\t\treturn this.detailViewContentHolder;\n\t\t},\n\t\tgetCurrentPageNum: function() {\n\t\t\treturn $('input[name=\"currentPageNum\"]', this.content).val();\n\t\t},\n\t\tsetCurrentPageNumber: function(pageNumber) {\n\t\t\t$('input[name=\"currentPageNum\"]', this.content).val(pageNumber);\n\t\t},\n\t\tgetOrderBy: function() {\n\t\t\treturn $('#orderBy', this.content).val();\n\t\t},\n\t\tgetDefaultParams: function() {\n\t\t\tlet container = this.getRelatedContainer();\n\t\t\tlet params = {\n\t\t\t\trelationId: container.find('#relationId').val(),\n\t\t\t\torderby: this.getOrderBy(),\n\t\t\t\tpage: this.getCurrentPageNum()\n\t\t\t};\n\t\t\tif (container.find('.pagination').length) {\n\t\t\t\tparams['totalCount'] = container.find('.pagination').data('totalCount');\n\t\t\t}\n\t\t\tif (container.find('.entityState').length) {\n\t\t\t\tparams['entityState'] = container.find('.entityState').val();\n\t\t\t}\n\t\t\tif (this.listSearchInstance) {\n\t\t\t\tvar searchValue = this.listSearchInstance.getAlphabetSearchValue();\n\t\t\t\tparams.search_params = JSON.stringify(this.listSearchInstance.getListSearchParams());\n\t\t\t}\n\t\t\tif (typeof searchValue !== 'undefined' && searchValue.length > 0) {\n\t\t\t\tparams['search_key'] = this.listSearchInstance.getAlphabetSearchField();\n\t\t\t\tparams['search_value'] = searchValue;\n\t\t\t\tparams['operator'] = 's';\n\t\t\t}\n\t\t\tif (this.moduleName == 'Calendar') {\n\t\t\t\tvar switchBtn = container.find('.js-switch--calendar');\n\t\t\t\tif (switchBtn.length) {\n\t\t\t\t\tparams.time = switchBtn.first().prop('checked') ? 'current' : 'history';\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn params;\n\t\t},\n\t\tgetCompleteParams: function() {\n\t\t\tlet container = this.getRelatedContainer();\n\t\t\tlet params = {\n\t\t\t\tview: 'Detail',\n\t\t\t\tmodule: this.parentModuleName,\n\t\t\t\trecord: this.getParentId(),\n\t\t\t\trelatedModule: this.moduleName,\n\t\t\t\trelatedView: this.relatedView,\n\t\t\t\tmode: 'showRelatedList',\n\t\t\t\ttab_label: container.find('#tab_label').val()\n\t\t\t};\n\t\t\treturn $.extend(this.getDefaultParams(), params);\n\t\t},\n\t\tloadRelatedList: function(params) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tif (typeof thisInstance.moduleName === 'undefined' || thisInstance.moduleName.length <= 0) {\n\t\t\t\tvar currentInstance = Vtiger_Detail_Js.getInstance();\n\t\t\t\tcurrentInstance.loadWidgets();\n\t\t\t\treturn aDeferred.promise();\n\t\t\t}\n\t\t\tvar progressInstance = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar completeParams = this.getCompleteParams();\n\t\t\tvar activeTabsReference = thisInstance.relatedTabsContainer.find('li.active').data('reference');\n\t\t\tAppConnector.request($.extend(completeParams, params))\n\t\t\t\t.done(function(responseData) {\n\t\t\t\t\tvar currentInstance = Vtiger_Detail_Js.getInstance();\n\t\t\t\t\tcurrentInstance.loadWidgets();\n\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (activeTabsReference !== 'ProductsAndServices') {\n\t\t\t\t\t\tthisInstance.relatedTabsContainer.find('li').removeClass('active');\n\t\t\t\t\t\tthisInstance.selectedRelatedTabElement.addClass('active');\n\t\t\t\t\t\tthisInstance.content.html(responseData);\n\t\t\t\t\t\t$('.pageNumbers', thisInstance.content).tooltip();\n\t\t\t\t\t\tthisInstance.registerPostLoadEvents();\n\t\t\t\t\t\tthisInstance.registerListEvents();\n\t\t\t\t\t}\n\t\t\t\t\taDeferred.resolve(responseData);\n\t\t\t\t})\n\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_NOT_ALLOWED_VALUE'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\ttriggerDisplayTypeEvent: function() {\n\t\t\tvar widthType = app.cacheGet('widthType', 'narrowWidthType');\n\t\t\tif (widthType) {\n\t\t\t\tvar elements = this.content.find('.listViewEntriesTable').find('td,th');\n\t\t\t\telements.attr('class', widthType);\n\t\t\t}\n\t\t},\n\t\tshowSelectRelation: function(extendParams) {\n\t\t\tlet params = $.extend(this.getRecordsListParams(), extendParams);\n\t\t\tapp.showRecordsList(params, (modal, instance) => {\n\t\t\t\tinstance.setSelectEvent(responseData => {\n\t\t\t\t\tthis.addRelations(Object.keys(responseData)).done(() => {\n\t\t\t\t\t\tapp.event.trigger('RelatedListView.AfterSelectRelation', responseData, this, instance, params);\n\t\t\t\t\t\tlet detail = Vtiger_Detail_Js.getInstance();\n\t\t\t\t\t\tthis.loadRelatedList().done(function() {\n\t\t\t\t\t\t\tdetail.registerRelatedModulesRecordCount();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (this.getSelectedTabElement().data('link-key') === 'LBL_RECORD_SUMMARY') {\n\t\t\t\t\t\t\tdetail.loadWidgets();\n\t\t\t\t\t\t\tdetail.registerRelatedModulesRecordCount();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgetRecordsListParams: function() {\n\t\t\treturn {\n\t\t\t\tmodule: this.moduleName,\n\t\t\t\tsrc_module: this.parentModuleName,\n\t\t\t\tsrc_record: this.parentRecordId,\n\t\t\t\tmulti_select: true\n\t\t\t};\n\t\t},\n\t\taddRelations: function(idList) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: this.parentModuleName,\n\t\t\t\taction: 'RelationAjax',\n\t\t\t\tmode: 'addRelation',\n\t\t\t\trelated_module: this.moduleName,\n\t\t\t\tsrc_record: this.parentRecordId,\n\t\t\t\trelationId: this.getCompleteParams()['relationId'],\n\t\t\t\trelated_record_list: $.isArray(idList) ? JSON.stringify(idList) : idList\n\t\t\t})\n\t\t\t\t.done(function(responseData) {\n\t\t\t\t\taDeferred.resolve(responseData);\n\t\t\t\t})\n\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tdeleteRelation(target) {\n\t\t\tlet params = {};\n\t\t\tif (target.data('url')) {\n\t\t\t\tparams = target.data('url');\n\t\t\t} else {\n\t\t\t\tlet id = target.data('id') ? target.data('id') : target.closest('tr').data('id');\n\t\t\t\tparams = {\n\t\t\t\t\tmodule: this.parentModuleName,\n\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\tmode: 'deleteRelation',\n\t\t\t\t\trelated_module: this.moduleName,\n\t\t\t\t\tsrc_record: this.parentRecordId,\n\t\t\t\t\trelationId: this.getCompleteParams()['relationId'],\n\t\t\t\t\trelated_record_list: JSON.stringify([id])\n\t\t\t\t};\n\t\t\t}\n\t\t\tlet progressInstance = $.progressIndicator({ position: 'html', blockInfo: { enabled: true } });\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(response => {\n\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (response.result) {\n\t\t\t\t\t\tlet widget = target.closest('.widgetContentBlock');\n\t\t\t\t\t\tconst detail = Vtiger_Detail_Js.getInstance();\n\t\t\t\t\t\tif (widget.length) {\n\t\t\t\t\t\t\tdetail.loadWidget(widget);\n\t\t\t\t\t\t\tlet updatesWidget = this.getContentHolder().find('[data-type=\"Updates\"]');\n\t\t\t\t\t\t\tif (updatesWidget.length > 0) {\n\t\t\t\t\t\t\t\tdetail.loadWidget(updatesWidget);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.loadRelatedList();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdetail.registerRelatedModulesRecordCount();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_CANNOT_REMOVE_RELATION'));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function(err, errThrow) {\n\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_CANNOT_REMOVE_RELATION'));\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to handle next page navigation\n\t\t */\n\t\tnextPageHandler: function() {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar pageLimit = jQuery('#pageLimit', this.content).val();\n\t\t\tvar noOfEntries = jQuery('#noOfEntries', this.content).val();\n\t\t\tif (noOfEntries == pageLimit) {\n\t\t\t\tvar pageNumber = this.getCurrentPageNum();\n\t\t\t\tvar nextPage = parseInt(pageNumber) + 1;\n\t\t\t\tthis.loadRelatedList({\n\t\t\t\t\tpage: nextPage\n\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tthisInstance.setCurrentPageNumber(nextPage);\n\t\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to handle next page navigation\n\t\t */\n\t\tpreviousPageHandler: function() {\n\t\t\tconst thisInstance = this,\n\t\t\t\taDeferred = jQuery.Deferred();\n\t\t\tlet pageNumber = this.getCurrentPageNum();\n\t\t\tif (pageNumber > 1) {\n\t\t\t\tlet previousPage = parseInt(pageNumber) - 1;\n\t\t\t\tthis.loadRelatedList({\n\t\t\t\t\tpage: previousPage\n\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tthisInstance.setCurrentPageNumber(previousPage);\n\t\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to handle select page jump in related list\n\t\t */\n\t\tselectPageHandler: function(pageNumber) {\n\t\t\tconst thisInstance = this,\n\t\t\t\taDeferred = jQuery.Deferred();\n\t\t\tthis.loadRelatedList({\n\t\t\t\tpage: pageNumber\n\t\t\t})\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tthisInstance.setCurrentPageNumber(pageNumber);\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to handle page jump in related list\n\t\t */\n\t\tpageJumpHandler: function(e) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tif (e.which == 13) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar response = Vtiger_WholeNumberGreaterThanZero_Validator_Js.invokeValidation(element);\n\t\t\t\tif (typeof response !== 'undefined') {\n\t\t\t\t\telement.validationEngine('showPrompt', response, '', 'topLeft', true);\n\t\t\t\t\te.preventDefault();\n\t\t\t\t} else {\n\t\t\t\t\telement.validationEngine('hideAll');\n\t\t\t\t\tvar jumpToPage = parseInt(element.val());\n\t\t\t\t\tvar totalPages = parseInt(jQuery('#totalPageCount', thisInstance.content).text());\n\t\t\t\t\tif (jumpToPage > totalPages) {\n\t\t\t\t\t\tvar error = app.vtranslate('JS_PAGE_NOT_EXIST');\n\t\t\t\t\t\telement.validationEngine('showPrompt', error, '', 'topLeft', true);\n\t\t\t\t\t}\n\t\t\t\t\tvar invalidFields = element.parent().find('.formError');\n\t\t\t\t\tif (invalidFields.length < 1) {\n\t\t\t\t\t\tvar currentPage = jQuery('input[name=\"currentPageNum\"]', thisInstance.content).val();\n\t\t\t\t\t\tif (jumpToPage == currentPage) {\n\t\t\t\t\t\t\tvar message = app.vtranslate('JS_YOU_ARE_IN_PAGE_NUMBER') + ' ' + jumpToPage;\n\t\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\t\ttext: message,\n\t\t\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.loadRelatedList({\n\t\t\t\t\t\t\tpage: jumpToPage\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\tthisInstance.setCurrentPageNumber(jumpToPage);\n\t\t\t\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to add related record for the module\n\t\t */\n\t\taddRelatedRecord: function(element, callback) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar referenceModuleName = this.moduleName;\n\t\t\tvar parentId = this.getParentId();\n\t\t\tvar parentModule = this.parentModuleName;\n\t\t\tvar quickCreateParams = {};\n\t\t\tvar relatedParams = {};\n\t\t\tvar relatedField = element.data('name');\n\t\t\tvar fullFormUrl = element.data('url');\n\t\t\tif (relatedField) {\n\t\t\t\trelatedParams[relatedField] = parentId;\n\t\t\t}\n\t\t\tvar eliminatedKeys = new Array('view', 'module', 'mode', 'action');\n\t\t\tvar preQuickCreateSave = function(data) {\n\t\t\t\tvar index, queryParam, queryParamComponents;\n\t\t\t\tlet queryParameters = [];\n\n\t\t\t\t//To handle switch to task tab when click on add task from related list of activities\n\t\t\t\t//As this is leading to events tab intially even clicked on add task\n\t\t\t\tif (typeof fullFormUrl !== 'undefined' && fullFormUrl.indexOf('?') !== -1) {\n\t\t\t\t\tvar urlSplit = fullFormUrl.split('?');\n\t\t\t\t\tvar queryString = urlSplit[1];\n\t\t\t\t\tqueryParameters = queryString.split('&');\n\t\t\t\t\tfor (index = 0; index < queryParameters.length; index++) {\n\t\t\t\t\t\tqueryParam = queryParameters[index];\n\t\t\t\t\t\tqueryParamComponents = queryParam.split('=');\n\t\t\t\t\t\tif (queryParamComponents[0] == 'mode' && queryParamComponents[1] == 'Calendar') {\n\t\t\t\t\t\t\tdata.find('a[data-tab-name=\"Task\"]').trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tjQuery('<input type=\"hidden\" name=\"sourceModule\" value=\"' + parentModule + '\" />').appendTo(data);\n\t\t\t\tjQuery('<input type=\"hidden\" name=\"sourceRecord\" value=\"' + parentId + '\" />').appendTo(data);\n\t\t\t\tjQuery('<input type=\"hidden\" name=\"relationOperation\" value=\"true\" />').appendTo(data);\n\n\t\t\t\tif (typeof relatedField !== 'undefined') {\n\t\t\t\t\tvar field = data.find('[name=\"' + relatedField + '\"]');\n\t\t\t\t\t//If their is no element with the relatedField name,we are adding hidden element with\n\t\t\t\t\t//name as relatedField name,for saving of record with relation to parent record\n\t\t\t\t\tif (field.length == 0) {\n\t\t\t\t\t\tjQuery('<input type=\"hidden\" name=\"' + relatedField + '\" value=\"' + parentId + '\" />').appendTo(\n\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (index = 0; index < queryParameters.length; index++) {\n\t\t\t\t\tqueryParam = queryParameters[index];\n\t\t\t\t\tqueryParamComponents = queryParam.split('=');\n\t\t\t\t\tif (\n\t\t\t\t\t\tjQuery.inArray(queryParamComponents[0], eliminatedKeys) == '-1' &&\n\t\t\t\t\t\tdata.find('[name=\"' + queryParamComponents[0] + '\"]').length == 0\n\t\t\t\t\t) {\n\t\t\t\t\t\tjQuery(\n\t\t\t\t\t\t\t'<input type=\"hidden\" name=\"' +\n\t\t\t\t\t\t\t\tqueryParamComponents[0] +\n\t\t\t\t\t\t\t\t'\" value=\"' +\n\t\t\t\t\t\t\t\tqueryParamComponents[1] +\n\t\t\t\t\t\t\t\t'\" />'\n\t\t\t\t\t\t).appendTo(data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof callback !== 'undefined') {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar postQuickCreateSave = function(data) {\n\t\t\t\tthisInstance.loadRelatedList().done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t//If url contains params then seperate them and make them as relatedParams\n\t\t\tif (typeof fullFormUrl !== 'undefined' && fullFormUrl.indexOf('?') !== -1) {\n\t\t\t\tvar urlSplit = fullFormUrl.split('?');\n\t\t\t\tvar queryString = urlSplit[1];\n\t\t\t\tvar queryParameters = queryString.split('&');\n\t\t\t\tfor (var index = 0; index < queryParameters.length; index++) {\n\t\t\t\t\tvar queryParam = queryParameters[index];\n\t\t\t\t\tvar queryParamComponents = queryParam.split('=');\n\t\t\t\t\tif (jQuery.inArray(queryParamComponents[0], eliminatedKeys) == '-1') {\n\t\t\t\t\t\trelatedParams[queryParamComponents[0]] = queryParamComponents[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tquickCreateParams['data'] = relatedParams;\n\t\t\tquickCreateParams['callbackFunction'] = postQuickCreateSave;\n\t\t\tquickCreateParams['callbackPostShown'] = preQuickCreateSave;\n\t\t\tquickCreateParams['noCache'] = true;\n\t\t\tVtiger_Header_Js.getInstance().quickCreateModule(referenceModuleName, quickCreateParams);\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetRelatedPageCount: function() {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar element = this.content.find('#totalPageCount');\n\t\t\tvar totalCountElem = this.content.find('#totalCount');\n\t\t\tvar totalPageNumber = element.text();\n\t\t\tif (totalPageNumber == '') {\n\t\t\t\telement.progressIndicator({});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: this.parentModuleName,\n\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\tmode: 'getRelatedListPageCount',\n\t\t\t\t\trecord: this.getParentId(),\n\t\t\t\t\trelationId: this.getCompleteParams()['relationId'],\n\t\t\t\t\trelatedModule: this.moduleName\n\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tvar pageCount = data['result']['page'];\n\t\t\t\t\t\tvar numberOfRecords = data['result']['numberOfRecords'];\n\t\t\t\t\t\ttotalCountElem.val(numberOfRecords);\n\t\t\t\t\t\telement.text(pageCount);\n\t\t\t\t\t\telement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\taDeferred.resolve();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\taDeferred.reject(false);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\taDeferred.resolve();\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tfavoritesRelation: function(relcrmId, state) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tif (relcrmId) {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: this.parentModuleName,\n\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\tmode: 'updateFavoriteForRecord',\n\t\t\t\t\trecord: this.getParentId(),\n\t\t\t\t\trelcrmid: relcrmId,\n\t\t\t\t\trelatedModule: this.moduleName,\n\t\t\t\t\trelationId: this.getCompleteParams()['relationId'],\n\t\t\t\t\tactionMode: state ? 'delete' : 'add'\n\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tif (data.result) aDeferred.resolve(true);\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\taDeferred.reject(false);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\taDeferred.reject(false);\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tupdatePreview: function(url) {\n\t\t\tvar frame = this.content.find('.listPreviewframe');\n\t\t\tthis.frameProgress = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tmessage: app.vtranslate('JS_FRAME_IN_PROGRESS'),\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar defaultView = '';\n\t\t\tif (app.getMainParams('defaultDetailViewName')) {\n\t\t\t\tdefaultView =\n\t\t\t\t\tdefaultView +\n\t\t\t\t\t'&mode=showDetailViewByMode&requestMode=' +\n\t\t\t\t\tapp.getMainParams('defaultDetailViewName'); // full, summary\n\t\t\t}\n\t\t\tframe.attr('src', url.replace('view=Detail', 'view=DetailPreview') + defaultView);\n\t\t},\n\t\tregisterUnreviewedCountEvent: function() {\n\t\t\tvar ids = [];\n\t\t\tvar relatedContent = this.content;\n\t\t\tvar isUnreviewedActive = relatedContent.find('.unreviewed').length;\n\t\t\trelatedContent.find('tr.listViewEntries').each(function() {\n\t\t\t\tvar id = jQuery(this).data('id');\n\t\t\t\tif (id) {\n\t\t\t\t\tids.push(id);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!ids || isUnreviewedActive < 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tAppConnector.request({\n\t\t\t\taction: 'ChangesReviewedOn',\n\t\t\t\tmode: 'getUnreviewed',\n\t\t\t\tmodule: 'ModTracker',\n\t\t\t\tsourceModule: this.moduleName,\n\t\t\t\trecordsId: ids\n\t\t\t}).done(function(appData) {\n\t\t\t\tvar data = appData.result;\n\t\t\t\t$.each(data, function(id, value) {\n\t\t\t\t\tif (value.a > 0) {\n\t\t\t\t\t\trelatedContent\n\t\t\t\t\t\t\t.find('tr[data-id=\"' + id + '\"] .unreviewed .badge.all')\n\t\t\t\t\t\t\t.text(value.a)\n\t\t\t\t\t\t\t.parent()\n\t\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tif (value.m > 0) {\n\t\t\t\t\t\trelatedContent\n\t\t\t\t\t\t\t.find('tr[data-id=\"' + id + '\"] .unreviewed .badge.mail')\n\t\t\t\t\t\t\t.text(value.m)\n\t\t\t\t\t\t\t.parent()\n\t\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterChangeEntityStateEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar relatedContent = this.content;\n\t\t\trelatedContent.on('click', '.dropdownEntityState a', function(e) {\n\t\t\t\tvar element = $(this);\n\t\t\t\trelatedContent.find('.entityState').val(element.data('value'));\n\t\t\t\trelatedContent.find('.pagination').data('totalCount', 0);\n\t\t\t\trelatedContent\n\t\t\t\t\t.find('.dropdownEntityState button')\n\t\t\t\t\t.find('span')\n\t\t\t\t\t.attr('class', element.find('span').attr('class'));\n\t\t\t\tthisInstance.loadRelatedList({ page: 1 });\n\t\t\t});\n\t\t},\n\t\tregisterRowsEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tif (this.relatedView === 'List' || this.relatedView === 'Detail') {\n\t\t\t\tthis.content.find('.listViewEntries').on('click', function(e) {\n\t\t\t\t\tif ($(e.target).is('td')) {\n\t\t\t\t\t\tif (app.getViewName() == 'DetailPreview') {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t$(e.target)\n\t\t\t\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t\t\t\t.data('recordurl')\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\ttop.document.location.href = $(e.target)\n\t\t\t\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t\t\t\t.data('recordurl');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t$(e.target)\n\t\t\t\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t\t\t\t.data('recordurl')\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tdocument.location.href = $(e.target)\n\t\t\t\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t\t\t\t.data('recordurl');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.content.find('.showInventoryRow').on('click', function(e) {\n\t\t\t\t\tvar target = $(this);\n\t\t\t\t\tvar row = target.closest('tr');\n\t\t\t\t\tvar inventoryRow = row.next();\n\t\t\t\t\tif (inventoryRow.hasClass('listViewInventoryEntries')) {\n\t\t\t\t\t\tinventoryRow.toggleClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (this.relatedView === 'ListPreview') {\n\t\t\t\tthis.content.find('.listViewEntries').on('click', function(e) {\n\t\t\t\t\tlet target = $(e.target);\n\t\t\t\t\tif (target.closest('div').hasClass('actions')) return;\n\t\t\t\t\tif (target.is('button') || target.parent().is('button')) return;\n\t\t\t\t\tif (target.closest('a').hasClass('noLinkBtn')) return;\n\t\t\t\t\tif ($(e.target, $(e.currentTarget)).is('td:first-child')) return;\n\t\t\t\t\tif (target.is('input[type=\"checkbox\"]')) return;\n\t\t\t\t\tif (\n\t\t\t\t\t\t$.contains(\n\t\t\t\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t\t\t\t.find('td:last-child')\n\t\t\t\t\t\t\t\t.get(0),\n\t\t\t\t\t\t\ttarget[0]\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (\n\t\t\t\t\t\t$.contains(\n\t\t\t\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t\t\t\t.find('td:first-child')\n\t\t\t\t\t\t\t\t.get(0),\n\t\t\t\t\t\t\ttarget[0]\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tvar recordUrl = $(this).data('recordurl');\n\t\t\t\t\tthisInstance.content.find('.listViewEntriesTable .listViewEntries').removeClass('active');\n\t\t\t\t\t$(this).addClass('active');\n\t\t\t\t\tthisInstance.updatePreview(recordUrl);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tregisterSummationEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.content.on('click', '.listViewSummation button', function() {\n\t\t\t\tvar button = $(this);\n\t\t\t\tvar calculateValue = button.closest('td').find('.calculateValue');\n\t\t\t\tvar params = thisInstance.getCompleteParams();\n\t\t\t\tparams['action'] = 'RelationAjax';\n\t\t\t\tparams['mode'] = 'calculate';\n\t\t\t\tparams['fieldName'] = button.data('field');\n\t\t\t\tparams['calculateType'] = button.data('operator');\n\t\t\t\tdelete params['view'];\n\t\t\t\tvar progress = $.progressIndicator({\n\t\t\t\t\tmessage: app.vtranslate('JS_CALCULATING_IN_PROGRESS'),\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tapp.hidePopover(button);\n\t\t\t\tAppConnector.request(params).done(function(response) {\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tcalculateValue.html(response.result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcalculateValue.html('');\n\t\t\t\t\t}\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t\t},\n\t\tregisterPreviewEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar contentHeight = this.content.find('.js-detail-preview,.js-list-preview');\n\t\t\tcontentHeight.height(app.getScreenHeight() - (this.content.offset().top + $('.js-footer').height()));\n\t\t\tthis.content.find('.listPreviewframe').on('load', function() {\n\t\t\t\tif (thisInstance.frameProgress) {\n\t\t\t\t\tthisInstance.frameProgress.progressIndicator({ mode: 'hide' });\n\t\t\t\t}\n\t\t\t\tcontentHeight.height(\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.contents()\n\t\t\t\t\t\t.find('.bodyContents')\n\t\t\t\t\t\t.height() + 2\n\t\t\t\t);\n\t\t\t});\n\t\t\tthis.content\n\t\t\t\t.find('.listViewEntriesTable .listViewEntries')\n\t\t\t\t.first()\n\t\t\t\t.trigger('click');\n\t\t},\n\t\tregisterPaginationEvents: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar relatedContent = this.content;\n\t\t\tthis.content.on('click', '#relatedViewNextPageButton', function(e) {\n\t\t\t\tif ($(this).hasClass('disabled')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthisInstance.nextPageHandler();\n\t\t\t});\n\t\t\tthis.content.on('click', '#relatedViewPreviousPageButton', function() {\n\t\t\t\tthisInstance.previousPageHandler();\n\t\t\t});\n\t\t\tthis.content.on('click', '#relatedListPageJump', function(e) {\n\t\t\t\tthisInstance.getRelatedPageCount();\n\t\t\t});\n\t\t\tthis.content\n\t\t\t\t.on('click', '#relatedListPageJumpDropDown > li', function(e) {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t})\n\t\t\t\t.on('keypress', '#pageToJump', function(e) {\n\t\t\t\t\tthisInstance.pageJumpHandler(e);\n\t\t\t\t});\n\t\t\tthis.content.on('click', '.pageNumber', function() {\n\t\t\t\tif ($(this).hasClass('disabled')) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthisInstance.selectPageHandler($(this).data('id'));\n\t\t\t});\n\t\t\tthis.content.on('click', '#totalCountBtn', function() {\n\t\t\t\tapp.hidePopover($(this));\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: thisInstance.parentModuleName,\n\t\t\t\t\tview: 'Pagination',\n\t\t\t\t\tmode: 'getRelationPagination',\n\t\t\t\t\trecord: thisInstance.getParentId(),\n\t\t\t\t\trelatedModule: thisInstance.moduleName,\n\t\t\t\t\tnoOfEntries: $('#noOfEntries', relatedContent).val(),\n\t\t\t\t\tpage: relatedContent.find('[name=\"currentPageNum\"]').val()\n\t\t\t\t};\n\t\t\t\tif (relatedContent.find('.entityState').length) {\n\t\t\t\t\tparams['entityState'] = relatedContent.find('.entityState').val();\n\t\t\t\t}\n\t\t\t\tAppConnector.request(params).done(function(response) {\n\t\t\t\t\trelatedContent.find('.paginationDiv').html(response);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterListEvents: function() {\n\t\t\tvar relatedContent = this.content;\n\t\t\tvar thisInstance = this;\n\t\t\tthis.content.find('a.favorites').on('click', function(e) {\n\t\t\t\tvar progressInstance = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar element = $(this);\n\t\t\t\tvar row = element.closest('tr');\n\t\t\t\tthisInstance.favoritesRelation(row.data('id'), element.data('state')).done(function(response) {\n\t\t\t\t\tif (response) {\n\t\t\t\t\t\tvar state = element.data('state') ? 0 : 1;\n\t\t\t\t\t\telement.data('state', state);\n\t\t\t\t\t\tif (state) {\n\t\t\t\t\t\t\telement.find('.far').addClass('d-none');\n\t\t\t\t\t\t\telement.find('.fas').removeClass('d-none');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telement.find('.fas').addClass('d-none');\n\t\t\t\t\t\t\telement.find('.far').removeClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tvar text = app.vtranslate('JS_REMOVED_FROM_FAVORITES');\n\t\t\t\t\t\tif (state) {\n\t\t\t\t\t\t\ttext = app.vtranslate('JS_ADDED_TO_FAVORITES');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({ text: text, type: 'success' });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.content.find('[name=\"addButton\"]').on('click', function(e) {\n\t\t\t\tconst element = $(this);\n\t\t\t\tif (element.hasClass('quickCreateSupported') !== true) {\n\t\t\t\t\tapp.openUrl(element.data('url'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthisInstance.addRelatedRecord(element);\n\t\t\t});\n\t\t\tthis.content.find('.relatedHeader button.selectRelation').on('click', function(e) {\n\t\t\t\tlet restrictionsField = $(this).data('rf');\n\t\t\t\tlet params = {\n\t\t\t\t\trelationId: thisInstance.getCompleteParams()['relationId']\n\t\t\t\t};\n\t\t\t\tif (restrictionsField && Object.keys(restrictionsField).length > 0) {\n\t\t\t\t\tparams = {\n\t\t\t\t\t\tsearch_key: restrictionsField.key,\n\t\t\t\t\t\tsearch_value: restrictionsField.name,\n\t\t\t\t\t\trelationId: thisInstance.getCompleteParams()['relationId']\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthisInstance.showSelectRelation(params);\n\t\t\t});\n\t\t\tthis.content.find('button.relationDelete').on('click', function(e) {\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\tlet target = $(e.currentTarget);\n\t\t\t\tlet params = {};\n\t\t\t\tif (target.data('confirm')) {\n\t\t\t\t\tparams.message = target.data('confirm');\n\t\t\t\t\tparams.title = target.html() + ' ' + target.data('content');\n\t\t\t\t} else if (target.data('content')) {\n\t\t\t\t\tparams.message = target.data('content');\n\t\t\t\t} else {\n\t\t\t\t\tparams.message = app.vtranslate('JS_DELETE_CONFIRMATION');\n\t\t\t\t}\n\t\t\t\tVtiger_Helper_Js.showConfirmationBox(params).done(function() {\n\t\t\t\t\tthisInstance.deleteRelation(target);\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.content.find('.js-switch--calendar').on('change', function(e) {\n\t\t\t\tthisInstance.loadRelatedList();\n\t\t\t});\n\t\t\tthis.content.find('.relatedViewGroup a').on('click', function(e) {\n\t\t\t\tvar element = $(this);\n\t\t\t\tthisInstance.relatedView = element.data('view');\n\t\t\t\trelatedContent.find('.pagination').data('totalCount', 0);\n\t\t\t\tthisInstance.loadRelatedList({ page: 1 });\n\t\t\t});\n\t\t},\n\t\tregisterPostLoadEvents: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.registerRowsEvent();\n\t\t\tthis.registerListScroll();\n\t\t\tif (this.relatedView === 'ListPreview') {\n\t\t\t\tthis.registerPreviewEvent();\n\t\t\t\tif (!this.content.find('.gutter').length) {\n\t\t\t\t\tif (!this.content.find('.js-list-preview').length) return;\n\t\t\t\t\tthis.setDomParams(this.content);\n\t\t\t\t\tthis.toggleSplit(this.content);\n\t\t\t\t\tthis.registerListPreviewEvents();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.listSearchInstance = YetiForce_ListSearch_Js.getInstance(this.content, false, this);\n\t\t\tapp.event.trigger('RelatedList.AfterLoad', thisInstance);\n\t\t},\n\t\tgetSecondColMinWidth: function(container) {\n\t\t\tlet maxWidth = 0,\n\t\t\t\tthisWidth;\n\t\t\tcontainer.find('.js-list__row').each(function(i) {\n\t\t\t\tthisWidth = $(this)\n\t\t\t\t\t.find('.js-list__field')\n\t\t\t\t\t.first()\n\t\t\t\t\t.width();\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tmaxWidth = thisWidth;\n\t\t\t\t} else {\n\t\t\t\t\tthisWidth > maxWidth ? (maxWidth = thisWidth) : maxWidth;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn maxWidth;\n\t\t},\n\t\tsetDomParams: function(container) {\n\t\t\tthis.listColumnFirstWidth = container\n\t\t\t\t.find('.listViewEntriesDiv .listViewHeaders th')\n\t\t\t\t.first()\n\t\t\t\t.width();\n\t\t\tthis.listColumnSecondWidth = this.getSecondColMinWidth(container);\n\t\t\tthis.windowW = $(window).width();\n\t\t\tthis.mainBody = container.closest('.mainBody');\n\t\t\tthis.windowMinWidth = (15 / this.windowW) * 100;\n\t\t\tthis.windowMaxWidth = 100 - this.minWidth;\n\t\t\tthis.sideBlocks = container.find('.js-side-block');\n\t\t\tthis.sideBlockLeft = this.sideBlocks.first();\n\t\t\tthis.sideBlockRight = this.sideBlocks.last();\n\t\t\tthis.list = container.find('.js-list-preview');\n\t\t\tthis.preview = container.find('.js-detail-preview');\n\t\t\tthis.rotatedText = container.find('.u-rotate-90');\n\t\t\tthis.footerH = $('.js-footer').outerHeight();\n\t\t\tthis.headerH = $('.js-header').outerHeight();\n\t\t},\n\t\tgetDefaultSplitSizes: function() {\n\t\t\tlet thWidth = ((this.listColumnFirstWidth + this.listColumnSecondWidth + 82) / this.windowW) * 100;\n\t\t\treturn [thWidth, 100 - thWidth];\n\t\t},\n\t\tgetSplitSizes() {\n\t\t\tconst cachedParams = app.moduleCacheGet('userRelatedSplitSet');\n\t\t\tif (cachedParams !== undefined) {\n\t\t\t\treturn cachedParams;\n\t\t\t} else {\n\t\t\t\treturn this.getDefaultSplitSizes();\n\t\t\t}\n\t\t},\n\t\tregisterListPreviewEvents() {\n\t\t\tapp.showNewScrollbarTopBottom(this.content.find('.js-list-preview--scroll'));\n\t\t\tapp.showNewScrollbarLeft(this.list);\n\t\t\tthis.list.on('click', '.listViewEntries', () => {\n\t\t\t\tif (this.split.getSizes()[1] < 10) {\n\t\t\t\t\tconst defaultGutterPosition = this.getDefaultSplitSizes();\n\t\t\t\t\tthis.split.setSizes(defaultGutterPosition);\n\t\t\t\t\tthis.preview.show();\n\t\t\t\t\tthis.sideBlockRight.removeClass('d-block');\n\t\t\t\t\tapp.moduleCacheSet('userRelatedSplitSet', defaultGutterPosition);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!this.list.parents('.blockContent').length) {\n\t\t\t\tthis.registerScrollEvent();\n\t\t\t}\n\t\t},\n\t\tregisterScrollEvent() {\n\t\t\tthis.gutter.addClass('js-fixed-scroll');\n\t\t\tlet scrollContainer = App.Components.Scrollbar.page.element;\n\t\t\tlet listOffsetTop = this.list.offset().top - this.headerH;\n\t\t\tlet initialH = this.sideBlocks.height();\n\t\t\tlet mainViewPortHeightCss = { height: this.mainBody.height() };\n\t\t\tlet mainViewPortWidthCss = { width: this.mainBody.height() };\n\t\t\tlet fixedElements = this.mainBody.find('.js-fixed-scroll');\n\t\t\tif (!this.mainBody.length) {\n\t\t\t\tthis.mainBody = $(top.document).find('.mainBody');\n\t\t\t\tthis.headerH = $(top.document)\n\t\t\t\t\t.find('.js-header')\n\t\t\t\t\t.outerHeight();\n\t\t\t\tscrollContainer = top.window.App.Components.Scrollbar.page.element;\n\t\t\t\tlet iframe = $(top.document).find('.js-detail-preview');\n\t\t\t\tlistOffsetTop = this.list.offset().top + iframe.offset().top - this.headerH + 1;\n\t\t\t\tmainViewPortHeightCss = { height: this.mainBody.height() };\n\t\t\t\tmainViewPortWidthCss = { width: this.mainBody.height() };\n\t\t\t}\n\t\t\tconst onScroll = () => {\n\t\t\t\tif (scrollContainer.scrollTop() >= listOffsetTop) {\n\t\t\t\t\tfixedElements.css({ top: scrollContainer.scrollTop() - listOffsetTop });\n\t\t\t\t\tthis.sideBlocks.css({ top: scrollContainer.scrollTop() - listOffsetTop + 56 });\n\t\t\t\t\tfixedElements.css(mainViewPortHeightCss);\n\t\t\t\t\tthis.rotatedText.css(mainViewPortHeightCss);\n\t\t\t\t\tthis.rotatedText.css(mainViewPortWidthCss);\n\t\t\t\t} else {\n\t\t\t\t\tfixedElements.css({ top: 'initial' });\n\t\t\t\t\tfixedElements.css({ height: initialH + scrollContainer.scrollTop() });\n\t\t\t\t\tthis.rotatedText.css({\n\t\t\t\t\t\twidth: initialH + scrollContainer.scrollTop(),\n\t\t\t\t\t\theight: initialH + scrollContainer.scrollTop()\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t\tscrollContainer.on('scroll', onScroll);\n\t\t},\n\t\t/**\n\t\t * Registers split's events.\n\t\t * @param {jQuery} container - current container for reference.\n\t\t * @param {Split} split - a split object.\n\t\t */\n\t\tregisterSplitEvents: function(container, split) {\n\t\t\tvar rightSplitMaxWidth = (400 / this.windowW) * 100;\n\t\t\tvar minWindowWidth = (23 / this.windowW) * 100;\n\t\t\tvar maxWindowWidth = 100 - minWindowWidth;\n\t\t\tvar listPreview = container.find('.js-detail-preview');\n\t\t\tthis.gutter.on('dblclick', () => {\n\t\t\t\tlet gutterRelatedMidPosition = app.moduleCacheGet('gutterRelatedMidPosition');\n\t\t\t\tif (isNaN(this.split.getSizes()[0])) {\n\t\t\t\t\tthis.split.setSizes(gutterRelatedMidPosition);\n\t\t\t\t}\n\t\t\t\tif (split.getSizes()[0] < 7) {\n\t\t\t\t\tthis.gutter.removeClass('js-gutter-corr-left');\n\t\t\t\t\tthis.sideBlockLeft.removeClass('d-block');\n\t\t\t\t\tthis.list.removeClass('u-hide-underneath');\n\t\t\t\t\tif (gutterRelatedMidPosition[0] > 11) {\n\t\t\t\t\t\tsplit.setSizes(gutterRelatedMidPosition);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsplit.setSizes(this.getDefaultSplitSizes());\n\t\t\t\t\t}\n\t\t\t\t} else if (split.getSizes()[1] < 20) {\n\t\t\t\t\tif (gutterRelatedMidPosition[1] > rightSplitMaxWidth + 1) {\n\t\t\t\t\t\tsplit.setSizes(gutterRelatedMidPosition);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsplit.setSizes(this.getDefaultSplitSizes());\n\t\t\t\t\t}\n\t\t\t\t\tthis.gutter.removeClass('js-gutter-corr-right');\n\t\t\t\t\tthis.sideBlockRight.removeClass('d-block');\n\t\t\t\t\tlistPreview.show();\n\t\t\t\t} else if (split.getSizes()[0] > 7 && split.getSizes()[0] < 50) {\n\t\t\t\t\tsplit.setSizes([minWindowWidth, maxWindowWidth]);\n\t\t\t\t\tthis.gutter.addClass('js-gutter-corr-left');\n\t\t\t\t\tthis.sideBlockLeft.addClass('d-block');\n\t\t\t\t\tthis.list.addClass('u-hide-underneath');\n\t\t\t\t} else if (split.getSizes()[1] > 10 && split.getSizes()[1] < 50) {\n\t\t\t\t\tsplit.setSizes([maxWindowWidth, minWindowWidth]);\n\t\t\t\t\tthis.gutter.addClass('js-gutter-corr-right');\n\t\t\t\t\tthis.sideBlockRight.addClass('d-block');\n\t\t\t\t\tlistPreview.hide();\n\t\t\t\t\t//this.list.width(this.list.width() - 10);\n\t\t\t\t}\n\t\t\t\tapp.moduleCacheSet('userRelatedSplitSet', split.getSizes());\n\t\t\t});\n\t\t\tthis.sideBlockLeft.on('click', () => {\n\t\t\t\tlet gutterRelatedMidPosition = app.moduleCacheGet('gutterRelatedMidPosition');\n\t\t\t\tif (gutterRelatedMidPosition[0] > 11) {\n\t\t\t\t\tsplit.setSizes(gutterRelatedMidPosition);\n\t\t\t\t} else {\n\t\t\t\t\tsplit.setSizes(this.getDefaultSplitSizes());\n\t\t\t\t}\n\t\t\t\tthis.gutter.removeClass('js-gutter-corr-left');\n\t\t\t\tthis.sideBlockLeft.removeClass('d-block');\n\t\t\t\tthis.list.removeClass('u-hide-underneath');\n\t\t\t\tapp.moduleCacheSet('userRelatedSplitSet', split.getSizes());\n\t\t\t});\n\t\t\tthis.sideBlockRight.on('click', () => {\n\t\t\t\tlet gutterRelatedMidPosition = app.moduleCacheGet('gutterRelatedMidPosition');\n\t\t\t\tif (gutterRelatedMidPosition[1] > rightSplitMaxWidth + 1) {\n\t\t\t\t\tsplit.setSizes(gutterRelatedMidPosition);\n\t\t\t\t} else {\n\t\t\t\t\tsplit.setSizes(this.getDefaultSplitSizes());\n\t\t\t\t}\n\t\t\t\tthis.gutter.removeClass('js-gutter-corr-right');\n\t\t\t\tthis.sideBlockRight.removeClass('d-block');\n\t\t\t\tlistPreview.show();\n\t\t\t\tapp.moduleCacheSet('userRelatedSplitSet', split.getSizes());\n\t\t\t});\n\t\t},\n\t\tregisterSplit: function(container) {\n\t\t\tvar rightSplitMaxWidth = (400 / this.windowW) * 100;\n\t\t\tconst splitSizes = this.getSplitSizes();\n\t\t\tapp.moduleCacheSet('gutterRelatedMidPosition', splitSizes);\n\t\t\tvar split = Split([this.list[0], this.preview[0]], {\n\t\t\t\tsizes: splitSizes,\n\t\t\t\tminSize: 10,\n\t\t\t\tgutterSize: 24,\n\t\t\t\tsnapOffset: 100,\n\t\t\t\tonDrag: () => {\n\t\t\t\t\tif (split.getSizes()[1] < rightSplitMaxWidth) {\n\t\t\t\t\t\tsplit.collapse(1);\n\t\t\t\t\t}\n\t\t\t\t\tif (split.getSizes()[0] < 7) {\n\t\t\t\t\t\tthis.sideBlockLeft.addClass('d-block');\n\t\t\t\t\t\tthis.list.addClass('u-hide-underneath');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.gutter.removeClass('js-gutter-corr-left');\n\t\t\t\t\t\tthis.sideBlockLeft.removeClass('d-block');\n\t\t\t\t\t\tthis.list.removeClass('u-hide-underneath');\n\t\t\t\t\t}\n\t\t\t\t\tif (split.getSizes()[1] < 10) {\n\t\t\t\t\t\tthis.sideBlockRight.addClass('d-block');\n\t\t\t\t\t\tthis.preview.hide();\n\t\t\t\t\t\tthis.list.width(this.list.width() - 10);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.gutter.removeClass('js-gutter-corr-right');\n\t\t\t\t\t\tthis.sideBlockRight.removeClass('d-block');\n\t\t\t\t\t\tthis.preview.show();\n\t\t\t\t\t}\n\t\t\t\t\tif (split.getSizes()[0] > 10 && split.getSizes()[1] > rightSplitMaxWidth) {\n\t\t\t\t\t\tapp.moduleCacheSet('gutterRelatedMidPosition', split.getSizes());\n\t\t\t\t\t}\n\t\t\t\t\tapp.moduleCacheSet('userRelatedSplitSet', split.getSizes());\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.gutter = container.find('.gutter');\n\t\t\tif (splitSizes[0] < 10) {\n\t\t\t\tthis.gutter.addClass('js-gutter-corr-left');\n\t\t\t\tthis.sideBlockLeft.addClass('d-block');\n\t\t\t\tthis.list.addClass('u-hide-underneath');\n\t\t\t} else if (splitSizes[1] < rightSplitMaxWidth) {\n\t\t\t\tthis.gutter.addClass('js-gutter-corr-right');\n\t\t\t\tthis.sideBlockRight.addClass('d-block');\n\t\t\t\tthis.preview.hide();\n\t\t\t}\n\t\t\tvar mainWindowHeightCss = { height: $(window).height() - this.list.offset().top - this.footerH };\n\t\t\tif (!container.closest('.mainBody').length) {\n\t\t\t\tlet mainBody = $(top.document)\n\t\t\t\t\t.find('.mainBody')\n\t\t\t\t\t.height();\n\t\t\t\tlet iframe = $(top.document).find('.js-detail-preview');\n\t\t\t\tmainWindowHeightCss = { height: mainBody - this.list.offset().top - iframe.offset().top + 50 };\n\t\t\t}\n\t\t\tif (!this.list.parents('.blockContent').length) {\n\t\t\t\tthis.gutter.css(mainWindowHeightCss);\n\t\t\t\tthis.list.css(mainWindowHeightCss);\n\t\t\t\tthis.sideBlocks.css(mainWindowHeightCss);\n\t\t\t\tthis.rotatedText.css({\n\t\t\t\t\twidth: this.sideBlockLeft.height(),\n\t\t\t\t\theight: this.sideBlockLeft.height()\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.registerSplitEvents(container, split);\n\t\t\treturn split;\n\t\t},\n\t\ttoggleSplit: function(container) {\n\t\t\tvar commactHeight = container.closest('.commonActionsContainer').height();\n\t\t\tvar splitsArray = [];\n\t\t\tthis.split = this.registerSplit(container);\n\t\t\tsplitsArray.push(this.split);\n\t\t\t$(window).on('resize', () => {\n\t\t\t\tif ($(window).width() < 993) {\n\t\t\t\t\tif (container.find('.gutter').length) {\n\t\t\t\t\t\tsplitsArray[splitsArray.length - 1].destroy();\n\t\t\t\t\t\tthis.sideBlockRight.removeClass('d-block');\n\t\t\t\t\t\tthis.sideBlockLeft.removeClass('d-block');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (container.find('.gutter').length !== 1) {\n\t\t\t\t\t\tthis.split = this.registerSplit(container);\n\t\t\t\t\t\tvar gutter = container.find('.gutter');\n\t\t\t\t\t\tif (this.mainBody.scrollTop() >= this.list.offset().top + commactHeight) {\n\t\t\t\t\t\t\tgutter.addClass('gutterOnScroll');\n\t\t\t\t\t\t\tgutter.css('left', this.preview.offset().left - 8);\n\t\t\t\t\t\t\tgutter.on('mousedown', function() {\n\t\t\t\t\t\t\t\t$(this).on('mousemove', function(e) {\n\t\t\t\t\t\t\t\t\t$(this).css('left', this.preview.offset().left - 8);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsplitsArray.push(this.split);\n\t\t\t\t\t}\n\t\t\t\t\tvar currentSplit = splitsArray[splitsArray.length - 1];\n\t\t\t\t\tvar minWidth = (15 / $(window).width()) * 100;\n\t\t\t\t\tvar maxWidth = 100 - minWidth;\n\t\t\t\t\tif (typeof currentSplit === 'undefined') return;\n\t\t\t\t\tif (currentSplit.getSizes()[0] < minWidth + 5) {\n\t\t\t\t\t\tcurrentSplit.setSizes([minWidth, maxWidth]);\n\t\t\t\t\t} else if (currentSplit.getSizes()[1] < minWidth + 5) {\n\t\t\t\t\t\tcurrentSplit.setSizes([maxWidth, minWidth]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterListScroll: function() {\n\t\t\tlet container = $('.listViewEntriesDiv');\n\t\t\tif (this.relatedView !== 'ListPreview' && Quasar.plugins.Platform.is.desktop) {\n\t\t\t\tcontainer.each((index, element) => {\n\t\t\t\t\tif (container.closest('.js-detail-widget-content').length) {\n\t\t\t\t\t\telement = container.closest('.js-detail-widget-content');\n\t\t\t\t\t\telement.each((i, el) => {\n\t\t\t\t\t\t\tApp.Components.Scrollbar.xy($(el));\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tApp.Components.Scrollbar.xy($(element));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetRecordsCount: function() {\n\t\t\tlet aDeferred = $.Deferred(),\n\t\t\t\trecordCountVal = $('#recordsCount').val();\n\t\t\tif (recordCountVal != '') {\n\t\t\t\taDeferred.resolve(recordCountVal);\n\t\t\t} else {\n\t\t\t\tlet params = this.getCompleteParams();\n\t\t\t\tdelete params.view;\n\t\t\t\tparams.action = 'DetailAjax';\n\t\t\t\tparams.mode = 'getRecordsCount';\n\t\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\t\t$('#recordsCount').val(data['result']['count']);\n\t\t\t\t\taDeferred.resolve(data['result']['count']);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tnoRecordSelectedAlert: function(text = 'JS_PLEASE_SELECT_ONE_RECORD') {\n\t\t\treturn Vtiger_Helper_Js.showPnotify({ text: app.vtranslate(text) });\n\t\t},\n\t\tgetCurrentCvId: function() {\n\t\t\treturn $('#customFilter')\n\t\t\t\t.find('option:selected')\n\t\t\t\t.data('id');\n\t\t},\n\t\tcheckListRecordSelected: function(minNumberOfRecords = 1) {\n\t\t\tlet selectedIds = this.readSelectedIds();\n\t\t\tif (typeof selectedIds === 'object' && selectedIds.length < minNumberOfRecords) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\treadSelectedIds: function(decode) {\n\t\t\tlet selectedIdsDataAttr = this.getCurrentCvId() + 'selectedIds',\n\t\t\t\tselectedIdsElementDataAttributes = $('#selectedIds').data(),\n\t\t\t\tselectedIds = [];\n\t\t\tif (!(selectedIdsDataAttr in selectedIdsElementDataAttributes)) {\n\t\t\t\tthis.writeSelectedIds(selectedIds);\n\t\t\t} else {\n\t\t\t\tselectedIds = selectedIdsElementDataAttributes[selectedIdsDataAttr];\n\t\t\t}\n\t\t\tif (decode == true && typeof selectedIds == 'object') {\n\t\t\t\treturn JSON.stringify(selectedIds);\n\t\t\t}\n\t\t\treturn selectedIds;\n\t\t},\n\t\twriteSelectedIds: function(selectedIds) {\n\t\t\tif (!Array.isArray(selectedIds)) {\n\t\t\t\tselectedIds = [selectedIds];\n\t\t\t}\n\t\t\t$('#selectedIds').data(this.getCurrentCvId() + 'selectedIds', selectedIds);\n\t\t},\n\t\treadExcludedIds: function(decode) {\n\t\t\tlet excludedIdsDataAttr = this.getCurrentCvId() + 'Excludedids',\n\t\t\t\texcludedIdsElementDataAttributes = $('#excludedIds').data(),\n\t\t\t\texcludedIds = [];\n\t\t\tif (!(excludedIdsDataAttr in excludedIdsElementDataAttributes)) {\n\t\t\t\tthis.writeExcludedIds(excludedIds);\n\t\t\t} else {\n\t\t\t\texcludedIds = excludedIdsElementDataAttributes[excludedIdsDataAttr];\n\t\t\t}\n\t\t\tif (decode == true && typeof excludedIds == 'object') {\n\t\t\t\treturn JSON.stringify(excludedIds);\n\t\t\t}\n\t\t\treturn excludedIds;\n\t\t},\n\t\twriteExcludedIds: function(excludedIds) {\n\t\t\t$('#excludedIds').data(this.getCurrentCvId() + 'Excludedids', excludedIds);\n\t\t},\n\t\tcheckSelectAll: function() {\n\t\t\tlet state = true;\n\t\t\t$('.relatedListViewEntriesCheckBox').each(function(index, element) {\n\t\t\t\tif ($(element).is(':checked')) {\n\t\t\t\t\tstate = true;\n\t\t\t\t} else {\n\t\t\t\t\tstate = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t$('#relatedListViewEntriesMainCheckBox').prop('checked', state);\n\t\t\treturn state;\n\t\t},\n\t\tregisterCheckBoxClickEvent: function() {\n\t\t\tconst self = this;\n\t\t\tthis.getRelatedContainer().on('click', '.relatedListViewEntriesCheckBox', function(e) {\n\t\t\t\tlet selectedIds = self.readSelectedIds(),\n\t\t\t\t\texcludedIds = self.readExcludedIds(),\n\t\t\t\t\telem = $(e.currentTarget);\n\t\t\t\tif (elem.is(':checked')) {\n\t\t\t\t\telem.closest('tr').addClass('highlightBackgroundColor');\n\t\t\t\t\tif (selectedIds == 'all') {\n\t\t\t\t\t\texcludedIds.splice($.inArray(elem.val(), excludedIds), 1);\n\t\t\t\t\t} else if ($.inArray(elem.val(), selectedIds) == -1) {\n\t\t\t\t\t\tselectedIds.push(elem.val());\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\telem.closest('tr').removeClass('highlightBackgroundColor');\n\t\t\t\t\tif (selectedIds == 'all') {\n\t\t\t\t\t\texcludedIds.push(elem.val());\n\t\t\t\t\t\tselectedIds = 'all';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectedIds.splice($.inArray(elem.val(), selectedIds), 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.checkSelectAll();\n\t\t\t\tself.writeSelectedIds(selectedIds);\n\t\t\t\tself.writeExcludedIds(excludedIds);\n\t\t\t});\n\t\t},\n\t\tregisterMainCheckBoxClickEvent: function() {\n\t\t\tconst self = this;\n\t\t\tthis.getRelatedContainer().on('click', '#relatedListViewEntriesMainCheckBox', function() {\n\t\t\t\tlet selectedIds = self.readSelectedIds(),\n\t\t\t\t\texcludedIds = self.readExcludedIds();\n\t\t\t\tif ($('#relatedListViewEntriesMainCheckBox').is(':checked')) {\n\t\t\t\t\tlet recordCountObj = self.getRecordsCount();\n\t\t\t\t\trecordCountObj.done(function(data) {\n\t\t\t\t\t\t$('#totalRecordsCount').text(data);\n\t\t\t\t\t\tif ($('#deSelectAllMsgDiv').css('display') == 'none') {\n\t\t\t\t\t\t\t$('#selectAllMsgDiv').show();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$('.relatedListViewEntriesCheckBox').each(function(index, element) {\n\t\t\t\t\t\t$(this)\n\t\t\t\t\t\t\t.prop('checked', true)\n\t\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t\t.addClass('highlightBackgroundColor');\n\t\t\t\t\t\tif (selectedIds == 'all' && $.inArray($(element).val(), excludedIds) != -1) {\n\t\t\t\t\t\t\texcludedIds.splice($.inArray($(element).val(), excludedIds), 1);\n\t\t\t\t\t\t} else if ($.inArray($(element).val(), selectedIds) == -1) {\n\t\t\t\t\t\t\tselectedIds.push($(element).val());\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$('#selectAllMsgDiv').hide();\n\t\t\t\t\t$('.relatedListViewEntriesCheckBox').each(function(index, element) {\n\t\t\t\t\t\t$(this)\n\t\t\t\t\t\t\t.prop('checked', false)\n\t\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t\t.removeClass('highlightBackgroundColor');\n\t\t\t\t\t\tif (selectedIds == 'all') {\n\t\t\t\t\t\t\texcludedIds.push($(element).val());\n\t\t\t\t\t\t\tselectedIds = 'all';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tselectedIds.splice($.inArray($(element).val(), selectedIds), 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tself.writeSelectedIds(selectedIds);\n\t\t\t\tself.writeExcludedIds(excludedIds);\n\t\t\t});\n\t\t},\n\t\tregisterSelectAllClickEvent: function() {\n\t\t\tconst self = this;\n\t\t\tself.getRelatedContainer().on('click', '#selectAllMsg', function() {\n\t\t\t\t$('#selectAllMsgDiv').hide();\n\t\t\t\t$('#deSelectAllMsgDiv').show();\n\t\t\t\t$('#relatedListViewEntriesMainCheckBox').prop('checked', true);\n\t\t\t\t$('.relatedListViewEntriesCheckBox').each(function(index, element) {\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.prop('checked', true)\n\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t.addClass('highlightBackgroundColor');\n\t\t\t\t});\n\t\t\t\tself.writeSelectedIds('all');\n\t\t\t});\n\t\t},\n\t\tregisterDeselectAllClickEvent: function() {\n\t\t\tconst self = this;\n\t\t\tself.getRelatedContainer().on('click', '#deSelectAllMsg', function() {\n\t\t\t\t$('#deSelectAllMsgDiv').hide();\n\t\t\t\t$('#relatedListViewEntriesMainCheckBox').prop('checked', false);\n\t\t\t\t$('.relatedListViewEntriesCheckBox').each(function(index, element) {\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.prop('checked', false)\n\t\t\t\t\t\t.closest('tr')\n\t\t\t\t\t\t.removeClass('highlightBackgroundColor');\n\t\t\t\t});\n\t\t\t\tself.writeSelectedIds([]);\n\t\t\t\tself.writeExcludedIds([]);\n\t\t\t});\n\t\t},\n\t\tregisterRelatedEvents: function() {\n\t\t\tthis.registerUnreviewedCountEvent();\n\t\t\tthis.registerChangeEntityStateEvent();\n\t\t\tthis.registerPaginationEvents();\n\t\t\tthis.registerListEvents();\n\t\t\tthis.registerPostLoadEvents();\n\t\t\tthis.registerSummationEvent();\n\t\t\tthis.registerCheckBoxClickEvent();\n\t\t\tthis.registerMainCheckBoxClickEvent();\n\t\t\tthis.registerSelectAllClickEvent();\n\t\t\tthis.registerDeselectAllClickEvent();\n\t\t\tYetiForce_ListSearch_Js.registerSearch(this.content, data => {\n\t\t\t\tthis.loadRelatedList(data);\n\t\t\t});\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","parentId","parentModule","selectedRelatedTabElement","relatedModuleName","Vtiger_RelatedList_Js","relatedListInstance","moduleName","moduleClassName","app","getModuleName","fallbackClassName","instance","window","parentRecordId","parentModuleName","relatedTabsContainer","closest","content","$","relatedView","find","val","massActionUrl","type","self","this","checkListRecordSelected","progressIndicatorElement","progressIndicator","selectedIds","readSelectedIds","excludedIds","readExcludedIds","cvId","getCurrentCvId","postData","getCompleteParams","mode","view","viewname","selected_ids","excluded_ids","actionParams","openUrlMethodPost","request","done","responseData","result","notify","showMessage","reloadList","reloadRelatedList","procesStop","fail","error","err","noRecordSelectedAlert","aDeferred","Deferred","message","showPnotify","text","resolve","promise","thisInstance","verifyFileExist","data","triggerMassAction","substring","indexOf","tabElement","container","detailViewContentHolder","pageNumber","getRelatedContainer","params","getOrderBy","getCurrentPageNum","length","listSearchInstance","searchValue","getAlphabetSearchValue","search_params","JSON","stringify","getListSearchParams","getAlphabetSearchField","switchBtn","time","first","prop","getParentId","extend","getDefaultParams","Vtiger_Detail_Js","getInstance","loadWidgets","progressInstance","completeParams","activeTabsReference","removeClass","addClass","html","tooltip","registerPostLoadEvents","registerListEvents","textStatus","errorThrown","reject","vtranslate","widthType","cacheGet","attr","extendParams","getRecordsListParams","showRecordsList","modal","setSelectEvent","addRelations","Object","keys","event","trigger","_this","detail","loadRelatedList","registerRelatedModulesRecordCount","getSelectedTabElement","idList","isArray","target","id","position","blockInfo","enabled","response","widget","loadWidget","updatesWidget","_this2","getContentHolder","errThrow","pageLimit","nextPage","parseInt","setCurrentPageNumber","previousPage","e","which","element","currentTarget","Vtiger_WholeNumberGreaterThanZero_Validator_Js","invokeValidation","validationEngine","preventDefault","jumpToPage","totalPages","parent","currentPage","callback","referenceModuleName","quickCreateParams","relatedParams","relatedField","fullFormUrl","eliminatedKeys","Array","queryParameters","split","index","queryParamComponents","inArray","appendTo","quickCreateModule","totalCountElem","pageCount","numberOfRecords","relcrmId","state","url","frame","frameProgress","defaultView","getMainParams","replace","ids","relatedContent","isUnreviewedActive","each","push","appData","value","a","m","on","page","is","getViewName","document","location","href","inventoryRow","next","hasClass","toggleClass","contains","get","recordUrl","updatePreview","button","calculateValue","progress","hidePopover","success","contentHeight","height","getScreenHeight","offset","top","contents","nextPageHandler","previousPageHandler","getRelatedPageCount","stopImmediatePropagation","pageJumpHandler","selectPageHandler","row","favoritesRelation","addRelatedRecord","openUrl","restrictionsField","key","name","showSelectRelation","title","showConfirmationBox","deleteRelation","registerRowsEvent","registerListScroll","registerPreviewEvent","setDomParams","toggleSplit","registerListPreviewEvents","YetiForce_ListSearch_Js","maxWidth","thisWidth","i","width","listColumnFirstWidth","listColumnSecondWidth","getSecondColMinWidth","windowW","mainBody","windowMinWidth","windowMaxWidth","minWidth","sideBlocks","sideBlockLeft","sideBlockRight","last","list","preview","rotatedText","footerH","outerHeight","headerH","thWidth","cachedParams","moduleCacheGet","undefined","getDefaultSplitSizes","showNewScrollbarTopBottom","showNewScrollbarLeft","_this3","getSizes","defaultGutterPosition","setSizes","show","moduleCacheSet","parents","registerScrollEvent","gutter","scrollContainer","App","Components","Scrollbar","listOffsetTop","initialH","mainViewPortHeightCss","mainViewPortWidthCss","fixedElements","iframe","scrollTop","css","rightSplitMaxWidth","minWindowWidth","maxWindowWidth","listPreview","gutterRelatedMidPosition","isNaN","_this5","hide","splitSizes","getSplitSizes","Split","collapse","_this6","mainWindowHeightCss","registerSplitEvents","commactHeight","splitsArray","registerSplit","destroy","_this7","left","currentSplit","Quasar","plugins","Platform","desktop","el","xy","recordCountVal","action","Vtiger_Helper_Js","minNumberOfRecords","decode","selectedIdsDataAttr","selectedIdsElementDataAttributes","writeSelectedIds","excludedIdsDataAttr","excludedIdsElementDataAttributes","writeExcludedIds","elem","splice","checkSelectAll","getRecordsCount","registerUnreviewedCountEvent","registerChangeEntityStateEvent","registerPaginationEvents","registerSummationEvent","registerCheckBoxClickEvent","registerMainCheckBoxClickEvent","registerSelectAllClickEvent","registerDeselectAllClickEvent","registerSearch"],"mappings":"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"}