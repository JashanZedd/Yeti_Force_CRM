{"version":3,"file":"TreeInventoryModal.min.js","sources":["TreeInventoryModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_TreeInventoryModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Tree instance\n\t\t */\n\t\ttreeInstance: false,\n\t\t/**\n\t\t * Set event for select row\n\t\t * @param {function} cb\n\t\t */\n\t\tsetSelectEvent: function (cb) {\n\t\t\tthis.selectEvent = cb;\n\t\t},\n\t\t/**\n\t\t * Gets tree data\n\t\t */\n\t\tgetTreeData: function () {\n\t\t\tlet treeData = this.container.find('.js-tree-value').val();\n\t\t\treturn treeData ? JSON.parse(treeData) : [];\n\t\t},\n\n\t\t/*\n\t\t * Function generates a tree.\n\t\t */\n\t\tgenerateTree: function () {\n\t\t\tif (this.treeInstance == false) {\n\t\t\t\tthis.treeInstance = this.container.find('.js-tree-contents');\n\t\t\t\tlet plugins = ['search', 'category', 'checkbox'];\n\t\t\t\tthis.treeInstance.jstree(\n\t\t\t\t\t$.extend(\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcore: {\n\t\t\t\t\t\t\t\tdata: this.getTreeData(),\n\t\t\t\t\t\t\t\tthemes: {\n\t\t\t\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcheckbox: {\n\t\t\t\t\t\t\t\tthree_state: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tplugins: plugins\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.treeInstance.data('params')\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Function looks up the entered phrases.\n\t\t */\n\t\tsearching: function (text) {\n\t\t\tthis.treeInstance.jstree(true).search(text);\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the search terms.\n\t\t */\n\t\tregisterSearchEvent: function () {\n\t\t\tlet valueSearch = this.container.find('#valueSearchTree');\n\t\t\tlet btnSearch = this.container.find('#btnSearchTree');\n\t\t\tvalueSearch.on('keypress', (e) => {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tbtnSearch.on('click', () => {\n\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the selected records.\n\t\t */\n\t\tregisterSelectRecords: function () {\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\tlet recordsToAdd = [];\n\t\t\t\t$.each(this.treeInstance.jstree('getCategory', true), function (_, treeElement) {\n\t\t\t\t\tif (treeElement.attr === 'record') {\n\t\t\t\t\t\trecordsToAdd[treeElement.record_id] = treeElement.text;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (recordsToAdd.length) {\n\t\t\t\t\tthis.selectEvent(recordsToAdd);\n\t\t\t\t\tapp.hideModalWindow(false, this.container.parent().attr('id'));\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_PLEASE_SELECT_ONE_RECORD') });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register modal events\n\t\t */\n\t\tregisterEvents: function (container) {\n\t\t\tthis.container = container;\n\t\t\tthis.generateTree();\n\t\t\tthis.registerSelectRecords();\n\t\t\tthis.registerSearchEvent();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","treeInstance","setSelectEvent","cb","selectEvent","getTreeData","treeData","find","val","JSON","parse","generateTree","jstree","extend","core","data","themes","name","responsive","checkbox","three_state","plugins","searching","text","search","registerSearchEvent","valueSearch","btnSearch","on","e","which","registerSelectRecords","each","_","treeElement","attr","recordsToAdd","record_id","length","app","hideModalWindow","parent","showNotify","vtranslate","registerEvents"],"mappings":"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"}