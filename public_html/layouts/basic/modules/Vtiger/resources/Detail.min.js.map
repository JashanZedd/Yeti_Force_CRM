{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Vtiger_Detail_Js',\n\t{\n\t\tdetailInstance: false,\n\t\tgetInstance: function() {\n\t\t\tif (Vtiger_Detail_Js.detailInstance == false) {\n\t\t\t\tlet moduleClassName = app.getModuleName() + '_' + app.getViewName() + '_Js',\n\t\t\t\t\tinstance;\n\t\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\t\tinstance = new window[moduleClassName]();\n\t\t\t\t} else {\n\t\t\t\t\tinstance = new Vtiger_Detail_Js();\n\t\t\t\t}\n\t\t\t\tVtiger_Detail_Js.detailInstance = instance;\n\t\t\t}\n\t\t\treturn Vtiger_Detail_Js.detailInstance;\n\t\t},\n\t\t/*\n\t\t * function to trigger Detail view actions\n\t\t * @params: Action url , callback function.\n\t\t */\n\t\ttriggerDetailViewAction: function(detailActionUrl, callBackFunction) {\n\t\t\tvar detailInstance = Vtiger_Detail_Js.getInstance();\n\t\t\tvar selectedIds = [];\n\t\t\tselectedIds.push(detailInstance.getRecordId());\n\t\t\tvar postData = {\n\t\t\t\tselected_ids: JSON.stringify(selectedIds)\n\t\t\t};\n\t\t\tvar actionParams = {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: detailActionUrl,\n\t\t\t\tdataType: 'html',\n\t\t\t\tdata: postData\n\t\t\t};\n\n\t\t\tAppConnector.request(actionParams)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tapp.showModalWindow(data, { 'text-align': 'left' });\n\t\t\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {});\n\t\t},\n\t\t/*\n\t\t * function to trigger send Sms\n\t\t * @params: send sms url , module name.\n\t\t */\n\t\ttriggerSendSms: function(detailActionUrl, module) {\n\t\t\tVtiger_Detail_Js.triggerDetailViewAction(detailActionUrl);\n\t\t},\n\t\ttriggerTransferOwnership: function(massActionUrl) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.getRelatedModulesContainer = false;\n\t\t\tvar actionParams = {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: massActionUrl,\n\t\t\t\tdataType: 'html',\n\t\t\t\tdata: {}\n\t\t\t};\n\t\t\tAppConnector.request(actionParams).done(function(data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tvar callback = function(data) {\n\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\tparams.onValidationComplete = function(form, valid) {\n\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\tif (form.attr('name') == 'changeOwner') {\n\t\t\t\t\t\t\t\t\tthisInstance.transferOwnershipSave(form);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tjQuery('#changeOwner').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t};\n\t\t\t\t\tapp.showModalWindow(data, function(data) {\n\t\t\t\t\t\tvar selectElement = thisInstance.getRelatedModuleContainer();\n\t\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(selectElement, 'select2');\n\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttransferOwnershipSave: function(form) {\n\t\t\tvar transferOwner = jQuery('#transferOwnerId').val();\n\t\t\tvar relatedModules = jQuery('#related_modules').val();\n\t\t\tvar recordId = jQuery('#recordId').val();\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'TransferOwnership',\n\t\t\t\trecord: recordId,\n\t\t\t\ttransferOwnerId: transferOwner,\n\t\t\t\trelated_modules: relatedModules\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\ttext: app.vtranslate('JS_RECORDS_TRANSFERRED_SUCCESSFULLY'),\n\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t};\n\t\t\t\t\tvar oldvalue = jQuery('.assigned_user_id').val();\n\t\t\t\t\tvar element = jQuery('.assigned_user_id ');\n\n\t\t\t\t\telement.find('option[value=\"' + oldvalue + '\"]').removeAttr('selected');\n\t\t\t\t\telement.find('option[value=\"' + transferOwner + '\"]').attr('selected', 'selected');\n\t\t\t\t\telement.trigger('liszt:updated');\n\t\t\t\t\tvar Fieldname = element.find('option[value=\"' + transferOwner + '\"]').data('picklistvalue');\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.row-fluid')\n\t\t\t\t\t\t.find('.value')\n\t\t\t\t\t\t.html(\n\t\t\t\t\t\t\t'<a href=\"index.php?module=Users&amp;parent=Settings&amp;view=Detail&amp;record=' +\n\t\t\t\t\t\t\t\ttransferOwner +\n\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\tFieldname +\n\t\t\t\t\t\t\t\t'</a>'\n\t\t\t\t\t\t);\n\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Function to get the related module container\n\t\t */\n\t\tgetRelatedModuleContainer: function() {\n\t\t\tif (this.getRelatedModulesContainer == false) {\n\t\t\t\tthis.getRelatedModulesContainer = jQuery('#related_modules');\n\t\t\t}\n\t\t\treturn this.getRelatedModulesContainer;\n\t\t},\n\t\treloadRelatedList: function() {\n\t\t\tvar detailInstance = Vtiger_Detail_Js.getInstance();\n\t\t\tvar params = {};\n\t\t\tif (jQuery('[name=\"currentPageNum\"]').length > 0) {\n\t\t\t\tparams.page = jQuery('[name=\"currentPageNum\"]').val();\n\t\t\t}\n\t\t\tdetailInstance.loadRelatedList(params);\n\t\t},\n\t\tshowWorkflowTriggerView: function(instance) {\n\t\t\t$(instance).popover('hide');\n\t\t\tconst detailInstance = Vtiger_Detail_Js.getInstance(),\n\t\t\t\tcallback = function(data) {\n\t\t\t\t\tlet treeInstance = data.find('#treeWorkflowContents');\n\t\t\t\t\ttreeInstance.jstree({\n\t\t\t\t\t\tcore: {\n\t\t\t\t\t\t\tdata: JSON.parse(data.find('.js-tree-workflow-data').val()),\n\t\t\t\t\t\t\tthemes: {\n\t\t\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\t\t\tresponsive: true,\n\t\t\t\t\t\t\t\ticons: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcheckbox: {\n\t\t\t\t\t\t\tthree_state: false\n\t\t\t\t\t\t},\n\t\t\t\t\t\tplugins: ['search', 'category']\n\t\t\t\t\t});\n\t\t\t\t\tdata.find('[type=\"submit\"]').on('click', function() {\n\t\t\t\t\t\tlet tasks = {};\n\t\t\t\t\t\tlet selected = treeInstance.jstree('getCategory', true);\n\t\t\t\t\t\t$.each(selected, function(index, treeElement) {\n\t\t\t\t\t\t\tif (treeElement.attr === 'record') {\n\t\t\t\t\t\t\t\ttasks[treeElement.record_id] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$.each(selected, function(index, treeElement) {\n\t\t\t\t\t\t\tif (tasks[treeElement.parent] !== undefined && treeElement.attr === 'task') {\n\t\t\t\t\t\t\t\ttasks[treeElement.parent].push(treeElement.record_id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (Object.keys(tasks).length === 0) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_INFORMATION'),\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_NOT_SELECTED_WORKFLOW_TRIGGER'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_STARTED_PERFORM_WORKFLOW'),\n\t\t\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\t\taction: 'Workflow',\n\t\t\t\t\t\t\t\tmode: 'execute',\n\t\t\t\t\t\t\t\tuser: data.find('[name=\"user\"]').val(),\n\t\t\t\t\t\t\t\trecord: detailInstance.getRecordId(),\n\t\t\t\t\t\t\t\ttasks: JSON.stringify(tasks)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function() {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_COMPLETED_PERFORM_WORKFLOW'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tdetailInstance.loadWidgets();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR_DURING_TRIGGER_OF_WORKFLOW'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'WorkflowTrigger',\n\t\t\t\trecord: detailInstance.getRecordId()\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tapp.showModalWindow(data, '', callback);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\ttargetPicklistChange: false,\n\t\ttargetPicklist: false,\n\t\tdetailViewContentHolder: false,\n\t\tdetailViewForm: false,\n\t\tdetailViewDetailsTabLabel: 'LBL_RECORD_DETAILS',\n\t\tdetailViewSummaryTabLabel: 'LBL_RECORD_SUMMARY',\n\t\tdetailViewRecentCommentsTabLabel: 'ModComments',\n\t\tdetailViewRecentActivitiesTabLabel: 'Activities',\n\t\tdetailViewRecentUpdatesTabLabel: 'LBL_UPDATES',\n\t\tdetailViewRecentDocumentsTabLabel: 'Documents',\n\t\tfieldUpdatedEvent: 'Vtiger.Field.Updated',\n\t\t//Filels list on updation of which we need to upate the detailview header\n\t\tupdatedFields: ['company', 'designation', 'title'],\n\t\t//Event that will triggered before saving the ajax edit of fields\n\t\tfieldPreSave: 'Vtiger.Field.PreSave',\n\t\ttempData: [],\n\t\treferenceFieldNames: {\n\t\t\tCalendar: {\n\t\t\t\tAccounts: 'link',\n\t\t\t\tLeads: 'link',\n\t\t\t\tVendors: 'link',\n\t\t\t\tOSSEmployees: 'link',\n\t\t\t\tContacts: 'linkextend',\n\t\t\t\tCampaigns: 'process',\n\t\t\t\tHelpDesk: 'process',\n\t\t\t\tProjects: 'process',\n\t\t\t\tServiceContracts: 'process'\n\t\t\t},\n\t\t\tOutsourcedProducts: {\n\t\t\t\tLeads: 'parent_id',\n\t\t\t\tAccounts: 'parent_id',\n\t\t\t\tContacts: 'parent_id'\n\t\t\t},\n\t\t\tAssets: {\n\t\t\t\tAccounts: 'parent_id',\n\t\t\t\tContacts: 'parent_id'\n\t\t\t},\n\t\t\tOSSOutsourcedServices: {\n\t\t\t\tLeads: 'parent_id',\n\t\t\t\tAccounts: 'parent_id',\n\t\t\t\tContacts: 'parent_id'\n\t\t\t},\n\t\t\tOSSSoldServices: {\n\t\t\t\tAccounts: 'parent_id',\n\t\t\t\tContacts: 'parent_id'\n\t\t\t}\n\t\t},\n\t\t//constructor\n\t\tinit: function() {},\n\t\tloadWidgetsEvents: function() {\n\t\t\tconst thisInstance = this;\n\t\t\tapp.event.on('DetailView.Widget.AfterLoad', function(e, widgetContent, relatedModuleName, instance) {\n\t\t\t\tif (relatedModuleName === 'Calendar') {\n\t\t\t\t\tthisInstance.reloadWidgetActivitesStats(widgetContent.closest('.activityWidgetContainer'));\n\t\t\t\t}\n\t\t\t\tif (relatedModuleName === 'ModComments') {\n\t\t\t\t\tthisInstance.registerCommentEventsInDetail(widgetContent.closest('.updatesWidgetContainer'));\n\t\t\t\t}\n\t\t\t\tif (widgetContent.find('[name=\"relatedModule\"]').length) {\n\t\t\t\t\tthisInstance.registerShowSummary(widgetContent);\n\t\t\t\t}\n\t\t\t\tif (relatedModuleName === 'OSSMailView') {\n\t\t\t\t\tVtiger_Index_Js.registerMailButtons(widgetContent);\n\t\t\t\t\twidgetContent.find('.showMailModal').on('click', function(e) {\n\t\t\t\t\t\tlet progressIndicatorElement = jQuery.progressIndicator();\n\t\t\t\t\t\tapp.showModalWindow('', $(e.currentTarget).data('url') + '&noloadlibs=1', function(data) {\n\t\t\t\t\t\t\tVtiger_Index_Js.registerMailButtons(data);\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthisInstance.registerEmailEvents(widgetContent);\n\t\t\t\tif (relatedModuleName === 'DetailView') {\n\t\t\t\t\tthisInstance.registerBlockStatusCheckOnLoad();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tloadWidgets: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar widgetList = jQuery('[class^=\"widgetContainer_\"]');\n\t\t\twidgetList.each(function(index, widgetContainerELement) {\n\t\t\t\tvar widgetContainer = jQuery(widgetContainerELement);\n\t\t\t\tthisInstance.loadWidget(widgetContainer);\n\t\t\t});\n\t\t\tthisInstance.registerRelatedModulesRecordCount();\n\t\t},\n\t\tloadWidget: function(widgetContainer, params) {\n\t\t\tconst thisInstance = this,\n\t\t\t\tcontentContainer = $('.js-detail-widget-content', widgetContainer);\n\t\t\tlet relatedModuleName;\n\t\t\tthis.registerFilterForAddingModuleRelatedRecordFromSummaryWidget(widgetContainer);\n\t\t\tif (widgetContainer.find('[name=\"relatedModule\"]').length) {\n\t\t\t\trelatedModuleName = widgetContainer.find('[name=\"relatedModule\"]').val();\n\t\t\t} else {\n\t\t\t\trelatedModuleName = widgetContainer.data('name');\n\t\t\t}\n\t\t\tif (params === undefined) {\n\t\t\t\tlet urlParams = widgetContainer.data('url');\n\t\t\t\tif (urlParams == undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet queryParameters = urlParams.split('&'),\n\t\t\t\t\tkeyValueMap = {},\n\t\t\t\t\tindex;\n\t\t\t\tfor (index = 0; index < queryParameters.length; index++) {\n\t\t\t\t\tlet queryParamComponents = queryParameters[index].split('=');\n\t\t\t\t\tkeyValueMap[queryParamComponents[0]] = queryParamComponents[1];\n\t\t\t\t}\n\t\t\t\tparams = keyValueMap;\n\t\t\t}\n\t\t\tlet aDeferred = $.Deferred();\n\t\t\tcontentContainer.progressIndicator({});\n\t\t\tAppConnector.request({\n\t\t\t\ttype: 'POST',\n\t\t\t\tasync: false,\n\t\t\t\tdataType: 'html',\n\t\t\t\tdata: params\n\t\t\t})\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tcontentContainer.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tcontentContainer.html(data);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(widgetContainer.find('.select2'));\n\t\t\t\t\tapp.registerModal(contentContainer);\n\t\t\t\t\tif (relatedModuleName) {\n\t\t\t\t\t\tlet relatedController = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\t\t\t\tthisInstance.getRecordId(),\n\t\t\t\t\t\t\tapp.getModuleName(),\n\t\t\t\t\t\t\tthisInstance.getSelectedTab(),\n\t\t\t\t\t\t\trelatedModuleName\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelatedController.setRelatedContainer(contentContainer);\n\t\t\t\t\t\trelatedController.registerRelatedEvents();\n\t\t\t\t\t\tthisInstance.widgetRelatedRecordView(widgetContainer, true);\n\t\t\t\t\t}\n\t\t\t\t\tapp.event.trigger('DetailView.Widget.AfterLoad', contentContainer, relatedModuleName, thisInstance);\n\t\t\t\t\taDeferred.resolve(params);\n\t\t\t\t})\n\t\t\t\t.fail(function() {\n\t\t\t\t\tcontentContainer.progressIndicator({ mode: 'hide' });\n\t\t\t\t\taDeferred.reject();\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\twidgetRelatedRecordView: function(container, load) {\n\t\t\tvar cacheKey = this.getRecordId() + '_' + container.data('id');\n\t\t\tvar relatedRecordCacheID = app.moduleCacheGet(cacheKey);\n\t\t\tif (relatedRecordCacheID !== null) {\n\t\t\t\tvar newActive = container.find(\".js-carousel-item[data-id = '\" + relatedRecordCacheID + \"']\");\n\t\t\t\tif (newActive.length) {\n\t\t\t\t\tcontainer.find('.js-carousel-item.active').removeClass('active');\n\t\t\t\t\tcontainer.find(\".js-carousel-item[data-id = '\" + relatedRecordCacheID + \"']\").addClass('active');\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar controlBox = container.find('.control-widget');\n\t\t\tvar prev = controlBox.find('.prev');\n\t\t\tvar next = controlBox.find('.next');\n\t\t\tvar active = container.find('.js-carousel-item.active');\n\t\t\tif (container.find('.js-carousel-item').length <= 1 || !active.next().length) {\n\t\t\t\tnext.addClass('disabled');\n\t\t\t} else {\n\t\t\t\tnext.removeClass('disabled');\n\t\t\t}\n\t\t\tif (container.find('.js-carousel-item').length <= 1 || !active.prev().length) {\n\t\t\t\tprev.addClass('disabled');\n\t\t\t} else {\n\t\t\t\tprev.removeClass('disabled');\n\t\t\t}\n\t\t\tif (load) {\n\t\t\t\tnext.on('click', function() {\n\t\t\t\t\tif ($(this).hasClass('disabled')) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar active = container.find('.js-carousel-item.active');\n\t\t\t\t\tactive.removeClass('active');\n\t\t\t\t\tvar nextElement = active.next();\n\t\t\t\t\tnextElement.addClass('active');\n\t\t\t\t\tif (!nextElement.next().length) {\n\t\t\t\t\t\tnext.addClass('disabled');\n\t\t\t\t\t}\n\t\t\t\t\tif (active.prev()) {\n\t\t\t\t\t\tprev.removeClass('disabled');\n\t\t\t\t\t}\n\t\t\t\t\tapp.moduleCacheSet(cacheKey, nextElement.data('id'));\n\t\t\t\t});\n\t\t\t\tprev.on('click', function() {\n\t\t\t\t\tif ($(this).hasClass('disabled')) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar active = container.find('.js-carousel-item.active');\n\t\t\t\t\tactive.removeClass('active');\n\t\t\t\t\tvar prevElement = active.prev();\n\t\t\t\t\tprevElement.addClass('active');\n\t\t\t\t\tif (!prevElement.prev().length) {\n\t\t\t\t\t\tprev.addClass('disabled');\n\t\t\t\t\t}\n\t\t\t\t\tif (active.next()) {\n\t\t\t\t\t\tnext.removeClass('disabled');\n\t\t\t\t\t}\n\t\t\t\t\tapp.moduleCacheSet(cacheKey, prevElement.data('id'));\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tloadContents: function(url, data) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar aDeferred = jQuery.Deferred();\n\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tvar params = url;\n\t\t\tif (typeof data !== 'undefined') {\n\t\t\t\tparams = {};\n\t\t\t\tparams.url = url;\n\t\t\t\tparams.data = data;\n\t\t\t}\n\t\t\tAppConnector.requestPjax(params).done(function(responseData) {\n\t\t\t\tdetailContentsHolder.html(responseData);\n\t\t\t\tresponseData = detailContentsHolder.html();\n\t\t\t\t//thisInstance.triggerDisplayTypeEvent();\n\t\t\t\tthisInstance.registerBlockStatusCheckOnLoad();\n\t\t\t\t//Make select box more usability\n\t\t\t\tApp.Fields.Picklist.changeSelectElementView(detailContentsHolder);\n\t\t\t\t//Attach date picker event to date fields\n\t\t\t\tApp.Fields.Date.register(detailContentsHolder);\n\t\t\t\tthisInstance.getForm().validationEngine();\n\t\t\t\tapp.event.trigger('DetailView.LoadContents.AfterLoad', responseData);\n\t\t\t\taDeferred.resolve(responseData);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetUpdateFieldsArray: function() {\n\t\t\treturn this.updatedFields;\n\t\t},\n\t\t/**\n\t\t * Function to return related tab.\n\t\t * @return : jQuery Object.\n\t\t */\n\t\tgetTabByLabel: function(tabLabel) {\n\t\t\tvar tabs = this.getTabs();\n\t\t\tvar targetTab = false;\n\t\t\ttabs.each(function(index, element) {\n\t\t\t\tvar tab = jQuery(element);\n\t\t\t\tvar labelKey = tab.data('labelKey');\n\t\t\t\tif (labelKey == tabLabel) {\n\t\t\t\t\ttargetTab = tab;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn targetTab;\n\t\t},\n\t\tgetTabByModule: function(moduleName, relationId = '') {\n\t\t\tvar tabs = this.getTabs();\n\t\t\tvar targetTab = false;\n\t\t\ttabs.each(function(index, element) {\n\t\t\t\tvar tab = jQuery(element);\n\t\t\t\tif (\n\t\t\t\t\ttab.data('reference') == moduleName &&\n\t\t\t\t\t(!relationId || (relationId && relationId == tab.data('relation-id')))\n\t\t\t\t) {\n\t\t\t\t\ttargetTab = tab;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn targetTab;\n\t\t},\n\t\tselectModuleTab: function() {\n\t\t\tvar relatedTabContainer = this.getTabContainer();\n\t\t\tvar moduleTab = relatedTabContainer.find('li.module-tab');\n\t\t\tthis.deSelectAllrelatedTabs();\n\t\t\tthis.markTabAsSelected(moduleTab);\n\t\t},\n\t\tdeSelectAllrelatedTabs: function() {\n\t\t\tthis.getTabs().removeClass('active');\n\t\t},\n\t\tmarkTabAsSelected: function(tabElement) {\n\t\t\ttabElement.addClass('active');\n\t\t\t$(\n\t\t\t\t'.related .dropdown [data-reference=\"' +\n\t\t\t\t\ttabElement.data('reference') +\n\t\t\t\t\t'\"][data-relation-id=\"' +\n\t\t\t\t\ttabElement.data('relation-id') +\n\t\t\t\t\t'\"]'\n\t\t\t).addClass('active');\n\t\t},\n\t\treloadTabContent: function() {\n\t\t\tthis.getSelectedTab().trigger('click');\n\t\t},\n\t\tgetSelectedTab: function() {\n\t\t\tvar tabContainer = this.getTabContainer();\n\t\t\treturn tabContainer.find('.js-detail-tab.active:not(.d-none)');\n\t\t},\n\t\tgetTabContainer: function() {\n\t\t\treturn jQuery('div.related');\n\t\t},\n\t\tgetTabs: function() {\n\t\t\tvar topTabs = this.getTabContainer().find('li.baseLink:not(.d-none)');\n\t\t\tvar dropdownMenuTabs = this.getTabContainer().find('li:not(.baseLink)');\n\t\t\tdropdownMenuTabs.each(function(n, e) {\n\t\t\t\tvar currentTarget = jQuery(this);\n\t\t\t\tvar iteration = currentTarget.data('iteration');\n\t\t\t\tvar className = currentTarget.hasClass('mainNav') ? 'mainNav' : 'relatedNav';\n\t\t\t\tif (\n\t\t\t\t\titeration != undefined &&\n\t\t\t\t\ttopTabs.filter('.' + className + '[data-iteration=\"' + iteration + '\"]').length < 1\n\t\t\t\t) {\n\t\t\t\t\ttopTabs.push(currentTarget.get(0));\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn topTabs;\n\t\t},\n\t\tgetContentHolder: function() {\n\t\t\tif (this.detailViewContentHolder == false) {\n\t\t\t\tthis.detailViewContentHolder = jQuery('div.details div.contents');\n\t\t\t}\n\t\t\treturn this.detailViewContentHolder;\n\t\t},\n\t\t/**\n\t\t * Function which will give the detail view form\n\t\t * @return : jQuery element\n\t\t */\n\t\tgetForm: function() {\n\t\t\tif (this.detailViewForm == false) {\n\t\t\t\tthis.detailViewForm = jQuery('#detailView');\n\t\t\t}\n\t\t\treturn this.detailViewForm;\n\t\t},\n\t\tgetRecordId: function() {\n\t\t\treturn app.getRecordId();\n\t\t},\n\t\tgetRelatedModuleName: function() {\n\t\t\tif (jQuery('.relatedModuleName', this.getContentHolder()).length == 1) {\n\t\t\t\treturn jQuery('.relatedModuleName', this.getContentHolder()).val();\n\t\t\t}\n\t\t},\n\t\tsaveFieldValues: function(fieldDetailList) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\n\t\t\tvar recordId = this.getRecordId();\n\n\t\t\tvar data = {};\n\t\t\tif (typeof fieldDetailList !== 'undefined') {\n\t\t\t\tdata = fieldDetailList;\n\t\t\t}\n\t\t\tdata['record'] = recordId;\n\t\t\tdata['module'] = app.getModuleName();\n\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function(reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t})\n\t\t\t\t.fail((jqXHR, textStatus, errorThrown) => {\n\t\t\t\t\taDeferred.reject(jqXHR, textStatus, errorThrown);\n\t\t\t\t});\n\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetRelatedListCurrentPageNum: function() {\n\t\t\treturn jQuery('input[name=\"currentPageNum\"]', this.getContentHolder()).val();\n\t\t},\n\t\t/**\n\t\t * function to remove comment block if its exists.\n\t\t */\n\t\tremoveCommentBlockIfExists: function() {\n\t\t\t$('.js-add-comment-block', $('.js-comments-body', this.getContentHolder())).remove();\n\t\t},\n\t\t/**\n\t\t * function to get the Comment thread for the given parent.\n\t\t * params: Url to get the Comment thread\n\t\t */\n\t\tgetCommentThread: function(url) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tAppConnector.request(url)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to save comment\n\t\t */\n\t\tsaveCommentAjax: function(\n\t\t\telement,\n\t\t\tcommentMode,\n\t\t\tcommentContentValue,\n\t\t\teditCommentReason,\n\t\t\tcommentId,\n\t\t\tparentCommentId,\n\t\t\taDeferred\n\t\t) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({});\n\t\t\tvar commentInfoBlock = element.closest('.js-comment-single');\n\t\t\tvar relatedTo = commentInfoBlock.find('.related_to').val();\n\t\t\tif (!relatedTo) {\n\t\t\t\trelatedTo = thisInstance.getRecordId();\n\t\t\t}\n\t\t\tlet postData = {\n\t\t\t\tcommentcontent: commentContentValue.replace(/\\/|br|/gi, ''),\n\t\t\t\trelated_to: relatedTo,\n\t\t\t\tmodule: 'ModComments'\n\t\t\t};\n\n\t\t\tif (commentMode == 'edit') {\n\t\t\t\tpostData['record'] = commentId;\n\t\t\t\tpostData['reasontoedit'] = editCommentReason;\n\t\t\t\tpostData['parent_comments'] = parentCommentId;\n\t\t\t\tpostData['mode'] = 'edit';\n\t\t\t\tpostData['action'] = 'Save';\n\t\t\t} else if (commentMode == 'add') {\n\t\t\t\tpostData['parent_comments'] = commentId;\n\t\t\t\tpostData['action'] = 'SaveAjax';\n\t\t\t}\n\t\t\tAppConnector.request(postData)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (commentMode == 'add') {\n\t\t\t\t\t\tthisInstance.addRelationBetweenRecords(\n\t\t\t\t\t\t\t'ModComments',\n\t\t\t\t\t\t\tdata.result.id,\n\t\t\t\t\t\t\tthisInstance.getTabByLabel(thisInstance.detailViewRecentCommentsTabLabel)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tapp.event.trigger('DetailView.SaveComment.AfterAjax', commentInfoBlock, postData, data);\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\telement.removeAttr('disabled');\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t},\n\t\tsaveComment: function(e) {\n\t\t\tlet aDeferred = jQuery.Deferred(),\n\t\t\t\tcurrentTarget = jQuery(e.currentTarget),\n\t\t\t\tcommentMode = currentTarget.data('mode'),\n\t\t\t\tclosestCommentBlock = currentTarget.closest('.js-add-comment-block'),\n\t\t\t\tcommentContent = closestCommentBlock.find('.js-comment-content'),\n\t\t\t\tcommentContentValue = commentContent.html(),\n\t\t\t\terrorMsg,\n\t\t\t\teditCommentReason;\n\t\t\tif ('' === commentContentValue) {\n\t\t\t\terrorMsg = app.vtranslate('JS_LBL_COMMENT_VALUE_CANT_BE_EMPTY');\n\t\t\t\tcommentContent.validationEngine('showPrompt', errorMsg, 'error', 'bottomLeft', true);\n\t\t\t\taDeferred.reject(errorMsg);\n\t\t\t\treturn aDeferred.promise();\n\t\t\t}\n\t\t\tif ('edit' === commentMode) {\n\t\t\t\teditCommentReason = closestCommentBlock.find('[name=\"reasonToEdit\"]').val();\n\t\t\t}\n\t\t\tlet element = jQuery(e.currentTarget),\n\t\t\t\tcommentInfoHeader = closestCommentBlock.closest('.js-comment-details').find('.js-comment-info-header'),\n\t\t\t\tcommentId = commentInfoHeader.data('commentid'),\n\t\t\t\tparentCommentId = commentInfoHeader.data('parentcommentid');\n\t\t\tthis.saveCommentAjax(\n\t\t\t\telement,\n\t\t\t\tcommentMode,\n\t\t\t\tcommentContentValue,\n\t\t\t\teditCommentReason,\n\t\t\t\tcommentId,\n\t\t\t\tparentCommentId,\n\t\t\t\taDeferred\n\t\t\t);\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * function to return the UI of the comment.\n\t\t * return html\n\t\t */\n\t\tgetCommentUI: function(commentId) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar postData = {\n\t\t\t\tview: 'DetailAjax',\n\t\t\t\tmodule: 'ModComments',\n\t\t\t\trecord: commentId\n\t\t\t};\n\t\t\tAppConnector.request(postData)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * function to return cloned add comment block\n\t\t * return jQuery Obj.\n\t\t */\n\t\tgetCommentBlock: function() {\n\t\t\tlet clonedCommentBlock = jQuery('.basicAddCommentBlock', this.getContentHolder())\n\t\t\t\t.clone(true, true)\n\t\t\t\t.removeClass('basicAddCommentBlock d-none')\n\t\t\t\t.addClass('js-add-comment-block');\n\t\t\tclonedCommentBlock\n\t\t\t\t.find('.commentcontenthidden')\n\t\t\t\t.removeClass('commentcontenthidden')\n\t\t\t\t.addClass('js-comment-content');\n\t\t\treturn clonedCommentBlock;\n\t\t},\n\t\t/**\n\t\t * function to return cloned edit comment block\n\t\t * return jQuery Obj.\n\t\t */\n\t\tgetEditCommentBlock: function() {\n\t\t\tlet clonedCommentBlock = jQuery('.basicEditCommentBlock', this.getContentHolder())\n\t\t\t\t.clone(true, true)\n\t\t\t\t.removeClass('basicEditCommentBlock d-none')\n\t\t\t\t.addClass('js-add-comment-block');\n\t\t\tclonedCommentBlock\n\t\t\t\t.find('.commentcontenthidden')\n\t\t\t\t.removeClass('commentcontenthidden')\n\t\t\t\t.addClass('js-comment-content');\n\t\t\tnew App.Fields.Text.Completions(clonedCommentBlock.find('.js-completions'), { emojiPanel: false });\n\t\t\treturn clonedCommentBlock;\n\t\t},\n\t\t/*\n\t\t * Function to register the submit event for Send Sms\n\t\t */\n\t\tregisterSendSmsSubmitEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('body').on('submit', '#massSave', function(e) {\n\t\t\t\tvar form = jQuery(e.currentTarget);\n\t\t\t\tvar smsTextLength = form.find('#message').html().length;\n\t\t\t\tif (smsTextLength > 160) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\ttext: app.vtranslate('LBL_SMS_MAX_CHARACTERS_ALLOWED'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar submitButton = form.find(':submit');\n\t\t\t\tsubmitButton.attr('disabled', 'disabled');\n\t\t\t\tthisInstance.SendSmsSave(form);\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Function to Save and sending the Sms and hide the modal window of send sms\n\t\t */\n\t\tSendSmsSave: function(form) {\n\t\t\tvar progressInstance = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar SendSmsUrl = form.serializeFormData();\n\t\t\tAppConnector.request(SendSmsUrl)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tprogressInstance.progressIndicator({\n\t\t\t\t\t\tmode: 'hide'\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {});\n\t\t},\n\t\t/**\n\t\t * Function which will register events to update the record name in the detail view when any of\n\t\t * the name field is changed\n\t\t */\n\t\tregisterNameAjaxEditEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = thisInstance.getContentHolder();\n\t\t\tdetailContentsHolder.on(thisInstance.fieldUpdatedEvent, '.nameField', function(e, params) {\n\t\t\t\tvar form = thisInstance.getForm();\n\t\t\t\tvar nameFields = form.data('nameFields');\n\t\t\t\tvar recordLabel = '';\n\t\t\t\tfor (var index in nameFields) {\n\t\t\t\t\tif (index != 0) {\n\t\t\t\t\t\trecordLabel += ' ';\n\t\t\t\t\t}\n\n\t\t\t\t\tvar nameFieldName = nameFields[index];\n\t\t\t\t\trecordLabel += form.find('[name=\"' + nameFieldName + '\"]').val();\n\t\t\t\t}\n\t\t\t\tvar recordLabelElement = detailContentsHolder.closest('.contentsDiv').find('.recordLabel');\n\t\t\t\trecordLabelElement.text(recordLabel);\n\t\t\t});\n\t\t},\n\t\tupdateHeaderNameFields: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = thisInstance.getContentHolder();\n\t\t\tvar form = thisInstance.getForm();\n\t\t\tvar nameFields = form.data('nameFields');\n\t\t\tvar recordLabelElement = detailContentsHolder.closest('.contentsDiv').find('.recordLabel');\n\t\t\tvar title = '';\n\t\t\tfor (var index in nameFields) {\n\t\t\t\tvar nameFieldName = nameFields[index];\n\t\t\t\tvar nameField = form.find('[name=\"' + nameFieldName + '\"]');\n\t\t\t\tif (nameField.length > 0) {\n\t\t\t\t\tvar recordLabel = nameField.val();\n\t\t\t\t\ttitle += recordLabel + ' ';\n\t\t\t\t\trecordLabelElement.find('[class=\"' + nameFieldName + '\"]').text(recordLabel);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar salutatioField = recordLabelElement.find('.salutation');\n\t\t\tif (salutatioField.length > 0) {\n\t\t\t\tvar salutatioValue = salutatioField.text();\n\t\t\t\ttitle = salutatioValue + title;\n\t\t\t}\n\t\t\trecordLabelElement.attr('title', title);\n\t\t},\n\t\tregisterAjaxEditEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = thisInstance.getContentHolder();\n\t\t\tdetailContentsHolder.on(thisInstance.fieldUpdatedEvent, 'input,select,textarea', function(e) {\n\t\t\t\tthisInstance.updateHeaderValues(jQuery(e.currentTarget));\n\t\t\t});\n\t\t},\n\t\tupdateHeaderValues: function(currentElement) {\n\t\t\tvar thisInstance = this;\n\t\t\tif (currentElement.hasClass('nameField')) {\n\t\t\t\tthisInstance.updateHeaderNameFields();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar name = currentElement.attr('name');\n\t\t\tvar updatedFields = this.getUpdateFieldsArray();\n\t\t\tvar detailContentsHolder = thisInstance.getContentHolder();\n\t\t\tif (jQuery.inArray(name, updatedFields) != '-1') {\n\t\t\t\tvar recordLabel = currentElement.val();\n\t\t\t\tvar recordLabelElement = detailContentsHolder.closest('.contentsDiv').find('.' + name + '_label');\n\t\t\t\trecordLabelElement.text(recordLabel);\n\t\t\t}\n\t\t},\n\t\t/*\n\t\t * Function to register the click event of email field\n\t\t */\n\t\tregisterEmailFieldClickEvent: function() {\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tdetailContentsHolder.on('click', '.emailField', function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Function to register the click event of phone field\n\t\t */\n\t\tregisterPhoneFieldClickEvent: function() {\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tdetailContentsHolder.on('click', '.phoneField', function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Function to register the click event of url field\n\t\t */\n\t\tregisterUrlFieldClickEvent: function() {\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tdetailContentsHolder.on('click', '.urlField', function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register event for related list row click\n\t\t */\n\t\tregisterRelatedRowClickEvent: function() {\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tdetailContentsHolder.on('click', '.listViewEntries', function(e) {\n\t\t\t\tvar targetElement = jQuery(e.target, jQuery(e.currentTarget));\n\t\t\t\tif (targetElement.is('td:first-child') && targetElement.children('input[type=\"checkbox\"]').length > 0)\n\t\t\t\t\treturn;\n\t\t\t\tif (jQuery(e.target).is('input[type=\"checkbox\"]')) return;\n\t\t\t\tvar elem = jQuery(e.currentTarget);\n\t\t\t\tvar recordUrl = elem.data('recordurl');\n\t\t\t\tif (typeof recordUrl !== 'undefined') {\n\t\t\t\t\twindow.location.href = recordUrl;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tloadRelatedList: function(params) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tif (params == undefined) {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tvar relatedListInstance = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\tthis.getRecordId(),\n\t\t\t\tapp.getModuleName(),\n\t\t\t\tthis.getSelectedTab(),\n\t\t\t\tthis.getRelatedModuleName()\n\t\t\t);\n\t\t\trelatedListInstance.loadRelatedList(params).done(\n\t\t\t\tfunction(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t},\n\t\t\t\tfunction(textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t}\n\t\t\t);\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to register Event for Sorting\n\t\t */\n\t\tregisterEventForRelatedList: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tvar relatedModuleName = thisInstance.getRelatedModuleName();\n\t\t\tif (relatedModuleName) {\n\t\t\t\tvar relatedController = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\t\tthisInstance.getRecordId(),\n\t\t\t\t\tapp.getModuleName(),\n\t\t\t\t\tthisInstance.getSelectedTab(),\n\t\t\t\t\trelatedModuleName\n\t\t\t\t);\n\t\t\t\trelatedController.setRelatedContainer(detailContentsHolder);\n\t\t\t\trelatedController.registerRelatedEvents();\n\t\t\t}\n\t\t\tdetailContentsHolder.find('.detailViewBlockLink').each(function(n, block) {\n\t\t\t\tblock = $(block);\n\t\t\t\tvar blockContent = block.find('.blockContent');\n\t\t\t\tif (blockContent.is(':visible')) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\ttype: 'GET',\n\t\t\t\t\t\tdataType: 'html',\n\t\t\t\t\t\tdata: block.data('url')\n\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\tblockContent.html(response);\n\t\t\t\t\t\tvar relatedController = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\t\t\t\tthisInstance.getRecordId(),\n\t\t\t\t\t\t\tapp.getModuleName(),\n\t\t\t\t\t\t\tthisInstance.getSelectedTab(),\n\t\t\t\t\t\t\tblock.data('reference')\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelatedController.setRelatedContainer(blockContent);\n\t\t\t\t\t\trelatedController.registerRelatedEvents();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tdetailContentsHolder.find('.detailViewBlockLink .blockHeader').on('click', function(e) {\n\t\t\t\tconst target = $(e.target);\n\t\t\t\tif (\n\t\t\t\t\ttarget.is('input') ||\n\t\t\t\t\ttarget.is('button') ||\n\t\t\t\t\ttarget.parents().is('button') ||\n\t\t\t\t\ttarget.hasClass('js-stop-propagation') ||\n\t\t\t\t\ttarget.parents().hasClass('js-stop-propagation')\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst block = $(this).closest('.js-toggle-panel');\n\t\t\t\tconst blockContent = block.find('.blockContent');\n\t\t\t\tconst isEmpty = blockContent.is(':empty');\n\t\t\t\tif (!blockContent.is(':visible')) {\n\t\t\t\t\tblockContent.progressIndicator();\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\ttype: 'GET',\n\t\t\t\t\t\tdataType: 'html',\n\t\t\t\t\t\tdata: block.data('url')\n\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\tblockContent.html(response);\n\t\t\t\t\t\tconst relatedController = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\t\t\t\tthisInstance.getRecordId(),\n\t\t\t\t\t\t\tapp.getModuleName(),\n\t\t\t\t\t\t\tthisInstance.getSelectedTab(),\n\t\t\t\t\t\t\tblock.data('reference')\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelatedController.setRelatedContainer(blockContent);\n\t\t\t\t\t\tif (isEmpty) {\n\t\t\t\t\t\t\trelatedController.registerRelatedEvents();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trelatedController.registerPostLoadEvents();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterBlockAnimationEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tdetailContentsHolder.find('.blockHeader').on('click', function(e) {\n\t\t\t\tconst target = $(e.target);\n\t\t\t\tif (\n\t\t\t\t\ttarget.is('input') ||\n\t\t\t\t\ttarget.is('button') ||\n\t\t\t\t\ttarget.parents().is('button') ||\n\t\t\t\t\ttarget.hasClass('js-stop-propagation') ||\n\t\t\t\t\ttarget.parents().hasClass('js-stop-propagation')\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar currentTarget = $(this)\n\t\t\t\t\t.find('.js-block-toggle')\n\t\t\t\t\t.not('.d-none');\n\t\t\t\tvar blockId = currentTarget.data('id');\n\t\t\t\tvar closestBlock = currentTarget.closest('.js-toggle-panel');\n\t\t\t\tvar bodyContents = closestBlock.find('.blockContent');\n\t\t\t\tvar data = currentTarget.data();\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tif (data.mode === 'show') {\n\t\t\t\t\tbodyContents.addClass('d-none');\n\t\t\t\t\tapp.cacheSet(module + '.' + blockId, 0);\n\t\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\t\tclosestBlock.find('[data-mode=\"hide\"]').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tbodyContents.removeClass('d-none');\n\t\t\t\t\tapp.cacheSet(module + '.' + blockId, 1);\n\t\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\t\tclosestBlock.find('[data-mode=\"show\"]').removeClass('d-none');\n\t\t\t\t}\n\t\t\t\tapp.event.trigger('DetailView.js-block-toggle.PostLoad', bodyContents, data, thisInstance);\n\t\t\t});\n\t\t},\n\t\tregisterBlockStatusCheckOnLoad: function() {\n\t\t\tlet blocks = this.getContentHolder().find('.js-toggle-panel');\n\t\t\tlet module = app.getModuleName();\n\t\t\tblocks.each(function(index, block) {\n\t\t\t\tlet currentBlock = jQuery(block);\n\t\t\t\tlet dynamicAttr = currentBlock.attr('data-dynamic');\n\t\t\t\tif (typeof dynamicAttr !== typeof undefined && dynamicAttr !== false) {\n\t\t\t\t\tlet headerAnimationElement = currentBlock.find('.js-block-toggle').not('.d-none');\n\t\t\t\t\tlet bodyContents = currentBlock.closest('.js-toggle-panel').find('.blockContent');\n\t\t\t\t\tlet blockId = headerAnimationElement.data('id');\n\t\t\t\t\tlet cacheKey = module + '.' + blockId;\n\t\t\t\t\tlet value = app.cacheGet(cacheKey, null);\n\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\tif (value == 1) {\n\t\t\t\t\t\t\theaderAnimationElement.addClass('d-none');\n\t\t\t\t\t\t\tcurrentBlock.find(\"[data-mode='show']\").removeClass('d-none');\n\t\t\t\t\t\t\tbodyContents.removeClass('d-none');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\theaderAnimationElement.addClass('d-none');\n\t\t\t\t\t\t\tcurrentBlock.find(\"[data-mode='hide']\").removeClass('d-none');\n\t\t\t\t\t\t\tbodyContents.addClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to handle the ajax edit for detailview and summary view fields\n\t\t * which will expects the currentTdElement\n\t\t */\n\t\tajaxEditHandling: function(currentTdElement) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet readRecord = $('.setReadRecord'),\n\t\t\t\tdetailViewValue = $('.value', currentTdElement),\n\t\t\t\teditElement = $('.edit', currentTdElement),\n\t\t\t\tactionElement = $('.js-detail-quick-edit', currentTdElement),\n\t\t\t\tfieldElement = $('.fieldname', editElement);\n\t\t\treadRecord.prop('disabled', true);\n\t\t\t$(fieldElement).each(function(index, element) {\n\t\t\t\tlet fieldName = $(element).val(),\n\t\t\t\t\telementTarget = $(element),\n\t\t\t\t\telementName =\n\t\t\t\t\t\t$.inArray(elementTarget.data('type'), [\n\t\t\t\t\t\t\t'taxes',\n\t\t\t\t\t\t\t'sharedOwner',\n\t\t\t\t\t\t\t'multipicklist',\n\t\t\t\t\t\t\t'multiListFields',\n\t\t\t\t\t\t\t'multiDomain',\n\t\t\t\t\t\t\t'mailScannerFields',\n\t\t\t\t\t\t\t'mailScannerActions'\n\t\t\t\t\t\t]) != -1\n\t\t\t\t\t\t\t? fieldName + '[]'\n\t\t\t\t\t\t\t: fieldName;\n\t\t\t\tlet fieldElement = $('[name=\"' + elementName + '\"]:not([type=\"hidden\"])', editElement);\n\t\t\t\tif (fieldElement.attr('disabled') == 'disabled') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (editElement.length <= 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (editElement.is(':visible')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (fieldElement.attr('data-inputmask')) {\n\t\t\t\t\tfieldElement.inputmask();\n\t\t\t\t}\n\t\t\t\tdetailViewValue.addClass('d-none');\n\t\t\t\tactionElement.addClass('d-none');\n\t\t\t\teditElement\n\t\t\t\t\t.removeClass('d-none')\n\t\t\t\t\t.children()\n\t\t\t\t\t.filter('input[type!=\"hidden\"]input[type!=\"image\"],select')\n\t\t\t\t\t.filter(':first')\n\t\t\t\t\t.focus();\n\t\t\t\tlet saveHandler = function(e) {\n\t\t\t\t\tthisInstance.registerNameAjaxEditEvent();\n\t\t\t\t\tlet element = $(e.target);\n\t\t\t\t\tif ($(e.currentTarget).find('.dateTimePickerField').length) {\n\t\t\t\t\t\tif (element.closest('.drp-calendar').length || element.hasClass('drp-calendar')) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\telement.closest('.fieldValue').is(currentTdElement) ||\n\t\t\t\t\t\telement.hasClass('select2-selection__choice__remove') ||\n\t\t\t\t\t\telement.closest('.select2-container--open').length ||\n\t\t\t\t\t\telement.parents('.clockpicker-popover').length\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentTdElement.removeAttr('tabindex');\n\t\t\t\t\tcurrentTdElement.removeClass('is-edit-active');\n\t\t\t\t\tlet previousValue = elementTarget.data('prevValue'),\n\t\t\t\t\t\tajaxEditNewValue = elementTarget\n\t\t\t\t\t\t\t.closest('.edit')\n\t\t\t\t\t\t\t.find('[name=\"' + elementTarget.val() + '\"]')\n\t\t\t\t\t\t\t.val(),\n\t\t\t\t\t\tfieldInfo = Vtiger_Field_Js.getInstance(fieldElement.data('fieldinfo')),\n\t\t\t\t\t\tdateTimeField = [],\n\t\t\t\t\t\tdateTime = false;\n\t\t\t\t\tif (editElement.find('[data-fieldinfo]').length == 2) {\n\t\t\t\t\t\teditElement.find('[data-fieldinfo]').each(function() {\n\t\t\t\t\t\t\tlet field = {\n\t\t\t\t\t\t\t\tname: $(this).attr('name'),\n\t\t\t\t\t\t\t\ttype: $(this).data('fieldinfo').type\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (field['type'] == 'datetime') {\n\t\t\t\t\t\t\t\tdateTime = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdateTimeField.push(field);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (fieldElement.is('input:checkbox')) {\n\t\t\t\t\t\tif (fieldElement.is(':checked')) {\n\t\t\t\t\t\t\tajaxEditNewValue = '1';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tajaxEditNewValue = '0';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfieldElement = fieldElement.filter('[type=\"checkbox\"]');\n\t\t\t\t\t}\n\t\t\t\t\tif (fieldElement.validationEngine('validate')) {\n\t\t\t\t\t\tif (fieldElement.attr('data-inputmask')) {\n\t\t\t\t\t\t\tfieldElement.inputmask();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfunction toStr(v) {\n\t\t\t\t\t\treturn v === undefined || v === null ? '' : v + '';\n\t\t\t\t\t}\n\t\t\t\t\tfieldElement.validationEngine('hide');\n\t\t\t\t\tif (toStr(previousValue) === toStr(ajaxEditNewValue)) {\n\t\t\t\t\t\teditElement.addClass('d-none');\n\t\t\t\t\t\tdetailViewValue.removeClass('d-none');\n\t\t\t\t\t\tactionElement.removeClass('d-none');\n\t\t\t\t\t\treadRecord.prop('disabled', false);\n\t\t\t\t\t\teditElement.off('clickoutside');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet preFieldSaveEvent = jQuery.Event(thisInstance.fieldPreSave),\n\t\t\t\t\t\t\tfieldNameValueMap = {};\n\t\t\t\t\t\tfieldElement.trigger(preFieldSaveEvent, {\n\t\t\t\t\t\t\tfieldValue: ajaxEditNewValue,\n\t\t\t\t\t\t\trecordId: thisInstance.getRecordId()\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (preFieldSaveEvent.isDefaultPrevented()) {\n\t\t\t\t\t\t\treadRecord.prop('disabled', false);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentTdElement.progressIndicator();\n\t\t\t\t\t\teditElement.addClass('d-none');\n\t\t\t\t\t\tfieldNameValueMap['value'] = ajaxEditNewValue;\n\t\t\t\t\t\tfieldNameValueMap['field'] = fieldName;\n\t\t\t\t\t\tfieldNameValueMap = thisInstance.getCustomFieldNameValueMap(fieldNameValueMap);\n\t\t\t\t\t\tthisInstance\n\t\t\t\t\t\t\t.saveFieldValues(fieldNameValueMap)\n\t\t\t\t\t\t\t.done(function(response) {\n\t\t\t\t\t\t\t\teditElement.off('clickoutside');\n\t\t\t\t\t\t\t\treadRecord.prop('disabled', false);\n\t\t\t\t\t\t\t\tcurrentTdElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tdetailViewValue.removeClass('d-none');\n\t\t\t\t\t\t\t\tactionElement.removeClass('d-none');\n\t\t\t\t\t\t\t\tif (!response.success) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst postSaveRecordDetails = response.result;\n\t\t\t\t\t\t\t\tlet displayValue = postSaveRecordDetails[fieldName].display_value,\n\t\t\t\t\t\t\t\t\tprevDisplayValue = postSaveRecordDetails[fieldName].prev_display_value;\n\t\t\t\t\t\t\t\tif (dateTimeField.length && dateTime) {\n\t\t\t\t\t\t\t\t\tdisplayValue =\n\t\t\t\t\t\t\t\t\t\tpostSaveRecordDetails[dateTimeField[0].name].display_value +\n\t\t\t\t\t\t\t\t\t\t' ' +\n\t\t\t\t\t\t\t\t\t\tpostSaveRecordDetails[dateTimeField[1].name].display_value;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdetailViewValue.html(displayValue);\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\t\ttext:\n\t\t\t\t\t\t\t\t\t\t'<b>' +\n\t\t\t\t\t\t\t\t\t\tfieldInfo.data.label +\n\t\t\t\t\t\t\t\t\t\t'</b><br>' +\n\t\t\t\t\t\t\t\t\t\t'<b>' +\n\t\t\t\t\t\t\t\t\t\tapp.vtranslate('JS_SAVED_FROM') +\n\t\t\t\t\t\t\t\t\t\t'</b>: ' +\n\t\t\t\t\t\t\t\t\t\tprevDisplayValue +\n\t\t\t\t\t\t\t\t\t\t'<br> ' +\n\t\t\t\t\t\t\t\t\t\t'<b>' +\n\t\t\t\t\t\t\t\t\t\tapp.vtranslate('JS_SAVED_TO') +\n\t\t\t\t\t\t\t\t\t\t'</b>: ' +\n\t\t\t\t\t\t\t\t\t\tdisplayValue,\n\t\t\t\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\t\t\t\ttextTrusted: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (postSaveRecordDetails['isViewable'] === false) {\n\t\t\t\t\t\t\t\t\tlet urlObject = app.convertUrlToObject(window.location.href);\n\t\t\t\t\t\t\t\t\tif (window !== window.parent) {\n\t\t\t\t\t\t\t\t\t\twindow.parent.location.href =\n\t\t\t\t\t\t\t\t\t\t\t'index.php?module=' + urlObject['module'] + '&view=ListPreview';\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = 'index.php?module=' + urlObject['module'] + '&view=List';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (postSaveRecordDetails['isEditable'] === false) {\n\t\t\t\t\t\t\t\t\t$.progressIndicator({\n\t\t\t\t\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (window !== window.parent) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = window.location.href.replace(\n\t\t\t\t\t\t\t\t\t\t\t'view=Detail',\n\t\t\t\t\t\t\t\t\t\t\t'view=DetailPreview'\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfieldElement.trigger(thisInstance.fieldUpdatedEvent, {\n\t\t\t\t\t\t\t\t\told: previousValue,\n\t\t\t\t\t\t\t\t\tnew: ajaxEditNewValue\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tajaxEditNewValue = ajaxEditNewValue === undefined ? '' : ajaxEditNewValue; //data cannot be undefined\n\t\t\t\t\t\t\t\telementTarget.data('prevValue', ajaxEditNewValue);\n\t\t\t\t\t\t\t\tfieldElement.data('selectedValue', ajaxEditNewValue);\n\t\t\t\t\t\t\t\tif (thisInstance.targetPicklistChange) {\n\t\t\t\t\t\t\t\t\tif ($('.js-widget-general-info', thisInstance.getForm()).length > 0) {\n\t\t\t\t\t\t\t\t\t\tthisInstance.targetPicklist.find('.js-detail-quick-edit').trigger('click');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthisInstance.targetPicklist.trigger('click');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthisInstance.targetPicklistChange = false;\n\t\t\t\t\t\t\t\t\tthisInstance.targetPicklist = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet selectedTabElement = thisInstance.getSelectedTab();\n\t\t\t\t\t\t\t\tif (selectedTabElement.data('linkKey') == thisInstance.detailViewSummaryTabLabel) {\n\t\t\t\t\t\t\t\t\tlet detailContentsHolder = thisInstance.getContentHolder();\n\t\t\t\t\t\t\t\t\tthisInstance.reloadTabContent();\n\t\t\t\t\t\t\t\t\tthisInstance.registerSummaryViewContainerEvents(detailContentsHolder);\n\t\t\t\t\t\t\t\t\tthisInstance.registerEventForPicklistDependencySetup(thisInstance.getForm());\n\t\t\t\t\t\t\t\t\tthisInstance.registerEventForRelatedList();\n\t\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\t\tselectedTabElement.data('linkKey') == thisInstance.detailViewDetailsTabLabel\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tthisInstance.registerEventForPicklistDependencySetup(thisInstance.getForm());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthisInstance.updateRecordsPDFTemplateBtn(thisInstance.getForm());\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function(jqXHR, textStatus, errorThrown) {\n\t\t\t\t\t\t\t\teditElement.addClass('d-none');\n\t\t\t\t\t\t\t\tdetailViewValue.removeClass('d-none');\n\t\t\t\t\t\t\t\tactionElement.removeClass('d-none');\n\t\t\t\t\t\t\t\teditElement.off('clickoutside');\n\t\t\t\t\t\t\t\treadRecord.prop('disabled', false);\n\t\t\t\t\t\t\t\tcurrentTdElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_SAVE_NOTIFY_FAIL'),\n\t\t\t\t\t\t\t\t\ttext: textStatus\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\teditElement.on('clickoutside', saveHandler);\n\t\t\t});\n\t\t},\n\t\ttriggerDisplayTypeEvent: function() {\n\t\t\tvar widthType = app.cacheGet('widthType', 'narrowWidthType');\n\t\t\tif (widthType) {\n\t\t\t\tvar elements = jQuery('#detailView').find('td');\n\t\t\t\telements.addClass(widthType);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Function updates the hidden elements which is used for creating relations\n\t\t */\n\t\taddElementsToQuickCreateForCreatingRelation: function(container, customParams) {\n\t\t\tjQuery('<input type=\"hidden\" name=\"relationOperation\" value=\"true\" >').appendTo(container);\n\t\t\tjQuery.each(customParams, function(index, value) {\n\t\t\t\tjQuery('<input type=\"hidden\" name=\"' + index + '\" value=\"' + value + '\" >').appendTo(container);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register event for activity widget for adding\n\t\t * event and task from the widget\n\t\t */\n\t\tregisterEventForActivityWidget: function() {\n\t\t\tvar thisInstance = this;\n\n\t\t\t/*\n\t\t\t * Register click event for add button in Related Activities widget\n\t\t\t */\n\t\t\tjQuery('.createActivity').on('click', function(e) {\n\t\t\t\tvar referenceModuleName = 'Calendar';\n\t\t\t\tvar recordId = thisInstance.getRecordId();\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\n\t\t\t\tlet customParams = {};\n\t\t\t\tcustomParams['sourceModule'] = module;\n\t\t\t\tcustomParams['sourceRecord'] = recordId;\n\t\t\t\tif (\n\t\t\t\t\tmodule != '' &&\n\t\t\t\t\treferenceModuleName != '' &&\n\t\t\t\t\ttypeof thisInstance.referenceFieldNames[referenceModuleName] !== 'undefined' &&\n\t\t\t\t\ttypeof thisInstance.referenceFieldNames[referenceModuleName][module] !== 'undefined'\n\t\t\t\t) {\n\t\t\t\t\tvar relField = thisInstance.referenceFieldNames[referenceModuleName][module];\n\t\t\t\t\tcustomParams[relField] = recordId;\n\t\t\t\t}\n\t\t\t\tvar fullFormUrl = element.data('url');\n\t\t\t\tvar preQuickCreateSave = function(data) {\n\t\t\t\t\tthisInstance.addElementsToQuickCreateForCreatingRelation(data, customParams);\n\t\t\t\t\tvar taskGoToFullFormButton = data\n\t\t\t\t\t\t.find('[class^=\"CalendarQuikcCreateContents\"]')\n\t\t\t\t\t\t.find('.js-full-editlink');\n\t\t\t\t\tvar eventsGoToFullFormButton = data\n\t\t\t\t\t\t.find('[class^=\"EventsQuikcCreateContents\"]')\n\t\t\t\t\t\t.find('.js-full-editlink');\n\t\t\t\t\tvar taskFullFormUrl = taskGoToFullFormButton.data('url') + '&' + fullFormUrl;\n\t\t\t\t\tvar eventsFullFormUrl = eventsGoToFullFormButton.data('url') + '&' + fullFormUrl;\n\t\t\t\t\ttaskGoToFullFormButton.data('url', taskFullFormUrl);\n\t\t\t\t\teventsGoToFullFormButton.data('url', eventsFullFormUrl);\n\t\t\t\t};\n\t\t\t\tvar callbackFunction = function() {\n\t\t\t\t\tvar widgetContainer = element.closest('.js-detail-widget');\n\t\t\t\t\tvar widgetContentBlock = widgetContainer.find('.widgetContentBlock');\n\t\t\t\t\tvar urlParams = widgetContentBlock.data('url');\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttype: 'GET',\n\t\t\t\t\t\tdataType: 'html',\n\t\t\t\t\t\tdata: urlParams\n\t\t\t\t\t};\n\t\t\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\t\t\tvar activitiesWidget = widgetContainer.find('.js-detail-widget-content');\n\t\t\t\t\t\tactivitiesWidget.html(data);\n\t\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(activitiesWidget);\n\t\t\t\t\t\tthisInstance.loadWidget($('.widgetContentBlock[data-type=\"Updates\"]'));\n\t\t\t\t\t\tthisInstance.loadWidget($('.widgetContentBlock[data-name=\"Calendar\"]'));\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\tlet QuickCreateParams = {};\n\t\t\t\tQuickCreateParams['callbackPostShown'] = preQuickCreateSave;\n\t\t\t\tQuickCreateParams['callbackFunction'] = callbackFunction;\n\t\t\t\tQuickCreateParams['data'] = Object.assign({}, customParams);\n\t\t\t\tQuickCreateParams['noCache'] = false;\n\t\t\t\tVtiger_Header_Js.getInstance().quickCreateModule(referenceModuleName, QuickCreateParams);\n\t\t\t});\n\t\t},\n\t\tgetEndDate: function(startDate) {\n\t\t\tvar dateTab = startDate.split('-');\n\t\t\tvar date = new Date(dateTab[0], dateTab[1], dateTab[2]);\n\t\t\tvar newDate = new Date();\n\n\t\t\tnewDate.setDate(date.getDate() + 2);\n\t\t\treturn app.getStringDate(newDate);\n\t\t},\n\t\tgetSingleEventType: function(modDay, id, type) {\n\t\t\tvar dateStartEl = jQuery('[name=\"date_start\"]');\n\t\t\tvar dateStartVal = jQuery(dateStartEl).val();\n\t\t\tvar dateStartFormat = jQuery(dateStartEl).data('date-format');\n\t\t\tvar validDateFromat = Vtiger_Helper_Js.convertToDateString(dateStartVal, dateStartFormat, modDay, type);\n\t\t\tvar map = jQuery.extend({}, ['#b6a996,black']);\n\n\t\t\tvar params = {\n\t\t\t\tmodule: 'Calendar',\n\t\t\t\taction: 'Feed',\n\t\t\t\tstart: validDateFromat,\n\t\t\t\tend: this.getEndDate(validDateFromat),\n\t\t\t\ttype: type,\n\t\t\t\tmapping: map\n\t\t\t};\n\n\t\t\tAppConnector.request(params).done(function(events) {\n\t\t\t\tvar testDate = Vtiger_Helper_Js.convertToDateString(dateStartVal, dateStartFormat, modDay);\n\t\t\t\tif (!jQuery.isEmptyObject(events)) {\n\t\t\t\t\tif (events[0]['activitytype'] === 'Task') {\n\t\t\t\t\t\tfor (var ev in events) {\n\t\t\t\t\t\t\tif (events[ev]['start'].indexOf(testDate) > -1) {\n\t\t\t\t\t\t\t\tjQuery('#' + id + ' .table').append(\n\t\t\t\t\t\t\t\t\t'<tr><td><a target=\"_blank\" href=\"' +\n\t\t\t\t\t\t\t\t\t\tevents[ev]['url'] +\n\t\t\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\t\t\tevents[ev]['title'] +\n\t\t\t\t\t\t\t\t\t\t'</a></td></tr>'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = 0; i < events[0].length; i++) {\n\t\t\t\t\t\t\tif (events[0][i]['start'].indexOf(testDate) > -1) {\n\t\t\t\t\t\t\t\tjQuery('#' + id + ' .table').append(\n\t\t\t\t\t\t\t\t\t'<tr><td><a target=\"_blank\" href=\"' +\n\t\t\t\t\t\t\t\t\t\tevents[0][i]['url'] +\n\t\t\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\t\t\tevents[0][i]['title'] +\n\t\t\t\t\t\t\t\t\t\t'</a></td></tr>'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to add module related record from summary widget\n\t\t */\n\t\tregisterFilterForAddingModuleRelatedRecordFromSummaryWidget: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.find('.createRecordFromFilter').on('click', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tvar summaryWidgetContainer = currentElement.closest('.js-detail-widget');\n\t\t\t\tvar referenceModuleName = summaryWidgetContainer.data('moduleName');\n\t\t\t\tvar quickcreateUrl = currentElement.data('url');\n\t\t\t\tvar parentId = thisInstance.getRecordId();\n\t\t\t\tvar quickCreateParams = {};\n\t\t\t\tvar relatedField = currentElement.data('prf');\n\t\t\t\tvar autoCompleteFields = currentElement.data('acf');\n\t\t\t\tvar moduleName = currentElement\n\t\t\t\t\t.closest('.js-detail-widget-header')\n\t\t\t\t\t.find('[name=\"relatedModule\"]')\n\t\t\t\t\t.val();\n\t\t\t\tvar relatedParams = {};\n\t\t\t\tvar postQuickCreateSave = function(data) {\n\t\t\t\t\tthisInstance.postSummaryWidgetAddRecord(data, currentElement);\n\t\t\t\t\tif (referenceModuleName == 'ProjectTask') {\n\t\t\t\t\t\tthisInstance.loadModuleSummary();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (typeof relatedField !== 'undefined') {\n\t\t\t\t\trelatedParams[relatedField] = parentId;\n\t\t\t\t}\n\t\t\t\tif (typeof autoCompleteFields !== 'undefined') {\n\t\t\t\t\t$.each(autoCompleteFields, function(index, value) {\n\t\t\t\t\t\trelatedParams[index] = value;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (Object.keys(relatedParams).length > 0) {\n\t\t\t\t\tquickCreateParams['data'] = relatedParams;\n\t\t\t\t}\n\t\t\t\tquickCreateParams['noCache'] = true;\n\t\t\t\tquickCreateParams['callbackFunction'] = postQuickCreateSave;\n\t\t\t\tvar progress = jQuery.progressIndicator({\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlet headerInstance;\n\t\t\t\tif (window !== window.parent) {\n\t\t\t\t\theaderInstance = window.parent.Vtiger_Header_Js.getInstance();\n\t\t\t\t} else {\n\t\t\t\t\theaderInstance = Vtiger_Header_Js.getInstance();\n\t\t\t\t}\n\t\t\t\theaderInstance.getQuickCreateForm(quickcreateUrl, moduleName, quickCreateParams).done(function(data) {\n\t\t\t\t\theaderInstance.handleQuickCreateData(data, quickCreateParams);\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontainer.find('button.selectRelation').on('click', function(e) {\n\t\t\t\tlet summaryWidgetContainer = jQuery(e.currentTarget).closest('.js-detail-widget');\n\t\t\t\tlet referenceModuleName = summaryWidgetContainer.data('moduleName');\n\t\t\t\tlet restrictionsField = $(this).data('rf');\n\t\t\t\tlet params = {\n\t\t\t\t\tmodule: referenceModuleName,\n\t\t\t\t\tsrc_module: app.getModuleName(),\n\t\t\t\t\tsrc_record: thisInstance.getRecordId(),\n\t\t\t\t\tmulti_select: true,\n\t\t\t\t\trelationId: summaryWidgetContainer.data('relationId')\n\t\t\t\t};\n\t\t\t\tif (restrictionsField && Object.keys(restrictionsField).length > 0) {\n\t\t\t\t\tparams['search_key'] = restrictionsField.key;\n\t\t\t\t\tparams['search_value'] = restrictionsField.name;\n\t\t\t\t}\n\t\t\t\tapp.showRecordsList(params, (modal, instance) => {\n\t\t\t\t\tinstance.setSelectEvent(responseData => {\n\t\t\t\t\t\tthisInstance\n\t\t\t\t\t\t\t.addRelationBetweenRecords(referenceModuleName, Object.keys(responseData))\n\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\tthisInstance.loadWidget(summaryWidgetContainer.find('.widgetContentBlock'));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterAddingInventoryRecords: function() {\n\t\t\tjQuery('.createInventoryRecordFromFilter').on('click', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tvar createUrl = currentElement.data('url');\n\t\t\t\tvar autoCompleteFields = currentElement.data('acf');\n\t\t\t\tvar addidtionalParams = '';\n\t\t\t\tif (typeof autoCompleteFields !== 'undefined') {\n\t\t\t\t\t$.each(autoCompleteFields, function(index, value) {\n\t\t\t\t\t\taddidtionalParams = '&' + index + '=' + value;\n\t\t\t\t\t\tcreateUrl = createUrl.concat(addidtionalParams);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twindow.location.href = createUrl;\n\t\t\t});\n\t\t},\n\t\tregisterEmailEvent: function() {\n\t\t\tthis.getContentHolder()\n\t\t\t\t.find('.resetRelationsEmail')\n\t\t\t\t.on('click', function(e) {\n\t\t\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t\t\tmessage: app.vtranslate('JS_EMAIL_RESET_RELATIONS_CONFIRMATION')\n\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'OSSMailView',\n\t\t\t\t\t\t\taction: 'Relation',\n\t\t\t\t\t\t\tmoduleName: app.getModuleName(),\n\t\t\t\t\t\t\trecord: app.getRecordId()\n\t\t\t\t\t\t}).done(function(d) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage({ text: d.result });\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\tgetFiltersDataAndLoad: function(e, params) {\n\t\t\tvar data = this.getFiltersData(e, params);\n\t\t\tthis.loadWidget(data['container'], data['params']);\n\t\t},\n\t\tgetFiltersData: function(e, params) {\n\t\t\tif (e.currentTarget) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t} else {\n\t\t\t\tcurrentElement = e;\n\t\t\t}\n\t\t\tvar summaryWidgetContainer = currentElement.closest('.js-detail-widget');\n\t\t\tvar widget = summaryWidgetContainer.find('.widgetContentBlock');\n\t\t\tvar url = '&' + widget.data('url');\n\t\t\tvar urlParams = {};\n\t\t\turl.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {\n\t\t\t\turlParams[key] = value;\n\t\t\t});\n\t\t\tvar urlNewParams = [];\n\t\t\tsummaryWidgetContainer\n\t\t\t\t.find('.js-detail-widget .js-switch, .js-detail-widget-header .js-filter_field')\n\t\t\t\t.each(function(n, item) {\n\t\t\t\t\tvar value = '';\n\t\t\t\t\tvar element = jQuery(item);\n\t\t\t\t\tvar name = element.data('urlparams');\n\t\t\t\t\tif (element.attr('type') == 'radio') {\n\t\t\t\t\t\tif (element.prop('checked')) {\n\t\t\t\t\t\t\tvalue =\n\t\t\t\t\t\t\t\ttypeof element.data('on-val') !== 'undefined'\n\t\t\t\t\t\t\t\t\t? element.data('on-val')\n\t\t\t\t\t\t\t\t\t: element.data('off-val');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar selectedFilter = element.find('option:selected').val();\n\t\t\t\t\t\tvar fieldlable = element.data('fieldlable');\n\t\t\t\t\t\tvar filter = element.data('filter');\n\t\t\t\t\t\tif (selectedFilter != fieldlable) {\n\t\t\t\t\t\t\tvalue = [[filter, 'e', selectedFilter]];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (name && value) {\n\t\t\t\t\t\tif (name in urlNewParams) {\n\t\t\t\t\t\t\turlNewParams[name].push(value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\turlNewParams[name] = [value];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\tif (params != undefined) {\n\t\t\t\t$.extend(urlNewParams, params);\n\t\t\t}\n\t\t\treturn { container: $(widget), params: $.extend(urlParams, urlNewParams) };\n\t\t},\n\t\tregisterChangeFilterForWidget: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('.js-switch').on('change', function(e, state) {\n\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t.closest('.js-switch__btn')\n\t\t\t\t\t.addClass('active')\n\t\t\t\t\t.siblings()\n\t\t\t\t\t.removeClass('active');\n\t\t\t\tthisInstance.getFiltersDataAndLoad(e);\n\t\t\t});\n\t\t\tjQuery('.js-filter_field').on('select2:select', function(e, state) {\n\t\t\t\tthisInstance.getFiltersDataAndLoad(e);\n\t\t\t});\n\t\t},\n\t\tregisterChangeSwitchForWidget: function(summaryViewContainer) {\n\t\t\tvar thisInstance = this;\n\t\t\tsummaryViewContainer.find('.activityWidgetContainer').on('change', '.js-switch', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tvar summaryWidgetContainer = currentElement.closest('.js-detail-widget');\n\t\t\t\tvar widget = summaryWidgetContainer.find('.widgetContentBlock');\n\t\t\t\tvar url = widget.data('url');\n\t\t\t\turl = url.replace('&type=current', '').replace('&type=history', '');\n\t\t\t\turl += '&type=';\n\t\t\t\tif (typeof currentElement.data('on-val') !== 'undefined') {\n\t\t\t\t\tsummaryWidgetContainer.find('.ativitiesPagination').removeClass('d-none');\n\t\t\t\t\turl += 'current';\n\t\t\t\t\turl = url.replace('&sortorder=DESC', '&sortorder=ASC');\n\t\t\t\t} else if (typeof currentElement.data('off-val') !== 'undefined') {\n\t\t\t\t\tsummaryWidgetContainer.find('.ativitiesPagination').addClass('d-none');\n\t\t\t\t\turl += 'history';\n\t\t\t\t\turl = url.replace('&sortorder=ASC', '&sortorder=DESC');\n\t\t\t\t}\n\t\t\t\twidget.data('url', url);\n\t\t\t\tthisInstance.loadWidget($(widget));\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register all the events related to summary view widgets\n\t\t */\n\t\tregisterSummaryViewContainerEvents: function(summaryViewContainer) {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.registerEventForActivityWidget();\n\t\t\tthis.registerChangeFilterForWidget();\n\t\t\tthis.registerChangeSwitchForWidget(summaryViewContainer);\n\t\t\tthis.registerAddingInventoryRecords();\n\t\t\tthis.registerEmailEvent();\n\t\t\t/**\n\t\t\t * Function to handle the ajax edit for summary view fields\n\t\t\t */\n\t\t\tsummaryViewContainer.off('click').on('click', '.row .js-detail-quick-edit', function(e) {\n\t\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\tvar currentTdElement = currentTarget.closest('.fieldValue');\n\t\t\t\tthisInstance.ajaxEditHandling(currentTdElement);\n\t\t\t});\n\t\t\t/**\n\t\t\t * Function to handle actions after ajax save in summary view\n\t\t\t */\n\t\t\tsummaryViewContainer.on(thisInstance.fieldUpdatedEvent, '.js-widget-general-info', function() {\n\t\t\t\tlet updatesWidget = summaryViewContainer.find(\"[data-type='Updates']\"),\n\t\t\t\t\tparams;\n\t\t\t\tif (updatesWidget.length) {\n\t\t\t\t\tparams = thisInstance.getFiltersData(updatesWidget);\n\t\t\t\t\tupdatesWidget\n\t\t\t\t\t\t.find('.btnChangesReviewedOn')\n\t\t\t\t\t\t.parent()\n\t\t\t\t\t\t.remove();\n\t\t\t\t\tthisInstance.loadWidget(updatesWidget, params['params']);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsummaryViewContainer.on('click', '.editDefaultStatus', function(e) {\n\t\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\t\tcurrentTarget.popover('hide');\n\t\t\t\tvar url = currentTarget.data('url');\n\t\t\t\tif (url) {\n\t\t\t\t\tif (currentTarget.hasClass('showEdit')) {\n\t\t\t\t\t\tvar headerInstance = Vtiger_Header_Js.getInstance();\n\t\t\t\t\t\tif (window !== window.parent) {\n\t\t\t\t\t\t\theaderInstance = window.parent.Vtiger_Header_Js.getInstance();\n\t\t\t\t\t\t}\n\t\t\t\t\t\theaderInstance.getQuickCreateForm(url, 'Calendar', { noCache: true }).done(data => {\n\t\t\t\t\t\t\theaderInstance.handleQuickCreateData(data, {\n\t\t\t\t\t\t\t\tcallbackFunction: () => {\n\t\t\t\t\t\t\t\t\tlet widget = currentTarget.closest('.widgetContentBlock');\n\t\t\t\t\t\t\t\t\tif (widget.length) {\n\t\t\t\t\t\t\t\t\t\tthisInstance.loadWidget(widget);\n\t\t\t\t\t\t\t\t\t\tlet updatesWidget = thisInstance\n\t\t\t\t\t\t\t\t\t\t\t.getContentHolder()\n\t\t\t\t\t\t\t\t\t\t\t.find(\"[data-type='Updates']\");\n\t\t\t\t\t\t\t\t\t\tif (updatesWidget.length > 0) {\n\t\t\t\t\t\t\t\t\t\t\tthisInstance.loadWidget(updatesWidget);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthisInstance.loadRelatedList();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthisInstance.registerRelatedModulesRecordCount();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapp.showModalWindow(null, url);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * Register the event to edit Description for related activities\n\t\t\t */\n\t\t\tsummaryViewContainer.on('click', '.editDescription', function(e) {\n\t\t\t\tlet currentTarget = jQuery(e.currentTarget),\n\t\t\t\t\tcurrentDiv = currentTarget.closest('.activityDescription'),\n\t\t\t\t\teditElement = currentDiv.find('.edit'),\n\t\t\t\t\tdetailViewElement = currentDiv.find('.value'),\n\t\t\t\t\tdescriptionText = currentDiv.find('.js-description-text'),\n\t\t\t\t\tdescriptionEmpty = currentDiv.find('.js-no-description'),\n\t\t\t\t\tsaveButton = currentDiv.find('.js-save-description'),\n\t\t\t\t\tcloseButton = currentDiv.find('.js-close-description'),\n\t\t\t\t\tactivityButtonContainer = currentDiv.find('.js-activity-buttons__container'),\n\t\t\t\t\tfieldnameElement = jQuery('.fieldname', editElement),\n\t\t\t\t\tfieldName = fieldnameElement.val(),\n\t\t\t\t\tfieldElement = jQuery('[name=\"' + fieldName + '\"]', editElement),\n\t\t\t\t\tcallbackFunction = () => {\n\t\t\t\t\t\tlet previousValue = fieldnameElement.data('prevValue'),\n\t\t\t\t\t\t\tajaxEditNewValue = fieldElement.val(),\n\t\t\t\t\t\t\tajaxEditNewLable = fieldElement.val(),\n\t\t\t\t\t\t\tactivityDiv = currentDiv.closest('.activityEntries'),\n\t\t\t\t\t\t\tactivityId = activityDiv.find('.activityId').val(),\n\t\t\t\t\t\t\tmoduleName = activityDiv.find('.activityModule').val(),\n\t\t\t\t\t\t\tactivityType = activityDiv.find('.activityType').val();\n\t\t\t\t\t\tif (previousValue == ajaxEditNewValue) {\n\t\t\t\t\t\t\tcloseDescription();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrentDiv.progressIndicator();\n\t\t\t\t\t\t\teditElement.add(activityButtonContainer).addClass('d-none');\n\t\t\t\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\t\t\t\tresolve(fieldElement.validationEngine('validate'));\n\t\t\t\t\t\t\t}).then(errorExists => {\n\t\t\t\t\t\t\t\t//If validation fails\n\t\t\t\t\t\t\t\tif (errorExists) {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.addClickOutSideEvent(currentDiv, callbackFunction);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tajaxEditNewValue = fieldElement.val(); //update editor value after conversion\n\t\t\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\t\t\taction: 'SaveAjax',\n\t\t\t\t\t\t\t\t\t\trecord: activityId,\n\t\t\t\t\t\t\t\t\t\tfield: fieldName,\n\t\t\t\t\t\t\t\t\t\tvalue: ajaxEditNewValue,\n\t\t\t\t\t\t\t\t\t\tmodule: moduleName,\n\t\t\t\t\t\t\t\t\t\tactivitytype: activityType\n\t\t\t\t\t\t\t\t\t}).done(() => {\n\t\t\t\t\t\t\t\t\t\tcurrentDiv.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\t\t\tdetailViewElement.removeClass('d-none');\n\t\t\t\t\t\t\t\t\t\tcurrentTarget.show();\n\t\t\t\t\t\t\t\t\t\tdescriptionText.html(ajaxEditNewLable);\n\t\t\t\t\t\t\t\t\t\tfieldnameElement.data('prevValue', ajaxEditNewValue);\n\t\t\t\t\t\t\t\t\t\tif (ajaxEditNewValue === '') {\n\t\t\t\t\t\t\t\t\t\t\tdescriptionEmpty.removeClass('d-none');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdescriptionEmpty.addClass('d-none');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcloseDescription = function() {\n\t\t\t\t\t\tfieldElement.val(fieldnameElement.data('prevValue'));\n\t\t\t\t\t\teditElement.add(activityButtonContainer).addClass('d-none');\n\t\t\t\t\t\tdetailViewElement.removeClass('d-none');\n\t\t\t\t\t\tcurrentTarget.show();\n\t\t\t\t\t};\n\t\t\t\tcurrentTarget.hide();\n\t\t\t\tdetailViewElement.addClass('d-none');\n\t\t\t\tactivityButtonContainer.removeClass('d-none');\n\t\t\t\teditElement.removeClass('d-none').show();\n\t\t\t\tsaveButton.off('click').one('click', callbackFunction);\n\t\t\t\tcloseButton.off('click').one('click', closeDescription);\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * Register click event for add button in Related widgets\n\t\t\t * to add record from widget\n\t\t\t */\n\n\t\t\tjQuery('.changeDetailViewMode').on('click', function(e) {\n\t\t\t\tthisInstance\n\t\t\t\t\t.getTabs()\n\t\t\t\t\t.filter('[data-link-key=\"' + thisInstance.detailViewDetailsTabLabel + '\"]:not(.d-none)')\n\t\t\t\t\t.trigger('click');\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * Register click event for add button in Related widgets\n\t\t\t * to add record from widget\n\t\t\t */\n\t\t\tjQuery('.createRecord').on('click', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tvar summaryWidgetContainer = currentElement.closest('.js-detail-widget');\n\t\t\t\tvar widgetHeaderContainer = summaryWidgetContainer.find('.js-detail-widget-header');\n\t\t\t\tvar referenceModuleName = widgetHeaderContainer.find('[name=\"relatedModule\"]').val();\n\t\t\t\tvar recordId = thisInstance.getRecordId();\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tvar customParams = {};\n\t\t\t\tcustomParams['sourceModule'] = module;\n\t\t\t\tcustomParams['sourceRecord'] = recordId;\n\t\t\t\tif (\n\t\t\t\t\tmodule != '' &&\n\t\t\t\t\treferenceModuleName != '' &&\n\t\t\t\t\ttypeof thisInstance.referenceFieldNames[referenceModuleName] !== 'undefined' &&\n\t\t\t\t\ttypeof thisInstance.referenceFieldNames[referenceModuleName][module] !== 'undefined'\n\t\t\t\t) {\n\t\t\t\t\tvar fieldName = thisInstance.referenceFieldNames[referenceModuleName][module];\n\t\t\t\t\tcustomParams[fieldName] = recordId;\n\t\t\t\t}\n\n\t\t\t\tvar postQuickCreateSave = function(data) {\n\t\t\t\t\tthisInstance.postSummaryWidgetAddRecord(data, currentElement);\n\t\t\t\t};\n\n\t\t\t\tvar goToFullFormcallback = function(data) {\n\t\t\t\t\tthisInstance.addElementsToQuickCreateForCreatingRelation(data, customParams);\n\t\t\t\t};\n\n\t\t\t\tvar QuickCreateParams = {};\n\t\t\t\tQuickCreateParams['callbackFunction'] = postQuickCreateSave;\n\t\t\t\tQuickCreateParams['goToFullFormcallback'] = goToFullFormcallback;\n\t\t\t\tQuickCreateParams['data'] = customParams;\n\t\t\t\tQuickCreateParams['noCache'] = false;\n\t\t\t\tVtiger_Header_Js.getInstance().quickCreateModule(referenceModuleName, QuickCreateParams);\n\t\t\t});\n\t\t\tthis.registerFastEditingFiels();\n\t\t},\n\t\taddRelationBetweenRecords: function(relatedModule, relatedModuleRecordId, selectedTabElement) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tif (selectedTabElement == undefined) {\n\t\t\t\tselectedTabElement = thisInstance.getSelectedTab();\n\t\t\t}\n\t\t\tvar relatedController = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\tthisInstance.getRecordId(),\n\t\t\t\tapp.getModuleName(),\n\t\t\t\tselectedTabElement,\n\t\t\t\trelatedModule\n\t\t\t);\n\t\t\trelatedController\n\t\t\t\t.addRelations(relatedModuleRecordId)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tvar summaryViewContainer = thisInstance.getContentHolder();\n\t\t\t\t\tvar updatesWidget = summaryViewContainer.find(\"[data-type='Updates']\");\n\t\t\t\t\tif (updatesWidget.length > 0) {\n\t\t\t\t\t\tvar params = thisInstance.getFiltersData(updatesWidget);\n\t\t\t\t\t\tupdatesWidget\n\t\t\t\t\t\t\t.find('.btnChangesReviewedOn')\n\t\t\t\t\t\t\t.parent()\n\t\t\t\t\t\t\t.remove();\n\t\t\t\t\t\tthisInstance.loadWidget(updatesWidget, params['params']);\n\t\t\t\t\t}\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to handle Post actions after adding record from\n\t\t * summary view widget\n\t\t */\n\t\tpostSummaryWidgetAddRecord: function(data, currentElement) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar summaryWidgetContainer = currentElement.closest('.js-detail-widget');\n\t\t\tvar widgetHeaderContainer = summaryWidgetContainer.find('.js-detail-widget-header');\n\t\t\tvar referenceModuleName = widgetHeaderContainer.find('[name=\"relatedModule\"]').val();\n\t\t\tvar idList = [];\n\t\t\tidList.push(data.result._recordId);\n\t\t\tthis.addRelationBetweenRecords(referenceModuleName, idList).done(function(data) {\n\t\t\t\tthisInstance.loadWidget(summaryWidgetContainer.find('[class^=\"widgetContainer_\"]'));\n\t\t\t});\n\t\t},\n\t\tregisterChangeEventForModulesList: function() {\n\t\t\tjQuery('#tagSearchModulesList').on('change', function(e) {\n\t\t\t\tvar modulesSelectElement = jQuery(e.currentTarget);\n\t\t\t\tif (modulesSelectElement.val() == 'all') {\n\t\t\t\t\tjQuery('[name=\"tagSearchModuleResults\"]').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tjQuery('[name=\"tagSearchModuleResults\"]').removeClass('d-none');\n\t\t\t\t\tvar selectedOptionValue = modulesSelectElement.val();\n\t\t\t\t\tjQuery('[name=\"tagSearchModuleResults\"]')\n\t\t\t\t\t\t.filter(':not(#' + selectedOptionValue + ')')\n\t\t\t\t\t\t.addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterEventForRelatedTabClick: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = thisInstance.getContentHolder();\n\t\t\tvar detailContainer = detailContentsHolder.closest('div.detailViewInfo');\n\n\t\t\tjQuery('.related', detailContainer).on('click', 'li:not(.spaceRelatedList)', function(e, urlAttributes) {\n\t\t\t\tvar tabElement = jQuery(e.currentTarget);\n\t\t\t\tif (!tabElement.hasClass('dropdown')) {\n\t\t\t\t\tvar element = jQuery('<div></div>');\n\t\t\t\t\telement.progressIndicator({\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\t\telementToBlock: detailContainer\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tvar url = tabElement.data('url');\n\t\t\t\t\tif (typeof urlAttributes !== 'undefined') {\n\t\t\t\t\t\tvar callBack = urlAttributes.callback;\n\t\t\t\t\t\tdelete urlAttributes.callback;\n\t\t\t\t\t}\n\t\t\t\t\tthisInstance\n\t\t\t\t\t\t.loadContents(url, urlAttributes)\n\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\tthisInstance.deSelectAllrelatedTabs();\n\t\t\t\t\t\t\tthisInstance.markTabAsSelected(tabElement);\n\t\t\t\t\t\t\tVtiger_Helper_Js.showHorizontalTopScrollBar();\n\t\t\t\t\t\t\telement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\tthisInstance.registerHelpInfo();\n\t\t\t\t\t\t\tapp.registerModal(detailContentsHolder);\n\t\t\t\t\t\t\tif (typeof callBack == 'function') {\n\t\t\t\t\t\t\t\tcallBack(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//Summary tab is clicked\n\t\t\t\t\t\t\tif (tabElement.data('linkKey') == thisInstance.detailViewSummaryTabLabel) {\n\t\t\t\t\t\t\t\tthisInstance.loadWidgets();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthisInstance.registerBasicEvents();\n\t\t\t\t\t\t\t// Let listeners know about page state change.\n\t\t\t\t\t\t\tapp.notifyPostAjaxReady();\n\t\t\t\t\t\t\tapp.event.trigger('DetailView.Tab.AfterLoad', data, thisInstance);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\telement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register event for setting up picklistdependency\n\t\t * for a module if exist on change of picklist value\n\t\t */\n\t\tregisterEventForPicklistDependencySetup: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar picklistDependcyElemnt = jQuery('[name=\"picklistDependency\"]', container);\n\t\t\tif (picklistDependcyElemnt.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar picklistDependencyMapping = JSON.parse(picklistDependcyElemnt.val());\n\t\t\tvar sourcePicklists = Object.keys(picklistDependencyMapping);\n\t\t\tif (sourcePicklists.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar sourcePickListNames = [];\n\t\t\tfor (var i = 0; i < sourcePicklists.length; i++) {\n\t\t\t\tsourcePickListNames.push('[name=\"' + sourcePicklists[i] + '\"]');\n\t\t\t}\n\t\t\tsourcePickListNames = sourcePickListNames.join(',');\n\t\t\tvar sourcePickListElements = container.find(sourcePickListNames);\n\t\t\tsourcePickListElements.on('change', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tvar sourcePicklistname = currentElement.attr('name');\n\n\t\t\t\tvar configuredDependencyObject = picklistDependencyMapping[sourcePicklistname];\n\t\t\t\tvar selectedValue = currentElement.val();\n\t\t\t\tvar targetObjectForSelectedSourceValue = configuredDependencyObject[selectedValue];\n\t\t\t\tvar picklistmap = configuredDependencyObject['__DEFAULT__'];\n\n\t\t\t\tif (typeof targetObjectForSelectedSourceValue === 'undefined') {\n\t\t\t\t\ttargetObjectForSelectedSourceValue = picklistmap;\n\t\t\t\t}\n\t\t\t\tjQuery.each(picklistmap, function(targetPickListName, targetPickListValues) {\n\t\t\t\t\tvar targetPickListMap = targetObjectForSelectedSourceValue[targetPickListName];\n\t\t\t\t\tif (typeof targetPickListMap === 'undefined') {\n\t\t\t\t\t\ttargetPickListMap = targetPickListValues;\n\t\t\t\t\t}\n\t\t\t\t\tvar targetPickList = jQuery('[name=\"' + targetPickListName + '\"]', container);\n\t\t\t\t\tif (targetPickList.length <= 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t//On change of SourceField value, If TargetField value is not there in mapping, make user to select the new target value also.\n\t\t\t\t\tvar selectedValue = targetPickList.data('selectedValue');\n\t\t\t\t\tif (jQuery.inArray(selectedValue, targetPickListMap) == -1) {\n\t\t\t\t\t\tthisInstance.targetPicklistChange = true;\n\t\t\t\t\t\tthisInstance.targetPicklist = targetPickList.closest('td');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthisInstance.targetPicklistChange = false;\n\t\t\t\t\t\tthisInstance.targetPicklist = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar listOfAvailableOptions = targetPickList.data('availableOptions');\n\t\t\t\t\tif (typeof listOfAvailableOptions === 'undefined') {\n\t\t\t\t\t\tlistOfAvailableOptions = jQuery('option', targetPickList);\n\t\t\t\t\t\ttargetPickList.data('available-options', listOfAvailableOptions);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar targetOptions = new jQuery();\n\t\t\t\t\tvar optionSelector = [];\n\t\t\t\t\toptionSelector.push('');\n\t\t\t\t\tfor (var i = 0; i < targetPickListMap.length; i++) {\n\t\t\t\t\t\toptionSelector.push(targetPickListMap[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\tjQuery.each(listOfAvailableOptions, function(i, e) {\n\t\t\t\t\t\tvar picklistValue = jQuery(e).val();\n\t\t\t\t\t\tif (jQuery.inArray(picklistValue, optionSelector) != -1) {\n\t\t\t\t\t\t\ttargetOptions = targetOptions.add(jQuery(e));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tvar targetPickListSelectedValue = '';\n\t\t\t\t\ttargetPickListSelectedValue = targetOptions.filter('[selected]').val();\n\t\t\t\t\tif (targetPickListMap.length == 1) {\n\t\t\t\t\t\ttargetPickListSelectedValue = targetPickListMap[0]; // to automatically select picklist if only one picklistmap is present.\n\t\t\t\t\t}\n\t\t\t\t\ttargetPickList\n\t\t\t\t\t\t.html(targetOptions)\n\t\t\t\t\t\t.val(targetPickListSelectedValue)\n\t\t\t\t\t\t.trigger('change');\n\t\t\t\t});\n\t\t\t});\n\t\t\t//To Trigger the change on load\n\t\t\tsourcePickListElements.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Function to get child comments\n\t\t */\n\t\tgetChildComments: function(commentId) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar url =\n\t\t\t\t'module=' +\n\t\t\t\tapp.getModuleName() +\n\t\t\t\t'&view=Detail&record=' +\n\t\t\t\tthis.getRecordId() +\n\t\t\t\t'&mode=showChildComments&commentid=' +\n\t\t\t\tcommentId;\n\t\t\tvar dataObj = this.getCommentThread(url);\n\t\t\tdataObj.done(function(data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to get parent comment\n\t\t * @param {number} commentId\n\t\t * @returns {string}\n\t\t */\n\t\tgetParentComments(commentId) {\n\t\t\tlet aDeferred = $.Deferred(),\n\t\t\t\turl =\n\t\t\t\t\t'module=' +\n\t\t\t\t\tapp.getModuleName() +\n\t\t\t\t\t'&view=Detail&record=' +\n\t\t\t\t\tthis.getRecordId() +\n\t\t\t\t\t'&mode=showParentComments&commentid=' +\n\t\t\t\t\tcommentId;\n\t\t\tthis.getCommentThread(url).done(function(data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to show total records count in listview on hover\n\t\t * of pageNumber text\n\t\t */\n\t\tregisterEventForTotalRecordsCount: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tdetailContentsHolder.on('click', '.totalNumberOfRecords', function(e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar totalNumberOfRecords = jQuery('#totalCount').val();\n\t\t\t\telement.addClass('d-none');\n\t\t\t\telement.parent().progressIndicator({});\n\t\t\t\tif (totalNumberOfRecords == '') {\n\t\t\t\t\tvar selectedTabElement = thisInstance.getSelectedTab();\n\t\t\t\t\tvar relatedModuleName = thisInstance.getRelatedModuleName();\n\t\t\t\t\tvar relatedController = Vtiger_RelatedList_Js.getInstance(\n\t\t\t\t\t\tthisInstance.getRecordId(),\n\t\t\t\t\t\tapp.getModuleName(),\n\t\t\t\t\t\tselectedTabElement,\n\t\t\t\t\t\trelatedModuleName\n\t\t\t\t\t);\n\t\t\t\t\trelatedController.getRelatedPageCount().done(function() {\n\t\t\t\t\t\tthisInstance.showPagingInfo();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthisInstance.showPagingInfo();\n\t\t\t\t}\n\t\t\t\telement.parent().progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t\t},\n\t\tshowPagingInfo: function() {\n\t\t\tvar totalNumberOfRecords = jQuery('#totalCount').val();\n\t\t\tvar pageNumberElement = jQuery('.pageNumbersText');\n\t\t\tvar pageRange = pageNumberElement.text();\n\t\t\tvar newPagingInfo = pageRange + ' (' + totalNumberOfRecords + ')';\n\t\t\tvar listViewEntriesCount = parseInt(jQuery('#noOfEntries').val());\n\t\t\tif (listViewEntriesCount != 0) {\n\t\t\t\tjQuery('.pageNumbersText').html(newPagingInfo);\n\t\t\t} else {\n\t\t\t\tjQuery('.pageNumbersText').html('');\n\t\t\t}\n\t\t},\n\t\tgetCustomFieldNameValueMap: function(fieldNameValueMap) {\n\t\t\treturn fieldNameValueMap;\n\t\t},\n\t\tregisterSetReadRecord: function(detailContentsHolder) {\n\t\t\tvar thisInstance = this;\n\t\t\tdetailContentsHolder.on('click', '.setReadRecord', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tcurrentElement.closest('.btn-group').addClass('d-none');\n\t\t\t\tjQuery('#Accounts_detailView_fieldValue_was_read')\n\t\t\t\t\t.find('.value')\n\t\t\t\t\t.text(app.vtranslate('LBL_YES'));\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'SaveAjax',\n\t\t\t\t\trecord: thisInstance.getRecordId(),\n\t\t\t\t\tfield: 'was_read',\n\t\t\t\t\tvalue: 'on'\n\t\t\t\t};\n\t\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: app.vtranslate('JS_SET_READ_RECORD'),\n\t\t\t\t\t\ttitle: app.vtranslate('System'),\n\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\tvar relatedTabKey = jQuery('.related li.active');\n\t\t\t\t\tif (\n\t\t\t\t\t\trelatedTabKey.data('linkKey') == thisInstance.detailViewSummaryTabLabel ||\n\t\t\t\t\t\trelatedTabKey.data('linkKey') == thisInstance.detailViewDetailsTabLabel\n\t\t\t\t\t) {\n\t\t\t\t\t\tthisInstance.reloadTabContent();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterFastEditingFiels: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar fastEditingFiels = jQuery('.summaryWidgetFastEditing select');\n\t\t\tfastEditingFiels.on('change', function(e) {\n\t\t\t\tvar fieldElement = jQuery(e.currentTarget);\n\t\t\t\tvar fieldContainer = fieldElement.closest('.editField');\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\t\tposition: 'summaryWidgetFastEditing',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar fieldName = fieldContainer.data('fieldname');\n\t\t\t\tfieldName = fieldName.replace('q_', '');\n\t\t\t\tvar fieldValue = fieldElement.val();\n\t\t\t\tvar errorExists = fieldElement.validationEngine('validate');\n\t\t\t\tif (errorExists) {\n\t\t\t\t\tfieldContainer.progressIndicator({ mode: 'hide' });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar preFieldSaveEvent = jQuery.Event(thisInstance.fieldPreSave);\n\t\t\t\tfieldElement.trigger(preFieldSaveEvent, {\n\t\t\t\t\tfieldValue: fieldValue,\n\t\t\t\t\trecordId: thisInstance.getRecordId()\n\t\t\t\t});\n\t\t\t\tvar fieldNameValueMap = {};\n\t\t\t\tfieldNameValueMap['value'] = fieldValue;\n\t\t\t\tfieldNameValueMap['field'] = fieldName;\n\t\t\t\tfieldNameValueMap = thisInstance.getCustomFieldNameValueMap(fieldNameValueMap);\n\t\t\t\tthisInstance.saveFieldValues(fieldNameValueMap);\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\tvar params = {\n\t\t\t\t\ttitle: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\ttype: 'success'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\tthisInstance.reloadTabContent();\n\t\t\t});\n\t\t},\n\t\tregisterHelpInfo: function() {\n\t\t\tvar form = this.getForm();\n\t\t\tapp.showPopoverElementView(form.find('.js-help-info'));\n\t\t},\n\t\t/**\n\t\t * Register related modules record cound\n\t\t * @param {jQuery} tabContainer\n\t\t */\n\t\tregisterRelatedModulesRecordCount(tabContainer) {\n\t\t\tconst moreList = $('.related .nav .dropdown-menu');\n\t\t\tlet relationContainer = tabContainer;\n\t\t\tif (!relationContainer || typeof relationContainer.length === 'undefined') {\n\t\t\t\trelationContainer = $(\n\t\t\t\t\t'.related .nav > .relatedNav, .related .nav > .mainNav, .detailViewBlockLink, .related .nav .dropdown-menu > .relatedNav'\n\t\t\t\t);\n\t\t\t}\n\t\t\trelationContainer.each((n, item) => {\n\t\t\t\titem = $(item);\n\t\t\t\tlet relationId = item.data('relationId'),\n\t\t\t\t\trelatedModule = item.data('reference');\n\t\t\t\tif (item.data('count') === 1) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\t\trelatedModule: relatedModule,\n\t\t\t\t\t\tmode: 'getRelatedListPageCount',\n\t\t\t\t\t\trelationId: relationId,\n\t\t\t\t\t\ttab_label: item.data('label-key')\n\t\t\t\t\t}).done(response => {\n\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\tif (response.result.numberOfRecords === 0) {\n\t\t\t\t\t\t\t\tresponse.result.numberOfRecords = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem.find('.count').text(response.result.numberOfRecords);\n\t\t\t\t\t\t\tmoreList\n\t\t\t\t\t\t\t\t.find('[data-reference=\"${relatedModule}\"][data-relation-id=\"${relationId}\"] .count')\n\t\t\t\t\t\t\t\t.text(response.result.numberOfRecords);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to display a new comments\n\t\t */\n\t\taddComment: function(currentTarget, data) {\n\t\t\tconst self = this;\n\t\t\tlet mode = currentTarget.data('mode'),\n\t\t\t\tclosestAddCommentBlock = currentTarget.closest('.js-add-comment-block'),\n\t\t\t\tcommentTextAreaElement = closestAddCommentBlock.find('.js-comment-content'),\n\t\t\t\tcommentInfoBlock = currentTarget.closest('.js-comment-single');\n\t\t\tcommentTextAreaElement.html('');\n\t\t\tif (mode == 'add') {\n\t\t\t\tlet commentId = data['result']['id'],\n\t\t\t\t\tcommentHtml = self.getCommentUI(commentId);\n\t\t\t\tcommentHtml.done(function(data) {\n\t\t\t\t\tlet commentBlock = closestAddCommentBlock.closest('.js-comment-details'),\n\t\t\t\t\t\tdetailContentsHolder = self.getContentHolder(),\n\t\t\t\t\t\tnoCommentsMsgContainer = $('.js-noCommentsMsgContainer', detailContentsHolder);\n\t\t\t\t\tnoCommentsMsgContainer.remove();\n\t\t\t\t\tif (commentBlock.length > 0) {\n\t\t\t\t\t\tclosestAddCommentBlock.remove();\n\t\t\t\t\t\tlet childComments = commentBlock.find('ul');\n\t\t\t\t\t\tif (childComments.length <= 0) {\n\t\t\t\t\t\t\tlet currentChildCommentsCount = commentInfoBlock\n\t\t\t\t\t\t\t\t\t.find('.js-view-thread-block')\n\t\t\t\t\t\t\t\t\t.data('data-child-comments-count'),\n\t\t\t\t\t\t\t\tnewChildCommentCount = currentChildCommentsCount + 1;\n\t\t\t\t\t\t\tcommentInfoBlock.find('.js-child-comments-count').text(newChildCommentCount);\n\t\t\t\t\t\t\tlet parentCommentId = commentInfoBlock.find('.js-comment-info-header').data('commentid');\n\t\t\t\t\t\t\tself.getChildComments(parentCommentId).done(function(responsedata) {\n\t\t\t\t\t\t\t\t$(responsedata).appendTo(commentBlock);\n\t\t\t\t\t\t\t\tcommentInfoBlock.find('.js-view-thread-block').hide();\n\t\t\t\t\t\t\t\tcommentInfoBlock.find('.hideThreadBlock').show();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('<li class=\"js-comment-details commentDetails\">' + data + '</li>').appendTo(\n\t\t\t\t\t\t\t\tcommentBlock.find('.js-comments-body')\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('<li class=\"js-comment-details commentDetails\">' + data + '</li>').prependTo(\n\t\t\t\t\t\t\tclosestAddCommentBlock.closest('.contents').find('.commentsList')\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tcommentInfoBlock.find('.js-comment-container').show();\n\t\t\t\t\tapp.event.trigger('DetailView.SaveComment.AfterLoad', commentInfoBlock, data);\n\t\t\t\t});\n\t\t\t} else if (mode == 'edit') {\n\t\t\t\tlet modifiedTime = commentInfoBlock.find('.js-comment-modified-time'),\n\t\t\t\t\tcommentInfoContent = commentInfoBlock.find('.js-comment-info'),\n\t\t\t\t\tcommentEditStatus = commentInfoBlock.find('.js-edited-status'),\n\t\t\t\t\tcommentReason = commentInfoBlock.find('.js-edit-reason-span');\n\t\t\t\tcommentInfoContent.html(data.result.commentcontent);\n\t\t\t\tcommentReason.html(data.result.reasontoedit);\n\t\t\t\tmodifiedTime.html(data.result.modifiedtime);\n\t\t\t\tmodifiedTime.attr('title', data.result.modifiedtimetitle);\n\t\t\t\tif (commentEditStatus.hasClass('d-none')) {\n\t\t\t\t\tcommentEditStatus.removeClass('d-none');\n\t\t\t\t}\n\t\t\t\tif (data.result.reasontoedit != '') {\n\t\t\t\t\tcommentInfoBlock.find('.js-edit-reason').removeClass('d-none');\n\t\t\t\t}\n\t\t\t\tcommentInfoContent.show();\n\t\t\t\tcommentInfoBlock.find('.js-comment-container').show();\n\t\t\t\tclosestAddCommentBlock.remove();\n\t\t\t\tapp.event.trigger('DetailView.SaveComment.AfterUpdate', commentInfoBlock, data);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register all comment events\n\t\t * @param {jQuery} detailContentsHolder\n\t\t */\n\t\tregisterCommentEvents(detailContentsHolder) {\n\t\t\tconst self = this;\n\t\t\tdetailContentsHolder.on('click', '.js-close-comment-block', function(e) {\n\t\t\t\tlet commentInfoBlock = $(e.currentTarget.closest('.js-comment-single'));\n\t\t\t\tcommentInfoBlock.find('.js-comment-container').show();\n\t\t\t\tcommentInfoBlock.find('.js-comment-info').show();\n\t\t\t\tself.removeCommentBlockIfExists();\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-reply-comment', function(e) {\n\t\t\t\tself.removeCommentBlockIfExists();\n\t\t\t\tlet commentInfoBlock = $(e.currentTarget).closest('.js-comment-single');\n\t\t\t\tcommentInfoBlock.find('.js-comment-container').hide();\n\t\t\t\tself.getCommentBlock()\n\t\t\t\t\t.appendTo(commentInfoBlock)\n\t\t\t\t\t.show();\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-edit-comment', function(e) {\n\t\t\t\tself.removeCommentBlockIfExists();\n\t\t\t\tlet commentInfoBlock = $(e.currentTarget).closest('.js-comment-single'),\n\t\t\t\t\tcommentInfoContent = commentInfoBlock.find('.js-comment-info'),\n\t\t\t\t\teditCommentBlock = self.getEditCommentBlock();\n\t\t\t\teditCommentBlock.find('.js-comment-content').html(commentInfoContent.html());\n\t\t\t\teditCommentBlock.find('.js-reason-to-edit').html(commentInfoBlock.find('.js-edit-reason-span').text());\n\t\t\t\tcommentInfoContent.hide();\n\t\t\t\tcommentInfoBlock.find('.js-comment-container').hide();\n\t\t\t\teditCommentBlock.appendTo(commentInfoBlock).show();\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-detail-view-save-comment', function(e) {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tif (!element.is(':disabled')) {\n\t\t\t\t\tself.saveComment(e)\n\t\t\t\t\t\t.done(function() {\n\t\t\t\t\t\t\tself.registerRelatedModulesRecordCount();\n\t\t\t\t\t\t\tself.loadWidget(detailContentsHolder.find(\"[data-type='Comments']\")).done(function() {\n\t\t\t\t\t\t\t\telement.removeAttr('disabled');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\t\telement.removeAttr('disabled');\n\t\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-save-comment', function(e) {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tif (!element.is(':disabled')) {\n\t\t\t\t\tself.saveComment(e)\n\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\tself.registerRelatedModulesRecordCount(\n\t\t\t\t\t\t\t\tself.getTabByLabel(self.detailViewRecentCommentsTabLabel)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tself.addComment(element, data);\n\t\t\t\t\t\t\telement.removeAttr('disabled');\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\t\telement.removeAttr('disabled');\n\t\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-more-recent-comments ', function() {\n\t\t\t\tself.getTabByLabel(self.detailViewRecentCommentsTabLabel).trigger('click');\n\t\t\t});\n\t\t\tdetailContentsHolder.find('.js-detail-hierarchy-comments-btn').on('click', function(e) {\n\t\t\t\tif (\n\t\t\t\t\t$(this).hasClass('active') &&\n\t\t\t\t\tdetailContentsHolder.find('.js-detail-hierarchy-comments-btn.active').length < 2\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet recentCommentsTab = self.getTabByLabel(self.detailViewRecentCommentsTabLabel),\n\t\t\t\t\turl = recentCommentsTab.data('url'),\n\t\t\t\t\tregex = /&hierarchy=+([\\w,]+)/;\n\t\t\t\turl = url.replace(regex, '');\n\t\t\t\tlet hierarchy = [];\n\t\t\t\tif ($(this).hasClass('active')) {\n\t\t\t\t\t$(this).removeClass('active');\n\t\t\t\t} else {\n\t\t\t\t\t$(this).addClass('active');\n\t\t\t\t}\n\t\t\t\tdetailContentsHolder.find('.js-detail-hierarchy-comments-btn.active').each(function() {\n\t\t\t\t\thierarchy.push(\n\t\t\t\t\t\t$(this)\n\t\t\t\t\t\t\t.find('.js-detail-hierarchy-comments')\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t\tif (hierarchy.length !== 0) {\n\t\t\t\t\turl += '&hierarchy=' + hierarchy.join(',');\n\t\t\t\t}\n\t\t\t\trecentCommentsTab.data('url', url);\n\t\t\t\trecentCommentsTab.trigger('click');\n\t\t\t});\n\t\t\tdetailContentsHolder.on('keypress', '.js-comment-search', function(e) {\n\t\t\t\tif (13 === e.which) {\n\t\t\t\t\tself.submitSearchForm(detailContentsHolder);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-search-icon', function(e) {\n\t\t\t\tself.submitSearchForm(detailContentsHolder);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Submit search comment form\n\t\t * @param {jQuery} detailContentsHolder\n\t\t */\n\t\tsubmitSearchForm(detailContentsHolder) {\n\t\t\tlet searchTextDom = detailContentsHolder.find('.js-comment-search'),\n\t\t\t\twidgetContainer = searchTextDom.closest('[data-name=\"ModComments\"]'),\n\t\t\t\tprogressIndicatorElement = $.progressIndicator();\n\t\t\tif (searchTextDom.data('container') === 'widget' && !searchTextDom.val()) {\n\t\t\t\tlet request = widgetContainer.data('url');\n\t\t\t\tAppConnector.request(request).done(function(data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tdetailContentsHolder.find('.js-comments-container').html(data);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet hierarchy = [],\n\t\t\t\t\tlimit = '',\n\t\t\t\t\tisWidget = false;\n\t\t\t\tif (searchTextDom.data('container') === 'widget') {\n\t\t\t\t\t(limit = widgetContainer.data('limit')), (isWidget = true);\n\t\t\t\t\twidgetContainer.find('.js-hierarchy-comments:checked').each(function() {\n\t\t\t\t\t\thierarchy.push($(this).val());\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tdetailContentsHolder.find('.js-detail-hierarchy-comments:checked').each(function() {\n\t\t\t\t\t\thierarchy.push($(this).val());\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Detail',\n\t\t\t\t\tmode: 'showSearchComments',\n\t\t\t\t\thierarchy: hierarchy.join(','),\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tsearch_key: searchTextDom.val(),\n\t\t\t\t\tis_widget: isWidget\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (!searchTextDom.val()) {\n\t\t\t\t\t\tdetailContentsHolder.html(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdetailContentsHolder.find('.js-comments-body').html(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register hierarchy comments buttons\n\t\t * @param {jQuery} widgetContainer\n\t\t */\n\t\tregisterCommentEventsInDetail(widgetContainer) {\n\t\t\tnew App.Fields.Text.Completions($('.js-completions').eq(0), { emojiPanel: false });\n\t\t\twidgetContainer.on('change', '.js-hierarchy-comments', function(e) {\n\t\t\t\tlet hierarchy = [];\n\t\t\t\twidgetContainer.find('.js-hierarchy-comments').each(function() {\n\t\t\t\t\tif ($(this).is(':checked')) {\n\t\t\t\t\t\thierarchy.push($(this).val());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Detail',\n\t\t\t\t\tmode: 'showRecentComments',\n\t\t\t\t\thierarchy: hierarchy.join(','),\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tlimit: widgetContainer.find('.widgetContentBlock').data('limit')\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tlet widgetDataContainer = widgetContainer.find('.js-detail-widget-content');\n\t\t\t\t\twidgetDataContainer.html(data);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(widgetDataContainer.find('.select2'));\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterMailPreviewWidget: function(container) {\n\t\t\tconst self = this;\n\t\t\tcontainer.on('click', '.showMailBody', e => {\n\t\t\t\tlet row = $(e.currentTarget).closest('.row'),\n\t\t\t\t\tmailBody = row.find('.mailBody'),\n\t\t\t\t\tmailTeaser = row.find('.mailTeaser');\n\t\t\t\tmailBody.toggleClass('d-none');\n\t\t\t\tmailTeaser.toggleClass('d-none');\n\t\t\t});\n\t\t\tcontainer.find('[name=\"mail-type\"]').on('change', function(e) {\n\t\t\t\tself.loadMailPreviewWidget(container);\n\t\t\t});\n\t\t\tcontainer.find('[name=\"mailFilter\"]').on('change', function(e) {\n\t\t\t\tself.loadMailPreviewWidget(container);\n\t\t\t});\n\t\t\tcontainer.on('click', '.showMailsModal', e => {\n\t\t\t\tlet url = $(e.currentTarget).data('url');\n\t\t\t\turl += '&type=' + container.find('[name=\"mail-type\"]').val();\n\t\t\t\tif (container.find('[name=\"mailFilter\"]').length > 0) {\n\t\t\t\t\turl += '&mailFilter=' + container.find('[name=\"mailFilter\"]').val();\n\t\t\t\t}\n\t\t\t\tlet progressIndicatorElement = jQuery.progressIndicator();\n\t\t\t\tapp.showModalWindow('', url, data => {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tself.registerMailPreviewWidget(data);\n\t\t\t\t\tVtiger_Index_Js.registerMailButtons(data);\n\t\t\t\t\tdata.find('.expandAllMails').click();\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontainer.find('.expandAllMails').on('click', function(e) {\n\t\t\t\tcontainer.find('.mailBody').removeClass('d-none');\n\t\t\t\tcontainer.find('.mailTeaser').addClass('d-none');\n\t\t\t\tcontainer\n\t\t\t\t\t.find('.showMailBody .js-toggle-icon')\n\t\t\t\t\t.removeClass('fa-caret-down')\n\t\t\t\t\t.addClass('fa-caret-up');\n\t\t\t});\n\t\t\tcontainer.find('.collapseAllMails').on('click', function(e) {\n\t\t\t\tcontainer.find('.mailBody').addClass('d-none');\n\t\t\t\tcontainer.find('.mailTeaser').removeClass('d-none');\n\t\t\t\tcontainer\n\t\t\t\t\t.find('.showMailBody .js-toggle-icon')\n\t\t\t\t\t.removeClass('fa-caret-up')\n\t\t\t\t\t.addClass('fa-caret-down');\n\t\t\t});\n\t\t},\n\t\tloadMailPreviewWidget: function(widgetContent) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar widgetDataContainer = widgetContent.find('.js-detail-widget-content');\n\t\t\tvar recordId = $('#recordId').val();\n\t\t\tvar progress = widgetDataContainer.progressIndicator();\n\t\t\tvar params = {};\n\t\t\tparams['module'] = 'OSSMailView';\n\t\t\tparams['view'] = 'Widget';\n\t\t\tparams['smodule'] = $('#module').val();\n\t\t\tparams['srecord'] = recordId;\n\t\t\tparams['mode'] = 'showEmailsList';\n\t\t\tparams['type'] = $('[name=\"mail-type\"]').val();\n\t\t\tparams['mailFilter'] = $('[name=\"mailFilter\"]').val();\n\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\twidgetDataContainer.html(data);\n\t\t\t\tapp.event.trigger('DetailView.Widget.AfterLoad', widgetDataContainer, params['module'], thisInstance);\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t\t},\n\t\tregisterEmailEvents: function(detailContentsHolder) {\n\t\t\tVtiger_Index_Js.registerMailButtons(detailContentsHolder);\n\t\t},\n\t\tregisterMapsEvents: function(container) {\n\t\t\tif (container.find('#coordinates').length) {\n\t\t\t\tvar mapView = new OpenStreetMap_Map_Js();\n\t\t\t\tmapView.registerDetailView(container);\n\t\t\t}\n\t\t},\n\t\tregisterSocialMediaEvents(container) {\n\t\t\tlet socialMediaContainer = container.find('.tpl-Detail-SocialMedia');\n\t\t\tif (socialMediaContainer.length) {\n\t\t\t}\n\t\t},\n\t\tregisterShowSummary: function(container) {\n\t\t\tcontainer.on('click', '.showSummaryRelRecord', function(e) {\n\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\tvar id = currentTarget.data('id');\n\t\t\t\tvar summaryView = container.find('.summaryRelRecordView' + id);\n\t\t\t\tcontainer.find('.listViewEntriesTable').css('display', 'none');\n\t\t\t\tsummaryView.show();\n\t\t\t});\n\t\t\tcontainer.on('click', '.hideSummaryRelRecordView', function(e) {\n\t\t\t\tvar summaryView = container.find('.summaryRelRecordView');\n\t\t\t\tcontainer.find('.listViewEntriesTable').css('display', 'table');\n\t\t\t\tsummaryView.hide();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Show confirmation on event click\n\t\t * @param {jQuery} element\n\t\t * @param {string} picklistName\n\t\t */\n\t\tshowProgressConfirmation(element, picklistName) {\n\t\t\tconst self = this;\n\t\t\tlet picklistValue = $(element).data('picklistValue');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\ttitle: $(element).data('picklistLabel'),\n\t\t\t\tmessage: app.vtranslate('JS_CHANGE_VALUE_CONFIRMATION')\n\t\t\t}).done(() => {\n\t\t\t\tconst progressIndicatorElement = $.progressIndicator();\n\t\t\t\tself.saveFieldValues({\n\t\t\t\t\tvalue: picklistValue,\n\t\t\t\t\tfield: picklistName\n\t\t\t\t})\n\t\t\t\t\t.done(() => {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Change status from progress\n\t\t */\n\t\tregisterProgress() {\n\t\t\tconst self = this;\n\t\t\t$('.js-header-progress-bar').each((index, element) => {\n\t\t\t\tlet picklistName = $(element).data('picklistName');\n\t\t\t\t$(element)\n\t\t\t\t\t.find('.js-access')\n\t\t\t\t\t.on('click', e => {\n\t\t\t\t\t\tself.showProgressConfirmation(e.currentTarget, picklistName);\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tloadChat() {\n\t\t\tlet chatVue = $('#ChatRecordRoomVue', this.detailViewContentHolder);\n\t\t\tif (chatVue.length) {\n\t\t\t\tlet chatContainer = this.detailViewContentHolder.find('.js-chat-container');\n\t\t\t\tconst padding = 10;\n\t\t\t\tchatContainer.height(\n\t\t\t\t\t$(document).height() - chatContainer.offset().top - $('.js-footer').outerHeight() - padding\n\t\t\t\t);\n\t\t\t\twindow.ChatRecordRoomVueComponent.mount({\n\t\t\t\t\tel: '#ChatRecordRoomVue'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tregisterChat() {\n\t\t\tif (window.ChatRecordRoomVueComponent !== undefined) {\n\t\t\t\tthis.loadChat();\n\t\t\t\tapp.event.on('DetailView.Tab.AfterLoad', (e, data, instance) => {\n\t\t\t\t\tinstance.detailViewContentHolder.ready(() => {\n\t\t\t\t\t\tthis.loadChat();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tregisterBasicEvents: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = thisInstance.getContentHolder();\n\t\t\tvar selectedTabElement = thisInstance.getSelectedTab();\n\t\t\t//register all the events for summary view container\n\n\t\t\tif (this.getSelectedTab().data('labelKey') === 'ModComments') {\n\t\t\t\tnew App.Fields.Text.Completions(detailContentsHolder.find('.js-completions'), { emojiPanel: false });\n\t\t\t}\n\t\t\tthisInstance.registerSummaryViewContainerEvents(detailContentsHolder);\n\t\t\tthisInstance.registerCommentEvents(detailContentsHolder);\n\t\t\tthisInstance.registerEmailEvents(detailContentsHolder);\n\t\t\tthisInstance.registerMapsEvents(detailContentsHolder);\n\t\t\tthisInstance.registerSocialMediaEvents(detailContentsHolder);\n\t\t\tthisInstance.registerSubProducts(detailContentsHolder);\n\t\t\tthisInstance.registerCollapsiblePanels(detailContentsHolder);\n\t\t\tApp.Fields.Date.register(detailContentsHolder);\n\t\t\tApp.Fields.DateTime.register(detailContentsHolder);\n\t\t\tApp.Fields.MultiImage.register(detailContentsHolder);\n\t\t\t//Attach time picker event to time fields\n\t\t\tapp.registerEventForClockPicker();\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(detailContentsHolder.find('select.select2'));\n\t\t\tnew App.Fields.Text.Editor(detailContentsHolder, { toolbar: 'Min' });\n\t\t\tdetailContentsHolder.on('click', '#detailViewNextRecordButton', function(e) {\n\t\t\t\tvar url = selectedTabElement.data('url');\n\t\t\t\tvar currentPageNum = thisInstance.getRelatedListCurrentPageNum();\n\t\t\t\tvar requestedPage = parseInt(currentPageNum) + 1;\n\t\t\t\tvar nextPageUrl = url + '&page=' + requestedPage;\n\t\t\t\tthisInstance.loadContents(nextPageUrl);\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '#detailViewPreviousRecordButton', function(e) {\n\t\t\t\tvar url = selectedTabElement.data('url');\n\t\t\t\tvar currentPageNum = thisInstance.getRelatedListCurrentPageNum();\n\t\t\t\tvar requestedPage = parseInt(currentPageNum) - 1;\n\t\t\t\tvar params = {};\n\t\t\t\tvar nextPageUrl = url + '&page=' + requestedPage;\n\t\t\t\tthisInstance.loadContents(nextPageUrl);\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', 'div.detailViewTable div.fieldValue:not(.is-edit-active)', function(e) {\n\t\t\t\tlet target = $(e.target);\n\t\t\t\tif (target.closest('a').hasClass('btnNoFastEdit') || target.hasClass('btnNoFastEdit')) return;\n\t\t\t\tlet currentTdElement = jQuery(e.currentTarget);\n\t\t\t\tcurrentTdElement.addClass('is-edit-active');\n\t\t\t\tthisInstance.ajaxEditHandling(currentTdElement);\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', 'div.recordDetails span.squeezedWell', function(e) {\n\t\t\t\tvar currentElement = jQuery(e.currentTarget);\n\t\t\t\tvar relatedLabel = currentElement.data('reference');\n\t\t\t\tjQuery('.detailViewInfo .related .nav > li[data-reference=\"' + relatedLabel + '\"]').trigger('click');\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.relatedPopup', function(e) {\n\t\t\t\tvar editViewObj = new Vtiger_Edit_Js();\n\t\t\t\teditViewObj.showRecordsList(e);\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.viewThread', function(e) {\n\t\t\t\tlet currentTarget = jQuery(e.currentTarget),\n\t\t\t\t\tcurrentTargetParent = currentTarget.parent(),\n\t\t\t\t\tcommentActionsBlock = currentTarget.closest('.js-comment-actions'),\n\t\t\t\t\tcurrentCommentBlock = currentTarget.closest('.js-comment-details'),\n\t\t\t\t\tulElements = currentCommentBlock.find('ul');\n\t\t\t\tif (ulElements.length > 0) {\n\t\t\t\t\tulElements.show();\n\t\t\t\t\tcommentActionsBlock.find('.hideThreadBlock').show();\n\t\t\t\t\tcurrentTargetParent.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar commentId = currentTarget\n\t\t\t\t\t.closest('.js-comment-div')\n\t\t\t\t\t.find('.js-comment-info-header')\n\t\t\t\t\t.data('commentid');\n\t\t\t\tthisInstance.getChildComments(commentId).done(function(data) {\n\t\t\t\t\tjQuery(data).appendTo(jQuery(e.currentTarget).closest('.js-comment-details'));\n\t\t\t\t\tcommentActionsBlock.find('.hideThreadBlock').show();\n\t\t\t\t\tcurrentTargetParent.hide();\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-view-parent-thread', function(e) {\n\t\t\t\tlet currentTarget = jQuery(e.currentTarget),\n\t\t\t\t\tcurrentTargetParent = currentTarget.parent(),\n\t\t\t\t\tcommentId = currentTarget\n\t\t\t\t\t\t.closest('.js-comment-div')\n\t\t\t\t\t\t.find('.js-comment-info-header')\n\t\t\t\t\t\t.data('commentid');\n\t\t\t\tthisInstance.getParentComments(commentId).done(function(data) {\n\t\t\t\t\t$(e.currentTarget.closest('.js-comment-details')).html(data);\n\t\t\t\t\tcurrentTarget\n\t\t\t\t\t\t.closest('.js-comment-actions')\n\t\t\t\t\t\t.find('.hideThreadBlock')\n\t\t\t\t\t\t.show();\n\t\t\t\t\tcurrentTargetParent.hide();\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.js-fab__btn', e => {\n\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t.closest('.js-fab__container')\n\t\t\t\t\t.toggleClass('q-fab--opened');\n\t\t\t});\n\t\t\tdetailContentsHolder.find('.js-fab__container').on('clickoutside', e => {\n\t\t\t\t$(e.currentTarget).removeClass('q-fab--opened');\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.hideThread', function(e) {\n\t\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\t\tvar currentTargetParent = currentTarget.parent();\n\t\t\t\tvar commentActionsBlock = currentTarget.closest('.js-comment-actions');\n\t\t\t\tvar currentCommentBlock = currentTarget.closest('.js-comment-details');\n\t\t\t\tcurrentCommentBlock.find('ul').hide();\n\t\t\t\tcurrentTargetParent.hide();\n\t\t\t\tcommentActionsBlock.find('.js-view-thread-block').show();\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.detailViewThread', function(e) {\n\t\t\t\tvar recentCommentsTab = thisInstance.getTabByLabel(thisInstance.detailViewRecentCommentsTabLabel);\n\t\t\t\tvar commentId = jQuery(e.currentTarget)\n\t\t\t\t\t.closest('.js-comment-single')\n\t\t\t\t\t.find('.js-comment-info-header')\n\t\t\t\t\t.data('commentid');\n\t\t\t\tvar commentLoad = function(data) {\n\t\t\t\t\twindow.location.href = window.location.href + '#' + commentId;\n\t\t\t\t};\n\t\t\t\trecentCommentsTab.trigger('click', { commentid: commentId, callback: commentLoad });\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.moreRecentRecords', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar recentCommentsTab = thisInstance.getTabByModule(\n\t\t\t\t\t$(this).data('label-key'),\n\t\t\t\t\t$(this).data('relation-id')\n\t\t\t\t);\n\t\t\t\tif (recentCommentsTab.length) {\n\t\t\t\t\trecentCommentsTab.trigger('click');\n\t\t\t\t} else {\n\t\t\t\t\tlet currentTarget = $(e.currentTarget),\n\t\t\t\t\t\tcontainer = currentTarget.closest(\"[class^='widgetContainer_']\");\n\t\t\t\t\tif (container.length) {\n\t\t\t\t\t\tlet page = container.find('[name=\"page\"]:last').val(),\n\t\t\t\t\t\t\turl = container.data('url');\n\t\t\t\t\t\tcurrentTarget.prop('disabled', true);\n\t\t\t\t\t\turl = url.replace('&page=1', '&page=' + ++page);\n\t\t\t\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\t\t\t\tlet dataObj = $(data),\n\t\t\t\t\t\t\t\tcontainerTable = container.find('.js-detail-widget-content table');\n\t\t\t\t\t\t\tcurrentTarget.prop('disabled', false).addClass('d-none');\n\t\t\t\t\t\t\tcontainer.find('[name=\"page\"]:last').val(dataObj.find('[name=\"page\"]').val());\n\t\t\t\t\t\t\tif (containerTable.length) {\n\t\t\t\t\t\t\t\tcontainerTable.append(dataObj.find('tbody tr'));\n\t\t\t\t\t\t\t\tif (dataObj.find('.moreRecentRecords').length) {\n\t\t\t\t\t\t\t\t\tcurrentTarget.removeClass('d-none');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontainer.find('.js-detail-widget-content').append(dataObj);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tdetailContentsHolder.on('change', '.relatedHistoryTypes', function(e) {\n\t\t\t\tlet widgetContent = jQuery(this)\n\t\t\t\t\t\t.closest('.widgetContentBlock')\n\t\t\t\t\t\t.find('.widgetContent'),\n\t\t\t\t\tprogressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\t\telementToBlock: widgetContent\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Detail',\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tmode: 'showRecentRelation',\n\t\t\t\t\tpage: 1,\n\t\t\t\t\tlimit: widgetContent.find('.js-relatedHistoryPageLimit').val(),\n\t\t\t\t\ttype: $(e.currentTarget).val()\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\twidgetContent.find('#relatedHistoryCurrentPage').remove();\n\t\t\t\t\twidgetContent.find('#moreRelatedUpdates').remove();\n\t\t\t\t\twidgetContent.html(data);\n\t\t\t\t\tVtiger_Index_Js.registerMailButtons(widgetContent);\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.moreProductsService', function() {\n\t\t\t\tjQuery('.related .mainNav[data-reference=\"ProductsAndServices\"]:not(.d-none)').trigger('click');\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.moreRelatedUpdates', function() {\n\t\t\t\tvar widgetContainer = jQuery(this).closest('.widgetContentBlock');\n\t\t\t\tvar widgetContent = widgetContainer.find('.widgetContent');\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\telementToBlock: widgetContent\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar currentPage = widgetContent.find('#relatedHistoryCurrentPage').val();\n\t\t\t\tvar nextPage = parseInt(currentPage) + 1;\n\t\t\t\tvar types = widgetContainer.find('.relatedHistoryTypes').val();\n\t\t\t\tvar pageLimit = widgetContent.find('#relatedHistoryPageLimit').val();\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Detail',\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tmode: 'showRecentRelation',\n\t\t\t\t\tpage: nextPage,\n\t\t\t\t\tlimit: pageLimit,\n\t\t\t\t\ttype: types\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\twidgetContent.find('#relatedHistoryCurrentPage').remove();\n\t\t\t\t\twidgetContent.find('#moreRelatedUpdates').remove();\n\t\t\t\t\twidgetContent.find('#relatedUpdates').append(data);\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.moreRecentUpdates', function(e) {\n\t\t\t\tconst container = $(e.currentTarget).closest('.recentActivitiesContainer');\n\t\t\t\tlet newChange = container.find('#newChange').val(),\n\t\t\t\t\tnextPage = parseInt(container.find('#updatesCurrentPage').val()) + 1,\n\t\t\t\t\turl;\n\t\t\t\tif (container.closest('.js-detail-widget').length) {\n\t\t\t\t\tlet data = thisInstance.getFiltersData(\n\t\t\t\t\t\te,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpage: nextPage,\n\t\t\t\t\t\t\ttab_label: 'LBL_UPDATES',\n\t\t\t\t\t\t\tnewChange: newChange\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcontainer.find('#updates')\n\t\t\t\t\t);\n\t\t\t\t\turl = data['params'];\n\t\t\t\t} else {\n\t\t\t\t\turl = thisInstance.getTabByLabel(thisInstance.detailViewRecentUpdatesTabLabel).data('url');\n\t\t\t\t\turl = url.replace('&page=1', '&page=' + nextPage) + '&skipHeader=true&newChange=' + newChange;\n\t\t\t\t\tif (url.indexOf('&whereCondition') === -1) {\n\t\t\t\t\t\tlet switchBtn = jQuery('.active .js-switch--recentActivities');\n\t\t\t\t\t\turl +=\n\t\t\t\t\t\t\t'&whereCondition=' +\n\t\t\t\t\t\t\t(typeof switchBtn.data('on-val') === 'undefined'\n\t\t\t\t\t\t\t\t? switchBtn.data('off-val')\n\t\t\t\t\t\t\t\t: switchBtn.data('on-val'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\t\tlet dataContainer = jQuery(data);\n\t\t\t\t\tcontainer.find('#newChange').val(dataContainer.find('#newChange').val());\n\t\t\t\t\tcontainer.find('#updatesCurrentPage').val(dataContainer.find('#updatesCurrentPage').val());\n\t\t\t\t\tcontainer.find('.js-more-link').html(dataContainer.find('.js-more-link').html());\n\t\t\t\t\tcontainer.find('#updates ul').append(dataContainer.find('#updates ul').html());\n\t\t\t\t\tapp.event.trigger('DetailView.UpdatesWidget.AddMore', data, thisInstance);\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.btnChangesReviewedOn', function(e) {\n\t\t\t\tvar progressInstance = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar url = 'index.php?module=ModTracker&action=ChangesReviewedOn&record=' + app.getRecordId();\n\t\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tjQuery(e.currentTarget)\n\t\t\t\t\t\t.parent()\n\t\t\t\t\t\t.remove();\n\t\t\t\t\tthisInstance\n\t\t\t\t\t\t.getTabByLabel(thisInstance.detailViewRecentUpdatesTabLabel)\n\t\t\t\t\t\t.find('.count.badge')\n\t\t\t\t\t\t.text('');\n\t\t\t\t\tif (selectedTabElement.data('labelKey') == thisInstance.detailViewRecentUpdatesTabLabel) {\n\t\t\t\t\t\tthisInstance.reloadTabContent();\n\t\t\t\t\t} else if (selectedTabElement.data('linkKey') == thisInstance.detailViewSummaryTabLabel) {\n\t\t\t\t\t\tvar updatesWidget = detailContentsHolder.find(\"[data-type='Updates']\");\n\t\t\t\t\t\tif (updatesWidget.length > 0) {\n\t\t\t\t\t\t\tvar params = thisInstance.getFiltersData(updatesWidget);\n\t\t\t\t\t\t\tthisInstance.loadWidget(updatesWidget, params['params']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.moreRecentDocuments', function() {\n\t\t\t\tvar recentDocumentsTab = thisInstance.getTabByLabel(thisInstance.detailViewRecentDocumentsTabLabel);\n\t\t\t\trecentDocumentsTab.trigger('click');\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.moreRecentActivities', function(e) {\n\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\tcurrentTarget.prop('disabled', true);\n\t\t\t\tvar container = currentTarget.closest('.activityWidgetContainer');\n\t\t\t\tvar page = container.find('.currentPage').val();\n\t\t\t\tpage++;\n\t\t\t\tvar url = container.find('.widgetContentBlock').data('url');\n\t\t\t\turl = url.replace('&page=1', '&page=' + page);\n\t\t\t\turl += '&totalCount=' + container.find('.totaltActivities').val();\n\t\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\t\tcurrentTarget.prop('disabled', false);\n\t\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\t\tvar currentPage = container.find('.currentPage').val();\n\t\t\t\t\tcontainer.find('.currentPage').remove();\n\t\t\t\t\tcontainer.find('.countActivities').remove();\n\t\t\t\t\tcontainer.find('.js-detail-widget-content').append(data);\n\t\t\t\t\tcontainer\n\t\t\t\t\t\t.find('.countActivities')\n\t\t\t\t\t\t.val(\n\t\t\t\t\t\t\tparseInt(container.find('.countActivities').val()) +\n\t\t\t\t\t\t\t\tcurrentPage * parseInt(container.find('.pageLimit').val())\n\t\t\t\t\t\t);\n\t\t\t\t\tthisInstance.reloadWidgetActivitesStats(container);\n\t\t\t\t});\n\t\t\t});\n\t\t\tdetailContentsHolder.on('click', '.widgetFullscreen', function(e) {\n\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\tvar widgetContentBlock = currentTarget.closest('.widgetContentBlock');\n\t\t\t\tvar url = widgetContentBlock.data('url');\n\t\t\t\turl = url.replace('&view=Detail&', '&view=WidgetFullscreen&');\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tapp.showModalWindow(null, 'index.php?' + url, function(modal) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t});\n\t\t\tthisInstance.registerEventForRelatedList();\n\t\t\tthisInstance.registerBlockAnimationEvent();\n\t\t\tthisInstance.registerMailPreviewWidget(\n\t\t\t\tdetailContentsHolder.find('.widgetContentBlock[data-type=\"EmailList\"]')\n\t\t\t);\n\t\t\tthisInstance.registerMailPreviewWidget(\n\t\t\t\tdetailContentsHolder.find('.widgetContentBlock[data-type=\"HistoryRelation\"]')\n\t\t\t);\n\t\t\tdetailContentsHolder\n\t\t\t\t.find('.js-switch--recentActivities')\n\t\t\t\t.off()\n\t\t\t\t.on('change', function(e) {\n\t\t\t\t\tconst currentTarget = jQuery(e.currentTarget),\n\t\t\t\t\t\ttabElement = thisInstance.getTabByLabel(thisInstance.detailViewRecentUpdatesTabLabel),\n\t\t\t\t\t\tvariableName = currentTarget.data('urlparams'),\n\t\t\t\t\t\tvalueOn = $(this).data('on-val'),\n\t\t\t\t\t\tvalueOff = $(this).data('off-val');\n\t\t\t\t\tlet url = tabElement.data('url');\n\t\t\t\t\turl = url\n\t\t\t\t\t\t.replace('&' + variableName + '=' + valueOn, '')\n\t\t\t\t\t\t.replace('&' + variableName + '=' + valueOff, '');\n\t\t\t\t\tif (typeof currentTarget.data('on-val') !== 'undefined') {\n\t\t\t\t\t\turl += '&' + variableName + '=' + valueOn;\n\t\t\t\t\t} else if (typeof currentTarget.data('off-val') !== 'undefined') {\n\t\t\t\t\t\turl += '&' + variableName + '=' + valueOff;\n\t\t\t\t\t}\n\t\t\t\t\ttabElement.data('url', url);\n\t\t\t\t\ttabElement.trigger('click');\n\t\t\t\t});\n\t\t\tapp.registerIframeEvents(detailContentsHolder);\n\t\t},\n\t\treloadWidgetActivitesStats: function(container) {\n\t\t\tvar countElement = container.find('.countActivities');\n\t\t\tvar totalElement = container.find('.totaltActivities');\n\t\t\tif (!countElement.length || !totalElement.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar stats = ' (' + countElement.val() + '/' + totalElement.val() + ')';\n\t\t\tvar switchBtn = container.find('.active .js-switch');\n\t\t\tvar switchBtnParent = switchBtn.parent();\n\t\t\tvar text = switchBtn.data('basic-text') + stats;\n\t\t\tswitchBtnParent.removeTextNode();\n\t\t\tswitchBtnParent.append(text);\n\t\t},\n\t\trefreshCommentContainer: function(commentId) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar commentContainer = $('.commentsBody');\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'Detail',\n\t\t\t\trecord: thisInstance.getRecordId(),\n\t\t\t\tmode: 'showThreadComments',\n\t\t\t\tcommentid: commentId\n\t\t\t};\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\telementToBlock: commentContainer\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(params).done(function(data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\tcommentContainer.html(data);\n\t\t\t});\n\t\t},\n\t\tupdateRecordsPDFTemplateBtn: function(form) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet btnToolbar = $('.js-btn-toolbar .js-pdf');\n\t\t\tif (btnToolbar.length) {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\taction: 'PDF',\n\t\t\t\t\t\tmode: 'hasValidTemplate',\n\t\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\t\tview: app.getViewName()\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json'\n\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tif (data['result'].valid === false) {\n\t\t\t\t\t\t\tbtnToolbar.addClass('d-none');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbtnToolbar.removeClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(data, err) {\n\t\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tupdateWindowHeight: function(currentHeight, frame) {\n\t\t\tframe.height(currentHeight);\n\t\t},\n\t\tloadSubProducts: function(parentRow) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet recordId = parentRow.data('product-id'),\n\t\t\t\tsubProrductParams = {\n\t\t\t\t\tmodule: 'Products',\n\t\t\t\t\taction: 'SubProducts',\n\t\t\t\t\trecord: recordId\n\t\t\t\t};\n\t\t\tAppConnector.request(subProrductParams).done(function(data) {\n\t\t\t\tlet responseData = data.result;\n\t\t\t\tthisInstance.addSubProducts(parentRow, responseData);\n\t\t\t});\n\t\t},\n\t\taddSubProducts: function(parentRow, responseData) {\n\t\t\tlet subProductsContainer = $('.js-subproducts-container ul', parentRow);\n\t\t\tfor (let id in responseData) {\n\t\t\t\tlet productText = $('<li>').text(responseData[id]);\n\t\t\t\tsubProductsContainer.append(productText);\n\t\t\t}\n\t\t},\n\t\tregisterSubProducts: function(container) {\n\t\t\tconst thisInstance = this;\n\t\t\tcontainer.find('.inventoryItems .js-inventory-row').each(function(index) {\n\t\t\t\tthisInstance.loadSubProducts($(this), false);\n\t\t\t});\n\t\t},\n\t\tregisterCollapsiblePanels(detailViewContainer) {\n\t\t\tconst panels = detailViewContainer.find('.js-detail-widget-collapse');\n\t\t\tconst storageName = `yf-${app.getModuleName()}-detail-widgets`;\n\t\t\tif (Quasar.plugins.LocalStorage.has(storageName)) {\n\t\t\t\tthis.setPanels({ panels, storageName });\n\t\t\t} else {\n\t\t\t\tpanels.collapse('show');\n\t\t\t\tlet panelsStorage = {};\n\t\t\t\tpanels.each((i, item) => {\n\t\t\t\t\tpanelsStorage[item.dataset.storageId] = 'shown';\n\t\t\t\t});\n\t\t\t\tQuasar.plugins.LocalStorage.set(storageName, panelsStorage);\n\t\t\t}\n\t\t\tpanels.on('hidden.bs.collapse shown.bs.collapse', e => {\n\t\t\t\tthis.updatePanelsStorage({ id: e.target.dataset.storageKey, type: e.type, storageName });\n\t\t\t});\n\t\t\tpanels.on('hide.bs.collapse show.bs.collapse', function(e) {\n\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t.siblings('.js-detail-widget-header')\n\t\t\t\t\t.toggleClass('collapsed');\n\t\t\t});\n\t\t},\n\t\tsetPanels({ panels, storageName }) {\n\t\t\tconst panelsStorage = Quasar.plugins.LocalStorage.getItem(storageName);\n\t\t\tpanels.each((i, item) => {\n\t\t\t\tif (\n\t\t\t\t\tpanelsStorage[item.dataset.storageKey] === 'shown' ||\n\t\t\t\t\tundefined === panelsStorage[item.dataset.storageKey]\n\t\t\t\t) {\n\t\t\t\t\t$(item).collapse('show');\n\t\t\t\t\t$(item)\n\t\t\t\t\t\t.siblings('.js-detail-widget-header')\n\t\t\t\t\t\t.toggleClass('collapsed');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tupdatePanelsStorage({ id, type, storageName }) {\n\t\t\tconst panelsStorage = Quasar.plugins.LocalStorage.getItem(storageName);\n\t\t\tpanelsStorage[id] = type;\n\t\t\tQuasar.plugins.LocalStorage.set(storageName, panelsStorage);\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\t//this.triggerDisplayTypeEvent();\n\t\t\tthis.registerHelpInfo();\n\t\t\tthis.registerSendSmsSubmitEvent();\n\t\t\tthis.registerAjaxEditEvent();\n\t\t\tthis.registerRelatedRowClickEvent();\n\t\t\tthis.registerBlockStatusCheckOnLoad();\n\t\t\tthis.registerEmailFieldClickEvent();\n\t\t\tthis.registerPhoneFieldClickEvent();\n\t\t\tthis.registerEventForRelatedTabClick();\n\t\t\tVtiger_Helper_Js.showHorizontalTopScrollBar();\n\t\t\tthis.registerUrlFieldClickEvent();\n\t\t\tvar detailViewContainer = jQuery('div.detailViewContainer');\n\t\t\tif (detailViewContainer.length <= 0) {\n\t\t\t\t// Not detail view page\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.registerSetReadRecord(detailViewContainer);\n\t\t\tthis.registerEventForPicklistDependencySetup(this.getForm());\n\t\t\tthis.getForm().validationEngine(app.validationEngineOptionsForRecord);\n\t\t\tthis.loadWidgetsEvents();\n\t\t\tthis.loadWidgets();\n\t\t\tthis.registerBasicEvents();\n\t\t\tthis.registerEventForTotalRecordsCount();\n\t\t\tthis.registerProgress();\n\t\t\tthis.registerChat(detailViewContainer);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","Vtiger_Detail_Js","detailInstance","moduleClassName","app","getModuleName","getViewName","instance","window","detailActionUrl","callBackFunction","getInstance","selectedIds","push","getRecordId","postData","JSON","stringify","actionParams","request","done","data","showModalWindow","fail","error","err","module","triggerDetailViewAction","massActionUrl","thisInstance","getRelatedModulesContainer","callback","params","validationEngineOptions","onValidationComplete","form","valid","attr","transferOwnershipSave","validationEngine","selectElement","getRelatedModuleContainer","Fields","Picklist","changeSelectElementView","transferOwner","val","relatedModules","recordId","success","hideModalWindow","vtranslate","oldvalue","element","find","removeAttr","trigger","Fieldname","closest","html","showPnotify","length","page","loadRelatedList","popover","treeInstance","jstree","parse","on","tasks","selected","each","index","treeElement","record_id","parent","undefined","Object","keys","loadWidgets","event","e","widgetContent","relatedModuleName","reloadWidgetActivitesStats","registerCommentEventsInDetail","registerShowSummary","registerMailButtons","progressIndicatorElement","progressIndicator","$","currentTarget","mode","registerEmailEvents","registerBlockStatusCheckOnLoad","widgetList","widgetContainerELement","widgetContainer","loadWidget","registerRelatedModulesRecordCount","contentContainer","registerFilterForAddingModuleRelatedRecordFromSummaryWidget","urlParams","queryParameters","split","keyValueMap","queryParamComponents","aDeferred","Deferred","showSelect2ElementView","registerModal","relatedController","Vtiger_RelatedList_Js","getSelectedTab","setRelatedContainer","registerRelatedEvents","widgetRelatedRecordView","resolve","reject","promise","container","load","cacheKey","relatedRecordCacheID","moduleCacheGet","newActive","removeClass","addClass","controlBox","prev","next","active","hasClass","nextElement","moduleCacheSet","prevElement","url","detailContentsHolder","getContentHolder","requestPjax","responseData","Date","register","getForm","updatedFields","tabLabel","tabs","getTabs","targetTab","tab","labelKey","moduleName","relationId","relatedTabContainer","getTabContainer","moduleTab","deSelectAllrelatedTabs","markTabAsSelected","tabElement","tabContainer","topTabs","dropdownMenuTabs","n","iteration","className","filter","get","detailViewContentHolder","detailViewForm","fieldDetailList","async","dataType","reponseData","jqXHR","textStatus","errorThrown","remove","commentMode","commentContentValue","editCommentReason","commentId","parentCommentId","commentInfoBlock","relatedTo","replace","addRelationBetweenRecords","result","id","getTabByLabel","detailViewRecentCommentsTabLabel","closestCommentBlock","commentContent","errorMsg","commentInfoHeader","saveCommentAjax","clonedCommentBlock","clone","App","Text","Completions","emojiPanel","smsTextLength","submitButton","SendSmsSave","preventDefault","progressInstance","SendSmsUrl","serializeFormData","fieldUpdatedEvent","nameFields","recordLabel","nameFieldName","recordLabelElement","text","title","nameField","salutatioField","salutatioValue","updateHeaderValues","currentElement","updateHeaderNameFields","name","getUpdateFieldsArray","inArray","stopPropagation","targetElement","target","is","children","elem","recordUrl","location","href","relatedListInstance","getRelatedModuleName","block","blockContent","response","parents","isEmpty","registerPostLoadEvents","not","blockId","closestBlock","bodyContents","cacheSet","blocks","currentBlock","dynamicAttr","headerAnimationElement","value","cacheGet","currentTdElement","readRecord","detailViewValue","editElement","actionElement","fieldElement","prop","fieldName","elementTarget","elementName","inputmask","focus","saveHandler","registerNameAjaxEditEvent","previousValue","ajaxEditNewValue","fieldInfo","Vtiger_Field_Js","dateTimeField","dateTime","field","type","toStr","v","off","preFieldSaveEvent","Event","fieldPreSave","fieldNameValueMap","isDefaultPrevented","getCustomFieldNameValueMap","saveFieldValues","postSaveRecordDetails","displayValue","display_value","prevDisplayValue","prev_display_value","label","urlObject","convertUrlToObject","reload","targetPicklistChange","targetPicklist","selectedTabElement","detailViewSummaryTabLabel","reloadTabContent","registerSummaryViewContainerEvents","registerEventForPicklistDependencySetup","registerEventForRelatedList","detailViewDetailsTabLabel","updateRecordsPDFTemplateBtn","widthType","elements","customParams","appendTo","referenceModuleName","referenceFieldNames","relField","fullFormUrl","preQuickCreateSave","addElementsToQuickCreateForCreatingRelation","taskGoToFullFormButton","eventsGoToFullFormButton","taskFullFormUrl","eventsFullFormUrl","callbackFunction","widgetContentBlock","activitiesWidget","QuickCreateParams","assign","quickCreateModule","startDate","dateTab","date","newDate","setDate","getDate","getStringDate","modDay","dateStartEl","dateStartVal","dateStartFormat","validDateFromat","Vtiger_Helper_Js","convertToDateString","map","extend","getEndDate","events","testDate","isEmptyObject","ev","indexOf","append","i","summaryWidgetContainer","quickcreateUrl","parentId","quickCreateParams","relatedField","autoCompleteFields","relatedParams","postQuickCreateSave","postSummaryWidgetAddRecord","loadModuleSummary","progress","headerInstance","Vtiger_Header_Js","getQuickCreateForm","handleQuickCreateData","restrictionsField","key","showRecordsList","modal","setSelectEvent","createUrl","addidtionalParams","concat","showConfirmationBox","d","showMessage","getFiltersData","widget","m","urlNewParams","item","selectedFilter","fieldlable","state","siblings","getFiltersDataAndLoad","summaryViewContainer","registerEventForActivityWidget","registerChangeFilterForWidget","registerChangeSwitchForWidget","registerAddingInventoryRecords","registerEmailEvent","ajaxEditHandling","updatesWidget","noCache","currentDiv","detailViewElement","descriptionText","descriptionEmpty","saveButton","closeButton","activityButtonContainer","fieldnameElement","ajaxEditNewLable","activityDiv","activityId","activityType","add","Promise","then","errorExists","addClickOutSideEvent","show","closeDescription","hide","one","widgetHeaderContainer","goToFullFormcallback","registerFastEditingFiels","relatedModule","relatedModuleRecordId","addRelations","idList","_recordId","modulesSelectElement","selectedOptionValue","detailContainer","urlAttributes","callBack","loadContents","showHorizontalTopScrollBar","registerHelpInfo","registerBasicEvents","notifyPostAjaxReady","picklistDependcyElemnt","picklistDependencyMapping","sourcePicklists","sourcePickListNames","join","sourcePickListElements","sourcePicklistname","configuredDependencyObject","selectedValue","targetObjectForSelectedSourceValue","picklistmap","targetPickListName","targetPickListValues","targetPickListMap","targetPickList","listOfAvailableOptions","targetOptions","optionSelector","picklistValue","targetPickListSelectedValue","dataObj","getCommentThread","totalNumberOfRecords","getRelatedPageCount","showPagingInfo","pageNumberElement","pageRange","newPagingInfo","listViewEntriesCount","parseInt","relatedTabKey","fastEditingFiels","fieldContainer","fieldValue","showPopoverElementView","moreList","relationContainer","numberOfRecords","self","closestAddCommentBlock","commentTextAreaElement","commentHtml","getCommentUI","commentBlock","noCommentsMsgContainer","childComments","currentChildCommentsCount","newChildCommentCount","getChildComments","responsedata","prependTo","modifiedTime","commentInfoContent","commentEditStatus","commentReason","commentcontent","reasontoedit","modifiedtime","modifiedtimetitle","removeCommentBlockIfExists","getCommentBlock","editCommentBlock","getEditCommentBlock","saveComment","errorLog","addComment","recentCommentsTab","regex","hierarchy","which","submitSearchForm","searchTextDom","limit","isWidget","eq","widgetDataContainer","row","mailBody","mailTeaser","toggleClass","loadMailPreviewWidget","registerMailPreviewWidget","click","mapView","OpenStreetMap_Map_Js","registerDetailView","socialMediaContainer","summaryView","css","picklistName","showProgressConfirmation","chatVue","chatContainer","padding","height","document","offset","top","outerHeight","ChatRecordRoomVueComponent","mount","loadChat","ready","registerCommentEvents","registerMapsEvents","registerSocialMediaEvents","registerSubProducts","registerCollapsiblePanels","DateTime","MultiImage","registerEventForClockPicker","Editor","toolbar","currentPageNum","getRelatedListCurrentPageNum","requestedPage","nextPageUrl","relatedLabel","editViewObj","Vtiger_Edit_Js","currentTargetParent","commentActionsBlock","currentCommentBlock","ulElements","getParentComments","commentLoad","commentid","getTabByModule","containerTable","currentPage","nextPage","types","pageLimit","newChange","detailViewRecentUpdatesTabLabel","switchBtn","dataContainer","recentDocumentsTab","detailViewRecentDocumentsTabLabel","registerBlockAnimationEvent","variableName","valueOn","valueOff","registerIframeEvents","countElement","totalElement","stats","switchBtnParent","removeTextNode","commentContainer","btnToolbar","currentHeight","frame","parentRow","subProrductParams","addSubProducts","subProductsContainer","productText","loadSubProducts","detailViewContainer","panels","storageName","Quasar","plugins","LocalStorage","has","setPanels","collapse","panelsStorage","dataset","storageId","set","updatePanelsStorage","storageKey","getItem","registerSendSmsSubmitEvent","registerAjaxEditEvent","registerRelatedRowClickEvent","registerEmailFieldClickEvent","registerPhoneFieldClickEvent","registerEventForRelatedTabClick","registerUrlFieldClickEvent","registerSetReadRecord","validationEngineOptionsForRecord","loadWidgetsEvents","registerEventForTotalRecordsCount","registerProgress","registerChat"],"mappings":"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"}