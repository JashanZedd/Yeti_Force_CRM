{"version":3,"file":"RecordAddsTemplates.min.js","sources":["RecordAddsTemplates.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n$.Class(\n\t'Base_RecordAddsTemplates_JS',\n\t{},\n\t{\n\t\teditInstance: false,\n\t\t/**\n\t\t * Function listener to send a form\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterSubmitForm: function (container) {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet instanse = this;\n\t\t\tcontainer.on('click', '.js-modal__save', () => {\n\t\t\t\tlet params = {\n\t\t\t\t\taction: 'RecordAddsTemplates',\n\t\t\t\t\trecordAddsType: container.find('.js-modal-body').find(\"[name='recordAddsType']\").val()\n\t\t\t\t};\n\t\t\t\tlet validate = true;\n\t\t\t\tcontainer.find('form.js-record-template').each(function () {\n\t\t\t\t\tlet form = $(this);\n\t\t\t\t\tinstanse.editInstance.registerValidationsFields(form);\n\t\t\t\t\tlet formSerializeData = form.serializeFormData();\n\t\t\t\t\tparams[formSerializeData.module] = formSerializeData;\n\t\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\t\tvalidate = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (validate) {\n\t\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tlet response = data.result;\n\t\t\t\t\t\t\tlet preSave = response.preSave;\n\t\t\t\t\t\t\tif (typeof preSave !== 'undefined' && preSave.length) {\n\t\t\t\t\t\t\t\tfor (let i = 0; i < preSave.length; i++) {\n\t\t\t\t\t\t\t\t\tif (preSave[i] !== null && preSave[i].result !== true) {\n\t\t\t\t\t\t\t\t\t\tapp.showNotify(preSave[i].message ? preSave[i].message : app.vtranslate('JS_ERROR'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (response.url) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = response.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (response.length <= 0) {\n\t\t\t\t\t\t\t\taDeferred.resolve(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register events function\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.editInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.editInstance.registerBasicEvents(modalContainer);\n\t\t\tthis.registerSubmitForm(modalContainer);\n\t\t}\n\t}\n);\n"],"names":["$","Class","editInstance","registerSubmitForm","container","Deferred","instanse","on","params","action","recordAddsType","find","val","validate","each","registerValidationsFields","form","formSerializeData","serializeFormData","module","validationEngine","AppConnector","request","done","data","result","preSave","response","length","i","app","showNotify","message","vtranslate","success","hideModalWindow","text","type","url","window","location","href","reload","aDeferred","resolve","fail","textStatus","errorThrown","errorLog","registerEvents","modalContainer","Vtiger_Edit_Js","getInstance","registerBasicEvents"],"mappings":"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"}