{"version":3,"file":"AdvanceFilterEx.min.js","sources":["AdvanceFilterEx.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_AdvanceFilter_Js(\n\t'Vtiger_AdvanceFilterEx_Js',\n\t{},\n\t{\n\t\tvalidationSupportedFieldConditionMap: {\n\t\t\temail: ['e', 'n'],\n\t\t\tdate: ['is'],\n\t\t\tdatetime: ['is']\n\t\t},\n\t\t//Hols field type for which there is validations always needed\n\t\tallConditionValidationNeededFieldList: ['double', 'integer'],\n\t\t// comparators which do not have any field Specific UI.\n\t\tcomparatorsWithNoValueBoxMap: ['has changed', 'is empty', 'is not empty', 'is added'],\n\t\tinit: function(container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#advanceFilterContainer');\n\t\t\t}\n\n\t\t\tif (container.is('#advanceFilterContainer')) {\n\t\t\t\tthis.setFilterContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setFilterContainer(jQuery('#advanceFilterContainer', container));\n\t\t\t}\n\t\t\tthis.initialize();\n\t\t},\n\t\tgetFieldSpecificType: function(fieldSelected) {\n\t\t\tvar fieldInfo = fieldSelected.data('fieldinfo');\n\t\t\tvar type = fieldInfo.type;\n\t\t\treturn type;\n\t\t},\n\t\tgetModuleName: function() {\n\t\t\treturn 'AdvanceFilterEx';\n\t\t},\n\t\t/**\n\t\t * Function to add new condition row\n\t\t * @params : condtionGroupElement - group where condtion need to be added\n\t\t * @return : current instance\n\t\t */\n\t\taddNewCondition: function(conditionGroupElement) {\n\t\t\tvar basicElement = jQuery('.basic', conditionGroupElement);\n\t\t\tvar newRowElement = basicElement.find('.js-conditions-row').clone(true, true);\n\t\t\tjQuery('select', newRowElement).addClass('select2');\n\t\t\tvar conditionList = jQuery('.conditionList', conditionGroupElement);\n\t\t\tconditionList.append(newRowElement);\n\n\t\t\t//change in to chosen elements\n\t\t\tApp.Fields.Picklist.changeSelectElementView(newRowElement);\n\t\t\tnewRowElement\n\t\t\t\t.find('[name=\"columnname\"]')\n\t\t\t\t.find('optgroup:first option:first')\n\t\t\t\t.attr('selected', 'selected')\n\t\t\t\t.trigger('change');\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to load condition list for the selected field\n\t\t * (overrrided to remove \"has changed\" condition for related record fields in workflows)\n\t\t * @params : fieldSelect - select element which will represents field list\n\t\t * @return : select element which will represent the condition element\n\t\t */\n\t\tloadConditions: function(fieldSelect) {\n\t\t\tvar row = fieldSelect.closest('div.js-conditions-row');\n\t\t\tvar conditionSelectElement = row.find('select[name=\"comparator\"]');\n\t\t\tvar conditionSelected = conditionSelectElement.val();\n\t\t\tvar fieldSelected = fieldSelect.find('option:selected');\n\t\t\tvar fieldLabel = fieldSelected.val();\n\t\t\tvar match = fieldLabel.match(/\\((\\w+)\\) (\\w+)/);\n\t\t\tvar fieldSpecificType = this.getFieldSpecificType(fieldSelected);\n\t\t\tvar conditionList = this.getConditionListFromType(fieldSpecificType);\n\t\t\t//for none in field name\n\t\t\tif (typeof conditionList === 'undefined') {\n\t\t\t\tconditionList = {};\n\t\t\t\tconditionList['none'] = 'None';\n\t\t\t}\n\n\t\t\tvar options = '';\n\t\t\tfor (var key in conditionList) {\n\t\t\t\t//IE Browser consider the prototype properties also, it should consider has own properties only.\n\t\t\t\tif (conditionList.hasOwnProperty(key)) {\n\t\t\t\t\tvar conditionValue = conditionList[key];\n\t\t\t\t\tvar conditionLabel = this.getConditionLabel(conditionValue);\n\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\tif (conditionValue != 'has changed') {\n\t\t\t\t\t\t\toptions += '<option value=\"' + conditionValue + '\"';\n\t\t\t\t\t\t\tif (conditionValue == conditionSelected) {\n\t\t\t\t\t\t\t\toptions += ' selected=\"selected\" ';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toptions += '>' + conditionLabel + '</option>';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions += '<option value=\"' + conditionValue + '\"';\n\t\t\t\t\t\tif (conditionValue == conditionSelected) {\n\t\t\t\t\t\t\toptions += ' selected=\"selected\" ';\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions += '>' + conditionLabel + '</option>';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconditionSelectElement\n\t\t\t\t.empty()\n\t\t\t\t.html(options)\n\t\t\t\t.trigger('change');\n\t\t\treturn conditionSelectElement;\n\t\t},\n\t\t/**\n\t\t * Function to retrieve the values of the filter\n\t\t * @return : object\n\t\t */\n\t\tgetValues: function() {\n\t\t\tconst thisInstance = this,\n\t\t\t\tfilterContainer = this.getFilterContainer();\n\n\t\t\tlet fieldList = ['columnname', 'comparator', 'value', 'valuetype', 'column_condition'],\n\t\t\t\tvalues = {},\n\t\t\t\tcolumnIndex = 0,\n\t\t\t\tconditionGroups = $('.conditionGroup', filterContainer);\n\t\t\tconditionGroups.each(function(index, domElement) {\n\t\t\t\tlet groupElement = $(domElement),\n\t\t\t\t\tconditions = $('.conditionList .js-conditions-row', groupElement),\n\t\t\t\t\titerationValues = {};\n\t\t\t\tif (conditions.length <= 0) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconditions.each(function(i, conditionDomElement) {\n\t\t\t\t\tlet rowElement = $(conditionDomElement),\n\t\t\t\t\t\tfieldSelectElement = $('[name=\"columnname\"]', rowElement),\n\t\t\t\t\t\tvalueSelectElement = $('[data-value=\"value\"]', rowElement);\n\t\t\t\t\tif (thisInstance.isEmptyFieldSelected(fieldSelectElement)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tlet fieldType = fieldSelectElement.find('option:selected').data('fieldinfo').type,\n\t\t\t\t\t\trowValues = {},\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\tfield;\n\t\t\t\t\tif ($.inArray(fieldType, ['picklist', 'multipicklist', 'multiReferenceValue']) > -1) {\n\t\t\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\t\t\tif (field === 'value' && valueSelectElement.is('input')) {\n\t\t\t\t\t\t\t\tlet pickListValues = valueSelectElement.data('picklistvalues'),\n\t\t\t\t\t\t\t\t\tvaluesArr = valueSelectElement.val().split(','),\n\t\t\t\t\t\t\t\t\tnewValuesArr = [];\n\t\t\t\t\t\t\t\tfor (i = 0; i < valuesArr.length; i++) {\n\t\t\t\t\t\t\t\t\tif (typeof pickListValues[valuesArr[i]] !== 'undefined') {\n\t\t\t\t\t\t\t\t\t\tnewValuesArr.push(pickListValues[valuesArr[i]]);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tnewValuesArr.push(valuesArr[i]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trowValues[field] = newValuesArr.join(',');\n\t\t\t\t\t\t\t} else if (field === 'value' && valueSelectElement.is('select') && fieldType === 'picklist') {\n\t\t\t\t\t\t\t\trowValues[field] = valueSelectElement.val();\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\tfield === 'value' &&\n\t\t\t\t\t\t\t\tvalueSelectElement.is('select') &&\n\t\t\t\t\t\t\t\t$.inArray(fieldType, ['multipicklist', 'multiReferenceValue']) > -1\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tlet value = valueSelectElement.val();\n\t\t\t\t\t\t\t\tif (value == null) {\n\t\t\t\t\t\t\t\t\trowValues[field] = value;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trowValues[field] = value.join(',');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\t\t\tif (field === 'value') {\n\t\t\t\t\t\t\t\trowValues[field] = valueSelectElement.val();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t$('[name=\"valuetype\"]', rowElement).val() === 'false' ||\n\t\t\t\t\t\t$('[name=\"valuetype\"]', rowElement).length === 0\n\t\t\t\t\t) {\n\t\t\t\t\t\trowValues['valuetype'] = 'rawtext';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (index === 0) {\n\t\t\t\t\t\trowValues['groupid'] = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trowValues['groupid'] = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (rowElement.is(':last-child')) {\n\t\t\t\t\t\trowValues['column_condition'] = '';\n\t\t\t\t\t}\n\t\t\t\t\titerationValues[columnIndex] = rowValues;\n\t\t\t\t\tcolumnIndex++;\n\t\t\t\t});\n\n\t\t\t\tif (!$.isEmptyObject(iterationValues)) {\n\t\t\t\t\tvalues[index + 1] = {};\n\t\t\t\t\tvalues[index + 1]['columns'] = iterationValues;\n\t\t\t\t}\n\t\t\t\tif (groupElement.find('div.groupCondition').length > 0 && !$.isEmptyObject(values[index + 1])) {\n\t\t\t\t\tvalues[index + 1]['condition'] = conditionGroups.find('div.groupCondition [name=\"condition\"]').val();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn values;\n\t\t},\n\t\t/**\n\t\t * Functiont to get the field specific ui for the selected field\n\t\t * @prarms : fieldSelectElement - select element which will represents field list\n\t\t * @return : jquery object which represents the ui for the field\n\t\t */\n\t\tgetFieldSpecificUi: function(fieldSelectElement) {\n\t\t\tvar fieldSelected = fieldSelectElement.find('option:selected');\n\t\t\tvar fieldInfo = fieldSelected.data('fieldinfo');\n\t\t\tif (jQuery.inArray(fieldInfo.comparatorElementVal, this.comparatorsWithNoValueBoxMap) != -1) {\n\t\t\t\treturn jQuery('');\n\t\t\t} else {\n\t\t\t\treturn this._super(fieldSelectElement);\n\t\t\t}\n\t\t},\n\t\tgetPopUp: function(container) {\n\t\t\tconst thisInstance = this;\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = thisInstance.getFilterContainer();\n\t\t\t}\n\t\t\tcontainer.on('click', '.getPopupUi', function(e) {\n\t\t\t\tlet fieldValueElement = jQuery(e.currentTarget),\n\t\t\t\t\tfieldValue = fieldValueElement.val(),\n\t\t\t\t\tfieldUiHolder = fieldValueElement.closest('.fieldUiHolder'),\n\t\t\t\t\tvalueType = fieldUiHolder.find('[name=\"valuetype\"]').val(),\n\t\t\t\t\tconditionsContainer = fieldValueElement.closest('.js-conditions-container'),\n\t\t\t\t\tclonedPopupUi = conditionsContainer\n\t\t\t\t\t\t.find('.popupUi')\n\t\t\t\t\t\t.clone(true, true)\n\t\t\t\t\t\t.removeClass('popupUi')\n\t\t\t\t\t\t.addClass('clonedPopupUi'),\n\t\t\t\t\tvalue = '';\n\t\t\t\tclonedPopupUi.find('select').addClass('select2');\n\t\t\t\tclonedPopupUi.find('.fieldValue').val(fieldValue);\n\t\t\t\tif (valueType === '') {\n\t\t\t\t\tvalueType = 'rawtext';\n\t\t\t\t}\n\t\t\t\tif (fieldValueElement.hasClass('date')) {\n\t\t\t\t\tclonedPopupUi\n\t\t\t\t\t\t.find('.textType')\n\t\t\t\t\t\t.find('option[value=\"rawtext\"]')\n\t\t\t\t\t\t.attr('data-ui', 'input');\n\t\t\t\t\tlet dataFormat = fieldValueElement.data('date-format');\n\t\t\t\t\tif (valueType === 'rawtext') {\n\t\t\t\t\t\tvalue = fieldValueElement.val();\n\t\t\t\t\t}\n\t\t\t\t\tclonedPopupUi\n\t\t\t\t\t\t.find('.fieldValueContainer')\n\t\t\t\t\t\t.prepend(\n\t\t\t\t\t\t\t'<input type=\"text\" class=\"dateField fieldValue col-md-4\" value=\"' +\n\t\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t\t'\" data-date-format=\"' +\n\t\t\t\t\t\t\t\tdataFormat +\n\t\t\t\t\t\t\t\t'\" data-input=\"true\" >'\n\t\t\t\t\t\t);\n\t\t\t\t} else if (fieldValueElement.hasClass('time')) {\n\t\t\t\t\tclonedPopupUi\n\t\t\t\t\t\t.find('.textType')\n\t\t\t\t\t\t.find('option[value=\"rawtext\"]')\n\t\t\t\t\t\t.attr('data-ui', 'input');\n\t\t\t\t\tif (valueType === 'rawtext') {\n\t\t\t\t\t\tvalue = fieldValueElement.val();\n\t\t\t\t\t}\n\t\t\t\t\tclonedPopupUi\n\t\t\t\t\t\t.find('.fieldValueContainer')\n\t\t\t\t\t\t.prepend(\n\t\t\t\t\t\t\t'<input type=\"text\" class=\"clockPicker fieldValue col-md-4 form-control\" value=\"' +\n\t\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t\t'\" data-input=\"true\" >'\n\t\t\t\t\t\t);\n\t\t\t\t} else if (fieldValueElement.hasClass('boolean')) {\n\t\t\t\t\tclonedPopupUi\n\t\t\t\t\t\t.find('.textType')\n\t\t\t\t\t\t.find('option[value=\"rawtext\"]')\n\t\t\t\t\t\t.attr('data-ui', 'input');\n\t\t\t\t\tif (valueType === 'rawtext') {\n\t\t\t\t\t\tvalue = fieldValueElement.val();\n\t\t\t\t\t}\n\t\t\t\t\tclonedPopupUi\n\t\t\t\t\t\t.find('.fieldValueContainer')\n\t\t\t\t\t\t.prepend('<input type=\"checkbox\" class=\"fieldValue col-md-4\" value=\"' + value + '\" data-input=\"true\" >');\n\n\t\t\t\t\tif (value == 'true:boolean' || value === '') {\n\t\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer input').attr('checked', 'checked');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer input').removeAttr('checked');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet callBackFunction = function(data) {\n\t\t\t\t\tdata.find('.clonedPopupUi').removeClass('d-none');\n\t\t\t\t\tlet moduleNameElement = fieldValueElement.closest('.js-conditions-row').find('[name=\"modulename\"]');\n\t\t\t\t\tif (moduleNameElement.length > 0) {\n\t\t\t\t\t\tvar moduleName = moduleNameElement.val();\n\t\t\t\t\t\tdata.find('.useFieldElement').addClass('d-none');\n\t\t\t\t\t\tdata.find('[name=\"' + moduleName + '\"]').removeClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(data);\n\t\t\t\t\tApp.Fields.Date.register(data);\n\t\t\t\t\tapp.registerEventForClockPicker(data);\n\t\t\t\t\tthisInstance.postShowModalAction(data, valueType);\n\t\t\t\t\tthisInstance.registerChangeFieldEvent(data);\n\t\t\t\t\tthisInstance.registerSelectOptionEvent(data);\n\t\t\t\t\tthisInstance.registerPopUpSaveEvent(data, fieldUiHolder);\n\t\t\t\t\tthisInstance.registerRemoveModalEvent(data);\n\t\t\t\t\tdata\n\t\t\t\t\t\t.find('.fieldValue')\n\t\t\t\t\t\t.filter(':visible')\n\t\t\t\t\t\t.trigger('focus');\n\t\t\t\t\tdata\n\t\t\t\t\t\t.find('[data-close-modal=\"modal\"]')\n\t\t\t\t\t\t.off('click')\n\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\t$(this)\n\t\t\t\t\t\t\t\t.closest('.modal')\n\t\t\t\t\t\t\t\t.removeClass('in')\n\t\t\t\t\t\t\t\t.css('display', 'none');\n\t\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\tconditionsContainer.find('.clonedPopUp').html(clonedPopupUi);\n\t\t\t\t$('.clonedPopupUi').on('shown.bs.modal', function() {\n\t\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\t\tcallBackFunction($('.clonedPopupUi', conditionsContainer));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t$('.clonedPopUp', conditionsContainer)\n\t\t\t\t\t.find('.clonedPopupUi')\n\t\t\t\t\t.modal();\n\t\t\t});\n\t\t},\n\t\tpostShowModalAction: function(data, valueType) {\n\t\t\tif (valueType == 'fieldname') {\n\t\t\t\tjQuery('.useFieldContainer', data).removeClass('d-none');\n\t\t\t\tjQuery('.textType', data)\n\t\t\t\t\t.val(valueType)\n\t\t\t\t\t.trigger('change');\n\t\t\t} else if (valueType == 'expression') {\n\t\t\t\tjQuery('.useFieldContainer', data).removeClass('d-none');\n\t\t\t\tjQuery('.useFunctionContainer', data).removeClass('d-none');\n\t\t\t\tjQuery('.textType', data)\n\t\t\t\t\t.val(valueType)\n\t\t\t\t\t.trigger('change');\n\t\t\t}\n\t\t\tjQuery('#' + valueType + '_help', data).removeClass('d-none');\n\t\t\tvar uiType = jQuery('.textType', data)\n\t\t\t\t.find('option:selected')\n\t\t\t\t.data('ui');\n\t\t\tjQuery('.fieldValue', data).hide();\n\t\t\tjQuery('[data-' + uiType + ']', data).show();\n\t\t},\n\t\tregisterChangeFieldEvent: function(data) {\n\t\t\tjQuery('.textType', data).on('change', function(e) {\n\t\t\t\tvar valueType = jQuery(e.currentTarget).val();\n\t\t\t\tvar useFieldContainer = jQuery('.useFieldContainer', data);\n\t\t\t\tvar useFunctionContainer = jQuery('.useFunctionContainer', data);\n\t\t\t\tvar uiType = jQuery(e.currentTarget)\n\t\t\t\t\t.find('option:selected')\n\t\t\t\t\t.data('ui');\n\t\t\t\tjQuery('.fieldValue', data).hide();\n\t\t\t\tjQuery('[data-' + uiType + ']', data).show();\n\t\t\t\tif (valueType == 'fieldname') {\n\t\t\t\t\tuseFieldContainer.removeClass('d-none');\n\t\t\t\t\tuseFunctionContainer.addClass('d-none');\n\t\t\t\t} else if (valueType == 'expression') {\n\t\t\t\t\tuseFieldContainer.removeClass('d-none');\n\t\t\t\t\tuseFunctionContainer.removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tuseFieldContainer.addClass('d-none');\n\t\t\t\t\tuseFunctionContainer.addClass('d-none');\n\t\t\t\t}\n\t\t\t\tjQuery('.helpmessagebox', data).addClass('d-none');\n\t\t\t\tjQuery('#' + valueType + '_help', data).removeClass('d-none');\n\t\t\t\tdata.find('.fieldValue').val('');\n\t\t\t});\n\t\t},\n\t\tregisterSelectOptionEvent: function(data) {\n\t\t\t$('.useField,.useFunction', data).on('change', function(e) {\n\t\t\t\tlet currentElement = jQuery(e.currentTarget);\n\t\t\t\tlet newValue = currentElement.val();\n\t\t\t\tlet oldValue = data\n\t\t\t\t\t.find('.fieldValue')\n\t\t\t\t\t.filter(':visible')\n\t\t\t\t\t.val();\n\t\t\t\tif (currentElement.hasClass('useField')) {\n\t\t\t\t\tif (oldValue != '') {\n\t\t\t\t\t\tvar concatenatedValue = oldValue + ' ' + newValue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconcatenatedValue = newValue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconcatenatedValue = oldValue + newValue;\n\t\t\t\t}\n\t\t\t\tdata.find('.fieldValue').val(concatenatedValue);\n\t\t\t\tcurrentElement.val('').trigger('change.select2');\n\t\t\t});\n\t\t},\n\t\tregisterPopUpSaveEvent: function(data, fieldUiHolder) {\n\t\t\tjQuery('[name=\"saveButton\"]', data).on('click', function(e) {\n\t\t\t\tvar valueType = jQuery('.textType', data).val();\n\n\t\t\t\tfieldUiHolder.find('[name=\"valuetype\"]').val(valueType);\n\t\t\t\tvar fieldValueElement = fieldUiHolder.find('.getPopupUi');\n\t\t\t\tif (valueType != 'rawtext') {\n\t\t\t\t\tfieldValueElement.removeAttr('data-validation-engine');\n\t\t\t\t\tfieldValueElement.removeClass('validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]');\n\t\t\t\t} else {\n\t\t\t\t\tfieldValueElement.addClass('validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]');\n\t\t\t\t\tfieldValueElement.attr(\n\t\t\t\t\t\t'data-validation-engine',\n\t\t\t\t\t\t'validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tvar fieldType = data\n\t\t\t\t\t.find('.fieldValue')\n\t\t\t\t\t.filter(':visible')\n\t\t\t\t\t.attr('type');\n\t\t\t\tvar fieldValue = data\n\t\t\t\t\t.find('.fieldValue')\n\t\t\t\t\t.filter(':visible')\n\t\t\t\t\t.val();\n\t\t\t\t//For checkbox field type, handling fieldValue\n\t\t\t\tif (fieldType == 'checkbox') {\n\t\t\t\t\tif (\n\t\t\t\t\t\tdata\n\t\t\t\t\t\t\t.find('.fieldValue')\n\t\t\t\t\t\t\t.filter(':visible')\n\t\t\t\t\t\t\t.is(':checked')\n\t\t\t\t\t) {\n\t\t\t\t\t\tfieldValue = 'true:boolean';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfieldValue = 'false:boolean';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfieldValueElement.val(fieldValue);\n\t\t\t\tdata.modal('hide');\n\t\t\t\tfieldValueElement.validationEngine('hide');\n\t\t\t});\n\t\t},\n\t\tregisterRemoveModalEvent: function(data) {\n\t\t\tdata.on('click', '.closeModal', function(e) {\n\t\t\t\tdata.modal('hide');\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will regiter all events for this page\n\t\t */\n\t\tregisterEvents: function() {\n\t\t\tthis._super();\n\t\t\tthis.getPopUp();\n\t\t}\n\t}\n);\n\nVtiger_Field_Js(\n\t'AdvanceFilterEx_Field_Js',\n\t{},\n\t{\n\t\tgetUiTypeSpecificHtml: function() {\n\t\t\tvar uiTypeModel = this.getUiTypeModel();\n\t\t\treturn uiTypeModel.getUi();\n\t\t},\n\t\tgetModuleName: function() {\n\t\t\tvar currentModule = app.getModuleName();\n\t\t\treturn currentModule;\n\t\t},\n\t\t/**\n\t\t * Funtion to get the ui for the field  - generally this will be extend by the child classes to\n\t\t * give ui type specific ui\n\t\t * return <String or Jquery> it can return either plain html or jquery object\n\t\t */\n\t\tgetUi: function() {\n\t\t\tvar html =\n\t\t\t\t'<input type=\"text\" class=\"getPopupUi form-control\" name=\"' +\n\t\t\t\tthis.getName() +\n\t\t\t\t'\"  /><input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t'\" />';\n\t\t\thtml = jQuery(html);\n\t\t\thtml.filter('.getPopupUi').val(app.htmlDecode(this.getValue()));\n\t\t\treturn this.addValidationToElement(html);\n\t\t}\n\t}\n);\n\nVtiger_Date_Field_Js(\n\t'AdvanceFilterEx_Date_Field_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to get the user date format\n\t\t */\n\t\tgetDateFormat: function() {\n\t\t\treturn this.get('date-format');\n\t\t},\n\t\t/**\n\t\t * Function to get the ui\n\t\t * @return - input text field\n\t\t */\n\t\tgetUi: function() {\n\t\t\tlet comparatorSelectedOptionVal = this.get('comparatorElementVal'),\n\t\t\t\tdateSpecificConditions = this.get('dateSpecificConditions'),\n\t\t\t\thtml,\n\t\t\t\telement;\n\t\t\tif (comparatorSelectedOptionVal.length > 0) {\n\t\t\t\tif (comparatorSelectedOptionVal === 'between' || comparatorSelectedOptionVal === 'custom') {\n\t\t\t\t\thtml =\n\t\t\t\t\t\t'<div class=\"date\"><input class=\"dateRangeField form-control\" data-calendar-type=\"range\" name=\"' +\n\t\t\t\t\t\tthis.getName() +\n\t\t\t\t\t\t'\" data-date-format=\"' +\n\t\t\t\t\t\tthis.getDateFormat() +\n\t\t\t\t\t\t'\" type=\"text\" ReadOnly=\"true\" value=\"' +\n\t\t\t\t\t\tthis.getValue() +\n\t\t\t\t\t\t'\"></div>';\n\t\t\t\t\telement = $(html);\n\t\t\t\t\treturn this.addValidationToElement(element);\n\t\t\t\t} else if (this._specialDateComparator(comparatorSelectedOptionVal)) {\n\t\t\t\t\thtml =\n\t\t\t\t\t\t'<input name=\"' +\n\t\t\t\t\t\tthis.getName() +\n\t\t\t\t\t\t'\" type=\"text\" value=\"' +\n\t\t\t\t\t\tthis.getValue() +\n\t\t\t\t\t\t'\" data-validation-engine=\"' +\n\t\t\t\t\t\t'validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]\"' +\n\t\t\t\t\t\t' data-validator=\"[{\"name\":\"PositiveNumber\"}]\">' +\n\t\t\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t\t\t'\" />';\n\t\t\t\t\treturn jQuery(html);\n\t\t\t\t} else if (comparatorSelectedOptionVal in dateSpecificConditions) {\n\t\t\t\t\tlet startValue = dateSpecificConditions[comparatorSelectedOptionVal]['startdate'],\n\t\t\t\t\t\tendValue = dateSpecificConditions[comparatorSelectedOptionVal]['enddate'];\n\t\t\t\t\thtml =\n\t\t\t\t\t\t'<input name=\"' +\n\t\t\t\t\t\tthis.getName() +\n\t\t\t\t\t\t'\"  type=\"text\" ReadOnly=\"true\" value=\"' +\n\t\t\t\t\t\tstartValue +\n\t\t\t\t\t\t',' +\n\t\t\t\t\t\tendValue +\n\t\t\t\t\t\t'\">';\n\t\t\t\t\treturn $(html);\n\t\t\t\t} else if (comparatorSelectedOptionVal === 'is today') {\n\t\t\t\t\t//show nothing\n\t\t\t\t} else {\n\t\t\t\t\treturn this._super();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thtml =\n\t\t\t\t\t'<input type=\"text\" class=\"getPopupUi date form-control\" name=\"' +\n\t\t\t\t\tthis.getName() +\n\t\t\t\t\t'\"  data-date-format=\"' +\n\t\t\t\t\tthis.getDateFormat() +\n\t\t\t\t\t'\"  value=\"' +\n\t\t\t\t\tthis.getValue() +\n\t\t\t\t\t'\" />' +\n\t\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t\t'\" />';\n\t\t\t\telement = $(html);\n\t\t\t\treturn this.addValidationToElement(element);\n\t\t\t}\n\t\t},\n\t\t_specialDateComparator: function(comp) {\n\t\t\tlet specialComparators = [\n\t\t\t\t\t'less than days ago',\n\t\t\t\t\t'more than days ago',\n\t\t\t\t\t'in less than',\n\t\t\t\t\t'in more than',\n\t\t\t\t\t'days ago',\n\t\t\t\t\t'days later'\n\t\t\t\t],\n\t\t\t\tindex;\n\t\t\tfor (index in specialComparators) {\n\t\t\t\tif (comp == specialComparators[index]) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n);\n\nVtiger_Date_Field_Js(\n\t'AdvanceFilterEx_Datetime_Field_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to get the user date format\n\t\t */\n\t\tgetDateFormat: function() {\n\t\t\treturn this.get('date-format');\n\t\t},\n\t\t/**\n\t\t * Function to get the ui\n\t\t * @return - input text field\n\t\t */\n\t\tgetUi: function() {\n\t\t\tlet comparatorSelectedOptionVal = this.get('comparatorElementVal'),\n\t\t\t\thtml,\n\t\t\t\telement;\n\t\t\tif (this._specialDateTimeComparator(comparatorSelectedOptionVal)) {\n\t\t\t\thtml =\n\t\t\t\t\t'<input name=\"' +\n\t\t\t\t\tthis.getName() +\n\t\t\t\t\t'\" type=\"text\" value=\"' +\n\t\t\t\t\tthis.getValue() +\n\t\t\t\t\t'\" data-validator=\"[{name:PositiveNumber}]\"><input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t\t'\" />';\n\t\t\t\telement = jQuery(html);\n\t\t\t} else {\n\t\t\t\thtml =\n\t\t\t\t\t'<input type=\"text\" class=\"getPopupUi date form-control\" name=\"' +\n\t\t\t\t\tthis.getName() +\n\t\t\t\t\t'\"  data-date-format=\"' +\n\t\t\t\t\tthis.getDateFormat() +\n\t\t\t\t\t'\"  value=\"' +\n\t\t\t\t\tthis.getValue() +\n\t\t\t\t\t'\" />' +\n\t\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t\t'\" />';\n\t\t\t\telement = jQuery(html);\n\t\t\t}\n\t\t\treturn element;\n\t\t},\n\t\t_specialDateTimeComparator: function(comp) {\n\t\t\tlet specialComparators = [\n\t\t\t\t\t'less than hours before',\n\t\t\t\t\t'less than hours later',\n\t\t\t\t\t'more than hours later',\n\t\t\t\t\t'more than hours before'\n\t\t\t\t],\n\t\t\t\tindex;\n\t\t\tfor (index in specialComparators) {\n\t\t\t\tif (comp == specialComparators[index]) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n);\n\nVtiger_Currency_Field_Js(\n\t'AdvanceFilterEx_Currency_Field_Js',\n\t{},\n\t{\n\t\tgetUi: function() {\n\t\t\tvar html =\n\t\t\t\t'<input type=\"text\" class=\"getPopupUi marginLeftZero form-control\" name=\"' +\n\t\t\t\tthis.getName() +\n\t\t\t\t'\" value=\"' +\n\t\t\t\tthis.getValue() +\n\t\t\t\t'\"  />' +\n\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t'\" />';\n\t\t\tvar element = jQuery(html);\n\t\t\treturn this.addValidationToElement(element);\n\t\t}\n\t}\n);\n\nVtiger_Time_Field_Js(\n\t'AdvanceFilterEx_Time_Field_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to get the ui\n\t\t * @return - input text field\n\t\t */\n\t\tgetUi: function() {\n\t\t\tvar html =\n\t\t\t\t'<input type=\"text\" class=\"getPopupUi time form-control\" name=\"' +\n\t\t\t\tthis.getName() +\n\t\t\t\t'\"  value=\"' +\n\t\t\t\tthis.getValue() +\n\t\t\t\t'\" />' +\n\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t'\" />';\n\t\t\tvar element = jQuery(html);\n\t\t\treturn this.addValidationToElement(element);\n\t\t}\n\t}\n);\n\nVtiger_Field_Js(\n\t'Vtiger_Percentage_Field_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to get the ui\n\t\t * @return - input percentage field\n\t\t */\n\t\tgetUi: function() {\n\t\t\tvar html =\n\t\t\t\t'<input type=\"text\" class=\"getPopupUi form-control\" name=\"' +\n\t\t\t\tthis.getName() +\n\t\t\t\t'\" value=\"' +\n\t\t\t\tthis.getValue() +\n\t\t\t\t'\" />' +\n\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t'\" />';\n\t\t\tvar element = jQuery(html);\n\t\t\treturn this.addValidationToElement(element);\n\t\t}\n\t}\n);\n\nVtiger_Field_Js(\n\t'Vtiger_Text_Field_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to get the ui\n\t\t * @return - input text field\n\t\t */\n\t\tgetUi: function() {\n\t\t\tvar html =\n\t\t\t\t'<input type=\"text\" class=\"getPopupUi form-control\" name=\"' +\n\t\t\t\tthis.getName() +\n\t\t\t\t'\" value=\"' +\n\t\t\t\tthis.getValue() +\n\t\t\t\t'\" />' +\n\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t'\" />';\n\t\t\tvar element = jQuery(html);\n\t\t\treturn this.addValidationToElement(element);\n\t\t}\n\t}\n);\n\nVtiger_Field_Js(\n\t'Vtiger_Boolean_Field_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to get the ui\n\t\t * @return - input text field\n\t\t */\n\t\tgetUi: function() {\n\t\t\tvar html =\n\t\t\t\t'<input type=\"text\" class=\"getPopupUi form-control boolean\" name=\"' +\n\t\t\t\tthis.getName() +\n\t\t\t\t'\" value=\"' +\n\t\t\t\tthis.getValue() +\n\t\t\t\t'\" />' +\n\t\t\t\t'<input type=\"hidden\" name=\"valuetype\" value=\"' +\n\t\t\t\tthis.get('workflow_valuetype') +\n\t\t\t\t'\" />';\n\t\t\tvar element = jQuery(html);\n\t\t\treturn this.addValidationToElement(element);\n\t\t}\n\t}\n);\n\nVtiger_Owner_Field_Js(\n\t'AdvanceFilterEx_Owner_Field_Js',\n\t{},\n\t{\n\t\tgetUi: function() {\n\t\t\tvar html = '<select class=\"select2\" name=\"' + this.getName() + '\">';\n\t\t\tvar pickListValues = this.getPickListValues();\n\t\t\tvar selectedOption = this.getValue();\n\t\t\tfor (var optGroup in pickListValues) {\n\t\t\t\thtml += '<optgroup label=\"' + optGroup + '\">';\n\t\t\t\tvar optionGroupValues = pickListValues[optGroup];\n\t\t\t\tfor (var option in optionGroupValues) {\n\t\t\t\t\thtml += '<option value=\"' + option + '\" ';\n\t\t\t\t\tif (option == selectedOption) {\n\t\t\t\t\t\thtml += ' selected ';\n\t\t\t\t\t}\n\t\t\t\t\thtml += '>' + optionGroupValues[option] + '</option>';\n\t\t\t\t}\n\t\t\t\thtml += '</optgroup>';\n\t\t\t}\n\n\t\t\thtml += '</select>';\n\t\t\tvar selectContainer = jQuery(html);\n\t\t\tthis.addValidationToElement(selectContainer);\n\t\t\treturn selectContainer;\n\t\t}\n\t}\n);\n\nVtiger_Picklist_Field_Js('AdvanceFilterEx_Picklist_Field_Js', {}, {});\n"],"names":["Vtiger_AdvanceFilter_Js","container","jQuery","is","setFilterContainer","initialize","fieldSelected","data","type","conditionGroupElement","newRowElement","find","clone","addClass","append","Fields","Picklist","changeSelectElementView","attr","trigger","this","fieldSelect","conditionSelectElement","closest","conditionSelected","val","match","fieldSpecificType","getFieldSpecificType","conditionList","getConditionListFromType","options","key","hasOwnProperty","conditionValue","conditionLabel","getConditionLabel","empty","html","thisInstance","filterContainer","getFilterContainer","fieldList","values","columnIndex","conditionGroups","$","each","index","domElement","groupElement","conditions","iterationValues","length","i","conditionDomElement","rowElement","fieldSelectElement","valueSelectElement","isEmptyFieldSelected","fieldType","rowValues","field","inArray","pickListValues","valuesArr","split","newValuesArr","push","join","value","isEmptyObject","fieldInfo","comparatorElementVal","comparatorsWithNoValueBoxMap","_super","on","e","fieldValueElement","currentTarget","fieldValue","fieldUiHolder","valueType","conditionsContainer","clonedPopupUi","removeClass","hasClass","dataFormat","prepend","removeAttr","callBackFunction","moduleNameElement","moduleName","Date","register","registerEventForClockPicker","postShowModalAction","registerChangeFieldEvent","registerSelectOptionEvent","registerPopUpSaveEvent","registerRemoveModalEvent","filter","off","css","modal","uiType","hide","show","useFieldContainer","useFunctionContainer","currentElement","newValue","oldValue","concatenatedValue","validationEngine","getPopUp","Vtiger_Field_Js","getUiTypeModel","getUi","app","getModuleName","getName","get","htmlDecode","getValue","addValidationToElement","Vtiger_Date_Field_Js","comparatorSelectedOptionVal","dateSpecificConditions","element","getDateFormat","_specialDateComparator","startValue","endValue","comp","specialComparators","_specialDateTimeComparator","Vtiger_Currency_Field_Js","Vtiger_Time_Field_Js","Vtiger_Owner_Field_Js","getPickListValues","selectedOption","optGroup","optionGroupValues","option","selectContainer","Vtiger_Picklist_Field_Js"],"mappings":"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"}