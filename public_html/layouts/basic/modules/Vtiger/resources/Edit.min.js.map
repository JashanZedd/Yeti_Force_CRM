{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\n$.Class(\n\t'Vtiger_Edit_Js',\n\t{\n\t\t//Event that will triggered when reference field is selected\n\t\treferenceSelectionEvent: 'Vtiger.Reference.Selection',\n\t\t//Event that will triggered when reference field is selected\n\t\treferenceDeSelectionEvent: 'Vtiger.Reference.DeSelection',\n\t\t//Event that will triggered before saving the record\n\t\trecordPreSave: 'Vtiger.Record.PreSave',\n\t\teditInstance: false,\n\t\tinventoryController: false,\n\t\t/**\n\t\t * Function to get Instance by name\n\t\t * @params moduleName:-- Name of the module to create instance\n\t\t */\n\t\tgetInstanceByModuleName: function(moduleName) {\n\t\t\tif (typeof moduleName === 'undefined') {\n\t\t\t\tmoduleName = app.getModuleName();\n\t\t\t}\n\t\t\tlet parentModule = app.getParentModuleName(),\n\t\t\t\tmoduleClassName,\n\t\t\t\tfallbackClassName,\n\t\t\t\tinstance;\n\t\t\tif (parentModule === 'Settings') {\n\t\t\t\tmoduleClassName = parentModule + '_' + moduleName + '_Edit_Js';\n\t\t\t\tif (typeof window[moduleClassName] === 'undefined') {\n\t\t\t\t\tmoduleClassName = moduleName + '_Edit_Js';\n\t\t\t\t}\n\t\t\t\tfallbackClassName = parentModule + '_Vtiger_Edit_Js';\n\t\t\t\tif (typeof window[fallbackClassName] === 'undefined') {\n\t\t\t\t\tfallbackClassName = 'Vtiger_Edit_Js';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmoduleClassName = moduleName + '_Edit_Js';\n\t\t\t\tfallbackClassName = 'Vtiger_Edit_Js';\n\t\t\t}\n\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\tinstance = new window[moduleClassName]();\n\t\t\t} else {\n\t\t\t\tinstance = new window[fallbackClassName]();\n\t\t\t}\n\t\t\tinstance.moduleName = moduleName;\n\t\t\treturn instance;\n\t\t},\n\t\tgetInstance: function() {\n\t\t\tif (Vtiger_Edit_Js.editInstance == false) {\n\t\t\t\tvar instance = Vtiger_Edit_Js.getInstanceByModuleName();\n\t\t\t\tVtiger_Edit_Js.editInstance = instance;\n\t\t\t\treturn instance;\n\t\t\t}\n\t\t\treturn Vtiger_Edit_Js.editInstance;\n\t\t}\n\t},\n\t{\n\t\tformElement: false,\n\t\trelationOperation: '',\n\t\tmoduleName: app.getModuleName(),\n\t\tgetForm: function() {\n\t\t\tif (this.formElement == false) {\n\t\t\t\tthis.setForm($('#EditView'));\n\t\t\t}\n\t\t\treturn this.formElement;\n\t\t},\n\t\tsetForm: function(element) {\n\t\t\tthis.formElement = element;\n\t\t\treturn this;\n\t\t},\n\t\tgetRecordsListParams: function(container) {\n\t\t\tlet sourceModule = app.getModuleName();\n\t\t\tlet popupReferenceModule = $('input[name=\"popupReferenceModule\"]', container).val();\n\t\t\tlet sourceFieldElement = $('input[class=\"sourceField\"]', container);\n\t\t\tlet sourceField = sourceFieldElement.attr('name');\n\t\t\tlet sourceRecordElement = $('input[name=\"record\"]');\n\t\t\tlet sourceRecordId = '';\n\t\t\tif (sourceRecordElement.length > 0) {\n\t\t\t\tsourceRecordId = sourceRecordElement.val();\n\t\t\t}\n\t\t\tlet isMultiple = false;\n\t\t\tif (sourceFieldElement.data('multiple') == true) {\n\t\t\t\tisMultiple = true;\n\t\t\t}\n\t\t\tlet filterFields = {};\n\t\t\tlet formElement = container.closest('form');\n\t\t\tlet mappingRelatedField = formElement.find('input[name=\"mappingRelatedField\"]').val();\n\t\t\tlet mappingRelatedModule = mappingRelatedField ? JSON.parse(mappingRelatedField) : [];\n\t\t\tif (\n\t\t\t\tmappingRelatedModule[sourceField] != undefined &&\n\t\t\t\tmappingRelatedModule[sourceField][popupReferenceModule] != undefined\n\t\t\t) {\n\t\t\t\t$.each(mappingRelatedModule[sourceField][popupReferenceModule], function(index, value) {\n\t\t\t\t\tlet mapFieldElement = formElement.find('[name=\"' + index + '\"]');\n\t\t\t\t\tif (mapFieldElement.length && mapFieldElement.val() != '') {\n\t\t\t\t\t\tfilterFields[index] = mapFieldElement.val();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tlet params = {\n\t\t\t\tmodule: popupReferenceModule,\n\t\t\t\tsrc_module: sourceModule,\n\t\t\t\tsrc_field: sourceField,\n\t\t\t\tsrc_record: sourceRecordId,\n\t\t\t\tfilterFields: filterFields\n\t\t\t};\n\t\t\t$.each(['link', 'process'], function(index, value) {\n\t\t\t\tlet fieldElement = formElement.find('[name=\"' + value + '\"]');\n\t\t\t\tif (fieldElement.length && fieldElement.val() != '' && fieldElement.val() != 0) {\n\t\t\t\t\tparams[value] = fieldElement.val();\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (isMultiple) {\n\t\t\t\tparams.multi_select = true;\n\t\t\t}\n\t\t\treturn params;\n\t\t},\n\t\t/**\n\t\t * Show records list modal\n\t\t * @param {jQuery.Event} e\n\t\t */\n\t\tshowRecordsList: function(e) {\n\t\t\tvar parentElem = $(e.target).closest('.fieldValue');\n\t\t\tif (parentElem.length <= 0) {\n\t\t\t\tparentElem = $(e.target).closest('td');\n\t\t\t}\n\t\t\tvar params = this.getRecordsListParams(parentElem);\n\t\t\tapp.showRecordsList(params, (modal, instance) => {\n\t\t\t\tinstance.setSelectEvent(data => {\n\t\t\t\t\tthis.setReferenceFieldValue(parentElem, data);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tsetReferenceFieldValue: function(container, params) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet sourceFieldElement = container.find('input.sourceField');\n\t\t\tlet sourceField = sourceFieldElement.attr('name');\n\t\t\tlet fieldElement = container.find('input[name=\"' + sourceField + '\"]');\n\t\t\tlet sourceFieldDisplay = sourceField + '_display';\n\t\t\tlet fieldDisplayElement = container.find('input[name=\"' + sourceFieldDisplay + '\"]');\n\t\t\tlet popupReferenceModule = container.find('input[name=\"popupReferenceModule\"]').val();\n\t\t\tlet selectedName = params.name;\n\t\t\tlet id = params.id;\n\n\t\t\tcontainer.find('.clearReferenceSelection').trigger('click');\n\n\t\t\tfieldElement.val(id);\n\t\t\tfieldDisplayElement.val(app.decodeHTML(selectedName)).attr('readonly', true);\n\t\t\tfieldElement.trigger(Vtiger_Edit_Js.referenceSelectionEvent, {\n\t\t\t\tmodule: popupReferenceModule,\n\t\t\t\trecord: id,\n\t\t\t\tselectedName: selectedName\n\t\t\t});\n\t\t\tfieldDisplayElement.validationEngine('closePrompt', fieldDisplayElement);\n\t\t\tif (sourceFieldElement.data('type') == 'inventory') {\n\t\t\t\treturn params;\n\t\t\t}\n\t\t\tlet formElement = container.closest('form');\n\t\t\tlet mappingRelatedField = this.getMappingRelatedField(sourceField, popupReferenceModule, formElement);\n\t\t\tif (typeof mappingRelatedField !== 'undefined') {\n\t\t\t\tlet params = {\n\t\t\t\t\tmodule: popupReferenceModule,\n\t\t\t\t\trecord: id\n\t\t\t\t};\n\t\t\t\tapp.getRecordDetails(params).done(function(data) {\n\t\t\t\t\tlet response = (params.data = data['result']['data']);\n\t\t\t\t\tapp.event.trigger('EditView.SelectReference', params, formElement);\n\t\t\t\t\t$.each(mappingRelatedField, function(key, value) {\n\t\t\t\t\t\tif (response[value[0]] != 0 && !thisInstance.getMappingValuesFromUrl(key)) {\n\t\t\t\t\t\t\tlet mapFieldElement = formElement.find('[name=\"' + key + '\"]');\n\t\t\t\t\t\t\tlet fieldinfo = mapFieldElement.data('fieldinfo');\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tdata['result']['type'][value[0]] === 'date' ||\n\t\t\t\t\t\t\t\tdata['result']['type'][value[0]] === 'datetime'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tmapFieldElement.val(data['result']['displayData'][value[0]]);\n\t\t\t\t\t\t\t} else if (data['result']['type'][value[0]] === 'multipicklist') {\n\t\t\t\t\t\t\t\tlet mapFieldElementMultiselect = formElement.find('[name=\"' + key + '[]\"]');\n\t\t\t\t\t\t\t\tif (mapFieldElementMultiselect.length > 0) {\n\t\t\t\t\t\t\t\t\tlet multipleAttr = mapFieldElement.attr('multiple');\n\t\t\t\t\t\t\t\t\tlet splitValues = response[value[0]].split(' |##| ');\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\ttypeof multipleAttr !== undefined &&\n\t\t\t\t\t\t\t\t\t\tmultipleAttr !== false &&\n\t\t\t\t\t\t\t\t\t\tsplitValues.length > 0\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\tmapFieldElementMultiselect.val(splitValues).trigger('change');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (mapFieldElement.is('select')) {\n\t\t\t\t\t\t\t\tif (mapFieldElement.find('option[value=\"' + response[value[0]] + '\"]').length) {\n\t\t\t\t\t\t\t\t\tmapFieldElement.val(response[value[0]]).trigger('change');\n\t\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\t\tmapFieldElement.data('fieldinfo').picklistvalues.hasOwnProperty(response[value[0]])\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tlet newOption = new Option(response[value[0]], response[value[0]], true, true);\n\t\t\t\t\t\t\t\t\tmapFieldElement.append(newOption).trigger('change');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (mapFieldElement.length == 0) {\n\t\t\t\t\t\t\t\t$(\"<input type='hidden'/>\")\n\t\t\t\t\t\t\t\t\t.attr('name', key)\n\t\t\t\t\t\t\t\t\t.attr('value', response[value[0]])\n\t\t\t\t\t\t\t\t\t.appendTo(formElement);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmapFieldElement.val(response[value[0]]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet mapFieldDisplayElement = formElement.find('input[name=\"' + key + '_display\"]');\n\t\t\t\t\t\t\tif (mapFieldDisplayElement.length > 0) {\n\t\t\t\t\t\t\t\tmapFieldDisplayElement\n\t\t\t\t\t\t\t\t\t.val(data['result']['displayData'][value[0]])\n\t\t\t\t\t\t\t\t\t.attr('readonly', true);\n\t\t\t\t\t\t\t\tif (fieldinfo.type === 'reference') {\n\t\t\t\t\t\t\t\t\tlet referenceModulesList = mapFieldElement\n\t\t\t\t\t\t\t\t\t\t.closest('.fieldValue')\n\t\t\t\t\t\t\t\t\t\t.find('.referenceModulesList');\n\t\t\t\t\t\t\t\t\tif (referenceModulesList.length > 0 && value[1]) {\n\t\t\t\t\t\t\t\t\t\treferenceModulesList.val(value[1]).trigger('change');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthisInstance.setReferenceFieldValue(mapFieldDisplayElement.closest('.fieldValue'), {\n\t\t\t\t\t\t\t\t\t\tname: data['result']['displayData'][value[0]],\n\t\t\t\t\t\t\t\t\t\tid: response[value[0]]\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetRelationOperation: function() {\n\t\t\tif (this.relationOperation === '') {\n\t\t\t\tvar relationOperation = $('[name=\"relationOperation\"]');\n\t\t\t\tif (relationOperation.length) {\n\t\t\t\t\tthis.relationOperation = relationOperation.val();\n\t\t\t\t} else {\n\t\t\t\t\tthis.relationOperation = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.relationOperation;\n\t\t},\n\t\tgetMappingValuesFromUrl: function(key) {\n\t\t\tvar relationOperation = this.getRelationOperation();\n\t\t\tif (relationOperation) {\n\t\t\t\treturn app.getUrlVar(key);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tproceedRegisterEvents: function() {\n\t\t\tif ($('.recordEditView').length > 0) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Function which will register reference field clear event\n\t\t * @params - container <jQuery> - element in which auto complete fields needs to be searched\n\t\t */\n\t\tregisterClearTreeSelectionEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.find('.clearTreeSelection').on('click', function(e) {\n\t\t\t\tthisInstance.clearFieldValue($(e.currentTarget));\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will handle the reference auto complete event registrations\n\t\t * @params - container <jQuery> - element in which auto complete fields needs to be searched\n\t\t */\n\t\tregisterTreeAutoCompleteFields: function(container) {\n\t\t\tcontainer.find('input.treeAutoComplete').autocomplete({\n\t\t\t\tdelay: '600',\n\t\t\t\tminLength: '3',\n\t\t\t\tsource: function(request, response) {\n\t\t\t\t\t//element will be array of dom elements\n\t\t\t\t\t//here this refers to auto complete instance\n\t\t\t\t\tlet inputElement = $(this.element[0]);\n\t\t\t\t\tlet searchValue = request.term.toLowerCase();\n\t\t\t\t\tlet parentElem = inputElement.closest('.fieldValue');\n\t\t\t\t\tlet sourceFieldElement = $('input[class=\"sourceField\"]', parentElem);\n\t\t\t\t\tlet fieldInfo = sourceFieldElement.data('fieldinfo');\n\t\t\t\t\tlet allValues = fieldInfo.picklistvalues;\n\t\t\t\t\tlet reponseDataList = [];\n\t\t\t\t\tfor (let id in allValues) {\n\t\t\t\t\t\tif (allValues[id].toLowerCase().indexOf(searchValue) >= 0) {\n\t\t\t\t\t\t\treponseDataList.push({ label: allValues[id], value: id, id: id });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (reponseDataList.length <= 0) {\n\t\t\t\t\t\t$(inputElement).val('');\n\t\t\t\t\t\treponseDataList.push({\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\t\t\ttype: 'no results'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tresponse(reponseDataList);\n\t\t\t\t},\n\t\t\t\tselect: function(event, ui) {\n\t\t\t\t\tvar selectedItemData = ui.item;\n\t\t\t\t\t//To stop selection if no results is selected\n\t\t\t\t\tif (typeof selectedItemData.type !== 'undefined' && selectedItemData.type == 'no results') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tselectedItemData.name = selectedItemData.value;\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\tvar parentElem = element.closest('.fieldValue');\n\t\t\t\t\tvar sourceField = parentElem.find('input[class=\"sourceField\"]');\n\t\t\t\t\tvar sourceFieldDisplay = sourceField.attr('name') + '_display';\n\t\t\t\t\tvar fieldDisplayElement = $('input[name=\"' + sourceFieldDisplay + '\"]', parentElem);\n\t\t\t\t\tsourceField.val(selectedItemData.id);\n\t\t\t\t\tthis.value = selectedItemData.label;\n\t\t\t\t\tfieldDisplayElement.attr('readonly', true);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tchange: function(event, ui) {},\n\t\t\t\topen: function(event, ui) {\n\t\t\t\t\t//To Make the menu come up in the case of quick create\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.data('ui-autocomplete')\n\t\t\t\t\t\t.menu.element.css('z-index', '100001');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\treferenceModulePopupRegisterEvent: function(container) {\n\t\t\tcontainer.on('click', '.relatedPopup', e => {\n\t\t\t\tthis.showRecordsList(e);\n\t\t\t});\n\t\t\tlet moduleList = container.find('.referenceModulesList');\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('.referenceModulesList:visible'));\n\t\t\tmoduleList.on('change', e => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tlet parentElem = element.closest('.fieldValue');\n\t\t\t\tlet popupReferenceModule = element.val();\n\t\t\t\tlet referenceModuleElement = $('input[name=\"popupReferenceModule\"]', parentElem);\n\t\t\t\tlet prevSelectedReferenceModule = referenceModuleElement.val();\n\t\t\t\treferenceModuleElement.val(popupReferenceModule);\n\t\t\t\t//If Reference module is changed then we should clear the previous value\n\t\t\t\tif (prevSelectedReferenceModule != popupReferenceModule) {\n\t\t\t\t\tparentElem.find('.clearReferenceSelection').trigger('click');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetReferencedModuleName: function(parenElement) {\n\t\t\treturn $('input[name=\"popupReferenceModule\"]', parenElement).val();\n\t\t},\n\t\tsearchModuleNames: function(params) {\n\t\t\tvar aDeferred = $.Deferred();\n\n\t\t\tif (typeof params.module === 'undefined') {\n\t\t\t\tparams.module = app.getModuleName();\n\t\t\t}\n\n\t\t\tif (typeof params.action === 'undefined') {\n\t\t\t\tparams.action = 'BasicAjax';\n\t\t\t}\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(error) {\n\t\t\t\t\taDeferred.reject();\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to get reference search params\n\t\t */\n\t\tgetReferenceSearchParams: function(element) {\n\t\t\tvar tdElement = $(element).closest('.fieldValue');\n\t\t\tvar params = {};\n\t\t\tvar searchModule = this.getReferencedModuleName(tdElement);\n\t\t\tparams.search_module = searchModule;\n\t\t\treturn params;\n\t\t},\n\t\t/**\n\t\t * Function which will handle the reference auto complete event registrations\n\t\t * @params - container <jQuery> - element in which auto complete fields needs to be searched\n\t\t */\n\t\tregisterAutoCompleteFields: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.find('input.autoComplete').autocomplete({\n\t\t\t\tdelay: '600',\n\t\t\t\tminLength: '3',\n\t\t\t\tsource: function(request, response) {\n\t\t\t\t\t//element will be array of dom elements\n\t\t\t\t\t//here this refers to auto complete instance\n\t\t\t\t\tvar inputElement = $(this.element[0]);\n\t\t\t\t\tvar searchValue = request.term;\n\t\t\t\t\tvar params = thisInstance.getReferenceSearchParams(inputElement);\n\t\t\t\t\tparams.search_value = searchValue;\n\t\t\t\t\t//params.parent_id = app.getRecordId();\n\t\t\t\t\t//params.parent_module = app.getModuleName();\n\t\t\t\t\tthisInstance.searchModuleNames(params).done(function(data) {\n\t\t\t\t\t\tvar reponseDataList = [];\n\t\t\t\t\t\tvar serverDataFormat = data.result;\n\t\t\t\t\t\tif (serverDataFormat.length <= 0) {\n\t\t\t\t\t\t\t$(inputElement).val('');\n\t\t\t\t\t\t\tserverDataFormat = new Array({\n\t\t\t\t\t\t\t\tlabel: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\t\t\t\ttype: 'no results'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var id in serverDataFormat) {\n\t\t\t\t\t\t\tvar responseData = serverDataFormat[id];\n\t\t\t\t\t\t\treponseDataList.push(responseData);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresponse(reponseDataList);\n\t\t\t\t\t\tapp.event.trigger('EditView.AfterSearch', {\n\t\t\t\t\t\t\tfield: inputElement,\n\t\t\t\t\t\t\tparams: params\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tselect: function(event, ui) {\n\t\t\t\t\tvar selectedItemData = ui.item;\n\t\t\t\t\t//To stop selection if no results is selected\n\t\t\t\t\tif (typeof selectedItemData.type !== 'undefined' && selectedItemData.type == 'no results') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tselectedItemData.name = selectedItemData.value;\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\tvar tdElement = element.closest('.fieldValue');\n\t\t\t\t\tthisInstance.setReferenceFieldValue(tdElement, selectedItemData);\n\t\t\t\t},\n\t\t\t\tchange: function(event, ui) {\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\t//if you dont have readonly attribute means the user didnt select the item\n\t\t\t\t\tif (element.attr('readonly') == undefined) {\n\t\t\t\t\t\telement\n\t\t\t\t\t\t\t.closest('.fieldValue')\n\t\t\t\t\t\t\t.find('.clearReferenceSelection')\n\t\t\t\t\t\t\t.trigger('click');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\topen: function(event, ui) {\n\t\t\t\t\t//To Make the menu come up in the case of quick create\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.data('ui-autocomplete')\n\t\t\t\t\t\t.menu.element.css('z-index', '100001');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will register reference field clear event\n\t\t * @params - container <jQuery> - element in which auto complete fields needs to be searched\n\t\t */\n\t\tregisterClearReferenceSelectionEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '.clearReferenceSelection', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tthisInstance.clearFieldValue(element);\n\t\t\t\telement\n\t\t\t\t\t.closest('.fieldValue')\n\t\t\t\t\t.find('.sourceField')\n\t\t\t\t\t.trigger(Vtiger_Edit_Js.referenceDeSelectionEvent);\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t},\n\t\tclearFieldValue: function(element) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar fieldValueContener = element.closest('.fieldValue');\n\t\t\tvar fieldNameElement = fieldValueContener.find('.sourceField');\n\t\t\tvar fieldName = fieldNameElement.attr('name');\n\t\t\tvar referenceModule = fieldValueContener.find('input[name=\"popupReferenceModule\"]').val();\n\t\t\tvar formElement = fieldValueContener.closest('form');\n\n\t\t\tfieldNameElement.val('');\n\t\t\tfieldValueContener\n\t\t\t\t.find('#' + fieldName + '_display')\n\t\t\t\t.removeAttr('readonly')\n\t\t\t\t.val('');\n\t\t\tapp.event.trigger('EditView.ClearField', { fieldName: fieldName, referenceModule: referenceModule });\n\t\t\tvar mappingRelatedField = this.getMappingRelatedField(fieldName, referenceModule, formElement);\n\t\t\t$.each(mappingRelatedField, function(key, value) {\n\t\t\t\tvar mapFieldElement = formElement.find('[name=\"' + key + '\"]');\n\t\t\t\tif (mapFieldElement.is('select')) {\n\t\t\t\t\tmapFieldElement.val(mapFieldElement.find('option:first').val()).trigger('change');\n\t\t\t\t} else {\n\t\t\t\t\tmapFieldElement.val('');\n\t\t\t\t}\n\t\t\t\tvar mapFieldDisplayElement = formElement.find('input[name=\"' + key + '_display\"]');\n\t\t\t\tif (mapFieldDisplayElement.length > 0) {\n\t\t\t\t\tmapFieldDisplayElement.val('').attr('readonly', false);\n\t\t\t\t\tvar referenceModulesList = formElement.find(\n\t\t\t\t\t\t'#' + thisInstance.moduleName + '_editView_fieldName_' + key + '_dropDown'\n\t\t\t\t\t);\n\t\t\t\t\tif (referenceModulesList.length > 0 && value[1]) {\n\t\t\t\t\t\treferenceModulesList.val(referenceModulesList.find('option:first').val()).trigger('change');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will register event to prevent form submission on pressing on enter\n\t\t * @params - container <jQuery> - element in which auto complete fields needs to be searched\n\t\t */\n\t\tregisterPreventingEnterSubmitEvent: function(container) {\n\t\t\tcontainer.on('keypress', function(e) {\n\t\t\t\t//Stop the submit when enter is pressed in the form\n\t\t\t\tvar currentElement = $(e.target);\n\t\t\t\tif (e.which == 13 && !currentElement.is('textarea')) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterTimeFields: function(container) {\n\t\t\tapp.registerEventForClockPicker();\n\t\t\tApp.Fields.Date.register(container);\n\t\t\tApp.Fields.DateTime.register(container);\n\t\t},\n\t\treferenceCreateHandler: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar postQuickCreateSave = function(data) {\n\t\t\t\tthisInstance.setReferenceFieldValue(container, {\n\t\t\t\t\tname: data.result._recordLabel,\n\t\t\t\t\tid: data.result._recordId\n\t\t\t\t});\n\t\t\t};\n\t\t\tvar params = { callbackFunction: postQuickCreateSave };\n\t\t\tif (app.getViewName() === 'Edit' && !app.getRecordId()) {\n\t\t\t\tvar formElement = this.getForm();\n\t\t\t\tvar formData = formElement.serializeFormData();\n\t\t\t\tfor (var i in formData) {\n\t\t\t\t\tif (!formData[i] || $.inArray(i, ['_csrf', 'action']) != -1) {\n\t\t\t\t\t\tdelete formData[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparams.data = {};\n\t\t\t\tparams.data.sourceRecordData = formData;\n\t\t\t}\n\t\t\tvar referenceModuleName = this.getReferencedModuleName(container);\n\t\t\tVtiger_Header_Js.getInstance().quickCreateModule(referenceModuleName, params);\n\t\t},\n\t\t/**\n\t\t * Function which will register event for create of reference record\n\t\t * This will allow users to create reference record from edit view of other record\n\t\t */\n\t\tregisterReferenceCreate: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '.createReferenceRecord', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar controlElementDiv = element.closest('.fieldValue');\n\t\t\t\tthisInstance.referenceCreateHandler(controlElementDiv);\n\t\t\t});\n\t\t},\n\t\taddressFieldsMapping: [\n\t\t\t'buildingnumber',\n\t\t\t'localnumber',\n\t\t\t'addresslevel1',\n\t\t\t'addresslevel2',\n\t\t\t'addresslevel3',\n\t\t\t'addresslevel4',\n\t\t\t'addresslevel5',\n\t\t\t'addresslevel6',\n\t\t\t'addresslevel7',\n\t\t\t'addresslevel8',\n\t\t\t'pobox'\n\t\t],\n\t\taddressFieldsMappingBlockID: {\n\t\t\tLBL_ADDRESS_INFORMATION: 'a',\n\t\t\tLBL_ADDRESS_MAILING_INFORMATION: 'b',\n\t\t\tLBL_ADDRESS_DELIVERY_INFORMATION: 'c'\n\t\t},\n\t\taddressFieldsData: false,\n\t\t/**\n\t\t * Function to register event for copying addresses\n\t\t */\n\t\tregisterEventForCopyAddress: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar account_id = false;\n\t\t\tvar contact_id = false;\n\t\t\tvar lead_id = false;\n\t\t\tvar vendor_id = false;\n\t\t\t$(\n\t\t\t\t'#EditView .js-toggle-panel:not(.inventoryHeader):not(.inventoryItems) .fieldValue, #EditView .js-toggle-panel:not(.inventoryHeader):not(.inventoryItems) .fieldLabel'\n\t\t\t).each(function(index) {\n\t\t\t\tvar block = $(this);\n\t\t\t\tvar referenceModulesList = false;\n\t\t\t\tvar relatedField = block.find('[name=\"popupReferenceModule\"]').val();\n\t\t\t\tif (relatedField == 'Accounts') {\n\t\t\t\t\taccount_id = block.find('.sourceField').attr('name');\n\t\t\t\t}\n\t\t\t\tif (relatedField == 'Contacts') {\n\t\t\t\t\tcontact_id = block.find('.sourceField').attr('name');\n\t\t\t\t}\n\t\t\t\tif (relatedField == 'Leads') {\n\t\t\t\t\tlead_id = block.find('.sourceField').attr('name');\n\t\t\t\t}\n\t\t\t\tif (relatedField == 'Vendors') {\n\t\t\t\t\tvendor_id = block.find('.sourceField').attr('name');\n\t\t\t\t}\n\t\t\t\treferenceModulesList = block.find('.referenceModulesList');\n\t\t\t\tif (referenceModulesList.length > 0) {\n\t\t\t\t\t$.each(referenceModulesList.find('option'), function(key, data) {\n\t\t\t\t\t\tif (data.value == 'Accounts') {\n\t\t\t\t\t\t\taccount_id = block.find('.sourceField').attr('name');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.value == 'Contacts') {\n\t\t\t\t\t\t\tcontact_id = block.find('.sourceField').attr('name');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.value == 'Leads') {\n\t\t\t\t\t\t\tlead_id = block.find('.sourceField').attr('name');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.value == 'Vendors') {\n\t\t\t\t\t\t\tvendor_id = block.find('.sourceField').attr('name');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (account_id == false) {\n\t\t\t\t$('.copyAddressFromAccount').addClass('d-none');\n\t\t\t} else {\n\t\t\t\t$('.copyAddressFromAccount').on('click', function(e) {\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\t\tvar from = element.data('label');\n\t\t\t\t\tvar to = block.data('label');\n\t\t\t\t\tvar recordRelativeAccountId = $('[name=\"' + account_id + '\"]').val();\n\n\t\t\t\t\tif (recordRelativeAccountId == '' || recordRelativeAccountId == '0') {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_PLEASE_SELECT_AN_ACCOUNT_TO_COPY_ADDRESS'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar recordRelativeAccountName = $('#' + account_id + '_display').val();\n\t\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\trecord: recordRelativeAccountId,\n\t\t\t\t\t\t\tselectedName: recordRelativeAccountName,\n\t\t\t\t\t\t\tmodule: 'Accounts'\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthisInstance.copyAddressDetails(from, to, data, element.closest('.js-toggle-panel'));\n\t\t\t\t\t\telement.attr('checked', 'checked');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (contact_id == false) {\n\t\t\t\t$('.copyAddressFromContact').addClass('d-none');\n\t\t\t} else {\n\t\t\t\t$('.copyAddressFromContact').on('click', function(e) {\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\t\tvar from = element.data('label');\n\t\t\t\t\tvar to = block.data('label');\n\t\t\t\t\tvar recordRelativeAccountId = $('[name=\"' + contact_id + '\"]').val();\n\t\t\t\t\tif (recordRelativeAccountId == '' || recordRelativeAccountId == '0') {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_PLEASE_SELECT_AN_CONTACT_TO_COPY_ADDRESS'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar recordRelativeAccountName = $('#' + contact_id + '_display').val();\n\t\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\trecord: recordRelativeAccountId,\n\t\t\t\t\t\t\tselectedName: recordRelativeAccountName,\n\t\t\t\t\t\t\tmodule: 'Contacts'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthisInstance.copyAddressDetails(from, to, data, element.closest('.js-toggle-panel'));\n\t\t\t\t\t\telement.attr('checked', 'checked');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (lead_id == false) {\n\t\t\t\t$('.copyAddressFromLead').addClass('d-none');\n\t\t\t} else {\n\t\t\t\t$('.copyAddressFromLead').on('click', function(e) {\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\t\tvar from = element.data('label');\n\t\t\t\t\tvar to = block.data('label');\n\t\t\t\t\tvar recordRelativeAccountId = $('[name=\"' + lead_id + '\"]').val();\n\t\t\t\t\tif (recordRelativeAccountId == '' || recordRelativeAccountId == '0') {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_PLEASE_SELECT_AN_LEAD_TO_COPY_ADDRESS'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar recordRelativeAccountName = $('#' + lead_id + '_display').val();\n\t\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\trecord: recordRelativeAccountId,\n\t\t\t\t\t\t\tselectedName: recordRelativeAccountName,\n\t\t\t\t\t\t\tmodule: 'Leads'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthisInstance.copyAddressDetails(from, to, data, element.closest('.js-toggle-panel'));\n\t\t\t\t\t\telement.attr('checked', 'checked');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (vendor_id == false) {\n\t\t\t\t$('.copyAddressFromVendor').addClass('d-none');\n\t\t\t} else {\n\t\t\t\t$('.copyAddressFromVendor').on('click', function(e) {\n\t\t\t\t\tvar element = $(this);\n\t\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\t\tvar from = element.data('label');\n\t\t\t\t\tvar to = block.data('label');\n\t\t\t\t\tvar recordRelativeAccountId = $('[name=\"' + vendor_id + '\"]').val();\n\t\t\t\t\tif (recordRelativeAccountId == '' || recordRelativeAccountId == '0') {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_PLEASE_SELECT_AN_VENDOR_TO_COPY_ADDRESS'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar recordRelativeAccountName = $('#' + vendor_id + '_display').val();\n\t\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\trecord: recordRelativeAccountId,\n\t\t\t\t\t\t\tselectedName: recordRelativeAccountName,\n\t\t\t\t\t\t\tmodule: 'Vendors'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthisInstance.copyAddressDetails(from, to, data, element.closest('.js-toggle-panel'));\n\t\t\t\t\t\telement.attr('checked', 'checked');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t$('#EditView .js-toggle-panel').each(function(index) {\n\t\t\t\tvar hideCopyAddressLabel = true;\n\t\t\t\t$(this)\n\t\t\t\t\t.find('.adressAction button')\n\t\t\t\t\t.each(function(index) {\n\t\t\t\t\t\tif ($(this).hasClass('d-none') == false) {\n\t\t\t\t\t\t\thideCopyAddressLabel = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tif (hideCopyAddressLabel) {\n\t\t\t\t\t$(this)\n\t\t\t\t\t\t.find('.copyAddressLabel')\n\t\t\t\t\t\t.addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t\t$('.copyAddressFromMain').on('click', function(e) {\n\t\t\t\tvar element = $(this);\n\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\tvar from = element.data('label');\n\t\t\t\tvar to = block.data('label');\n\t\t\t\tthisInstance.copyAddress(from, to, false, false);\n\t\t\t});\n\t\t\t$('.copyAddressFromMailing').on('click', function(e) {\n\t\t\t\tvar element = $(this);\n\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\tvar from = element.data('label');\n\t\t\t\tvar to = block.data('label');\n\t\t\t\tthisInstance.copyAddress(from, to, false, false);\n\t\t\t});\n\t\t\t$('.copyAddressFromDelivery').on('click', function(e) {\n\t\t\t\tvar element = $(this);\n\t\t\t\tvar block = element.closest('.js-toggle-panel');\n\t\t\t\tvar from = element.data('label');\n\t\t\t\tvar to = block.data('label');\n\t\t\t\tthisInstance.copyAddress(from, to, false, false);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will copy the address details\n\t\t */\n\t\tcopyAddressDetails: function(from, to, data, container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar sourceModule = data.module;\n\t\t\tapp.getRecordDetails(data).done(function(data) {\n\t\t\t\tvar response = data['result'];\n\t\t\t\tthisInstance.addressFieldsData = response;\n\t\t\t\tthisInstance.copyAddress(from, to, true, sourceModule);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to copy address between fields\n\t\t * @param strings which accepts value as either odd or even\n\t\t */\n\t\tcopyAddress: function(fromLabel, toLabel, relatedRecord, sourceModule) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet formElement = this.getForm(),\n\t\t\t\tstatus = false,\n\t\t\t\taddressMapping = this.addressFieldsMapping,\n\t\t\t\tBlockIds = this.addressFieldsMappingBlockID,\n\t\t\t\tfrom = BlockIds[fromLabel];\n\t\t\tif (relatedRecord === false || sourceModule === false) from = BlockIds[fromLabel];\n\t\t\tlet to = BlockIds[toLabel],\n\t\t\t\tkey,\n\t\t\t\tfromElement,\n\t\t\t\tfromElementLabel,\n\t\t\t\tnameElementFrom,\n\t\t\t\tnameElementTo;\n\t\t\tfor (key in addressMapping) {\n\t\t\t\tnameElementFrom = addressMapping[key] + from;\n\t\t\t\tnameElementTo = addressMapping[key] + to;\n\t\t\t\tif (relatedRecord) {\n\t\t\t\t\tfromElement = thisInstance.addressFieldsData['data'][nameElementFrom];\n\t\t\t\t\tfromElementLabel = thisInstance.addressFieldsData['displayData'][nameElementFrom];\n\t\t\t\t} else {\n\t\t\t\t\tfromElement = formElement.find('[name=\"' + nameElementFrom + '\"]').val();\n\t\t\t\t\tfromElementLabel = formElement.find('[name=\"' + nameElementFrom + '_display\"]').val();\n\t\t\t\t}\n\t\t\t\tlet toElement = formElement.find('[name=\"' + nameElementTo + '\"]'),\n\t\t\t\t\ttoElementLable = formElement.find('[name=\"' + nameElementTo + '_display\"]');\n\t\t\t\tif (fromElement !== '' && fromElement !== '0' && fromElement !== undefined) {\n\t\t\t\t\tif (toElementLable.length > 0) toElementLable.attr('readonly', true);\n\t\t\t\t\tstatus = true;\n\t\t\t\t\ttoElement.val(fromElement);\n\t\t\t\t\ttoElementLable.val(fromElementLabel);\n\t\t\t\t\tif (toElement.is('[data-select2-id]')) {\n\t\t\t\t\t\tif (toElement.val() !== fromElement) {\n\t\t\t\t\t\t\ttoElement.val('');\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttoElement.trigger('change');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttoElement.attr('readonly', false);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (status === false) {\n\t\t\t\tlet errorMsg;\n\t\t\t\tif (sourceModule === 'Accounts') {\n\t\t\t\t\terrorMsg = 'JS_SELECTED_ACCOUNT_DOES_NOT_HAVE_AN_ADDRESS';\n\t\t\t\t} else if (sourceModule === 'Contacts') {\n\t\t\t\t\terrorMsg = 'JS_SELECTED_CONTACT_DOES_NOT_HAVE_AN_ADDRESS';\n\t\t\t\t} else {\n\t\t\t\t\terrorMsg = 'JS_DOES_NOT_HAVE_AN_ADDRESS';\n\t\t\t\t}\n\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate(errorMsg));\n\t\t\t}\n\t\t},\n\t\tregisterReferenceSelectionEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar relategField = container.find(\"input[name*='addresslevel']\");\n\t\t\trelategField.on(Vtiger_Edit_Js.referenceSelectionEvent, function(e, data) {\n\t\t\t\tvar blockContainer = $(e.currentTarget).closest('.js-toggle-panel');\n\t\t\t\tthisInstance.copyAddressDetailsRef(data, blockContainer);\n\t\t\t});\n\t\t},\n\t\tcopyAddressDetailsRef: function(data, container) {\n\t\t\tvar thisInstance = this;\n\t\t\tapp.getRecordDetails(data)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tvar response = data['result'];\n\t\t\t\t\tthisInstance.mapAddressDetails(response, container);\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {});\n\t\t},\n\t\tmapAddressDetails: function(result, container) {\n\t\t\tfor (var key in result) {\n\t\t\t\tif (key.indexOf('addresslevel') != -1) {\n\t\t\t\t\tif (container.find('[name=\"' + key + '\"]').length != 0) {\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + '\"]').val(result['data'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + '\"]').attr('readonly', true);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + '_display\"]').val(result['displayData'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + '_display\"]').attr('readonly', true);\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'a\"]').length != 0 &&\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'a\"]').val() == 0 &&\n\t\t\t\t\t\tresult['data'][key] != 0\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'a\"]').val(result['data'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'a\"]').attr('readonly', true);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'a_display\"]').val(result['displayData'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'a_display\"]').attr('readonly', true);\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'b\"]').length != 0 &&\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'b\"]').val() == 0 &&\n\t\t\t\t\t\tresult['data'][key] != 0\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'b\"]').val(result['data'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'b\"]').attr('readonly', true);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'b_display\"]').val(result['displayData'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'b_display\"]').attr('readonly', true);\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'c\"]').length != 0 &&\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'c\"]').val() == 0 &&\n\t\t\t\t\t\tresult['data'][key] != 0\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'c\"]').val(result['data'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'c\"]').attr('readonly', true);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'c_display\"]').val(result['displayData'][key]);\n\t\t\t\t\t\tcontainer.find('[name=\"' + key + 'c_display\"]').attr('readonly', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tregisterMaskFields: function(container) {\n\t\t\tcontainer.find('[data-inputmask]').inputmask();\n\t\t},\n\t\ttriggerDisplayTypeEvent: function() {\n\t\t\tvar widthType = app.cacheGet('widthType', 'narrowWidthType');\n\t\t\tif (widthType) {\n\t\t\t\tvar elements = $('#EditView').find('.fieldValue,.fieldLabel');\n\t\t\t\telements.addClass(widthType);\n\t\t\t}\n\t\t},\n\t\tregisterSubmitEvent: function() {\n\t\t\tvar editViewForm = this.getForm();\n\t\t\teditViewForm.on('submit', function(e) {\n\t\t\t\t//Form should submit only once for multiple clicks also\n\t\t\t\tif (typeof editViewForm.data('submit') !== 'undefined') {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\tdocument.progressLoader = $.progressIndicator({\n\t\t\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditViewForm\n\t\t\t\t\t\t.find('.js-toggle-panel')\n\t\t\t\t\t\t.find('.js-block-content')\n\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\tif (editViewForm.validationEngine('validate')) {\n\t\t\t\t\t\t//Once the form is submiting add data attribute to that form element\n\t\t\t\t\t\teditViewForm.data('submit', 'true');\n\t\t\t\t\t\t//on submit form trigger the recordPreSave event\n\t\t\t\t\t\tvar recordPreSaveEvent = $.Event(Vtiger_Edit_Js.recordPreSave);\n\t\t\t\t\t\teditViewForm.trigger(recordPreSaveEvent, { value: 'edit' });\n\t\t\t\t\t\tif (recordPreSaveEvent.isDefaultPrevented()) {\n\t\t\t\t\t\t\t//If duplicate record validation fails, form should submit again\n\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\teditViewForm.removeData('submit');\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//If validation fails, form should submit again\n\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\teditViewForm.removeData('submit');\n\t\t\t\t\t\tapp.formAlignmentAfterValidation(editViewForm);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t * Function to check the view permission of a record after save\n\t\t */\n\t\tregisterRecordPreSaveEventEvent: function(form) {\n\t\t\tform.on(Vtiger_Edit_Js.recordPreSave, function(e, data) {});\n\t\t},\n\t\t/**\n\t\t * Function to register event for setting up picklistdependency\n\t\t * for a module if exist on change of picklist value\n\t\t */\n\t\tregisterEventForPicklistDependencySetup: function(container) {\n\t\t\tlet picklistDependcyElemnt = $('[name=\"picklistDependency\"]', container);\n\t\t\tif (picklistDependcyElemnt.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet picklistDependencyMapping = JSON.parse(picklistDependcyElemnt.val());\n\n\t\t\tlet sourcePicklists = Object.keys(picklistDependencyMapping);\n\t\t\tif (sourcePicklists.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet sourcePickListNames = [],\n\t\t\t\ti;\n\t\t\tfor (i = 0; i < sourcePicklists.length; i++) {\n\t\t\t\tsourcePickListNames.push('[name=\"' + sourcePicklists[i] + '\"]');\n\t\t\t}\n\t\t\tsourcePickListNames = sourcePickListNames.join(',');\n\t\t\tlet sourcePickListElements = container.find(sourcePickListNames);\n\n\t\t\tsourcePickListElements.on('change', function(e) {\n\t\t\t\tlet currentElement = $(e.currentTarget),\n\t\t\t\t\tconfiguredDependencyObject = picklistDependencyMapping[currentElement.attr('name')],\n\t\t\t\t\ttargetObjectForSelectedSourceValue = configuredDependencyObject[currentElement.val()],\n\t\t\t\t\tpicklistmap = configuredDependencyObject['__DEFAULT__'];\n\n\t\t\t\tif (typeof targetObjectForSelectedSourceValue === 'undefined') {\n\t\t\t\t\ttargetObjectForSelectedSourceValue = picklistmap;\n\t\t\t\t}\n\t\t\t\t$.each(picklistmap, function(targetPickListName, targetPickListValues) {\n\t\t\t\t\tlet targetPickListMap = targetObjectForSelectedSourceValue[targetPickListName];\n\t\t\t\t\tif (typeof targetPickListMap === 'undefined') {\n\t\t\t\t\t\ttargetPickListMap = targetPickListValues;\n\t\t\t\t\t}\n\t\t\t\t\tlet targetPickList = $('[name=\"' + targetPickListName + '\"]', container);\n\t\t\t\t\tif (targetPickList.length <= 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet listOfAvailableOptions = targetPickList.data('availableOptions');\n\t\t\t\t\tif (typeof listOfAvailableOptions === 'undefined') {\n\t\t\t\t\t\tlistOfAvailableOptions = $('option', targetPickList);\n\t\t\t\t\t\ttargetPickList.data('available-options', listOfAvailableOptions);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet targetOptions = new $(),\n\t\t\t\t\t\toptionSelector = [];\n\t\t\t\t\toptionSelector.push('');\n\t\t\t\t\tfor (i = 0; i < targetPickListMap.length; i++) {\n\t\t\t\t\t\toptionSelector.push(targetPickListMap[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(listOfAvailableOptions, function(i, e) {\n\t\t\t\t\t\tif ($.inArray($(e).val(), optionSelector) !== -1) {\n\t\t\t\t\t\t\ttargetOptions = targetOptions.add($(e));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\ttargetPickList\n\t\t\t\t\t\t.html(targetOptions)\n\t\t\t\t\t\t.val(targetOptions.filter('[selected]').val())\n\t\t\t\t\t\t.trigger('change');\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t//To Trigger the change on load\n\t\t\tsourcePickListElements.trigger('change');\n\t\t},\n\t\tregisterLeavePageWithoutSubmit: function(form) {\n\t\t\tif (\n\t\t\t\ttypeof CKEDITOR !== 'undefined' &&\n\t\t\t\ttypeof CKEDITOR.instances !== 'undefined' &&\n\t\t\t\tObject.keys(CKEDITOR.instances).length\n\t\t\t) {\n\t\t\t\tCKEDITOR.on('instanceReady', function(e) {\n\t\t\t\t\tlet initialFormData = form.serialize();\n\t\t\t\t\twindow.onbeforeunload = function(e) {\n\t\t\t\t\t\tif (initialFormData != form.serialize() && form.data('submit') != 'true') {\n\t\t\t\t\t\t\treturn app.vtranslate('JS_CHANGES_WILL_BE_LOST');\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet initialFormData = form.serialize();\n\t\t\t\twindow.onbeforeunload = function(e) {\n\t\t\t\t\tif (initialFormData != form.serialize() && form.data('submit') != 'true') {\n\t\t\t\t\t\treturn app.vtranslate('JS_CHANGES_WILL_BE_LOST');\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tstretchCKEditor: function() {\n\t\t\tvar row = $('.js-editor').parents('.fieldRow');\n\t\t\tvar td = $('.js-editor').parent();\n\t\t\t$(row)\n\t\t\t\t.find('.fieldLabel')\n\t\t\t\t.remove();\n\t\t\t$(td).removeClass('col-md-10');\n\t\t\t$(td).addClass('col-md-12');\n\t\t},\n\t\t/**\n\t\t * Function to register event for ckeditor for description field\n\t\t */\n\t\tregisterEventForEditor: function() {\n\t\t\tvar form = this.getForm();\n\t\t\tvar thisInstance = this;\n\t\t\t$.each(form.find('.js-editor'), function(key, data) {\n\t\t\t\tthisInstance.loadEditorElement($(data));\n\t\t\t});\n\t\t},\n\t\tloadEditorElement: function(noteContentElement) {\n\t\t\tvar customConfig = {};\n\t\t\tif (noteContentElement.hasClass('js-editor--basic')) {\n\t\t\t\tcustomConfig.toolbar = 'Min';\n\t\t\t}\n\t\t\tif (noteContentElement.data('height')) {\n\t\t\t\tcustomConfig.height = noteContentElement.data('height');\n\t\t\t}\n\t\t\tnew App.Fields.Text.Editor(noteContentElement, customConfig);\n\t\t},\n\t\tregisterHelpInfo: function() {\n\t\t\tvar form = this.getForm();\n\t\t\tapp.showPopoverElementView(form.find('.js-help-info'));\n\t\t},\n\t\tregisterBlockAnimationEvent: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar detailContentsHolder = this.getForm();\n\t\t\tdetailContentsHolder.on('click', '.blockHeader', function(e) {\n\t\t\t\tconst target = $(e.target);\n\t\t\t\tif (\n\t\t\t\t\ttarget.is('input') ||\n\t\t\t\t\ttarget.is('button') ||\n\t\t\t\t\ttarget.parents().is('button') ||\n\t\t\t\t\ttarget.hasClass('js-stop-propagation') ||\n\t\t\t\t\ttarget.parents().hasClass('js-stop-propagation')\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar currentTarget = $(e.currentTarget)\n\t\t\t\t\t.find('.js-block-toggle')\n\t\t\t\t\t.not('.d-none');\n\t\t\t\tvar blockId = currentTarget.data('id');\n\t\t\t\tvar closestBlock = currentTarget.closest('.js-toggle-panel');\n\t\t\t\tvar bodyContents = closestBlock.find('.blockContent');\n\t\t\t\tvar data = currentTarget.data();\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tvar hideHandler = function() {\n\t\t\t\t\tbodyContents.addClass('d-none');\n\t\t\t\t\tapp.cacheSet(module + '.' + blockId, 0);\n\t\t\t\t};\n\t\t\t\tvar showHandler = function() {\n\t\t\t\t\tbodyContents.removeClass('d-none');\n\t\t\t\t\tapp.cacheSet(module + '.' + blockId, 1);\n\t\t\t\t};\n\t\t\t\tif (data.mode == 'show') {\n\t\t\t\t\thideHandler();\n\t\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\t\tclosestBlock.find('[data-mode=\"hide\"]').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tshowHandler();\n\t\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\t\tclosestBlock.find(\"[data-mode='show']\").removeClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterBlockStatusCheckOnLoad: function() {\n\t\t\tlet blocks = this.getForm().find('.js-toggle-panel');\n\t\t\tlet module = app.getModuleName();\n\t\t\tblocks.each(function(index, block) {\n\t\t\t\tlet currentBlock = $(block);\n\t\t\t\tlet dynamicAttr = currentBlock.attr('data-dynamic');\n\t\t\t\tif (typeof dynamicAttr !== typeof undefined && dynamicAttr !== false) {\n\t\t\t\t\tlet headerAnimationElement = currentBlock.find('.js-block-toggle').not('.d-none');\n\t\t\t\t\tlet bodyContents = currentBlock.find('.blockContent');\n\t\t\t\t\tlet blockId = headerAnimationElement.data('id');\n\t\t\t\t\tlet cacheKey = module + '.' + blockId;\n\t\t\t\t\tlet value = app.cacheGet(cacheKey, null);\n\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\tif (value == 1) {\n\t\t\t\t\t\t\theaderAnimationElement.addClass('d-none');\n\t\t\t\t\t\t\tcurrentBlock.find(\"[data-mode='show']\").removeClass('d-none');\n\t\t\t\t\t\t\tbodyContents.removeClass('d-none');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\theaderAnimationElement.addClass('d-none');\n\t\t\t\t\t\t\tcurrentBlock.find(\"[data-mode='hide']\").removeClass('d-none');\n\t\t\t\t\t\t\tbodyContents.addClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterAutoloadAddress: function() {\n\t\t\tthis.getForm()\n\t\t\t\t.find('.js-search-address')\n\t\t\t\t.each(function(index, item) {\n\t\t\t\t\tlet search = $(item);\n\t\t\t\t\tlet container = search.closest('.js-block-content');\n\t\t\t\t\tlet input = search.find('.js-autoload-address');\n\t\t\t\t\tinput.autocomplete({\n\t\t\t\t\t\tsource: function(request, response) {\n\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\t\taction: 'Fields',\n\t\t\t\t\t\t\t\tmode: 'findAddress',\n\t\t\t\t\t\t\t\ttype: search.find('.js-select-operator').val(),\n\t\t\t\t\t\t\t\tvalue: request.term\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(requestData) {\n\t\t\t\t\t\t\t\t\tif (requestData.result === false) {\n\t\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_ERROR'));\n\t\t\t\t\t\t\t\t\t} else if (requestData.result.length) {\n\t\t\t\t\t\t\t\t\t\tresponse(requestData.result);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tresponse([{ label: app.vtranslate('JS_NO_RESULTS_FOUND'), value: '' }]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function(textStatus, errorThrown, jqXHR) {\n\t\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\t\t\t\ttext: jqXHR.responseJSON.error.message,\n\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tresponse([{ label: app.vtranslate('JS_NO_RESULTS_FOUND'), value: '' }]);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tminLength: input.data('min'),\n\t\t\t\t\t\tselect: function(event, ui) {\n\t\t\t\t\t\t\t$.each(ui.item.address, function(index, value) {\n\t\t\t\t\t\t\t\tlet field = container.find('.fieldValue [name^=' + index + ']');\n\t\t\t\t\t\t\t\tif (field.length && value) {\n\t\t\t\t\t\t\t\t\tif (typeof value !== 'object') {\n\t\t\t\t\t\t\t\t\t\tvalue = [value];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t$.each(value, function(index, v) {\n\t\t\t\t\t\t\t\t\t\tlet select = false,\n\t\t\t\t\t\t\t\t\t\t\telement = false;\n\t\t\t\t\t\t\t\t\t\tif (field.prop('tagName') === 'SELECT') {\n\t\t\t\t\t\t\t\t\t\t\tif (typeof v === 'object') {\n\t\t\t\t\t\t\t\t\t\t\t\t$.each(v, function(index, x) {\n\t\t\t\t\t\t\t\t\t\t\t\t\telement = field.find('option[data-' + index + \"='\" + x + \"']\");\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (x && element.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect = element.val();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\telement = field.find('option:contains(' + v + ')');\n\t\t\t\t\t\t\t\t\t\t\t\tif (v && element.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tselect = element.val();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\telement = field.find('option[value=\"' + v + '\"]');\n\t\t\t\t\t\t\t\t\t\t\t\tif (v && element.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tselect = element.val();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tselect = v;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (select) {\n\t\t\t\t\t\t\t\t\t\t\tfield.val(select).change();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfield.val('').change();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tui.item.value = input.val();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\tsetEnabledFields: function(element) {\n\t\t\tvar fieldValue = element.closest('.fieldValue');\n\t\t\tvar fieldName = fieldValue.find('input.sourceField').attr('name');\n\t\t\tvar fieldDisplay = fieldValue.find('#' + fieldName + '_display');\n\t\t\tfieldValue.find('button').removeAttr('disabled');\n\t\t\tif (fieldDisplay.val() == '') {\n\t\t\t\tfieldValue.find('input').removeAttr('readonly');\n\t\t\t}\n\t\t\tfieldValue.find('.referenceModulesListGroup').removeClass('d-none');\n\t\t\tvar placeholder = fieldDisplay.attr('placeholderDisabled');\n\t\t\tfieldDisplay.removeAttr('placeholderDisabled');\n\t\t\tfieldDisplay.attr('placeholder', placeholder);\n\t\t\tfieldValue.find('.referenceModulesList').attr('required', 'required');\n\t\t},\n\t\tsetDisabledFields: function(element) {\n\t\t\tvar fieldValue = element.closest('.fieldValue');\n\t\t\tvar fieldName = fieldValue.find('input.sourceField').attr('name');\n\t\t\tvar fieldDisplay = fieldValue.find('#' + fieldName + '_display');\n\t\t\tfieldValue.find('input').attr('readonly', 'readonly');\n\t\t\tfieldValue.find('button').attr('disabled', 'disabled');\n\t\t\tfieldValue.find('.referenceModulesListGroup').addClass('d-none');\n\t\t\tvar placeholder = fieldDisplay.attr('placeholder');\n\t\t\tfieldDisplay.removeAttr('placeholder');\n\t\t\tfieldDisplay.attr('placeholderDisabled', placeholder);\n\t\t\tfieldValue.find('.referenceModulesList').removeAttr('required');\n\t\t},\n\t\tgetMappingRelatedField: function(sourceField, sourceFieldModule, container) {\n\t\t\tconst mappingRelatedField = container.find('input[name=\"mappingRelatedField\"]').val();\n\t\t\tconst mappingRelatedModule = mappingRelatedField ? JSON.parse(mappingRelatedField) : [];\n\t\t\tif (\n\t\t\t\ttypeof mappingRelatedModule[sourceField] !== 'undefined' &&\n\t\t\t\ttypeof mappingRelatedModule[sourceField][sourceFieldModule] !== 'undefined'\n\t\t\t) {\n\t\t\t\treturn mappingRelatedModule[sourceField][sourceFieldModule];\n\t\t\t}\n\t\t\treturn [];\n\t\t},\n\t\tregisterValidationsFields: function(container) {\n\t\t\tvar params = app.validationEngineOptionsForRecord;\n\t\t\tcontainer.validationEngine(params);\n\t\t},\n\t\tcheckReferencesField: function(container, clear) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar activeProcess = false,\n\t\t\t\tactiveSubProcess = false;\n\t\t\tif (!CONFIG.fieldsReferencesDependent) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcontainer.find('input[data-fieldtype=\"referenceLink\"]').each(function(index, element) {\n\t\t\t\telement = $(element);\n\t\t\t\tvar t = true;\n\t\t\t\tif (element.closest('.tab-pane').length > 0) {\n\t\t\t\t\tt = false;\n\t\t\t\t\tif (element.closest('.tab-pane.active').length > 0) {\n\t\t\t\t\t\tt = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar referenceLink = element.val();\n\t\t\t\tif (t && referenceLink != '' && referenceLink != '0') {\n\t\t\t\t\tactiveProcess = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontainer.find('input[data-fieldtype=\"referenceProcess\"]').each(function(index, element) {\n\t\t\t\telement = $(element);\n\t\t\t\tif (activeProcess) {\n\t\t\t\t\tthisInstance.setEnabledFields(element);\n\t\t\t\t} else {\n\t\t\t\t\tif (clear) {\n\t\t\t\t\t\tthisInstance.clearFieldValue(element);\n\t\t\t\t\t}\n\t\t\t\t\tthisInstance.setDisabledFields(element);\n\t\t\t\t}\n\n\t\t\t\tvar t = true;\n\t\t\t\tif (element.closest('.tab-pane').length > 0) {\n\t\t\t\t\tt = false;\n\t\t\t\t\tif (element.closest('.tab-pane.active').length > 0) {\n\t\t\t\t\t\tt = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar referenceLink = element.val();\n\t\t\t\tif (t && referenceLink != '' && referenceLink != '0') {\n\t\t\t\t\tactiveSubProcess = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontainer.find('input[data-fieldtype=\"referenceSubProcess\"]').each(function(index, element) {\n\t\t\t\telement = $(element);\n\t\t\t\tvar processfieldElement = element.closest('.fieldValue');\n\t\t\t\tvar length = processfieldElement.find('.referenceModulesList option[disabled!=\"disabled\"]').length;\n\t\t\t\tif (activeSubProcess && length > 0) {\n\t\t\t\t\tthisInstance.setEnabledFields(element);\n\t\t\t\t} else {\n\t\t\t\t\tif (clear) {\n\t\t\t\t\t\tthisInstance.clearFieldValue(element);\n\t\t\t\t\t}\n\t\t\t\t\tthisInstance.setDisabledFields(element);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcheckSubProcessModulesList: function(element) {\n\t\t\tvar option = element.find('option:selected');\n\t\t\tif (option.data('is-quickcreate') != 1) {\n\t\t\t\telement\n\t\t\t\t\t.closest('.fieldValue')\n\t\t\t\t\t.find('.createReferenceRecord')\n\t\t\t\t\t.addClass('d-none');\n\t\t\t} else {\n\t\t\t\telement\n\t\t\t\t\t.closest('.fieldValue')\n\t\t\t\t\t.find('.createReferenceRecord')\n\t\t\t\t\t.removeClass('d-none');\n\t\t\t}\n\t\t},\n\t\tcheckReferenceModulesList: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar processfieldElement = container.find('input[data-fieldtype=\"referenceProcess\"]').closest('.fieldValue');\n\t\t\tvar referenceProcess = processfieldElement.find('input[name=\"popupReferenceModule\"]').val();\n\t\t\tvar subProcessfieldElement = container\n\t\t\t\t.find('input[data-fieldtype=\"referenceSubProcess\"]')\n\t\t\t\t.closest('.fieldValue');\n\t\t\tVtiger_Helper_Js.hideOptions(\n\t\t\t\tsubProcessfieldElement.find('.referenceModulesList'),\n\t\t\t\t'parent',\n\t\t\t\treferenceProcess\n\t\t\t);\n\t\t\tvar subProcessValue = subProcessfieldElement.find('.referenceModulesList').val();\n\t\t\tsubProcessfieldElement.find('[name=\"popupReferenceModule\"]').val(subProcessValue);\n\t\t\tthisInstance.checkSubProcessModulesList(subProcessfieldElement.find('.referenceModulesList'));\n\t\t},\n\t\tregisterReferenceFields: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tif (!CONFIG.fieldsReferencesDependent) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthisInstance.checkReferenceModulesList(container);\n\t\t\tthisInstance.checkReferencesField(container, false);\n\t\t\tcontainer.find('.sourceField').on(Vtiger_Edit_Js.referenceSelectionEvent, function(e, data) {\n\t\t\t\tthisInstance.checkReferencesField(container, true);\n\t\t\t});\n\t\t\tcontainer.find('.sourceField').on(Vtiger_Edit_Js.referenceDeSelectionEvent, function(e) {\n\t\t\t\tthisInstance.checkReferencesField(container, true);\n\t\t\t});\n\t\t\tcontainer\n\t\t\t\t.find('input[data-fieldtype=\"referenceProcess\"]')\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('.referenceModulesList')\n\t\t\t\t.on('change', function() {\n\t\t\t\t\tthisInstance.checkReferenceModulesList(container);\n\t\t\t\t});\n\t\t\tcontainer\n\t\t\t\t.find('input[data-fieldtype=\"referenceSubProcess\"]')\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('.referenceModulesList')\n\t\t\t\t.on('change', function(e) {\n\t\t\t\t\tthisInstance.checkSubProcessModulesList($(e.currentTarget));\n\t\t\t\t});\n\t\t},\n\t\tregisterFocusFirstField: function(container, afterTimeout) {\n\t\t\tlet elementToFocus, elementToFocusTabindex;\n\t\t\tif (afterTimeout === undefined && container.closest('.js-modal-container').length) {\n\t\t\t\tsetTimeout(_ => {\n\t\t\t\t\tthis.registerFocusFirstField(container, true);\n\t\t\t\t}, 500);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcontainer\n\t\t\t\t.find(\n\t\t\t\t\t'.fieldValue input.form-control:not([type=hidden],.dateField,.clockPicker), .fieldValue input[type=checkbox], .select2-selection.form-control'\n\t\t\t\t)\n\t\t\t\t.each(function(i, e) {\n\t\t\t\t\tlet element = $(e);\n\t\t\t\t\tif (!element.prop('readonly') && !element.prop('disabled')) {\n\t\t\t\t\t\telement = element.get(0);\n\t\t\t\t\t\tif (element.type !== 'number' && element.type !== 'checkbox' && element.value !== undefined) {\n\t\t\t\t\t\t\tlet elemLen = element.value.length;\n\t\t\t\t\t\t\telement.selectionStart = elemLen;\n\t\t\t\t\t\t\telement.selectionEnd = elemLen;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (i === 0 || !elementToFocus) {\n\t\t\t\t\t\t\telementToFocus = element;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet tabindex = $(element).attr('tabindex');\n\t\t\t\t\t\tif (tabindex > 0 && elementToFocusTabindex === undefined) {\n\t\t\t\t\t\t\telementToFocusTabindex = tabindex;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tabindex > 0 && tabindex < elementToFocusTabindex) {\n\t\t\t\t\t\t\telementToFocusTabindex = tabindex;\n\t\t\t\t\t\t\telementToFocus = element;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\tif (elementToFocus) {\n\t\t\t\telementToFocus.focus();\n\t\t\t}\n\t\t},\n\t\tregisterCopyValue: function(container) {\n\t\t\tcontainer.find('.fieldValue [data-copy-to-field]').on('change', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tcontainer.find('[name=\"' + element.data('copyToField') + '\"]').val(element.val());\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register multi image upload fields\n\t\t * @param {HTMLElement|jQuery} container\n\t\t */\n\t\tregisterMultiImageFields(container) {\n\t\t\treturn App.Fields.MultiImage.register(container);\n\t\t},\n\t\t/**\n\t\t * Register inventory controller\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterInventoryController(container) {\n\t\t\tif (typeof Vtiger_Inventory_Js !== 'undefined') {\n\t\t\t\tthis.inventoryController = Vtiger_Inventory_Js.getInventoryInstance(container);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Function which will register basic events which will be used in quick create as well\n\t\t *\n\t\t */\n\t\tregisterBasicEvents: function(container) {\n\t\t\tthis.registerClearTreeSelectionEvent(container);\n\t\t\tthis.registerTreeAutoCompleteFields(container);\n\t\t\tthis.referenceModulePopupRegisterEvent(container);\n\t\t\tthis.registerAutoCompleteFields(container);\n\t\t\tthis.registerClearReferenceSelectionEvent(container);\n\t\t\tthis.registerPreventingEnterSubmitEvent(container);\n\t\t\tthis.registerTimeFields(container);\n\t\t\tthis.registerEventForPicklistDependencySetup(container);\n\t\t\tthis.registerRecordPreSaveEventEvent(container);\n\t\t\tthis.registerReferenceSelectionEvent(container);\n\t\t\tthis.registerMaskFields(container);\n\t\t\tthis.registerHelpInfo();\n\t\t\tthis.registerReferenceFields(container);\n\t\t\tthis.registerFocusFirstField(container);\n\t\t\tthis.registerCopyValue(container);\n\t\t\tthis.registerMultiImageFields(container);\n\t\t\tthis.registerReferenceCreate(container);\n\t\t\tApp.Fields.MultiEmail.register(container);\n\t\t\tApp.Fields.MultiDependField.register(container);\n\t\t\tApp.Fields.Tree.register(container);\n\t\t\tApp.Fields.MultiCurrency.register(container);\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\tvar editViewForm = this.getForm();\n\t\t\tif (!this.proceedRegisterEvents()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.registerInventoryController(editViewForm);\n\t\t\tthis.registerBlockAnimationEvent();\n\t\t\tthis.registerBlockStatusCheckOnLoad();\n\t\t\tthis.registerEventForEditor();\n\t\t\tthis.stretchCKEditor();\n\t\t\tthis.registerBasicEvents(editViewForm);\n\t\t\tthis.registerEventForCopyAddress();\n\t\t\tthis.registerSubmitEvent();\n\t\t\tthis.registerLeavePageWithoutSubmit(editViewForm);\n\t\t\tthis.registerValidationsFields(editViewForm);\n\t\t\tthis.registerAutoloadAddress();\n\t\t\teditViewForm.find('.js-form-submit-btn').prop('disabled', false);\n\t\t\t//this.triggerDisplayTypeEvent();\n\t\t}\n\t}\n);\n"],"names":["$","Class","moduleName","app","getModuleName","parentModule","getParentModuleName","moduleClassName","fallbackClassName","instance","window","Vtiger_Edit_Js","editInstance","getInstanceByModuleName","this","formElement","setForm","element","container","sourceModule","popupReferenceModule","val","sourceFieldElement","sourceField","attr","sourceRecordElement","sourceRecordId","length","isMultiple","data","filterFields","closest","mappingRelatedField","find","mappingRelatedModule","JSON","parse","undefined","each","index","value","mapFieldElement","params","fieldElement","multi_select","e","parentElem","target","getRecordsListParams","showRecordsList","modal","setSelectEvent","setReferenceFieldValue","thisInstance","sourceFieldDisplay","fieldDisplayElement","selectedName","name","id","trigger","decodeHTML","referenceSelectionEvent","validationEngine","getMappingRelatedField","getRecordDetails","done","response","event","key","getMappingValuesFromUrl","fieldinfo","mapFieldElementMultiselect","multipleAttr","splitValues","split","is","picklistvalues","hasOwnProperty","newOption","Option","append","appendTo","mapFieldDisplayElement","type","referenceModulesList","relationOperation","getRelationOperation","getUrlVar","on","clearFieldValue","currentTarget","preventDefault","autocomplete","request","inputElement","searchValue","term","toLowerCase","allValues","reponseDataList","indexOf","push","label","vtranslate","ui","selectedItemData","item","menu","css","moduleList","Fields","Picklist","showSelect2ElementView","referenceModuleElement","prevSelectedReferenceModule","parenElement","aDeferred","Deferred","module","action","resolve","fail","error","reject","promise","tdElement","searchModule","getReferencedModuleName","search_module","getReferenceSearchParams","search_value","searchModuleNames","serverDataFormat","result","Array","responseData","referenceDeSelectionEvent","fieldValueContener","fieldNameElement","fieldName","referenceModule","removeAttr","currentElement","which","registerEventForClockPicker","Date","register","DateTime","callbackFunction","_recordLabel","_recordId","getViewName","getRecordId","formData","getForm","serializeFormData","i","inArray","sourceRecordData","referenceModuleName","getInstance","quickCreateModule","controlElementDiv","referenceCreateHandler","account_id","contact_id","lead_id","vendor_id","block","relatedField","addClass","from","to","recordRelativeAccountId","showPnotify","copyAddressDetails","hideCopyAddressLabel","hasClass","copyAddress","addressFieldsData","fromLabel","toLabel","relatedRecord","status","addressMapping","addressFieldsMapping","BlockIds","addressFieldsMappingBlockID","fromElement","fromElementLabel","nameElementFrom","nameElementTo","toElement","toElementLable","errorMsg","blockContainer","copyAddressDetailsRef","mapAddressDetails","err","inputmask","widthType","cacheGet","editViewForm","progressLoader","progressIndicator","removeClass","recordPreSaveEvent","Event","recordPreSave","isDefaultPrevented","mode","removeData","formAlignmentAfterValidation","form","picklistDependcyElemnt","picklistDependencyMapping","sourcePicklists","Object","keys","sourcePickListNames","join","sourcePickListElements","configuredDependencyObject","targetObjectForSelectedSourceValue","picklistmap","targetPickListName","targetPickListValues","targetPickListMap","targetPickList","listOfAvailableOptions","targetOptions","optionSelector","add","html","filter","CKEDITOR","instances","initialFormData","serialize","onbeforeunload","row","parents","td","parent","remove","loadEditorElement","noteContentElement","customConfig","toolbar","height","App","Text","Editor","showPopoverElementView","not","blockId","closestBlock","bodyContents","cacheSet","blocks","currentBlock","dynamicAttr","headerAnimationElement","cacheKey","search","input","requestData","textStatus","errorThrown","jqXHR","responseJSON","message","address","field","v","select","prop","x","change","fieldValue","fieldDisplay","placeholder","sourceFieldModule","validationEngineOptionsForRecord","clear","activeProcess","activeSubProcess","CONFIG","fieldsReferencesDependent","t","referenceLink","setEnabledFields","setDisabledFields","referenceProcess","subProcessfieldElement","hideOptions","subProcessValue","checkSubProcessModulesList","checkReferenceModulesList","checkReferencesField","afterTimeout","elementToFocus","elementToFocusTabindex","registerFocusFirstField","get","elemLen","selectionStart","selectionEnd","tabindex","focus","MultiImage","Vtiger_Inventory_Js","inventoryController","getInventoryInstance","registerClearTreeSelectionEvent","registerTreeAutoCompleteFields","referenceModulePopupRegisterEvent","registerAutoCompleteFields","registerClearReferenceSelectionEvent","registerPreventingEnterSubmitEvent","registerTimeFields","registerEventForPicklistDependencySetup","registerRecordPreSaveEventEvent","registerReferenceSelectionEvent","registerMaskFields","registerHelpInfo","registerReferenceFields","registerCopyValue","registerMultiImageFields","registerReferenceCreate","MultiEmail","MultiDependField","Tree","MultiCurrency","proceedRegisterEvents","registerInventoryController","registerBlockAnimationEvent","registerBlockStatusCheckOnLoad","registerEventForEditor","stretchCKEditor","registerBasicEvents","registerEventForCopyAddress","registerSubmitEvent","registerLeavePageWithoutSubmit","registerValidationsFields","registerAutoloadAddress"],"mappings":"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"}