{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\"use strict\";\n\n$.Class(\n\t\"Base_SortOrderModal_JS\",\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function() {\n\t\t\tlet orderBy = this.sourceContainer.find(\"#orderBy\").val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find(\".js-base-element\");\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement\n\t\t\t\t\t\t.find(\"select.js-orderBy\")\n\t\t\t\t\t\t.val(field)\n\t\t\t\t\t\t.change();\n\t\t\t\t\tlet sortIcon = element.find(\".js-sort-icon-active\");\n\t\t\t\t\tif (orderBy[field] && sortIcon.data(\"val\") != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger(\"click\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function() {\n\t\t\tlet sortContainer = this.container\n\t\t\t\t.find(\".js-base-element\")\n\t\t\t\t.clone(true, true)\n\t\t\t\t.removeClass(\"js-base-element\");\n\t\t\tthis.container.find(\".js-sort-container\").append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find(\"select\"));\n\t\t\treturn sortContainer.removeClass(\"d-none\");\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function() {\n\t\t\tthis.container.find(\".js-add\").on(\"click\", e => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find(\".js-clear\").on(\"click\", e => {\n\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t.closest(\".js-sort-container_element\")\n\t\t\t\t\t.remove();\n\t\t\t});\n\t\t\tthis.container.find(\".js-sort-order-button\").on(\"click\", e => {\n\t\t\t\tlet element = $(e.currentTarget).closest(\".js-sort-container_element\");\n\t\t\t\telement.find(\".js-sort-icon\").toggleClass(\"d-none js-sort-icon-active\");\n\t\t\t\telement.find(\".js-sort-order\").val(element.find(\".js-sort-icon-active\").data(\"val\"));\n\t\t\t});\n\t\t\tthis.container.find(\".js-modal__save\").on(\"click\", e => {\n\t\t\t\te.preventDefault;\n\t\t\t\tlet sortData = {};\n\t\t\t\tthis.container.find(\".js-sort-container_element:not(.js-base-element)\").each(function() {\n\t\t\t\t\tlet orderBy = $(this)\n\t\t\t\t\t\t.find(\".js-orderBy\")\n\t\t\t\t\t\t.val();\n\t\t\t\t\tif (orderBy) {\n\t\t\t\t\t\tsortData[orderBy] = $(this)\n\t\t\t\t\t\t\t.find(\".js-sort-order\")\n\t\t\t\t\t\t\t.val();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.sourceContainer.find(\".js-list-reload\").trigger(\"click\", { orderby: sortData });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function(modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest(\".js-modal-container\").attr(\"id\");\n\t\t\tthis.sourceContainer = $(\"[data-modalid=\" + this.source + \"]\").closest(\n\t\t\t\t\".listViewContentDiv,.relatedContainer\"\n\t\t\t);\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","orderBy","this","sourceContainer","find","val","JSON","parse","Object","keys","length","baseOrderBy","container","field","element","addRow","change","sortIcon","data","trigger","sortContainer","clone","removeClass","append","Fields","Picklist","showSelect2ElementView","on","e","currentTarget","closest","remove","toggleClass","preventDefault","sortData","each","orderby","hideModalWindow","_this","source","modalContainer","attr","registerListEvents","loadData"],"mappings":"aAGAA,EAAEC,MACD,yBACA,GACA,YAIY,mBAIM,UAIT,WAIE,eACLC,QAAUC,KAAKC,gBAAgBC,KAAK,YAAYC,kBAC1CJ,QAAUK,KAAKC,MAAMN,SAAW,KAC3BO,OAAOC,KAAKR,SAASS,OAAQ,KACvCC,YAAcT,KAAKU,UAAUR,KAAK,wBACjC,IAAIS,SAASZ,WACZU,YAAYP,KAAK,iBAAmBS,MAAQ,MAAMH,YAGnDI,QAAUZ,KAAKa,iBAEjBX,KAAK,qBACLC,IAAIQ,OACJG,aACEC,SAAWH,QAAQV,KAAK,wBACxBH,QAAQY,QAAUI,SAASC,KAAK,QAAUjB,QAAQY,iBAC5CM,QAAQ,oBAIdJ,iBAMC,eACHK,cAAgBlB,KAAKU,UACvBR,KAAK,oBACLiB,OAAM,GAAM,GACZC,YAAY,+BACTV,UAAUR,KAAK,sBAAsBmB,OAAOH,mBAC7CI,OAAOC,SAASC,uBAAuBN,cAAchB,KAAK,WACvDgB,cAAcE,YAAY,8BAKd,+BACdV,UAAUR,KAAK,WAAWuB,GAAG,SAAS,kBACrCZ,iBAEDH,UAAUR,KAAK,aAAauB,GAAG,SAAS,cAC1CC,EAAEC,eACFC,QAAQ,8BACRC,iBAEEnB,UAAUR,KAAK,yBAAyBuB,GAAG,SAAS,gBACpDb,QAAUf,EAAE6B,EAAEC,eAAeC,QAAQ,sCACjC1B,KAAK,iBAAiB4B,YAAY,sCAClC5B,KAAK,kBAAkBC,IAAIS,QAAQV,KAAK,wBAAwBc,KAAK,gBAEzEN,UAAUR,KAAK,mBAAmBuB,GAAG,SAAS,cAChDM,mBACEC,SAAW,SACVtB,UAAUR,KAAK,oDAAoD+B,MAAK,eACxElC,QAAUF,EAAEG,MACdE,KAAK,eACLC,MACEJ,mBACMA,SAAWF,EAAEG,MACpBE,KAAK,kBACLC,gBAGCF,gBAAgBC,KAAK,mBAAmBe,QAAQ,QAAS,CAAEiB,QAASF,eACrEG,gBAAgB,KAAMC,MAAKC,2BAOjB,SAASC,qBACnB5B,UAAY4B,oBACZD,OAASC,eAAeV,QAAQ,uBAAuBW,KAAK,WAC5DtC,gBAAkBJ,EAAE,iBAAmBG,KAAKqC,OAAS,KAAKT,QAC9D,8CAEIY,0BACAC"}