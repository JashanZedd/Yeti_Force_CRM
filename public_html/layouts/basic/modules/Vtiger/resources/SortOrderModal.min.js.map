{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_SortOrderModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function () {\n\t\t\tlet orderBy = this.sourceContainer.find('#orderBy').val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find('.js-base-element');\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement.find('select.js-orderBy').val(field).change();\n\t\t\t\t\tlet sortIcon = element.find('.js-sort-icon-active');\n\t\t\t\t\tif (orderBy[field] && sortIcon.data('val') != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function () {\n\t\t\tlet sortContainer = this.container.find('.js-base-element').clone(true, true).removeClass('js-base-element');\n\t\t\tthis.container.find('.js-sort-container').append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find('select'));\n\t\t\treturn sortContainer.removeClass('d-none');\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function () {\n\t\t\tthis.container.find('.js-add').on('click', (e) => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find('.js-clear').on('click', (e) => {\n\t\t\t\t$(e.currentTarget).closest('.js-sort-container_element').remove();\n\t\t\t});\n\t\t\tthis.container.find('.js-sort-order-button').on('click', (e) => {\n\t\t\t\tlet element = $(e.currentTarget).closest('.js-sort-container_element');\n\t\t\t\telement.find('.js-sort-icon').toggleClass('d-none js-sort-icon-active');\n\t\t\t\telement.find('.js-sort-order').val(element.find('.js-sort-icon-active').data('val'));\n\t\t\t});\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.sourceContainer.find('.js-list-reload').trigger('click', { orderby: this.getSortData() });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Gets sort data\n\t\t */\n\t\tgetSortData: function () {\n\t\t\tlet sortData = {};\n\t\t\tthis.container.find('.js-sort-container_element:not(.js-base-element)').each(function () {\n\t\t\t\tlet orderBy = $(this).find('.js-orderBy').val();\n\t\t\t\tif (orderBy) {\n\t\t\t\t\tsortData[orderBy] = $(this).find('.js-sort-order').val();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sortData;\n\t\t},\n\t\t/**\n\t\t * Gets basic container\n\t\t */\n\t\tgetSourceContainer: function () {\n\t\t\treturn $('[data-modalid=' + this.source + ']').closest(\n\t\t\t\t'.listViewContentDiv,.relatedContainer,.js-main-container'\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest('.js-modal-container').attr('id');\n\t\t\tthis.sourceContainer = this.getSourceContainer();\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","sourceContainer","source","loadData","find","val","orderBy","JSON","parse","Object","keys","length","baseOrderBy","field","element","addRow","change","sortIcon","data","trigger","sortContainer","clone","removeClass","append","App","Fields","Picklist","showSelect2ElementView","registerListEvents","on","e","currentTarget","closest","remove","toggleClass","preventDefault","orderby","getSortData","app","hideModalWindow","sortData","each","getSourceContainer","registerEvents","modalContainer","attr"],"mappings":"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"}