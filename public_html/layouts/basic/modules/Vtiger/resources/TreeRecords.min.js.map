{"version":3,"file":"TreeRecords.min.js","sources":["TreeRecords.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Vtiger_TreeRecords_Js',\n\t{},\n\t{\n\t\tmainContainer: false,\n\t\ttreeInstance: false,\n\t\ttreeData: false,\n\t\tgetContainer: function () {\n\t\t\tif (this.mainContainer == false) {\n\t\t\t\tthis.mainContainer = jQuery('#centerPanel');\n\t\t\t}\n\t\t\treturn this.mainContainer;\n\t\t},\n\t\tsetContainer: function (container) {\n\t\t\tthis.mainContainer = container;\n\t\t},\n\t\tgetTreeListValues: function (container) {\n\t\t\tif (this.treeData == false && container !== 'undefined') {\n\t\t\t\tlet treeValues = container.find('#treeListValues').val();\n\t\t\t\tif (treeValues != '') {\n\t\t\t\t\tthis.treeData = JSON.parse(treeValues);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.treeData;\n\t\t},\n\t\tgenerateTree: function (container) {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.treeInstance = container.find('#treeListContents');\n\t\t\tthisInstance.treeInstance.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: thisInstance.getTreeListValues(container),\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplugins: ['checkbox']\n\t\t\t});\n\t\t},\n\t\tgetRecordsParams: function (container) {\n\t\t\tlet selected = [];\n\t\t\t$.each(this.treeInstance.jstree('get_selected', true), function (index, value) {\n\t\t\t\tselected.push(value.original.record_id);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: app.getViewName(),\n\t\t\t\tbranches: selected,\n\t\t\t\tfilter: container.find('#moduleFilter').val()\n\t\t\t};\n\t\t},\n\t\tgetRecordsList: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet container = thisInstance.getContainer();\n\t\t\tlet progressIndicator = jQuery.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\tblockInfo: { enabled: true }\n\t\t\t});\n\n\t\t\t$.extend($.fn.dataTable.defaults, {\n\t\t\t\tlanguage: {\n\t\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\toPaginate: {\n\t\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t\t},\n\t\t\t\t\toAria: {\n\t\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tAppConnector.request(thisInstance.getRecordsParams(container))\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tcontainer.find('#recordsListContents').html(data);\n\t\t\t\t\tcontainer.find('#recordsListContents table').dataTable();\n\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t},\n\t\tregisterFilterChangeEvent: function (container) {\n\t\t\tlet thisInstance = this;\n\t\t\tcontainer.on('change', '#moduleFilter', function (e) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterSelectBrancheEvent: function (container) {\n\t\t\tlet thisInstance = this;\n\t\t\tthisInstance.treeInstance.on('changed.jstree', function (e, data) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tlet container = this.getContainer();\n\t\t\tthis.generateTree(container);\n\t\t\tthis.registerFilterChangeEvent(container);\n\t\t\tthis.registerSelectBrancheEvent(container);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","mainContainer","treeInstance","treeData","getContainer","setContainer","container","getTreeListValues","find","val","treeValues","JSON","parse","generateTree","thisInstance","jstree","core","data","themes","name","responsive","plugins","getRecordsParams","each","index","value","selected","push","original","record_id","module","app","getModuleName","view","getViewName","branches","filter","getRecordsList","progressIndicator","message","vtranslate","blockInfo","enabled","$","extend","fn","dataTable","defaults","language","sLengthMenu","sZeroRecords","sInfo","sInfoEmpty","sSearch","sEmptyTable","sInfoFiltered","sLoadingRecords","sProcessing","oPaginate","sFirst","sPrevious","sNext","sLast","oAria","sSortAscending","sSortDescending","AppConnector","request","done","html","mode","fail","registerFilterChangeEvent","on","registerSelectBrancheEvent","registerEvents"],"mappings":"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"}