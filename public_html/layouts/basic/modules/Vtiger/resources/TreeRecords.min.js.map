{"version":3,"file":"TreeRecords.min.js","sources":["TreeRecords.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"Vtiger_TreeRecords_Js\", {}, {\n\tmainContainer: false,\n\ttreeInstance: false,\n\ttreeData: false,\n\tgetContainer: function () {\n\t\tif (this.mainContainer == false) {\n\t\t\tthis.mainContainer = jQuery('#centerPanel');\n\t\t}\n\t\treturn this.mainContainer;\n\t},\n\tsetContainer: function (container) {\n\t\tthis.mainContainer = container;\n\t},\n\tgetTreeListValues: function (container) {\n\t\tif (this.treeData == false && container !== \"undefined\") {\n\t\t\tvar treeValues = container.find('#treeListValues').val();\n\t\t\tif (treeValues != '') {\n\t\t\t\tthis.treeData = JSON.parse(treeValues);\n\t\t\t}\n\t\t}\n\t\treturn this.treeData;\n\t},\n\tgenerateTree: function (container) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.treeInstance = container.find(\"#treeListContents\");\n\t\tvar plugins = [\"checkbox\"];\n\t\tif (app.getMainParams('isActiveCategory') == '1') {\n\t\t\tplugins.push(\"category\");\n\t\t}\n\t\tthisInstance.treeInstance.jstree({\n\t\t\tcore: {\n\t\t\t\tdata: thisInstance.getTreeListValues(container),\n\t\t\t\tthemes: {\n\t\t\t\t\tname: 'proton',\n\t\t\t\t\tresponsive: true\n\t\t\t\t}\n\t\t\t},\n\t\t\tplugins: plugins\n\t\t});\n\t},\n\tgetRecordsParams: function (container) {\n\t\tvar thisInstance = this;\n\t\tvar selectedFilter = container.find('#moduleFilter').val();\n\n\t\tvar selected = [];\n\t\t$.each(thisInstance.treeInstance.jstree(\"get_selected\", true), function (index, value) {\n\t\t\tselected.push(value.original.record_id);\n\t\t});\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tview: app.getViewName(),\n\t\t\tbranches: selected,\n\t\t\tfilter: selectedFilter\n\t\t};\n\t\tif (app.getMainParams('isActiveCategory') == '1') {\n\t\t\tparams.category = thisInstance.treeInstance.jstree(\"getCategory\");\n\t\t}\n\t\treturn params;\n\t},\n\tgetRecordsList: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = thisInstance.getContainer();\n\t\tvar progressIndicator = jQuery.progressIndicator({\n\t\t\tmessage: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\tblockInfo: {enabled: true}\n\t\t});\n\n\t\t$.extend($.fn.dataTable.defaults, {\n\t\t\tlanguage: {\n\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\toPaginate: {\n\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t},\n\t\t\t\toAria: {\n\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tAppConnector.request(thisInstance.getRecordsParams(container)).done(function (data) {\n\t\t\tcontainer.find('#recordsListContents').html(data);\n\t\t\tcontainer.find('#recordsListContents table').dataTable();\n\n\t\t\tprogressIndicator.progressIndicator({mode: 'hide'});\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicator.progressIndicator({mode: 'hide'});\n\t\t});\n\t},\n\tregisterFilterChangeEvent: function (container) {\n\t\tvar thisInstance = this;\n\t\tcontainer.on('change', '#moduleFilter', function (e) {\n\t\t\tthisInstance.getRecordsList();\n\t\t});\n\t},\n\tregisterSelectBrancheEvent: function (container) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.treeInstance.on(\"changed.jstree\", function (e, data) {\n\t\t\tthisInstance.getRecordsList();\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tvar container = this.getContainer();\n\t\tthis.generateTree(container);\n\t\tthis.registerFilterChangeEvent(container);\n\t\tthis.registerSelectBrancheEvent(container);\n\t}\n});\n"],"names":["jQuery","Class","mainContainer","treeInstance","treeData","getContainer","setContainer","container","getTreeListValues","find","val","JSON","parse","treeValues","generateTree","thisInstance","getMainParams","plugins","push","jstree","core","data","themes","name","responsive","getRecordsParams","selectedFilter","selected","$","each","index","value","original","record_id","module","app","getModuleName","view","getViewName","branches","filter","params","category","getRecordsList","progressIndicator","message","vtranslate","blockInfo","enabled","extend","fn","dataTable","defaults","language","sLengthMenu","sZeroRecords","sInfo","sInfoEmpty","sSearch","sEmptyTable","sInfoFiltered","sLoadingRecords","sProcessing","oPaginate","sFirst","sPrevious","sNext","sLast","oAria","sSortAscending","sSortDescending","AppConnector","request","done","html","mode","fail","registerFilterChangeEvent","on","registerSelectBrancheEvent","registerEvents"],"mappings":"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"}