{"version":3,"file":"TreeRecords.min.js","sources":["TreeRecords.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Vtiger_TreeRecords_Js',\n\t{},\n\t{\n\t\tmainContainer: false,\n\t\ttreeInstance: false,\n\t\ttreeData: false,\n\t\tgetContainer: function() {\n\t\t\tif (this.mainContainer == false) {\n\t\t\t\tthis.mainContainer = jQuery('#centerPanel');\n\t\t\t}\n\t\t\treturn this.mainContainer;\n\t\t},\n\t\tsetContainer: function(container) {\n\t\t\tthis.mainContainer = container;\n\t\t},\n\t\tgetTreeListValues: function(container) {\n\t\t\tif (this.treeData == false && container !== 'undefined') {\n\t\t\t\tvar treeValues = container.find('#treeListValues').val();\n\t\t\t\tif (treeValues != '') {\n\t\t\t\t\tthis.treeData = JSON.parse(treeValues);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.treeData;\n\t\t},\n\t\tgenerateTree: function(container) {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.treeInstance = container.find('#treeListContents');\n\t\t\tthisInstance.treeInstance.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: thisInstance.getTreeListValues(container),\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplugins: ['checkbox']\n\t\t\t});\n\t\t},\n\t\tgetRecordsParams: function(container) {\n\t\t\tlet selected = [];\n\t\t\t$.each(this.treeInstance.jstree('get_selected', true), function(index, value) {\n\t\t\t\tselected.push(value.original.record_id);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: app.getViewName(),\n\t\t\t\tbranches: selected,\n\t\t\t\tfilter: container.find('#moduleFilter').val()\n\t\t\t};\n\t\t},\n\t\tgetRecordsList: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = thisInstance.getContainer();\n\t\t\tvar progressIndicator = jQuery.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\tblockInfo: { enabled: true }\n\t\t\t});\n\n\t\t\t$.extend($.fn.dataTable.defaults, {\n\t\t\t\tlanguage: {\n\t\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\toPaginate: {\n\t\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t\t},\n\t\t\t\t\toAria: {\n\t\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tAppConnector.request(thisInstance.getRecordsParams(container))\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tcontainer.find('#recordsListContents').html(data);\n\t\t\t\t\tcontainer.find('#recordsListContents table').dataTable();\n\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t})\n\t\t\t\t.fail(function(error) {\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t},\n\t\tregisterFilterChangeEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('change', '#moduleFilter', function(e) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterSelectBrancheEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.treeInstance.on('changed.jstree', function(e, data) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\tvar container = this.getContainer();\n\t\t\tthis.generateTree(container);\n\t\t\tthis.registerFilterChangeEvent(container);\n\t\t\tthis.registerSelectBrancheEvent(container);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","this","mainContainer","container","treeData","treeValues","find","val","JSON","parse","treeInstance","jstree","getTreeListValues","selected","each","index","value","push","original","record_id","app","getModuleName","getViewName","getContainer","progressIndicator","vtranslate","enabled","extend","$","fn","dataTable","defaults","request","getRecordsParams","done","data","html","mode","fail","error","thisInstance","on","e","getRecordsList","generateTree","registerFilterChangeEvent","registerSelectBrancheEvent"],"mappings":"aAGAA,OAAOC,MACN,wBACA,GACA,gBACgB,gBACD,YACJ,eACI,kBACa,GAAtBC,KAAKC,qBACHA,cAAgBH,OAAO,iBAEtBE,KAAKC,4BAEC,SAASC,gBACjBD,cAAgBC,6BAEH,SAASA,cACN,GAAjBF,KAAKG,UAAmC,cAAdD,UAA2B,KACpDE,WAAaF,UAAUG,KAAK,mBAAmBC,MACjC,IAAdF,kBACED,SAAWI,KAAKC,MAAMJ,oBAGtBJ,KAAKG,uBAEC,SAASD,WACDF,KACRS,aAAeP,UAAUG,KAAK,qBADtBL,KAERS,aAAaC,OAAO,MAC1B,MAHcV,KAIAW,kBAAkBT,kBAC7B,MACD,qBACM,YAGL,CAAC,gCAGM,SAASA,eACtBU,SAAW,YACbC,KAAKb,KAAKS,aAAaC,OAAO,gBAAgB,IAAO,SAASI,MAAOC,gBAC7DC,KAAKD,MAAME,SAASC,cAEvB,QACEC,IAAIC,qBACND,IAAIE,uBACAT,gBACFV,UAAUG,KAAK,iBAAiBC,uBAG1B,eAEXJ,UADeF,KACUsB,eACzBC,kBAAoBzB,OAAOyB,kBAAkB,SACvCJ,IAAIK,WAAW,mCACb,CAAEC,SAAS,OAGrBC,OAAOC,EAAEC,GAAGC,UAAUC,SAAU,UACvB,aACIX,IAAIK,WAAW,iCACdL,IAAIK,WAAW,6BACtBL,IAAIK,WAAW,wBACVL,IAAIK,WAAW,2BAClBL,IAAIK,WAAW,yBACXL,IAAIK,WAAW,qCACbL,IAAIK,WAAW,sCACbL,IAAIK,WAAW,qCACnBL,IAAIK,WAAW,mCACjB,QACFL,IAAIK,WAAW,wBACZL,IAAIK,WAAW,uBACnBL,IAAIK,WAAW,mBACfL,IAAIK,WAAW,oBAEhB,gBACUL,IAAIK,WAAW,uCACdL,IAAIK,WAAW,yCAKtBO,QA/BM/B,KA+BegC,iBAAiB9B,YACjD+B,MAAK,SAASC,gBACJ7B,KAAK,wBAAwB8B,KAAKD,gBAClC7B,KAAK,8BAA8BwB,8BAE3BN,kBAAkB,CAAEa,KAAM,YAE5CC,MAAK,SAASC,yBACIf,kBAAkB,CAAEa,KAAM,uCAGpB,SAASlC,eAC/BqC,aAAevC,eACTwC,GAAG,SAAU,iBAAiB,SAASC,gBACnCC,gDAGa,SAASxC,eAChCqC,aAAevC,kBACNS,aAAa+B,GAAG,kBAAkB,SAASC,EAAGP,mBAC7CQ,oCAGC,eACXxC,UAAYF,KAAKsB,oBAChBqB,aAAazC,gBACb0C,0BAA0B1C,gBAC1B2C,2BAA2B3C"}