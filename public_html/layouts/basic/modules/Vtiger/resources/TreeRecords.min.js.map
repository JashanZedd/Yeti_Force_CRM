{"version":3,"file":"TreeRecords.min.js","sources":["TreeRecords.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Vtiger_TreeRecords_Js',\n\t{},\n\t{\n\t\tmainContainer: false,\n\t\ttreeInstance: false,\n\t\ttreeData: false,\n\t\tgetContainer: function() {\n\t\t\tif (this.mainContainer == false) {\n\t\t\t\tthis.mainContainer = jQuery('#centerPanel');\n\t\t\t}\n\t\t\treturn this.mainContainer;\n\t\t},\n\t\tsetContainer: function(container) {\n\t\t\tthis.mainContainer = container;\n\t\t},\n\t\tgetTreeListValues: function(container) {\n\t\t\tif (this.treeData == false && container !== 'undefined') {\n\t\t\t\tvar treeValues = container.find('#treeListValues').val();\n\t\t\t\tif (treeValues != '') {\n\t\t\t\t\tthis.treeData = JSON.parse(treeValues);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.treeData;\n\t\t},\n\t\tgenerateTree: function(container) {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.treeInstance = container.find('#treeListContents');\n\t\t\tthisInstance.treeInstance.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: thisInstance.getTreeListValues(container),\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplugins: ['checkbox']\n\t\t\t});\n\t\t},\n\t\tgetRecordsParams: function(container) {\n\t\t\tlet selected = [];\n\t\t\t$.each(this.treeInstance.jstree('get_selected', true), function(index, value) {\n\t\t\t\tselected.push(value.original.record_id);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: app.getViewName(),\n\t\t\t\tbranches: selected,\n\t\t\t\tfilter: container.find('#moduleFilter').val()\n\t\t\t};\n\t\t},\n\t\tgetRecordsList: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = thisInstance.getContainer();\n\t\t\tvar progressIndicator = jQuery.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\tblockInfo: { enabled: true }\n\t\t\t});\n\n\t\t\t$.extend($.fn.dataTable.defaults, {\n\t\t\t\tlanguage: {\n\t\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\toPaginate: {\n\t\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t\t},\n\t\t\t\t\toAria: {\n\t\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tAppConnector.request(thisInstance.getRecordsParams(container))\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tcontainer.find('#recordsListContents').html(data);\n\t\t\t\t\tcontainer.find('#recordsListContents table').dataTable();\n\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t})\n\t\t\t\t.fail(function(error) {\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t},\n\t\tregisterFilterChangeEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('change', '#moduleFilter', function(e) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterSelectBrancheEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.treeInstance.on('changed.jstree', function(e, data) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\tvar container = this.getContainer();\n\t\t\tthis.generateTree(container);\n\t\t\tthis.registerFilterChangeEvent(container);\n\t\t\tthis.registerSelectBrancheEvent(container);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","mainContainer","container","treeData","treeValues","find","val","JSON","parse","thisInstance","treeInstance","jstree","getTreeListValues","selected","each","index","value","push","original","record_id","app","getModuleName","getViewName","getContainer","progressIndicator","vtranslate","enabled","extend","$","fn","dataTable","defaults","request","getRecordsParams","done","data","html","mode","fail","error","on","e","getRecordsList","generateTree","registerFilterChangeEvent","registerSelectBrancheEvent"],"mappings":"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"}