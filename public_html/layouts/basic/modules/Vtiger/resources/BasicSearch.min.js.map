{"version":3,"file":"BasicSearch.min.js","sources":["BasicSearch.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Vtiger_BasicSearch_Js',\n\t{},\n\t{\n\t\t//stores the module that need to be searched\n\t\tsearchModule: false,\n\t\t//stores the module that need to be searched which is selected by the user\n\t\tcurrentSearchModule: false,\n\t\t// reduce the number of results\n\t\treduceNumberResults: false,\n\t\t// Should the result be in html\n\t\treturnHtml: true,\n\t\t// Main container with modules, value and buttons\n\t\tmainContainer: false,\n\t\t/**\n\t\t * Function to get the search module\n\t\t */\n\t\tgetSearchModule: function() {\n\t\t\tif (this.searchModule === false) {\n\t\t\t\t//default gives current module\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tif (typeof this.getCurrentSearchModule() !== 'undefined') {\n\t\t\t\t\tmodule = this.getCurrentSearchModule();\n\t\t\t\t}\n\n\t\t\t\tthis.setSearchModule(module);\n\t\t\t}\n\t\t\treturn this.searchModule;\n\t\t},\n\t\t/**\n\t\t * Function to set the search module\n\t\t */\n\t\tsetSearchModule: function(moduleName) {\n\t\t\tthis.searchModule = moduleName;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to set main conatainer\n\t\t */\n\t\tsetMainContainer: function(container) {\n\t\t\tthis.mainContainer = container;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to get the user selected search module\n\t\t */\n\t\tgetCurrentSearchModule: function() {\n\t\t\tif (this.currentSearchModule === false && this.mainContainer) {\n\t\t\t\tthis.currentSearchModule = this.mainContainer.find('.basicSearchModulesList').val();\n\t\t\t}\n\t\t\treturn this.currentSearchModule;\n\t\t},\n\t\t/**\n\t\t * Function which will perform the search\n\t\t */\n\t\t_search: function(params) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tif (typeof params === 'undefined') {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tif (params.searchModule && params.searchModule !== '-') {\n\t\t\t\tparams.module = params.searchModule;\n\t\t\t} else {\n\t\t\t\tparams.module = app.getModuleName();\n\t\t\t}\n\t\t\tparams.view = 'BasicAjax';\n\t\t\tparams.mode = 'showSearchResults';\n\t\t\tparams.limit = this.reduceNumberResults;\n\t\t\tparams.html = this.returnHtml;\n\t\t\tif (app.getParentModuleName()) {\n\t\t\t\tparams.parent = app.getParentModuleName();\n\t\t\t}\n\t\t\tparams.operator = CONFIG.globalSearchDefaultOperator;\n\t\t\tif (this.mainContainer) {\n\t\t\t\tlet operatorElement = this.mainContainer.find('.js-global-search-operator .active[data-operator]');\n\t\t\t\tif (operatorElement.length && operatorElement.data('operator') != '') {\n\t\t\t\t\tparams.operator = operatorElement.data('operator');\n\t\t\t\t}\n\t\t\t}\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\taDeferred.reject(error);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Helper function whicn invokes search\n\t\t */\n\t\tsearch: function(value) {\n\t\t\tvar searchModule = this.getCurrentSearchModule();\n\t\t\tvar params = {};\n\t\t\tparams.value = value;\n\t\t\tif (typeof searchModule !== 'undefined' && searchModule !== false) {\n\t\t\t\tparams.searchModule = searchModule;\n\t\t\t} else if (this.searchModule) {\n\t\t\t\tparams.searchModule = this.searchModule;\n\t\t\t}\n\t\t\treturn this._search(params);\n\t\t},\n\t\t/**\n\t\t * Function which shows the search results\n\t\t */\n\t\tshowSearchResults: function(data) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar postLoad = function(data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t};\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.cb = postLoad;\n\t\t\tapp.showModalWindow(params);\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","searchModule","module","app","getModuleName","getCurrentSearchModule","setSearchModule","moduleName","container","mainContainer","currentSearchModule","find","val","params","aDeferred","Deferred","view","mode","limit","reduceNumberResults","html","returnHtml","getParentModuleName","parent","operator","CONFIG","globalSearchDefaultOperator","operatorElement","length","data","request","done","resolve","fail","error","err","reject","promise","value","_search","postLoad","cb","showModalWindow"],"mappings":";;AAAA;;;;;;;;AAQA;AAEAA,OAAOC,KAAP,CACC,uBADD,EAEC,EAFD,EAGC;;eAEe,KAFf;;sBAIsB,KAJtB;;sBAMsB,KANtB;;aAQa,IARb;;gBAUgB,KAVhB;;;;kBAckB,2BAAW;MACvB,KAAKC,YAAL,KAAsB,KAA1B,EAAiC;;OAE5BC,SAASC,IAAIC,aAAJ,EAAb;OACI,OAAO,KAAKC,sBAAL,EAAP,KAAyC,WAA7C,EAA0D;aAChD,KAAKA,sBAAL,EAAT;;;QAGIC,eAAL,CAAqBJ,MAArB;;SAEM,KAAKD,YAAZ;EAxBF;;;;kBA6BkB,yBAASM,UAAT,EAAqB;OAChCN,YAAL,GAAoBM,UAApB;SACO,IAAP;EA/BF;;;;mBAoCmB,0BAASC,SAAT,EAAoB;OAChCC,aAAL,GAAqBD,SAArB;SACO,IAAP;EAtCF;;;;yBA2CyB,kCAAW;MAC9B,KAAKE,mBAAL,KAA6B,KAA7B,IAAsC,KAAKD,aAA/C,EAA8D;QACxDC,mBAAL,GAA2B,KAAKD,aAAL,CAAmBE,IAAnB,CAAwB,yBAAxB,EAAmDC,GAAnD,EAA3B;;SAEM,KAAKF,mBAAZ;EA/CF;;;;UAoDU,iBAASG,MAAT,EAAiB;MACrBC,YAAYf,OAAOgB,QAAP,EAAhB;MACI,OAAOF,MAAP,KAAkB,WAAtB,EAAmC;YACzB,EAAT;;MAEGA,OAAOZ,YAAP,IAAuBY,OAAOZ,YAAP,KAAwB,GAAnD,EAAwD;UAChDC,MAAP,GAAgBW,OAAOZ,YAAvB;GADD,MAEO;UACCC,MAAP,GAAgBC,IAAIC,aAAJ,EAAhB;;SAEMY,IAAP,GAAc,WAAd;SACOC,IAAP,GAAc,mBAAd;SACOC,KAAP,GAAe,KAAKC,mBAApB;SACOC,IAAP,GAAc,KAAKC,UAAnB;MACIlB,IAAImB,mBAAJ,EAAJ,EAA+B;UACvBC,MAAP,GAAgBpB,IAAImB,mBAAJ,EAAhB;;SAEME,QAAP,GAAkBC,OAAOC,2BAAzB;MACI,KAAKjB,aAAT,EAAwB;OACnBkB,kBAAkB,KAAKlB,aAAL,CAAmBE,IAAnB,CAAwB,mDAAxB,CAAtB;OACIgB,gBAAgBC,MAAhB,IAA0BD,gBAAgBE,IAAhB,CAAqB,UAArB,KAAoC,EAAlE,EAAsE;WAC9DL,QAAP,GAAkBG,gBAAgBE,IAAhB,CAAqB,UAArB,CAAlB;;;eAGWC,OAAb,CAAqBjB,MAArB,EACEkB,IADF,CACO,UAASF,IAAT,EAAe;aACVG,OAAV,CAAkBH,IAAlB;GAFF,EAIEI,IAJF,CAIO,UAASC,KAAT,EAAgBC,GAAhB,EAAqB;aAChBC,MAAV,CAAiBF,KAAjB;GALF;SAOOpB,UAAUuB,OAAV,EAAP;EAnFF;;;;SAwFS,gBAASC,KAAT,EAAgB;MACnBrC,eAAe,KAAKI,sBAAL,EAAnB;MACIQ,SAAS,EAAb;SACOyB,KAAP,GAAeA,KAAf;MACI,OAAOrC,YAAP,KAAwB,WAAxB,IAAuCA,iBAAiB,KAA5D,EAAmE;UAC3DA,YAAP,GAAsBA,YAAtB;GADD,MAEO,IAAI,KAAKA,YAAT,EAAuB;UACtBA,YAAP,GAAsB,KAAKA,YAA3B;;SAEM,KAAKsC,OAAL,CAAa1B,MAAb,CAAP;EAjGF;;;;oBAsGoB,2BAASgB,IAAT,EAAe;MAC7Bf,YAAYf,OAAOgB,QAAP,EAAhB;MACIyB,WAAW,SAAXA,QAAW,CAASX,IAAT,EAAe;aACnBG,OAAV,CAAkBH,IAAlB;GADD;MAGIhB,SAAS,EAAb;SACOgB,IAAP,GAAcA,IAAd;SACOY,EAAP,GAAYD,QAAZ;MACIE,eAAJ,CAAoB7B,MAApB;SACOC,UAAUuB,OAAV,EAAP;;CAlHH"}