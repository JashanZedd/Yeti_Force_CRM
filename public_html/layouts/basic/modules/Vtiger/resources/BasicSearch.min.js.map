{"version":3,"file":"BasicSearch.min.js","sources":["BasicSearch.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Vtiger_BasicSearch_Js',\n\t{},\n\t{\n\t\t//stores the module that need to be searched\n\t\tsearchModule: false,\n\t\t//stores the module that need to be searched which is selected by the user\n\t\tcurrentSearchModule: false,\n\t\t// reduce the number of results\n\t\treduceNumberResults: false,\n\t\t// Should the result be in html\n\t\treturnHtml: true,\n\t\t// Main container with modules, value and buttons\n\t\tmainContainer: false,\n\t\t/**\n\t\t * Function to get the search module\n\t\t */\n\t\tgetSearchModule: function() {\n\t\t\tif (this.searchModule === false) {\n\t\t\t\t//default gives current module\n\t\t\t\tvar module = app.getModuleName();\n\t\t\t\tif (typeof this.getCurrentSearchModule() !== 'undefined') {\n\t\t\t\t\tmodule = this.getCurrentSearchModule();\n\t\t\t\t}\n\n\t\t\t\tthis.setSearchModule(module);\n\t\t\t}\n\t\t\treturn this.searchModule;\n\t\t},\n\t\t/**\n\t\t * Function to set the search module\n\t\t */\n\t\tsetSearchModule: function(moduleName) {\n\t\t\tthis.searchModule = moduleName;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to set main conatainer\n\t\t */\n\t\tsetMainContainer: function(container) {\n\t\t\tthis.mainContainer = container;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to get the user selected search module\n\t\t */\n\t\tgetCurrentSearchModule: function() {\n\t\t\tif (this.currentSearchModule === false && this.mainContainer) {\n\t\t\t\tthis.currentSearchModule = this.mainContainer.find('.basicSearchModulesList').val();\n\t\t\t}\n\t\t\treturn this.currentSearchModule;\n\t\t},\n\t\t/**\n\t\t * Function which will perform the search\n\t\t */\n\t\t_search: function(params) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tif (typeof params === 'undefined') {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tif (params.searchModule && params.searchModule !== '-') {\n\t\t\t\tparams.module = params.searchModule;\n\t\t\t} else {\n\t\t\t\tparams.module = app.getModuleName();\n\t\t\t}\n\t\t\tparams.view = 'BasicAjax';\n\t\t\tparams.mode = 'showSearchResults';\n\t\t\tparams.limit = this.reduceNumberResults;\n\t\t\tparams.html = this.returnHtml;\n\t\t\tif (app.getParentModuleName()) {\n\t\t\t\tparams.parent = app.getParentModuleName();\n\t\t\t}\n\t\t\tparams.operator = CONFIG.globalSearchDefaultOperator;\n\t\t\tif (this.mainContainer) {\n\t\t\t\tlet operatorElement = this.mainContainer.find('.js-global-search-operator .active[data-operator]');\n\t\t\t\tif (operatorElement.length && operatorElement.data('operator') != '') {\n\t\t\t\t\tparams.operator = operatorElement.data('operator');\n\t\t\t\t}\n\t\t\t}\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\taDeferred.reject(error);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Helper function whicn invokes search\n\t\t */\n\t\tsearch: function(value) {\n\t\t\tvar searchModule = this.getCurrentSearchModule();\n\t\t\tvar params = {};\n\t\t\tparams.value = value;\n\t\t\tif (typeof searchModule !== 'undefined' && searchModule !== false) {\n\t\t\t\tparams.searchModule = searchModule;\n\t\t\t} else if (this.searchModule) {\n\t\t\t\tparams.searchModule = this.searchModule;\n\t\t\t}\n\t\t\treturn this._search(params);\n\t\t},\n\t\t/**\n\t\t * Function which shows the search results\n\t\t */\n\t\tshowSearchResults: function(data) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar postLoad = function(data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t};\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.cb = postLoad;\n\t\t\tapp.showModalWindow(params);\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","this","searchModule","module","app","getModuleName","getCurrentSearchModule","setSearchModule","moduleName","container","mainContainer","currentSearchModule","find","val","params","aDeferred","Deferred","view","mode","limit","reduceNumberResults","html","returnHtml","getParentModuleName","parent","operator","CONFIG","globalSearchDefaultOperator","operatorElement","length","data","request","done","resolve","fail","error","err","reject","promise","value","_search","cb","showModalWindow"],"mappings":"aAUAA,OAAOC,MACN,wBACA,GACA,eAEe,uBAEO,uBAEA,cAET,iBAEG,kBAIE,eACU,IAAtBC,KAAKC,aAAwB,KAE5BC,OAASC,IAAIC,qBAC4B,IAAlCJ,KAAKK,kCACNL,KAAKK,+BAGVC,gBAAgBJ,eAEfF,KAAKC,8BAKI,SAASM,wBACpBN,aAAeM,WACbP,uBAKU,SAASQ,uBACrBC,cAAgBD,UACdR,6BAKgB,kBACU,IAA7BA,KAAKU,qBAAiCV,KAAKS,qBACzCC,oBAAsBV,KAAKS,cAAcE,KAAK,2BAA2BC,OAExEZ,KAAKU,6BAKJ,SAASG,YACbC,UAAYhB,OAAOiB,mBACD,IAAXF,gBACD,IAENA,OAAOZ,cAAwC,MAAxBY,OAAOZ,oBAC1BC,OAASW,OAAOZ,oBAEhBC,OAASC,IAAIC,uBAEdY,KAAO,mBACPC,KAAO,2BACPC,MAAQlB,KAAKmB,2BACbC,KAAOpB,KAAKqB,WACflB,IAAImB,+BACAC,OAASpB,IAAImB,8BAEdE,SAAWC,OAAOC,4BACrB1B,KAAKS,cAAe,KACnBkB,gBAAkB3B,KAAKS,cAAcE,KAAK,qDAC1CgB,gBAAgBC,QAA8C,IAApCD,gBAAgBE,KAAK,qBAC3CL,SAAWG,gBAAgBE,KAAK,iCAG5BC,QAAQjB,QACnBkB,MAAK,SAASF,gBACJG,QAAQH,SAElBI,MAAK,SAASC,MAAOC,eACXC,OAAOF,UAEZpB,UAAUuB,kBAKV,SAASC,WACZrC,aAAeD,KAAKK,yBACpBQ,OAAS,iBACNyB,MAAQA,WACa,IAAjBrC,eAAiD,IAAjBA,oBACnCA,aAAeA,aACZD,KAAKC,sBACRA,aAAeD,KAAKC,cAErBD,KAAKuC,QAAQ1B,2BAKF,SAASgB,UACvBf,UAAYhB,OAAOiB,WAInBF,OAAS,iBACNgB,KAAOA,YACPW,GALQ,SAASX,gBACbG,QAAQH,WAKfY,gBAAgB5B,QACbC,UAAUuB"}