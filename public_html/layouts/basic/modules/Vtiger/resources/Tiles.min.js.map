{"version":3,"file":"Tiles.min.js","sources":["Tiles.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n$.Class(\n\t'Vtiger_Tiles_Js',\n\t{},\n\t{\n\t\tcontentContainer: false,\n\t\t/**\n\t\t * Register tiles size change action\n\t\t * @param {jQuery} topMenuContainer\n\t\t */\n\t\tregisterTileSizeChange: function (topMenuContainer) {\n\t\t\ttopMenuContainer.find('.js-tile-size').on('click', (e) => {\n\t\t\t\tlet selectedTileSize = $(e.currentTarget).attr('data-tile-size');\n\t\t\t\ttopMenuContainer.find('.js-tile-dropdown-title').text($(e.currentTarget).text());\n\t\t\t\ttopMenuContainer.find('.js-selected-tile-size').attr('data-selected-tile-size', selectedTileSize);\n\t\t\t\tapp.setMainParams('pageNumber', '1');\n\t\t\t\tapp.setMainParams('pageToJump', '1');\n\t\t\t\tlet urlParams = {\n\t\t\t\t\tviewname: this.listInstance.getCurrentCvId(),\n\t\t\t\t\tsearch_key: this.listInstance.getAlphabetSearchField(),\n\t\t\t\t\tsearch_value: '',\n\t\t\t\t\tsearch_params: '',\n\t\t\t\t\tadvancedConditions: '',\n\t\t\t\t\ttile_size: selectedTileSize\n\t\t\t\t};\n\t\t\t\tthis.contentContainer.find('#recordsCount').val('');\n\t\t\t\tthis.contentContainer.find('#totalPageCount').text('');\n\t\t\t\ttopMenuContainer.find('.pagination').data('totalCount', 0);\n\t\t\t\tthis.listInstance.getListViewRecords(urlParams).done(() => {\n\t\t\t\t\tthis.listInstance.updatePagination(1);\n\t\t\t\t\tthis.setHeightOfTiles(this.contentContainer);\n\t\t\t\t});\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Adjust height tile to the highest\n\t\t */\n\t\tsetHeightOfTiles: function () {\n\t\t\tlet maxHeight = -1;\n\t\t\tlet tiles = this.contentContainer.find('.js-tile-card');\n\t\t\ttiles.each(function () {\n\t\t\t\tmaxHeight = maxHeight > $(this).height() ? maxHeight : $(this).height();\n\t\t\t});\n\t\t\ttiles.each(function () {\n\t\t\t\t$(this).height(maxHeight);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register the click on the tile\n\t\t * @param {jQuery} tileContainer\n\t\t */\n\t\tregisterTileClickEvent: function (tileContainer) {\n\t\t\ttileContainer.on('click', '.js-card-body', function (e) {\n\t\t\t\tif ($(e.target).hasClass('js-show-image-preview')) return;\n\t\t\t\tif ($(e.target).closest('div').hasClass('actions')) return;\n\t\t\t\tif ($(e.target).is('button') || $(e.target).parent().is('button')) return;\n\t\t\t\tif ($(e.target).closest('a').hasClass('noLinkBtn')) return;\n\t\t\t\tif ($(e.target).is('input[type=\"checkbox\"]')) return;\n\t\t\t\tlet recordUrl = $(e.target).closest('.js-tile-container').data('recordurl');\n\t\t\t\tif (typeof recordUrl !== 'undefined') {\n\t\t\t\t\twindow.location.href = recordUrl;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will give you all the list view params\n\t\t * @param {string} urlParams\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tthis.listInstance.getListViewRecords(urlParams).done(() => {\n\t\t\t\tthis.setHeightOfTiles(this.contentContainer);\n\t\t\t});\n\t\t},\n\t\tregisterImagePreview() {\n\t\t\tthis.contentContainer.on('click', '.js-show-image-preview', (e) => {\n\t\t\t\tconst moduleName = this.contentContainer.find('[name=\"module\"]').length\n\t\t\t\t\t? this.contentContainer.find('[name=\"module\"]').val()\n\t\t\t\t\t: app.getModuleName();\n\t\t\t\tconst recordId = $(e.target).closest('.js-tile-container').attr('data-record-id');\n\t\t\t\tconst url = `index.php?module=${moduleName}&view=ImagePreview&record=${recordId}`;\n\t\t\t\tapp.showModalWindow('', url, (modalWindow) => {\n\t\t\t\t\tlet imageSrc = '';\n\t\t\t\t\tif ('IMG' === e.target.nodeName) {\n\t\t\t\t\t\timageSrc = $(e.target).attr('src');\n\t\t\t\t\t} else {\n\t\t\t\t\t\timageSrc = $(e.target).css('background-image');\n\t\t\t\t\t\timageSrc = imageSrc.replace('url(\"', '');\n\t\t\t\t\t\timageSrc = imageSrc.replace('\")', '');\n\t\t\t\t\t}\n\t\t\t\t\tmodalWindow.find('img.js-image-preview').attr('src', imageSrc);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.listInstance = new Vtiger_List_Js();\n\t\t\tthis.listInstance.registerEvents();\n\t\t\tconst topMenuContainer = this.listInstance.getListViewTopMenuContainer();\n\t\t\tthis.contentContainer = this.listInstance.getListViewContainer();\n\t\t\tthis.registerTileSizeChange(topMenuContainer);\n\t\t\tthis.setHeightOfTiles();\n\t\t\tthis.registerTileClickEvent(this.contentContainer);\n\t\t\tthis.registerImagePreview();\n\t\t}\n\t}\n);\n"],"names":["$","Class","contentContainer","registerTileSizeChange","topMenuContainer","find","on","e","selectedTileSize","currentTarget","attr","text","app","setMainParams","urlParams","viewname","listInstance","getCurrentCvId","search_key","getAlphabetSearchField","search_value","search_params","advancedConditions","tile_size","val","data","getListViewRecords","done","updatePagination","setHeightOfTiles","stopPropagation","maxHeight","tiles","each","height","registerTileClickEvent","tileContainer","target","hasClass","closest","is","parent","recordUrl","window","location","href","registerImagePreview","moduleName","length","getModuleName","recordId","url","showModalWindow","modalWindow","imageSrc","nodeName","css","replace","registerEvents","Vtiger_List_Js","getListViewTopMenuContainer","getListViewContainer"],"mappings":"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"}