{"version":3,"file":"Tiles.min.js","sources":["Tiles.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n$.Class(\n\t'Vtiger_Tiles_Js',\n\t{},\n\t{\n\t\tcontentContainer: false,\n\t\t/**\n\t\t * Register tiles size change action\n\t\t * @param {jQuery} topMenuContainer\n\t\t */\n\t\tregisterTileSizeChange: function (topMenuContainer) {\n\t\t\ttopMenuContainer.find('.js-tile-size').on('click', (e) => {\n\t\t\t\tlet selectedTileSize = $(e.currentTarget).attr('data-tile-size');\n\t\t\t\ttopMenuContainer.find('.js-tile-dropdown-title').text($(e.currentTarget).text());\n\t\t\t\ttopMenuContainer.find('.js-selected-tile-size').attr('data-selected-tile-size', selectedTileSize);\n\t\t\t\tapp.setMainParams('pageNumber', '1');\n\t\t\t\tapp.setMainParams('pageToJump', '1');\n\t\t\t\tlet urlParams = {\n\t\t\t\t\tviewname: this.listInstance.getCurrentCvId(),\n\t\t\t\t\tsearch_key: this.listInstance.getAlphabetSearchField(),\n\t\t\t\t\tsearch_value: '',\n\t\t\t\t\tsearch_params: '',\n\t\t\t\t\tadvancedConditions: '',\n\t\t\t\t\ttile_size: selectedTileSize\n\t\t\t\t};\n\t\t\t\tthis.contentContainer.find('#recordsCount').val('');\n\t\t\t\tthis.contentContainer.find('#totalPageCount').text('');\n\t\t\t\ttopMenuContainer.find('.pagination').data('totalCount', 0);\n\t\t\t\tthis.listInstance.getListViewRecords(urlParams).done(() => {\n\t\t\t\t\tthis.listInstance.updatePagination(1);\n\t\t\t\t\tthis.setHeightOfTiles(this.contentContainer);\n\t\t\t\t});\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Adjust height tile to the highest\n\t\t */\n\t\tsetHeightOfTiles: function () {\n\t\t\tlet maxHeight = -1;\n\t\t\tlet tiles = this.contentContainer.find('.js-tile-card');\n\t\t\ttiles.each(function () {\n\t\t\t\tmaxHeight = maxHeight > $(this).height() ? maxHeight : $(this).height();\n\t\t\t});\n\t\t\ttiles.each(function () {\n\t\t\t\t$(this).height(maxHeight);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register the click on the tile\n\t\t * @param {jQuery} tileContainer\n\t\t */\n\t\tregisterTileClickEvent: function (tileContainer) {\n\t\t\ttileContainer.on('click', '.js-card-body', function (e) {\n\t\t\t\tif ($(e.target).hasClass('js-show-image-preview')) return;\n\t\t\t\tif ($(e.target).closest('div').hasClass('actions')) return;\n\t\t\t\tif ($(e.target).is('button') || $(e.target).parent().is('button')) return;\n\t\t\t\tif ($(e.target).closest('a').hasClass('noLinkBtn')) return;\n\t\t\t\tif ($(e.target).is('input[type=\"checkbox\"]')) return;\n\t\t\t\tlet recordUrl = $(e.target).closest('.js-tile-container').data('recordurl');\n\t\t\t\tif (typeof recordUrl !== 'undefined') {\n\t\t\t\t\twindow.location.href = recordUrl;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will give you all the list view params\n\t\t * @param {string} urlParams\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tthis.listInstance.getListViewRecords(urlParams).done(() => {\n\t\t\t\tthis.setHeightOfTiles(this.contentContainer);\n\t\t\t});\n\t\t},\n\t\tregisterImagePreview() {\n\t\t\tthis.contentContainer.on('click', '.js-show-image-preview', (e) => {\n\t\t\t\tconst moduleName = this.contentContainer.find('[name=\"module\"]').length\n\t\t\t\t\t? this.contentContainer.find('[name=\"module\"]').val()\n\t\t\t\t\t: app.getModuleName();\n\t\t\t\tconst recordId = $(e.target).closest('.js-tile-container').attr('data-record-id');\n\t\t\t\tconst url = `index.php?module=${moduleName}&view=ImagePreview&record=${recordId}`;\n\t\t\t\tapp.showModalWindow('', url, (modalWindow) => {\n\t\t\t\t\tlet imageSrc = '';\n\t\t\t\t\tif ('IMG' === e.target.nodeName) {\n\t\t\t\t\t\timageSrc = $(e.target).attr('src');\n\t\t\t\t\t} else {\n\t\t\t\t\t\timageSrc = $(e.target).css('background-image');\n\t\t\t\t\t\timageSrc = imageSrc.replace('url(\"', '');\n\t\t\t\t\t\timageSrc = imageSrc.replace('\")', '');\n\t\t\t\t\t}\n\t\t\t\t\tmodalWindow.find('img.js-image-preview').attr('src', imageSrc);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.listInstance = new Vtiger_List_Js();\n\t\t\tthis.listInstance.registerEvents();\n\t\t\tconst topMenuContainer = this.listInstance.getListViewTopMenuContainer();\n\t\t\tthis.contentContainer = this.listInstance.getListViewContainer();\n\t\t\tthis.registerTileSizeChange(topMenuContainer);\n\t\t\tthis.setHeightOfTiles();\n\t\t\tthis.registerTileClickEvent(this.contentContainer);\n\t\t\tthis.registerImagePreview();\n\t\t}\n\t}\n);\n"],"names":["$","Class","contentContainer","registerTileSizeChange","topMenuContainer","find","on","e","currentTarget","attr","text","selectedTileSize","app","setMainParams","urlParams","viewname","listInstance","getCurrentCvId","search_key","getAlphabetSearchField","search_value","search_params","advancedConditions","tile_size","val","data","getListViewRecords","done","updatePagination","setHeightOfTiles","stopPropagation","tiles","each","maxHeight","height","registerTileClickEvent","tileContainer","target","hasClass","closest","is","parent","recordUrl","window","location","href","registerImagePreview","length","getModuleName","recordId","url","moduleName","showModalWindow","modalWindow","nodeName","imageSrc","css","replace","registerEvents","Vtiger_List_Js","getListViewTopMenuContainer","getListViewContainer"],"mappings":"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"}