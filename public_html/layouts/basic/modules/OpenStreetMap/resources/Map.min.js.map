{"version":3,"file":"Map.min.js","sources":["Map.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"OpenStreetMap_Map_Js\", {}, {\n\tcontainer: false,\n\tmapInstance: false,\n\tselectedParams: false,\n\tlayerMarkers: false,\n\tmarkers: false,\n\tcacheMarkers: [],\n\tpolygonLayer: false,\n\trouteLayer: false,\n\trecordsIds: '',\n\tcacheLayerMarkers: {},\n\tindirectPointLayer: {},\n\tsetSelectedParams: function (params) {\n\t\tdelete params['view'];\n\t\tthis.selectedParams = params;\n\t},\n\tregisterMap: function (startCoordinate, startZoom) {\n\t\tvar myMap = L.map('mapid').setView(startCoordinate, startZoom);\n\t\tL.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n\t\t\tmaxZoom: 19,\n\t\t\tattribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\" rel=\"noreferrer noopener\">OpenStreetMap</a>'\n\n\t\t}).addTo(myMap);\n\t\tthis.mapInstance = myMap;\n\t\treturn myMap;\n\t},\n\tsetMarkersByResponse: function (response) {\n\t\tvar thisInstance = this;\n\t\tvar markerArray = [];\n\t\tvar container = this.container;\n\t\tvar map = this.mapInstance;\n\t\tif (typeof response.result.coordinates !== \"undefined\") {\n\t\t\tvar markers = L.markerClusterGroup({\n\t\t\t\tmaxClusterRadius: 10\n\t\t\t});\n\t\t\tvar coordinates = response.result.coordinates;\n\t\t\tif (typeof this.layerMarkers !== 'boolean') {\n\t\t\t\tmap.removeLayer(this.layerMarkers);\n\t\t\t}\n\t\t\tvar records = [];\n\t\t\tcoordinates.forEach(function (e) {\n\t\t\t\tmarkerArray.push([e.lat, e.lon]);\n\t\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\tmarkerColor: 'blue',\n\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\ticonColor: e.color\n\t\t\t\t\t})\n\t\t\t\t}).bindPopup(e.label);\n\t\t\t\tmarkers.addLayer(marker);\n\t\t\t\trecords.push(e.recordId);\n\t\t\t});\n\t\t\tthis.recordsIds = records;\n\t\t\tthis.markers = coordinates;\n\t\t\tthis.layerMarkers = markers;\n\t\t\tmap.addLayer(markers);\n\t\t}\n\t\tif (typeof this.polygonLayer !== 'boolean') {\n\t\t\tmap.removeLayer(this.polygonLayer);\n\t\t}\n\t\tif (typeof response.result.coordinatesCeneter !== \"undefined\") {\n\t\t\tif (typeof response.result.coordinatesCeneter.error === \"undefined\") {\n\t\t\t\tvar radius = container.find('.js-radius').val();\n\t\t\t\tmarkerArray.push([response.result.coordinatesCeneter.lat, response.result.coordinatesCeneter.lon]);\n\t\t\t\tvar popup = '<span class=\"description\">' + container.find('.searchValue').val() + '</span><br /><input type=hidden class=\"coordinates\" data-lon=\"' + response.result.coordinatesCeneter.lon + '\" data-lat=\"' + response.result.coordinatesCeneter.lat + '\">';\n\t\t\t\tpopup += '<button class=\"btn btn-success btn-sm p-1 startTrack mr-2\"><span class=\"fas  fa-truck\"></span></button>';\n\t\t\t\tpopup += '<button class=\"btn btn-danger btn-sm p-1 endTrack\"><span class=\"fas fa-flag-checkered\"></span></button>';\n\t\t\t\tvar marker = L.marker([response.result.coordinatesCeneter.lat, response.result.coordinatesCeneter.lon], {\n\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\ticon: 'search',\n\t\t\t\t\t\tmarkerColor: 'red',\n\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t})\n\t\t\t\t}).bindPopup(popup);\n\t\t\t\tmap.addLayer(marker);\n\t\t\t\tif ($.isNumeric(radius)) {\n\t\t\t\t\tradius = parseInt(radius) * 1000;\n\t\t\t\t\tvar circle = L.circle([response.result.coordinatesCeneter.lat, response.result.coordinatesCeneter.lon], radius, {\n\t\t\t\t\t\tcolor: 'red',\n\t\t\t\t\t\tfillColor: '#f03',\n\t\t\t\t\t\tfillOpacity: 0.05\n\t\t\t\t\t});\n\t\t\t\t\tthis.polygonLayer = L.featureGroup([circle]);\n\t\t\t\t\tmap.addLayer(this.polygonLayer);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar params = {\n\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\t\ttext: response.result.coordinatesCeneter.error,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t}\n\t\t}\n\t\tif (typeof response.result.cache !== \"undefined\") {\n\t\t\tvar cache = response.result.cache;\n\t\t\tObject.keys(cache).forEach(function (key) {\n\t\t\t\tif (typeof thisInstance.cacheLayerMarkers[key] !== \"undefined\") {\n\t\t\t\t\tmap.removeLayer(thisInstance.cacheLayerMarkers[key]);\n\t\t\t\t}\n\t\t\t\tvar markersCache = L.markerClusterGroup({\n\t\t\t\t\tmaxClusterRadius: 10\n\t\t\t\t});\n\t\t\t\tcoordinates = cache[key];\n\t\t\t\tcoordinates.forEach(function (e) {\n\t\t\t\t\tif (thisInstance.recordsIds.indexOf(e.recordId) === -1) {\n\t\t\t\t\t\tmarkerArray.push([e.lat, e.lon]);\n\t\t\t\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\t\t\tmarkerColor: 'orange',\n\t\t\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\t\t\ticonColor: e.color\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}).bindPopup(e.label);\n\t\t\t\t\t\tmarkersCache.addLayer(marker);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.cacheMarkers[key] = coordinates;\n\t\t\t\tmap.addLayer(markersCache);\n\t\t\t\tthisInstance.cacheLayerMarkers[key] = markersCache;\n\t\t\t});\n\t\t}\n\n\t\tvar footer = this.container.find('.modal-footer');\n\t\tif (typeof response.result.legend !== \"undefined\") {\n\t\t\tvar html = '';\n\t\t\tvar legend = response.result.legend;\n\t\t\tlegend.forEach(function (e) {\n\t\t\t\thtml += '<div class=\"pull-left\"><span class=\"leegendIcon\" style=\"background:' + e.color + '\"></span> ' + e.value + '</div>';\n\t\t\t});\n\t\t\tfooter.html(html);\n\t\t} else {\n\t\t\tfooter.html('');\n\t\t}\n\t\tif (markerArray.length)\n\t\t\tmap.fitBounds(markerArray);\n\t\tthis.container.find('.groupNeighbours').prop('checked', true);\n\t},\n\tshowCalculateBtn: function () {\n\t\tvar container = this.container;\n\t\tvar endAddress = container.find('.end').val();\n\t\tvar startAddress = container.find('.start').val();\n\t\tif (endAddress.length > 0 && startAddress.length > 0) {\n\t\t\tcontainer.find('.calculateTrack').removeClass('d-none');\n\t\t}\n\t},\n\tregisterCacheEvents: function (container) {\n\t\tvar thisInstance = this;\n\t\tcontainer.find('.showRecordsFromCache').on('change', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar moduleName = currentTarget.data('module');\n\t\t\tif (currentTarget.is(':checked')) {\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\t\taction: 'GetMarkers',\n\t\t\t\t\tsrcModule: app.getModuleName(),\n\t\t\t\t\tcache: [moduleName],\n\t\t\t\t};\n\t\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\t\tthisInstance.setMarkersByResponse(response);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthisInstance.mapInstance.removeLayer(thisInstance.cacheLayerMarkers[moduleName]);\n\t\t\t}\n\n\t\t});\n\t\tcontainer.find('.copyToClipboard').on('click', function () {\n\t\t\tvar params = {\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'ClipBoard',\n\t\t\t\tmode: 'save',\n\t\t\t\trecordIds: JSON.stringify(thisInstance.recordsIds),\n\t\t\t\tsrcModule: app.getModuleName()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\ttext: app.vtranslate('JS_NOTIFY_COPY_TEXT'),\n\t\t\t\t\ttype: 'success',\n\t\t\t\t});\n\t\t\t\tvar countRecords = container.find('.countRecords' + app.getModuleName());\n\t\t\t\tcountRecords.html(response.result);\n\t\t\t\tcountRecords.closest('.cacheModuleContainer').find('.deleteClipBoard').removeClass('d-none');\n\t\t\t});\n\t\t});\n\t\tcontainer.find('.deleteClipBoard').on('click', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar moduleName = currentTarget.data('module');\n\t\t\tvar params = {\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'ClipBoard',\n\t\t\t\tmode: 'delete',\n\t\t\t\tsrcModule: moduleName\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\ttype: 'success',\n\t\t\t\t});\n\t\t\t\tvar countRecords = container.find('.countRecords' + moduleName);\n\t\t\t\tcountRecords.html('');\n\t\t\t\tcurrentTarget.addClass('d-none');\n\t\t\t\tcountRecords.closest('.cacheModuleContainer').find('.showRecordsFromCache').prop('checked', false);\n\t\t\t\tcountRecords.closest('.cacheModuleContainer').find('.showRecordsFromCache').trigger('change');\n\t\t\t});\n\t\t});\n\t\tcontainer.find('.addAllRecords').on('click', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar moduleName = currentTarget.data('module');\n\t\t\tvar params = {\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'ClipBoard',\n\t\t\t\tmode: 'addAllRecords',\n\t\t\t\tsrcModule: moduleName\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\ttext: app.vtranslate('JS_MESSAGE_DOWNLOADED_ADDRESS_DATA'),\n\t\t\t\t\ttype: 'success',\n\t\t\t\t});\n\t\t\t\tcontainer.find('.countRecords' + moduleName).html(response.result.count);\n\t\t\t\tvar moduleContainer = currentTarget.closest('.cacheModuleContainer');\n\t\t\t\tmoduleContainer.find('.showRecordsFromCache').prop('checked', true);\n\t\t\t\tmoduleContainer.find('.showRecordsFromCache').trigger('change');\n\t\t\t\tif (response.result.count != '0')\n\t\t\t\t\tmoduleContainer.find('.deleteClipBoard').removeClass('d-none');\n\t\t\t});\n\t\t});\n\t},\n\tgetCacheParamsToRequest: function () {\n\t\tvar container = this.container;\n\t\tvar params = [];\n\t\tcontainer.find('.showRecordsFromCache').each(function () {\n\t\t\tvar currentObject = $(this);\n\t\t\tif (currentObject.is(':checked'))\n\t\t\t\tparams.push(currentObject.data('module'));\n\t\t});\n\t\treturn params;\n\t},\n\tregisterSearchCompany: function () {\n\t\tvar container = this.container;\n\t\tvar searchValue = container.find('.searchCompany');\n\t\tvar searchModule = container.find('.searchModule');\n\t\tvar addButton = container.find('.addRecord');\n\t\tvar thistInstance = this;\n\t\taddButton.on('click', function () {\n\t\t\tvar map = thistInstance.mapInstance;\n\t\t\tvar markers = thistInstance.layerMarkers;\n\t\t\tvar crmId = addButton.data('crmId');\n\t\t\tif (crmId == '')\n\t\t\t\treturn false;\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'ClipBoard',\n\t\t\t\tmode: 'addRecord',\n\t\t\t\trecord: crmId,\n\t\t\t\tsrcModuleName: searchModule.val()\n\t\t\t}).done(function (response) {\n\t\t\t\taddButton.data('crmId', '');\n\t\t\t\tif (response.result.length == 1) {\n\t\t\t\t\tvar marker = L.marker([response.result[0].lat, response.result[0].lon], {\n\t\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\t\tmarkerColor: 'cadetblue',\n\t\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\t\ticonColor: response.result[0].color\n\t\t\t\t\t\t})\n\t\t\t\t\t}).bindPopup(response.result[0].label);\n\t\t\t\t\tmarkers.addLayer(marker);\n\t\t\t\t\tmap.addLayer(markers);\n\t\t\t\t\tmap.setView(new L.LatLng(response.result[0].lat, response.result[0].lon), 14);\n\t\t\t\t} else {\n\t\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\t\t\ttext: response.result,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tsearchValue.val('');\n\t\t\t});\n\t\t});\n\t\t$.widget(\"custom.ivAutocomplete\", $.ui.autocomplete, {\n\t\t\t_create: function () {\n\t\t\t\tthis._super();\n\t\t\t\tthis.widget().menu(\"option\", \"items\", \"> :not(.ui-autocomplete-category)\");\n\t\t\t},\n\t\t\t_renderMenu: function (ul, items) {\n\t\t\t\tvar that = this, currentCategory = \"\";\n\t\t\t\t$.each(items, function (index, item) {\n\t\t\t\t\tvar li;\n\t\t\t\t\tif (item.category != currentCategory) {\n\t\t\t\t\t\tul.append(\"<li class='ui-autocomplete-category'>\" + item.category + \"</li>\");\n\t\t\t\t\t\tcurrentCategory = item.category;\n\t\t\t\t\t}\n\t\t\t\t\tthat._renderItemData(ul, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\t_renderItemData: function (ul, item) {\n\t\t\t\treturn this._renderItem(ul, item).data(\"ui-autocomplete-item\", item);\n\t\t\t},\n\t\t\t_renderItem: function (ul, item) {\n\t\t\t\treturn $(\"<li>\")\n\t\t\t\t\t.data(\"item.autocomplete\", item)\n\t\t\t\t\t.append($(\"<a></a>\").html(item.label))\n\t\t\t\t\t.appendTo(ul);\n\t\t\t},\n\t\t});\n\t\tsearchValue.ivAutocomplete({\n\t\t\tdelay: '600',\n\t\t\tminLength: '3',\n\t\t\tsource: function (request, response) {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: searchModule.val(),\n\t\t\t\t\tcurentModule: app.getModuleName(),\n\t\t\t\t\tsearchModule: searchModule.val(),\n\t\t\t\t\tview: 'BasicAjax',\n\t\t\t\t\tmode: 'showSearchResults',\n\t\t\t\t\tvalue: searchValue.val(),\n\t\t\t\t\thtml: false,\n\t\t\t\t}).done(function (responseAjax) {\n\t\t\t\t\tresponseAjax = JSON.parse(responseAjax);\n\t\t\t\t\tvar reponseDataList = responseAjax.result;\n\t\t\t\t\tif (reponseDataList.length <= 0) {\n\t\t\t\t\t\treponseDataList.push({\n\t\t\t\t\t\t\tlabel: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\t\t\ttype: 'no results',\n\t\t\t\t\t\t\tcategory: ''\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tresponse(reponseDataList);\n\t\t\t\t});\n\t\t\t},\n\t\t\tselect: function (event, ui) {\n\t\t\t\tvar selected = ui.item;\n\t\t\t\taddButton.data('crmId', selected.id);\n\t\t\t},\n\t\t\tclose: function (event, ui) {\n\n\t\t\t}\n\n\t\t});\n\t},\n\tregisterBasicModal: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = this.container;\n\t\tvar map = thisInstance.mapInstance;\n\t\tvar layer, description;\n\t\tthisInstance.registerCacheEvents(container);\n\t\tcontainer.find('.groupBy').on('click', function () {\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': container,\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'GetMarkers',\n\t\t\t\tsrcModule: app.getModuleName(),\n\t\t\t\tgroupBy: container.find('.fieldsToGroup').val(),\n\t\t\t\tsearchValue: container.find('.searchValue').val(),\n\t\t\t\tradius: container.find('.js-radius').val(),\n\t\t\t\tcache: thisInstance.getCacheParamsToRequest(),\n\t\t\t};\n\t\t\tparams = $.extend(thisInstance.selectedParams, params);\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tthisInstance.setMarkersByResponse(response);\n\t\t\t});\n\t\t});\n\t\tcontainer.find('.groupNeighbours').on('change', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tmap.removeLayer(thisInstance.layerMarkers);\n\t\t\tvar markers = thisInstance.markers;\n\t\t\tif (currentTarget.is(':checked')) {\n\t\t\t\tlayer = L.markerClusterGroup({\n\t\t\t\t\tmaxClusterRadius: 10\n\t\t\t\t});\n\t\t\t\tmarkers.forEach(function (e) {\n\t\t\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\t\tmarkerColor: 'blue',\n\t\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\t\ticonColor: e.color\n\t\t\t\t\t\t})\n\t\t\t\t\t}).bindPopup(e.label);\n\t\t\t\t\tlayer.addLayer(marker);\n\t\t\t\t});\n\n\t\t\t\tObject.keys(thisInstance.cacheLayerMarkers).forEach(function (key) {\n\t\t\t\t\tmap.removeLayer(thisInstance.cacheLayerMarkers[key]);\n\t\t\t\t\tvar cacheLayer = L.markerClusterGroup({\n\t\t\t\t\t\tmaxClusterRadius: 10\n\t\t\t\t\t});\n\t\t\t\t\tthisInstance.cacheMarkers[key].forEach(function (e) {\n\t\t\t\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\t\t\tmarkerColor: 'orange',\n\t\t\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\t\t\ticonColor: e.color\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}).bindPopup(e.label);\n\t\t\t\t\t\tcacheLayer.addLayer(marker);\n\t\t\t\t\t});\n\t\t\t\t\tthisInstance.cacheLayerMarkers[key] = cacheLayer;\n\t\t\t\t\tmap.addLayer(cacheLayer);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvar markerArray = [];\n\t\t\t\tmarkers.forEach(function (e) {\n\t\t\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\t\tmarkerColor: 'blue',\n\t\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\t\ticonColor: e.color\n\t\t\t\t\t\t})\n\t\t\t\t\t}).bindPopup(e.label);\n\t\t\t\t\tmarkerArray.push(marker);\n\t\t\t\t});\n\t\t\t\tlayer = L.featureGroup(markerArray);\n\t\t\t\tObject.keys(thisInstance.cacheLayerMarkers).forEach(function (key) {\n\t\t\t\t\tmap.removeLayer(thisInstance.cacheLayerMarkers[key]);\n\t\t\t\t\tvar markerArray = [];\n\t\t\t\t\tthisInstance.cacheMarkers[key].forEach(function (e) {\n\t\t\t\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\t\t\ticon: 'home',\n\t\t\t\t\t\t\t\tmarkerColor: 'orange',\n\t\t\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\t\t\ticonColor: e.color\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}).bindPopup(e.label);\n\t\t\t\t\t\tmarkerArray.push(marker);\n\t\t\t\t\t});\n\t\t\t\t\tthisInstance.cacheLayerMarkers[key] = L.featureGroup(markerArray);\n\t\t\t\t\tmap.addLayer(thisInstance.cacheLayerMarkers[key]);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthisInstance.layerMarkers = layer;\n\t\t\tmap.addLayer(layer);\n\t\t});\n\t\tcontainer.find('.searchBtn').on('click', function (e) {\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': container,\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'GetMarkers',\n\t\t\t\tsrcModule: app.getModuleName(),\n\t\t\t\tsearchValue: container.find('.searchValue').val(),\n\t\t\t\tcache: thisInstance.getCacheParamsToRequest(),\n\t\t\t};\n\t\t\tvar radiusValue = container.find('.js-radius').val();\n\t\t\tif (radiusValue !== '' && parseInt(radiusValue)) {\n\t\t\t\tparams['radius'] = radiusValue;\n\t\t\t}\n\t\t\tparams = $.extend(thisInstance.selectedParams, params);\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tthisInstance.setMarkersByResponse(response);\n\t\t\t});\n\t\t});\n\t\tvar startIconLayer = false;\n\t\tcontainer.on('click', '.startTrack', function (e) {\n\t\t\tif (startIconLayer) {\n\t\t\t\tmap.removeLayer(startIconLayer);\n\t\t\t}\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar containerPopup = currentTarget.closest('.leaflet-popup-content');\n\t\t\tdescription = containerPopup.find('.description').html();\n\t\t\tvar startElement = container.find('.start');\n\t\t\tvar coordinates = containerPopup.find('.coordinates');\n\t\t\tdescription = description.replace(/\\<br\\>/gi, \", \");\n\t\t\tstartElement.val(description);\n\t\t\tstartElement.data('lat', coordinates.data('lat'));\n\t\t\tstartElement.data('lon', coordinates.data('lon'));\n\t\t\tvar marker = L.marker([coordinates.data('lat'), coordinates.data('lon')], {\n\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\ticon: 'truck',\n\t\t\t\t\tmarkerColor: 'green',\n\t\t\t\t\tprefix: 'fa',\n\t\t\t\t})\n\t\t\t}).bindPopup(containerPopup.html());\n\t\t\tstartIconLayer = L.featureGroup([marker]);\n\t\t\tmap.addLayer(startIconLayer);\n\t\t\tthisInstance.showCalculateBtn();\n\t\t});\n\t\tvar endIconLayer = false;\n\t\tcontainer.on('click', '.endTrack', function (e) {\n\t\t\tif (endIconLayer) {\n\t\t\t\tmap.removeLayer(endIconLayer);\n\t\t\t}\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar containerPopup = currentTarget.closest('.leaflet-popup-content');\n\t\t\tdescription = containerPopup.find('.description').html();\n\t\t\tvar endElement = container.find('.end');\n\t\t\tvar coordinates = containerPopup.find('.coordinates');\n\t\t\tdescription = description.replace(/\\<br\\>/gi, \", \");\n\t\t\tendElement.val(description);\n\t\t\tendElement.data('lat', coordinates.data('lat'));\n\t\t\tendElement.data('lon', coordinates.data('lon'));\n\t\t\tvar marker = L.marker([coordinates.data('lat'), coordinates.data('lon')], {\n\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\ticon: 'flag-checkered',\n\t\t\t\t\tmarkerColor: 'red',\n\t\t\t\t\tprefix: 'fa',\n\t\t\t\t})\n\t\t\t}).bindPopup(containerPopup.html());\n\t\t\tendIconLayer = L.featureGroup([marker]);\n\t\t\tmap.addLayer(endIconLayer);\n\t\t\tthisInstance.showCalculateBtn();\n\t\t});\n\n\t\tcontainer.on('click', '.indirectPoint', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar containerPopup = currentTarget.closest('.leaflet-popup-content');\n\t\t\tdescription = containerPopup.find('.description').html();\n\t\t\tvar template = container.find('.indirectTemplate');\n\t\t\tvar indirect = template.clone();\n\t\t\ttemplate.before(indirect);\n\t\t\tindirect.removeClass('indirectTemplate');\n\t\t\tindirect.removeClass('d-none');\n\t\t\tvar coordinates = containerPopup.find('.coordinates');\n\t\t\tdescription = description.replace(/\\<br\\>/gi, \", \");\n\t\t\tif (typeof thisInstance.indirectPointLayer[description] !== \"undefined\") {\n\t\t\t\tmap.removeLayer(thisInstance.indirectPointLayer[description]);\n\t\t\t}\n\t\t\tvar indirectField = indirect.find('.indirect');\n\t\t\tindirectField.val(description);\n\t\t\tindirectField.data('lat', coordinates.data('lat'));\n\t\t\tindirectField.data('lon', coordinates.data('lon'));\n\t\t\tvar marker = L.marker([coordinates.data('lat'), coordinates.data('lon')], {\n\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\ticon: 'flag',\n\t\t\t\t\tmarkerColor: 'orange',\n\t\t\t\t\tprefix: 'fa',\n\t\t\t\t})\n\t\t\t}).bindPopup(containerPopup.html());\n\t\t\tthisInstance.indirectPointLayer[description] = L.featureGroup([marker]);\n\t\t\tmap.addLayer(thisInstance.indirectPointLayer[description]);\n\t\t});\n\t\tcontainer.on('click', '.removeIndirect', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar container = currentTarget.closest('.indirectContainer');\n\t\t\tmap.removeLayer(thisInstance.indirectPointLayer[container.find('.indirect').val()]);\n\t\t\tcurrentTarget.closest('.indirectContainer').remove();\n\t\t});\n\t\tcontainer.on('click', '.moveUp', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar container = currentTarget.closest('.indirectContainer');\n\t\t\tvar previousElement = container.prev();\n\t\t\tif (!previousElement.hasClass('startContainer')) {\n\t\t\t\tpreviousElement.before(container);\n\t\t\t}\n\t\t});\n\t\tcontainer.on('click', '.moveDown', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar container = currentTarget.closest('.indirectContainer');\n\t\t\tvar nextElement = container.next();\n\t\t\tif (!nextElement.hasClass('indirectTemplate')) {\n\t\t\t\tnextElement.after(container);\n\t\t\t}\n\t\t});\n\t\tcontainer.on('click', '.searchInRadius', function (e) {\n\t\t\tif (endIconLayer) {\n\t\t\t\tmap.removeLayer(endIconLayer);\n\t\t\t}\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar containerPopup = currentTarget.closest('.leaflet-popup-content');\n\t\t\tvar coordinates = containerPopup.find('.coordinates');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': container,\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {\n\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\taction: 'GetMarkers',\n\t\t\t\tsrcModule: app.getModuleName(),\n\t\t\t\tradius: container.find('.radius').val(),\n\t\t\t\tlat: coordinates.data('lat'),\n\t\t\t\tlon: coordinates.data('lon'),\n\t\t\t\tcache: thisInstance.getCacheParamsToRequest(),\n\t\t\t};\n\t\t\tparams = $.extend(thisInstance.selectedParams, params);\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tthisInstance.setMarkersByResponse(response);\n\t\t\t});\n\t\t});\n\t\tcontainer.find('.calculateTrack').on('click', function () {\n\t\t\tvar indirectLon = [];\n\t\t\tvar indirectLat = [];\n\t\t\tcontainer.find('.indirectContainer:not(.d-none) input.indirect').each(function () {\n\t\t\t\tvar currentTarget = $(this);\n\t\t\t\tindirectLat.push(currentTarget.data('lat'));\n\t\t\t\tindirectLon.push(currentTarget.data('lon'));\n\t\t\t});\n\t\t\tvar endElement = container.find('.end');\n\t\t\tvar startElement = container.find('.start');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': container,\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {\n\t\t\t\turl: 'index.php',\n\t\t\t\tdata: {\n\t\t\t\t\tmodule: 'OpenStreetMap',\n\t\t\t\t\taction: 'GetRoute',\n\t\t\t\t\tflon: startElement.data('lon'),\n\t\t\t\t\tflat: startElement.data('lat'),\n\t\t\t\t\tilon: indirectLon,\n\t\t\t\t\tilat: indirectLat,\n\t\t\t\t\ttlon: endElement.data('lon'),\n\t\t\t\t\ttlat: endElement.data('lat')\n\t\t\t\t}\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({mode: 'hide'});\n\t\t\t\tif (thisInstance.routeLayer) {\n\t\t\t\t\tmap.removeLayer(thisInstance.routeLayer);\n\t\t\t\t}\n\t\t\t\tvar route = L.geoJson(response.result.geoJson);\n\t\t\t\tthisInstance.routeLayer = L.featureGroup([route]);\n\t\t\t\tmap.addLayer(thisInstance.routeLayer);\n\t\t\t\tcontainer.find('.descriptionContainer').removeClass('d-none');\n\t\t\t\tcontainer.find('.descriptionContent .instruction').html(response.result.properties.description);\n\t\t\t\tcontainer.find('.descriptionContent .distance').html(App.Fields.Double.formatToDisplay(response.result.properties.distance));\n\t\t\t\tcontainer.find('.descriptionContent .travelTime').html(App.Fields.Double.formatToDisplay(response.result.properties.traveltime / 60));\n\t\t\t});\n\t\t});\n\t\tcontainer.on('click', '.setView', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar inputInstance = currentTarget.closest('.input-group').find('.end,.start,.indirect');\n\t\t\tvar lat = inputInstance.data('lat');\n\t\t\tvar lon = inputInstance.data('lon');\n\t\t\tif (!(typeof lat === \"undefined\" && typeof lon === \"undefined\")) {\n\t\t\t\tmap.setView(new L.LatLng(lat, lon), 14);\n\t\t\t}\n\t\t});\n\t\tthis.registerSearchCompany();\n\t},\n\tregisterModalView: function (container) {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': container,\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar heightMap = $('body').height();\n\t\tthis.container = container;\n\t\tvar startCoordinate = [0, 0];\n\t\tvar startZoom = 2;\n\t\t$('#mapid').css({\n\t\t\theight: heightMap - 200\n\t\t});\n\t\tthis.registerMap(startCoordinate, startZoom);\n\t\tvar params = {\n\t\t\tmodule: 'OpenStreetMap',\n\t\t\taction: 'GetMarkers',\n\t\t\tsrcModule: app.getModuleName(),\n\t\t};\n\t\tparams = $.extend(this.selectedParams, params);\n\t\tthisInstance.registerBasicModal();\n\t\tAppConnector.request(params).done(function (response) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\tthisInstance.setMarkersByResponse(response);\n\n\t\t});\n\t},\n\tregisterDetailView: function (container) {\n\t\tthis.container = container;\n\t\tvar coordinates = container.find('#coordinates').val();\n\t\tcoordinates = JSON.parse(coordinates);\n\t\tvar startCoordinate = [0, 0];\n\t\tvar startZoom = 2;\n\t\tvar $map = container.find('#mapid');\n\t\tif (coordinates.length) {\n\t\t\tstartCoordinate = coordinates[0];\n\t\t\tstartZoom = 6;\n\t\t}\n\t\tif ($('.mainBody').length) {\n\t\t\tif ($('.mainBody').height() < 1000) {\n\t\t\t\t$map.height($('.mainBody').height() - ($('.detailViewTitle').height() + $('.detailViewContainer .related').height() + 25));\n\t\t\t} else {\n\t\t\t\t$map.height(1000);\n\t\t\t}\n\t\t} else {\n\t\t\tif ($('.bodyContents').height() < 1000) {\n\t\t\t\t$map.height($('.bodyContents').height() - ($('.detailViewTitle').height() + $('.detailViewContainer .related').height() + 25));\n\t\t\t} else {\n\t\t\t\t$map.height(1000);\n\t\t\t}\n\t\t}\n\n\t\tvar myMap = this.registerMap(startCoordinate, startZoom);\n\t\tvar markers = L.markerClusterGroup({\n\t\t\tmaxClusterRadius: 10\n\t\t});\n\t\tcoordinates.forEach(function (e) {\n\t\t\tvar marker = L.marker([e.lat, e.lon], {\n\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\ticon: 'home',\n\t\t\t\t\tmarkerColor: 'blue',\n\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\ticonColor: e.color\n\t\t\t\t})\n\t\t\t}).bindPopup(e.label);\n\t\t\tmarkers.addLayer(marker);\n\t\t});\n\t\tmyMap.addLayer(markers);\n\t}\n});\n\n"],"names":["jQuery","Class","params","selectedParams","startCoordinate","startZoom","myMap","L","map","setView","tileLayer","addTo","mapInstance","response","thisInstance","this","markerArray","container","result","coordinates","markers","markerClusterGroup","layerMarkers","removeLayer","records","forEach","e","push","lat","lon","marker","AwesomeMarkers","icon","color","bindPopup","label","addLayer","recordId","recordsIds","polygonLayer","coordinatesCeneter","error","radius","find","val","popup","$","isNumeric","parseInt","circle","featureGroup","app","vtranslate","showMessage","cache","keys","key","cacheLayerMarkers","markersCache","indexOf","cacheMarkers","footer","legend","html","value","length","fitBounds","prop","endAddress","startAddress","removeClass","on","currentTarget","moduleName","data","is","getModuleName","request","done","setMarkersByResponse","JSON","stringify","countRecords","closest","addClass","trigger","count","moduleContainer","each","currentObject","searchValue","searchModule","addButton","thistInstance","crmId","LatLng","widget","ui","autocomplete","_super","menu","ul","items","that","currentCategory","index","item","category","append","_renderItemData","_renderItem","appendTo","ivAutocomplete","responseAjax","reponseDataList","parse","event","selected","id","layer","description","registerCacheEvents","progressIndicatorElement","progressIndicator","getCacheParamsToRequest","extend","mode","cacheLayer","radiusValue","startIconLayer","containerPopup","startElement","replace","showCalculateBtn","endIconLayer","endElement","template","indirect","clone","before","indirectPointLayer","indirectField","remove","previousElement","prev","hasClass","nextElement","next","after","indirectLon","indirectLat","routeLayer","route","geoJson","properties","App","Fields","Double","formatToDisplay","distance","traveltime","inputInstance","registerSearchCompany","heightMap","height","css","registerMap","registerBasicModal","$map"],"mappings":"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"}