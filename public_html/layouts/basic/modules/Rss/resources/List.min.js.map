{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_List_Js(\"Rss_List_Js\", {},\n\t{\n\t\t/**\n\t\t * Function get the height of the document\n\t\t * @return <integer> height\n\t\t */\n\t\tgetDocumentHeight: function () {\n\t\t\treturn jQuery(document).height();\n\t\t},\n\n\t\tregisterRssButtonClickEvent: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '.rssAddButton', function (e) {\n\t\t\t\tthisInstance.showRssModal('getRssAddForm').done(function (data) {\n\t\t\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\tvar form = data.find('#rssAddForm');\n\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\tthisInstance.rssFeedSave(form);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tform.validationEngine(params);\n\t\t\t\t\t};\n\t\t\t\t\tapp.showModalWindow(data, callBackFunction);\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontainer.on('click', '.changeFeedSource', function (e) {\n\t\t\t\tthisInstance.showRssModal('getRssWidget').done(function (data) {\n\t\t\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t\t\tdata.on('click', '.rssLink', function (e) {\n\t\t\t\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\t\t\t\tvar id = element.data('id');\n\t\t\t\t\t\t\tthisInstance.getRssFeeds(id).done(function () {\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\t\t\t\tapp.showModalWindow(data, callBackFunction);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tbreadCrumbsFilter: function (text) {\n\t\t\treturn;\n\t\t},\n\n\t\t/**\n\t\t * Function show rssAddForm model\n\t\t */\n\t\tshowRssModal: function (mode) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar progressInstance = jQuery.progressIndicator({});\n\t\t\tvar actionParams = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'view': 'ViewTypes',\n\t\t\t\t'mode': mode\n\t\t\t};\n\t\t\tAppConnector.request(actionParams).done(\n\t\t\t\tfunction (data) {\n\t\t\t\t\tprogressInstance.progressIndicator({'mode': 'hide'});\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t},\n\t\t\t\tfunction (textStatus, errorThrown) {\n\t\t\t\t}\n\t\t\t);\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to save rss feed\n\t\t * @parm form\n\t\t */\n\t\trssFeedSave: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar data = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'action': 'Save',\n\t\t\t\t'feedurl': data.feedurl\n\t\t\t};\n\t\t\tAppConnector.request(params).done(\n\t\t\t\tfunction (result) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t\t'mode': 'hide'\n\t\t\t\t\t});\n\t\t\t\t\tif (result.result.success) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tthisInstance.getRssFeeds(result.result.id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: app.vtranslate(result.result.message),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Function to get the feeds for specific id\n\t\t * @param <integer> id\n\t\t */\n\t\tgetRssFeeds: function (id) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar container = thisInstance.getListViewContainer();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'view': 'List',\n\t\t\t\t'id': id\n\t\t\t};\n\t\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t\tcontainer.find('#listViewContents').html(data);\n\t\t\t\tthisInstance.setFeedContainerHeight(container);\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t'mode': 'hide'\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to get the height of the Feed Container\n\t\t * @param container\n\t\t */\n\t\tsetFeedContainerHeight: function (container) {\n\t\t\tvar height = this.getDocumentHeight() / 1.5;\n\t\t\tcontainer.find('.feedListContainer').height(height);\n\t\t},\n\n\t\t/**\n\t\t * Function to register the click of feeds\n\t\t * @param container\n\t\t */\n\t\tregisterFeedClickEvent: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '.feedLink', function (e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar url = element.data('url');\n\t\t\t\tvar frameElement = thisInstance.getFrameElement(url);\n\t\t\t\tcontainer.find('.feedFrame').html(frameElement);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to get the iframe element\n\t\t * @param <string> url\n\t\t * @retrun <element> frameElement\n\t\t */\n\t\tgetFrameElement: function (url) {\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar frameElement = jQuery('<iframe>', {\n\t\t\t\tid: 'feedFrame',\n\t\t\t\tscrolling: 'auto',\n\t\t\t\twidth: '100%',\n\t\t\t\theight: this.getDocumentHeight() / 2\n\t\t\t});\n\t\t\tframeElement.addClass('table-bordered');\n\t\t\tthis.getHtml(url).done(function (html) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t'mode': 'hide'\n\t\t\t\t});\n\t\t\t\tvar frame = frameElement[0].contentDocument;\n\t\t\t\tframe.open();\n\t\t\t\tframe.write(html);\n\t\t\t\tframe.close();\n\t\t\t});\n\n\t\t\treturn frameElement;\n\t\t},\n\n\t\t/**\n\t\t * Function to get the html contents from url\n\t\t * @param <string> url\n\t\t * @return <string> html contents\n\t\t */\n\t\tgetHtml: function (url) {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'action': 'GetHtml',\n\t\t\t\t'url': url\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\taDeferred.resolve(data.result.html);\n\t\t\t});\n\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register record delete event\n\t\t */\n\t\tregisterDeleteRecordClickEvent: function () {\n\t\t\tvar container = this.getListViewContainer();\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '#deleteButton', function (e) {\n\t\t\t\tthisInstance.deleteRecord(container);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to delete the record\n\t\t */\n\t\tdeleteRecord: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar recordId = container.find('#recordId').val();\n\t\t\tvar message = app.vtranslate('LBL_DELETE_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(\n\t\t\t\tfunction (e) {\n\t\t\t\t\tvar module = app.getModuleName();\n\t\t\t\t\tvar postData = {\n\t\t\t\t\t\t\"module\": module,\n\t\t\t\t\t\t\"action\": \"DeleteAjax\",\n\t\t\t\t\t\t\"record\": recordId\n\t\t\t\t\t};\n\t\t\t\t\tvar deleteMessage = app.vtranslate('JS_RECORD_GETTING_DELETED');\n\t\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t\t'message': deleteMessage,\n\t\t\t\t\t\t'position': 'html',\n\t\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tAppConnector.request(postData).done(\n\t\t\t\t\t\tfunction (data) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t\t\t\t'mode': 'hide'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\t\t\tthisInstance.getRssFeeds();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate(data.error.message),\n\t\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION')\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfunction (error, err) {\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tfunction (error, err) {\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Function to register make default button click event\n\t\t */\n\t\tregisterMakeDefaultClickEvent: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '#makeDefaultButton', function () {\n\t\t\t\tthisInstance.makeDefault(container);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to make a record as default rss feed\n\t\t */\n\t\tmakeDefault: function (container) {\n\t\t\tvar recordId = container.find('#recordId').val();\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar postData = {\n\t\t\t\t\"module\": module,\n\t\t\t\t\"action\": \"MakeDefaultAjax\",\n\t\t\t\t\"record\": recordId\n\t\t\t};\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(postData).done(\n\t\t\t\tfunction (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\t\t'mode': 'hide'\n\t\t\t\t\t});\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: app.vtranslate(data.result.message),\n\t\t\t\t\t\t\ttype: 'info'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\t\ttext: app.vtranslate(data.error.message),\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION')\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tvar container = this.getListViewContainer();\n\t\t\tthis.registerRssButtonClickEvent(container);\n\t\t\tthis.registerFeedClickEvent(container);\n\t\t\tthis.registerMakeDefaultClickEvent(container);\n\t\t\tthis.setFeedContainerHeight(container);\n\t\t\tthis.registerDeleteRecordClickEvent();\n\t\t}\n\t});\n"],"names":["Vtiger_List_Js","jQuery","document","height","container","thisInstance","this","on","e","showRssModal","done","data","showModalWindow","params","app","validationEngineOptions","form","find","onValidationComplete","valid","rssFeedSave","validationEngine","id","currentTarget","getRssFeeds","hideModalWindow","text","mode","aDeferred","Deferred","progressInstance","progressIndicator","actionParams","getModuleName","request","resolve","textStatus","errorThrown","promise","serializeFormData","progressIndicatorElement","feedurl","result","success","vtranslate","message","showPnotify","getListViewContainer","requestPjax","html","setFeedContainerHeight","getDocumentHeight","url","frameElement","getFrameElement","addClass","getHtml","frame","contentDocument","open","write","close","deleteRecord","recordId","val","showConfirmationBox","postData","deleteMessage","error","err","makeDefault","_super","registerRssButtonClickEvent","registerFeedClickEvent","registerMakeDefaultClickEvent","registerDeleteRecordClickEvent"],"mappings":"aAWAA,eAAe,cAAe,GAC7B,mBAKoB,kBACXC,OAAOC,UAAUC,sCAGI,SAAUC,eAClCC,aAAeC,eACTC,GAAG,QAAS,iBAAiB,SAAUC,gBACnCC,aAAa,iBAAiBC,MAAK,SAAUC,UAYrDC,gBAAgBD,MAXG,SAAUA,UAC5BE,OAASC,IAAIC,wBACbC,KAAOL,KAAKM,KAAK,sBACdC,qBAAuB,SAAUF,KAAMG,cACzCA,oBACUC,YAAYJ,OAEnB,QAEHK,iBAAiBR,2BAKfN,GAAG,QAAS,qBAAqB,SAAUC,gBACvCC,aAAa,gBAAgBC,MAAK,SAAUC,UAWpDC,gBAAgBD,MAVG,SAAUA,WAC3BJ,GAAG,QAAS,YAAY,SAAUC,OAElCc,GADUrB,OAAOO,EAAEe,eACNZ,KAAK,mBACTa,YAAYF,IAAIZ,MAAK,eAC7Be,oDASS,SAAUC,qBAOf,SAAUC,UACnBC,UAAY3B,OAAO4B,WACnBC,iBAAmB7B,OAAO8B,kBAAkB,IAC5CC,aAAe,QACRlB,IAAImB,qBACN,iBACAN,0BAEIO,QAAQF,cAActB,MAClC,SAAUC,uBACQoB,kBAAkB,CAACJ,KAAQ,mBAClCQ,QAAQxB,SAEnB,SAAUyB,WAAYC,iBAGhBT,UAAUU,uBAOL,SAAUtB,UAClBX,aAAeC,KACfK,KAAOK,KAAKuB,oBACZC,yBAA2BvC,OAAO8B,kBAAkB,UAC3C,iBACC,UACD,KAGTlB,OAAS,QACFC,IAAImB,uBACJ,eACCtB,KAAK8B,sBAEJP,QAAQrB,QAAQH,MAC5B,SAAUgC,oCACgBX,kBAAkB,MAClC,SAELW,OAAOA,OAAOC,YACblB,+BACSD,YAAYkB,OAAOA,OAAOpB,QACjC,KACFT,OAAS,OACLC,IAAI8B,WAAW,mBAChB9B,IAAI8B,WAAWF,OAAOA,OAAOG,2BAEnBC,YAAYjC,yBAUpB,SAAUS,QAClBjB,aAAeC,KACfsB,UAAY3B,OAAO4B,WACnBzB,UAAYC,aAAa0C,uBACzBP,yBAA2BvC,OAAO8B,kBAAkB,UAC3C,iBACC,UACD,KAGTlB,OAAS,QACFC,IAAImB,qBACN,UACFX,wBAEM0B,YAAYnC,QAAQH,MAAK,SAAUC,gBACrCwB,QAAQxB,gBACRM,KAAK,qBAAqBgC,KAAKtC,mBAC5BuC,uBAAuB9C,oCACX2B,kBAAkB,MAClC,YAIHH,UAAUU,kCAOM,SAAUlC,eAC7BD,OAASG,KAAK6C,oBAAsB,cAC9BlC,KAAK,sBAAsBd,OAAOA,gCAOrB,SAAUC,eAC7BC,aAAeC,eACTC,GAAG,QAAS,aAAa,SAAUC,OAExC4C,IADUnD,OAAOO,EAAEe,eACLZ,KAAK,OACnB0C,aAAehD,aAAaiD,gBAAgBF,eACtCnC,KAAK,cAAcgC,KAAKI,kCASnB,SAAUD,SACtBZ,yBAA2BvC,OAAO8B,kBAAkB,UAC3C,iBACC,UACD,KAGTsB,aAAepD,OAAO,WAAY,IACjC,sBACO,aACJ,cACCK,KAAK6C,oBAAsB,wBAEvBI,SAAS,uBACjBC,QAAQJ,KAAK1C,MAAK,SAAUuC,+BACPlB,kBAAkB,MAClC,aAEL0B,MAAQJ,aAAa,GAAGK,sBACtBC,aACAC,MAAMX,YACNY,WAGAR,sBAQC,SAAUD,SACdxB,UAAY3B,OAAO4B,WACnBhB,OAAS,QACFC,IAAImB,uBACJ,cACHmB,yBAEKlB,QAAQrB,QAAQH,MAAK,SAAUC,gBACjCwB,QAAQxB,KAAK+B,OAAOO,SAGxBrB,UAAUU,0CAMc,eAC3BlC,UAAYE,KAAKyC,uBACjB1C,aAAeC,eACTC,GAAG,QAAS,iBAAiB,SAAUC,gBACnCsD,aAAa1D,4BAOd,SAAUA,eACnBC,aAAeC,KACfyD,SAAW3D,UAAUa,KAAK,aAAa+C,MACvCnB,QAAU/B,IAAI8B,WAAW,4CACZqB,oBAAoB,CAACpB,QAAWA,UAAUnC,MAC1D,SAAUF,OAEL0D,SAAW,QADFpD,IAAImB,uBAGN,oBACA8B,UAEPI,cAAgBrD,IAAI8B,WAAW,6BAC/BJ,yBAA2BvC,OAAO8B,kBAAkB,SAC5CoC,uBACC,iBACC,UACD,kBAGAjC,QAAQgC,UAAUxD,MAC9B,SAAUC,kCACgBoB,kBAAkB,MAClC,SAELpB,KAAKgC,qBACKnB,kBACP,KACFX,OAAS,MACNC,IAAI8B,WAAWjC,KAAKyD,MAAMvB,eACzB/B,IAAI8B,WAAW,uCAENE,YAAYjC,YAG/B,SAAUuD,MAAOC,YAKnB,SAAUD,MAAOC,wCAQY,SAAUjE,eACpCC,aAAeC,eACTC,GAAG,QAAS,sBAAsB,wBAC9B+D,YAAYlE,2BAOd,SAAUA,eAClB2D,SAAW3D,UAAUa,KAAK,aAAa+C,MAEvCE,SAAW,QADFpD,IAAImB,uBAGN,yBACA8B,UAEPvB,yBAA2BvC,OAAO8B,kBAAkB,UAC3C,iBACC,UACD,kBAGAG,QAAQgC,UAAUxD,MAC9B,SAAUC,kCACgBoB,kBAAkB,MAClC,SAELpB,KAAKgC,QAAS,KACb9B,OAAS,OACLC,IAAI8B,WAAW,mBAChB9B,IAAI8B,WAAWjC,KAAK+B,OAAOG,cAC3B,yBAEUC,YAAYjC,8BAEZiC,YAAY,MACtBhC,IAAI8B,WAAWjC,KAAKyD,MAAMvB,eACzB/B,IAAI8B,WAAW,0CAOX,gBACV2B,aACDnE,UAAYE,KAAKyC,4BAChByB,4BAA4BpE,gBAC5BqE,uBAAuBrE,gBACvBsE,8BAA8BtE,gBAC9B8C,uBAAuB9C,gBACvBuE"}