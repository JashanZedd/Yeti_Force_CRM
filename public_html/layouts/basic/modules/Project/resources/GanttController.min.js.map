{"version":3,"file":"GanttController.min.js","sources":["GanttController.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\"Project_Gantt_Js\", {}, {\n\tfilterSelectElement: false,\n\tgetFilterSelectElement: function () {\n\t\tif (this.filterSelectElement == false) {\n\t\t\tthis.filterSelectElement = jQuery('#customFilter');\n\t\t}\n\t\treturn this.filterSelectElement;\n\t},\n\tgetDefaultParams: function () {\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\taction: 'GanttData',\n\t\t};\n\t\tif (app.getParentModuleName()) {\n\t\t\tparams.parent = app.getParentModuleName();\n\t\t}\n\t\treturn params;\n\t},\n\tgetCurrentCvId: function () {\n\t\treturn jQuery('#customFilter').find('option:selected').data('id');\n\t},\n\tgetGanttData(urlParams) {\n\t\tlet aDeferred = $.Deferred();\n\t\tif (typeof urlParams === \"undefined\") {\n\t\t\turlParams = {};\n\t\t}\n\t\tlet defaultParams = this.getDefaultParams();\n\t\turlParams = $.extend(defaultParams, urlParams);\n\t\tconst progressInstance = jQuery.progressIndicator({\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true,\n\t\t\t\tonBlock: () => {\n\t\t\t\t\tAppConnector.request(urlParams).done(function (data) {\n\t\t\t\t\t\tprogressInstance.progressIndicator({mode: 'hide'});\n\t\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t\t\tapp.notifyPostAjaxReady();\n\t\t\t\t\t}).fail(function (textStatus, errorThrown) {\n\t\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * load gantt\n\t */\n\tloadGantt(container = '.js-gantt__container', ganttData = false) {\n\t\tcontainer = $(container);\n\t\tthis.gantt = new Gantt(container);\n\t\tconst projectId = container.parent().find('input[name=\"projectId\"]').val();\n\t\tif (!ganttData) {\n\t\t\tthis.gantt.loadProjectFromAjax({\n\t\t\t\tmodule: 'Project',\n\t\t\t\taction: 'GanttData',\n\t\t\t\tprojectId: projectId\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * reload gantt with new data\n\t * @param data\n\t */\n\treloadData(data) {\n\t\tthis.gantt.reloadData(data);\n\t},\n\t/*\n\t * Function to register the event for changing the custom Filter\n\t */\n\tregisterChangeCustomFilterEvent: function () {\n\t\tvar thisInstance = this;\n\t\tthis.getFilterSelectElement().on('change', function (event) {\n\t\t\t$(`.nav-item[data-cvid='${thisInstance.getCurrentCvId()}'] .nav-link`).tab('show');\n\t\t\tvar currentTarget = jQuery(event.currentTarget);\n\t\t\tvar selectOption = currentTarget.find(':selected');\n\t\t\tapp.setMainParams('pageNumber', '1');\n\t\t\tapp.setMainParams('pageToJump', '1');\n\t\t\tapp.setMainParams('orderBy', selectOption.data('orderby'));\n\t\t\tapp.setMainParams('sortOrder', selectOption.data('sortorder'));\n\t\t\tthisInstance.getGanttData({\n\t\t\t\t\"viewname\": jQuery(this).val(),\n\t\t\t}).done(function (data) {\n\t\t\t\tthisInstance.reloadData(data.result);\n\t\t\t});\n\t\t\tevent.stopPropagation();\n\t\t});\n\t},\n\tgetSelectOptionFromChosenOption: function (liElement) {\n\t\tvar id = liElement.attr(\"id\");\n\t\tvar idArr = id.split(\"-\");\n\t\tvar currentOptionId = '';\n\t\tif (idArr.length > 0) {\n\t\t\tcurrentOptionId = idArr[idArr.length - 1];\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t\treturn jQuery('#filterOptionId_' + currentOptionId);\n\t},\n\tchangeCustomFilterElementView: function () {\n\t\tvar thisInstance = this;\n\t\tvar filterSelectElement = this.getFilterSelectElement();\n\t\tif (filterSelectElement.length > 0 && filterSelectElement.is(\"select\")) {\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(filterSelectElement, {\n\t\t\t\ttemplateSelection: function (data) {\n\t\t\t\t\tvar resultContainer = jQuery('<span></span>');\n\t\t\t\t\tresultContainer.append(jQuery(jQuery('.filterImage').clone().get(0)).show());\n\t\t\t\t\tresultContainer.append(data.text);\n\t\t\t\t\treturn resultContainer;\n\t\t\t\t},\n\t\t\t\tcustomSortOptGroup: true,\n\t\t\t\tcloseOnSelect: true\n\t\t\t});\n\n\t\t\tvar select2Instance = filterSelectElement.data('select2');\n\t\t\tjQuery('.filterActionsDiv').appendTo(select2Instance.$dropdown.find('.select2-dropdown:last')).removeClass('d-none').on('click', function (e) {\n\t\t\t\tthisInstance.registerCreateFilterClickEvent(e);\n\t\t\t});\n\t\t}\n\t},\n\tregisterEvents: function () {\n\t\tthis.changeCustomFilterElementView();\n\t\tthis.registerChangeCustomFilterEvent();\n\t\tVtiger_Helper_Js.showHorizontalTopScrollBar();\n\t\tthis.loadGantt();\n\t},\n});\n\n"],"names":["$","Class","this","filterSelectElement","jQuery","params","app","getModuleName","getParentModuleName","parent","find","data","urlParams","aDeferred","Deferred","defaultParams","getDefaultParams","extend","progressInstance","progressIndicator","request","done","mode","resolve","notifyPostAjaxReady","fail","textStatus","errorThrown","reject","promise","container","ganttData","gantt","Gantt","projectId","val","loadProjectFromAjax","reloadData","thisInstance","getFilterSelectElement","on","event","getCurrentCvId","tab","selectOption","currentTarget","setMainParams","getGanttData","result","stopPropagation","liElement","idArr","attr","split","currentOptionId","length","is","Fields","Picklist","showSelect2ElementView","resultContainer","append","clone","get","show","text","select2Instance","appendTo","$dropdown","removeClass","e","registerCreateFilterClickEvent","changeCustomFilterElementView","registerChangeCustomFilterEvent","showHorizontalTopScrollBar","loadGantt"],"mappings":"aAGAA,EAAEC,MAAM,mBAAoB,GAAI,sBACV,yBACG,kBACS,GAA5BC,KAAKC,2BACHA,oBAAsBC,OAAO,kBAE5BF,KAAKC,sCAEK,eACbE,OAAS,QACJC,IAAIC,uBACJ,oBAELD,IAAIE,+BACAC,OAASH,IAAIE,uBAEdH,uBAEQ,kBACRD,OAAO,iBAAiBM,KAAK,mBAAmBC,KAAK,6BAEhDC,eACRC,UAAYb,EAAEc,gBACO,IAAdF,sBACE,QAETG,cAAgBb,KAAKc,6BACbhB,EAAEiB,OAAOF,cAAeH,eAC9BM,iBAAmBd,OAAOe,kBAAkB,WACtC,UACD,UACA,wBACKC,QAAQR,WAAWS,MAAK,SAAUV,uBAC7BQ,kBAAkB,CAACG,KAAM,mBAChCC,QAAQZ,UACda,yBACFC,MAAK,SAAUC,WAAYC,uBACnBC,OAAOF,WAAYC,2BAK1Bd,UAAUgB,oCAKRC,iEAAY,uBAAwBC,4EACjC/B,EAAE8B,gBACTE,MAAQ,IAAIC,MAAMH,eACjBI,UAAYJ,UAAUrB,SAASC,KAAK,2BAA2ByB,MAChEJ,gBACCC,MAAMI,oBAAoB,QACtB,iBACA,sBACGF,iCAQHvB,WACLqB,MAAMK,WAAW1B,uCAKU,eAC5B2B,aAAepC,UACdqC,yBAAyBC,GAAG,UAAU,SAAUC,iCAC1BH,aAAaI,iCAAgCC,IAAI,YAEvEC,aADgBxC,OAAOqC,MAAMI,eACAnC,KAAK,iBAClCoC,cAAc,aAAc,SAC5BA,cAAc,aAAc,SAC5BA,cAAc,UAAWF,aAAajC,KAAK,gBAC3CmC,cAAc,YAAaF,aAAajC,KAAK,2BACpCoC,aAAa,UACb3C,OAAOF,MAAMiC,QACvBd,MAAK,SAAUV,mBACJ0B,WAAW1B,KAAKqC,iBAExBC,sDAGyB,SAAUC,eAEtCC,MADKD,UAAUE,KAAK,MACTC,MAAM,KACjBC,gBAAkB,UAClBH,MAAMI,OAAS,oBACAJ,MAAMA,MAAMI,OAAS,GAIjCnD,OAAO,mBAAqBkD,iDAEL,eAC1BhB,aAAepC,KACfC,oBAAsBD,KAAKqC,4BAC3BpC,oBAAoBoD,OAAS,GAAKpD,oBAAoBqD,GAAG,UAAW,KACnEC,OAAOC,SAASC,uBAAuBxD,oBAAqB,mBAC5C,SAAUQ,UACxBiD,gBAAkBxD,OAAO,wCACbyD,OAAOzD,OAAOA,OAAO,gBAAgB0D,QAAQC,IAAI,IAAIC,wBACrDH,OAAOlD,KAAKsD,MACrBL,qCAEY,iBACL,QAGZM,gBAAkB/D,oBAAoBQ,KAAK,kBACxC,qBAAqBwD,SAASD,gBAAgBE,UAAU1D,KAAK,2BAA2B2D,YAAY,UAAU7B,GAAG,SAAS,SAAU8B,gBAC7HC,+BAA+BD,uBAI/B,gBACVE,qCACAC,mDACYC,kCACZC"}