{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\"Project_Detail_Js\", {}, {\n\t/**\n\t * Function to register event for create related record\n\t * in summary view widgets\n\t */\n\tregisterSummaryViewContainerEvents: function (summaryViewContainer) {\n\t\tthis._super(summaryViewContainer);\n\t},\n\t/**\n\t * Function to load module summary of Projects\n\t */\n\tloadModuleSummary: function () {\n\t\tvar summaryParams = {};\n\t\tsummaryParams['module'] = app.getModuleName();\n\t\tsummaryParams['view'] = \"Detail\";\n\t\tsummaryParams['mode'] = \"showModuleSummaryView\";\n\t\tsummaryParams['record'] = jQuery('#recordId').val();\n\t\tAppConnector.request(summaryParams).done(function (data) {\n\t\t\tjQuery('.js-widget-general-info').html(data);\n\t\t});\n\t},\n\t/**\n\t * Load gantt component\n\t */\n\tloadGantt() {\n\t\tlet ganttContainer = $('.c-gantt', this.detailViewContentHolder);\n\t\tif (ganttContainer.length) {\n\t\t\tlet gantt = new Project_Gantt_Js(this.detailViewContentHolder);\n\t\t\tgantt.registerEvents();\n\t\t}\n\t},\n\t/**\n\t * Load gantt component when needed\n\t */\n\tregisterGantt() {\n\t\tthis.loadGantt();\n\t\tapp.event.on('DetailView.Tab.AfterLoad', (e, data, instance) => {\n\t\t\tinstance.detailViewContentHolder.ready(() => {\n\t\t\t\tthis.loadGantt();\n\t\t\t})\n\t\t});\n\t},\n\t/**\n\t * Function to get response from hierarchy\n\t * @param {array} params\n\t * @returns {jQuery}\n\t */\n\tgetHierarchyResponseData: function (params) {\n\t\tlet thisInstance = this,\n\t\t\taDeferred = $.Deferred();\n\t\tif (!($.isEmptyObject(thisInstance.hierarchyResponseCache))) {\n\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t} else {\n\t\t\tAppConnector.request(params).then(\n\t\t\t\tfunction (data) {\n\t\t\t\t\tthisInstance.hierarchyResponseCache = data;\n\t\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function to display the hierarchy response data\n\t * @param {array} data\n\t */\n\tdisplayHierarchyResponseData: function (data) {\n\t\tlet callbackFunction = function () {\n\t\t\tapp.showScrollBar($('#hierarchyScroll'), {\n\t\t\t\theight: '300px',\n\t\t\t\trailVisible: true,\n\t\t\t\tsize: '6px'\n\t\t\t});\n\t\t};\n\t\tapp.showModalWindow(data, function () {\n\t\t\tif (typeof callbackFunction == 'function' && $(\"#hierarchyScroll\").height() > 300) {\n\t\t\t\tcallbackFunction();\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Registers read count of hierarchy if it is possible\n\t */\n\tregisterHierarchyRecordCount: function () {\n\t\tlet hierarchyButton = $('.js-detail-hierarchy'),\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'RelationAjax',\n\t\t\t\trecord: app.getRecordId(),\n\t\t\t\tmode: 'getHierarchyCount'\n\t\t\t};\n\t\tif (hierarchyButton.length) {\n\t\t\tAppConnector.request(params).then(function (response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\t$('.hierarchy .badge').html(response.result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Shows hierarchy\n\t */\n\tregisterShowHierarchy: function () {\n\t\tlet thisInstance = this,\n\t\t\thierarchyButton = $('.detailViewTitle'),\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'Hierarchy',\n\t\t\t\trecord: app.getRecordId()\n\t\t\t};\n\t\thierarchyButton.on('click', '.js-detail-hierarchy', function () {\n\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.getHierarchyResponseData(params).then(function (data) {\n\t\t\t\tthisInstance.displayHierarchyResponseData(data);\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents: function () {\n\t\tvar detailContentsHolder = this.getContentHolder();\n\t\tvar thisInstance = this;\n\t\tthis._super();\n\t\tdetailContentsHolder.on('click', '.moreRecentTickets', function () {\n\t\t\tvar recentTicketsTab = thisInstance.getTabByLabel(thisInstance.detailViewRecentTicketsTabLabel);\n\t\t\trecentTicketsTab.trigger('click');\n\t\t});\n\t\tthis.registerGantt();\n\t\tthis.registerHierarchyRecordCount();\n\t\tthis.registerShowHierarchy();\n\t}\n});\n"],"names":["Vtiger_Detail_Js","summaryViewContainer","_super","summaryParams","app","getModuleName","jQuery","val","request","done","data","html","ganttContainer","$","detailViewContentHolder","length","gantt","Project_Gantt_Js","registerEvents","loadGantt","event","on","e","instance","ready","params","thisInstance","aDeferred","Deferred","isEmptyObject","hierarchyResponseCache","resolve","then","promise","callbackFunction","showScrollBar","showModalWindow","height","hierarchyButton","getRecordId","response","success","result","progressIndicatorElement","progressIndicator","getHierarchyResponseData","displayHierarchyResponseData","detailContentsHolder","getContentHolder","recentTicketsTab","getTabByLabel","detailViewRecentTicketsTabLabel","trigger","registerGantt","registerHierarchyRecordCount","registerShowHierarchy"],"mappings":"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"}