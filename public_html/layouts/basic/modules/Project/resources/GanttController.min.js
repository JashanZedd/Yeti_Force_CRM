"use strict";$.Class("Project_Gantt_Js",{},{filterSelectElement:!1,getFilterSelectElement:function(){return 0==this.filterSelectElement&&(this.filterSelectElement=jQuery("#customFilter")),this.filterSelectElement},getDefaultParams:function(){var params={module:app.getModuleName(),action:"GanttData"};return app.getParentModuleName()&&(params.parent=app.getParentModuleName()),params},getCurrentCvId:function(){return jQuery("#customFilter").find("option:selected").data("id")},getGanttData:function(urlParams){var aDeferred=$.Deferred();void 0===urlParams&&(urlParams={});var defaultParams=this.getDefaultParams();urlParams=$.extend(defaultParams,urlParams);var progressInstance=jQuery.progressIndicator({blockInfo:{enabled:!0,onBlock:function(){AppConnector.request(urlParams).done((function(data){progressInstance.progressIndicator({mode:"hide"}),aDeferred.resolve(data),app.notifyPostAjaxReady()})).fail((function(textStatus,errorThrown){aDeferred.reject(textStatus,errorThrown)}))}}});return aDeferred.promise()},loadGantt:function(){var container=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".js-gantt__container",ganttData=arguments.length>1&&void 0!==arguments[1]&&arguments[1];container=$(container),this.gantt=new Gantt(container);var projectId=container.parent().find('input[name="projectId"]').val();ganttData||this.gantt.loadProjectFromAjax({module:"Project",action:"GanttData",projectId:projectId})},reloadData:function(data){this.gantt.reloadData(data)},registerChangeCustomFilterEvent:function(){var thisInstance=this;this.getFilterSelectElement().on("change",(function(event){$(".nav-item[data-cvid='"+thisInstance.getCurrentCvId()+"'] .nav-link").tab("show");var selectOption=jQuery(event.currentTarget).find(":selected");app.setMainParams("pageNumber","1"),app.setMainParams("pageToJump","1"),app.setMainParams("orderBy",selectOption.data("orderby")),app.setMainParams("sortOrder",selectOption.data("sortorder")),thisInstance.getGanttData({viewname:jQuery(this).val()}).done((function(data){thisInstance.reloadData(data.result)})),event.stopPropagation()}))},getSelectOptionFromChosenOption:function(liElement){var idArr=liElement.attr("id").split("-"),currentOptionId="";return idArr.length>0&&(currentOptionId=idArr[idArr.length-1],jQuery("#filterOptionId_"+currentOptionId))},changeCustomFilterElementView:function(){var thisInstance=this,filterSelectElement=this.getFilterSelectElement();if(filterSelectElement.length>0&&filterSelectElement.is("select")){App.Fields.Picklist.showSelect2ElementView(filterSelectElement,{templateSelection:function(data){var resultContainer=jQuery("<span></span>");return resultContainer.append(jQuery(jQuery(".filterImage").clone().get(0)).show()),resultContainer.append(data.text),resultContainer},customSortOptGroup:!0,closeOnSelect:!0});var select2Instance=filterSelectElement.data("select2");jQuery(".filterActionsDiv").appendTo(select2Instance.$dropdown.find(".select2-dropdown:last")).removeClass("d-none").on("click",(function(e){thisInstance.registerCreateFilterClickEvent(e)}))}},registerEvents:function(){this.changeCustomFilterElementView(),this.registerChangeCustomFilterEvent(),Vtiger_Helper_Js.showHorizontalTopScrollBar(),this.loadGantt()}});
//# sourceMappingURL=GanttController.min.js.map
