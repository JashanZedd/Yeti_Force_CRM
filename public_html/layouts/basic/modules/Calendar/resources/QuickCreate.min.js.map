{"version":3,"file":"QuickCreate.min.js","sources":["QuickCreate.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/**\n *  Class representing a modal calendar.\n * @extends Calendar_CalendarExtended_Js\n */\nwindow.Calendar_CalendarModal_Js = class extends Calendar_CalendarExtended_Js {\n\n\tconstructor(container, readonly) {\n\t\tsuper(container, readonly);\n\t\tthis.isSwitchAllDays = false;\n\t\tthis.sidebarName = 'add' //available: add, status, edit\n\t\tthis.eventCreate = true;\n\t\tthis.module = 'Calendar';\n\t\tthis.renderCalendar();\n\t\tthis.registerEvents();\n\t}\n\n\t/**\n\t * Function sets calendar moduls's options\n\t * Overwrites Calendar_Calendar_Js\n\t */\n\tsetCalendarModuleOptions() {\n\t\treturn {hiddenDays: app.getMainParams('hiddenDays', true)};\n\t}\n\n\t/**\n\t * Function registers calendar events\n\t * Overwrites Calendar_CalendarExtended_Js\n\t */\n\tregisterEvents() {\n\t\tthis.registerSwitchEvents();\n\t\tthis.registerUsersChange();\n\t\tthis.registerAutofillTime();\n\t\tthis.registerPopoverButtonsClickEvent();\n\t}\n\n\t/**\n\t * Function registers calendar switch event\n\t * Overwrites Calendar_CalendarExtended_Js\n\t */\n\tregisterSwitchEvents() {\n\t\tif (app.getMainParams('hiddenDays', true) !== false) {\n\t\t\tlet calendarview = this.getCalendarView(),\n\t\t\t\tswitchContainer = $(`<div class=\"js-calendar-switch-container\"></div>`).insertAfter(calendarview.find('.fc-center'));\n\t\t\t$(this.switchTpl(app.vtranslate('JS_WORK_DAYS'), app.vtranslate('JS_ALL'), this.isSwitchAllDays))\n\t\t\t\t.prependTo(switchContainer)\n\t\t\t\t.on('change', 'input', (e) => {\n\t\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\t\tlet hiddenDays = [];\n\t\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t\t\t\t\tthis.isSwitchAllDays = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.isSwitchAllDays = true;\n\t\t\t\t\t}\n\t\t\t\t\tthis.getCalendarView().fullCalendar('option', 'hiddenDays', hiddenDays);\n\t\t\t\t\tif (this.getCalendarView().fullCalendar('getView').type === 'year') {\n\t\t\t\t\t\tthis.registerViewRenderEvents(this.getCalendarView().fullCalendar('getView'));\n\t\t\t\t\t}\n\t\t\t\t\tthis.registerSwitchEvents();\n\t\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Function registers select's user change event\n\t * Overwrites Calendar_CalendarExtended_Js\n\t */\n\tregisterUsersChange() {\n\t\tthis.container.find('.assigned_user_id').on('change', () => {\n\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t}\n\n\t/**\n\t * Function return user's id\n\t * Overwrites Calendar_CalendarExtended_Js\n\t * @returns {int}\n\t */\n\tgetSelectedUsersCalendar() {\n\t\treturn this.container.find('.assigned_user_id').val();\n\t}\n\n\t/**\n\t * Function invokes by fullcalendar, sets selected days in form\n\t * Overwrites Calendar_CalendarExtended_Js\n\t * @param startDate\n\t * @param endDate\n\t */\n\tselectDays(startDate, endDate) {\n\t\tif (this.sidebarName === 'status') {\n\t\t\tthis.sidebarName = 'add';\n\t\t\tthis.getCalendarCreateView().done(() => {\n\t\t\t\tthis.selectDays(startDate, endDate)\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\tlet startHour = app.getMainParams('startHour'),\n\t\t\tendHour = app.getMainParams('endHour'),\n\t\t\tview = this.getCalendarView().fullCalendar('getView');\n\t\tif (endDate.hasTime() == false) {\n\t\t\tendDate.add(-1, 'days');\n\t\t}\n\t\tstartDate = startDate.format();\n\t\tendDate = endDate.format();\n\t\tif (startHour == '') {\n\t\t\tstartHour = '00';\n\t\t}\n\t\tif (endHour == '') {\n\t\t\tendHour = '00';\n\t\t}\n\t\tif (view.name != 'agendaDay' && view.name != 'agendaWeek') {\n\t\t\tstartDate = startDate + 'T' + startHour + ':00';\n\t\t\tendDate = endDate + 'T' + endHour + ':00';\n\t\t\tif (startDate == endDate) {\n\t\t\t\tlet activityType = this.container.find('[name=\"activitytype\"]').val();\n\t\t\t\tlet activityDurations = JSON.parse(this.container.find('[name=\"defaultOtherEventDuration\"]').val());\n\t\t\t\tlet minutes = 0;\n\t\t\t\tfor (let i in activityDurations) {\n\t\t\t\t\tif (activityDurations[i].activitytype === activityType) {\n\t\t\t\t\t\tminutes = parseInt(activityDurations[i].duration);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tendDate = moment(endDate).add(minutes, 'minutes').toISOString();\n\t\t\t}\n\t\t}\n\t\tlet dateFormat = this.container.find('[name=\"date_start\"]').data('dateFormat').toUpperCase(),\n\t\t\ttimeFormat = this.container.find('[name=\"time_start\"]').data('format'),\n\t\t\tdefaultTimeFormat = '';\n\t\tif (timeFormat == 24) {\n\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t} else {\n\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t}\n\t\tthis.container.find('[name=\"date_start\"]').val(moment(startDate).format(dateFormat));\n\t\tthis.container.find('[name=\"due_date\"]').val(moment(endDate).format(dateFormat));\n\t\tif (this.container.find('.js-autofill').prop('checked') === true) {\n\t\t\tlet calendarEditInstance = new Calendar_Edit_Js();\n\t\t\tcalendarEditInstance.getFreeTime(this.container);\n\t\t} else {\n\t\t\tthis.container.find('[name=\"time_start\"]').val(moment(startDate).format(defaultTimeFormat));\n\t\t\tthis.container.find('[name=\"time_end\"]').val(moment(endDate).format(defaultTimeFormat));\n\t\t}\n\t}\n\n\t/** @inheritdoc */\n\tregisterEditForm(sideBar) {\n\t\tlet editViewInstance = Vtiger_Edit_Js.getInstanceByModuleName(sideBar.find('[name=\"module\"]').val()),\n\t\t\theaderInstance = new Vtiger_Header_Js(),\n\t\t\tparams = [];\n\t\tlet rightFormCreate = sideBar.find('form[name=\"QuickCreate\"]');\n\t\teditViewInstance.registerBasicEvents(rightFormCreate);\n\t\trightFormCreate.validationEngine(app.validationEngineOptions);\n\t\theaderInstance.registerHelpInfo(rightFormCreate);\n\t\tApp.Fields.Picklist.showSelect2ElementView(sideBar.find('select'));\n\t\tsideBar.find('.js-summary-close-edit').on('click', () => {\n\t\t\tthis.getCalendarCreateView();\n\t\t});\n\t\theaderInstance.registerQuickCreatePostLoadEvents(rightFormCreate, params);\n\t\tnew App.Fields.Text.Editor(sideBar.find('.js-editor'), {height: '5em', toolbar: 'Min'});\n\t}\n\n\t/** @inheritdoc */\n\tupdateSidebar(sidebar, data) {\n\t\tconst modalTitleContainer = $('.js-modal-title__container'),\n\t\t\tmodalTitles = modalTitleContainer.find('[class*=\"js-modal-title\"]');\n\t\tdata = $(data);\n\n\t\tmodalTitles.addClass('d-none')\n\t\tif(data.hasClass('js-edit-form')) {\n\t\t\tlet title = data.find('.js-sidebar-title ').data('title')\n\t\t\tmodalTitles.filter(`.js-modal-title--${title}`).removeClass('d-none')\n\t\t\tthis.sidebarName = title\n\t\t} else if(data.hasClass('js-activity-state')) {\n\t\t\tmodalTitles.filter('.js-modal-title--status').removeClass('d-none')\n\t\t\tthis.sidebarName = 'status'\n\t\t}\n\t\tsidebar.find('.js-qc-form').html(data);\n\t}\n}\n\njQuery.Class(\"Calendar_QuickCreate_Js\", {}, {\n\tcontainer: false,\n\tgetContainer() {\n\t\treturn this.container;\n\t},\n\tsetContainer: function (container) {\n\t\tthis.container = container;\n\t},\n\tregisterExtendCalendar: function () {\n\t\tnew Calendar_CalendarModal_Js($('.js-modal-container'), true);\n\t\tlet container = this.getContainer();\n\t\tcontainer.find('.js-activity-buttons button').on('click', function (e) {\n\t\t\tlet form = container.find('form');\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\tif (1 === currentTarget.data('type')) {\n\t\t\t\tform.append('<input type=hidden name=\"activitystatus\" value=\"' + currentTarget.data('state') + '\">');\n\t\t\t\tform.submit();\n\t\t\t} else {\n\t\t\t\tcontainer.find('.js-activity-buttons').remove();\n\t\t\t\tform.find('[name=\"record\"]').val('');\n\t\t\t\tform.append('<input type=hidden name=\"postponed\" value=\"true\">');\n\t\t\t\tform.append('<input type=hidden name=\"followup\" value=\"' + currentTarget.data('id') + '\">');\n\t\t\t}\n\t\t});\n\t},\n\tregisterStandardCalendar: function () {\n\t\tconst thisInstance = this;\n\t\tlet container = this.getContainer();\n\t\tlet data = container.find('form')\n\t\tlet user = data.find('[name=\"assigned_user_id\"]');\n\t\tlet dateStartEl = data.find('[name=\"date_start\"]');\n\t\tlet dateEnd = data.find('[name=\"due_date\"]');\n\t\tuser.on('change', function (e) {\n\t\t\tvar element = $(e.currentTarget);\n\t\t\tvar data = element.closest('form');\n\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t});\n\t\tdateStartEl.on('change', function (e) {\n\t\t\tvar element = $(e.currentTarget);\n\t\t\tvar data = element.closest('form');\n\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t});\n\t\tdata.find('ul li a').on('click', function (e) {\n\t\t\tvar element = $(e.currentTarget);\n\t\t\tvar data = element.closest('form');\n\t\t\tdata.find('.addedNearCalendarEvent').remove();\n\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t});\n\t\tdata.on('click', '.nextDayBtn', function () {\n\t\t\tvar dateStartEl = data.find('[name=\"date_start\"]')\n\t\t\tvar startDay = dateStartEl.val();\n\t\t\tvar dateStartFormat = dateStartEl.data('date-format');\n\t\t\tstartDay = moment(Vtiger_Helper_Js.convertToDateString(startDay, dateStartFormat, '+7', ' ')).format(dateStartFormat.toUpperCase());\n\t\t\tdateStartEl.val(startDay);\n\t\t\tdateEnd.val(startDay);\n\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t});\n\t\tdata.on('click', '.previousDayBtn', function () {\n\t\t\tvar dateStartEl = data.find('[name=\"date_start\"]')\n\t\t\tvar startDay = dateStartEl.val();\n\t\t\tvar dateStartFormat = dateStartEl.data('date-format');\n\t\t\tstartDay = moment(Vtiger_Helper_Js.convertToDateString(startDay, dateStartFormat, '-7', ' ')).format(dateStartFormat.toUpperCase());\n\t\t\tdateStartEl.val(startDay);\n\t\t\tdateEnd.val(startDay);\n\t\t\tthisInstance.getNearCalendarEvent(data);\n\t\t});\n\t\tdata.on('click', '.dateBtn', function (e) {\n\t\t\tvar element = $(e.currentTarget);\n\t\t\tdateStartEl.val(element.data('date'));\n\t\t\tdata.find('[name=\"due_date\"]').val(element.data('date'));\n\t\t\tdata.find('[name=\"date_start\"]').trigger('change');\n\t\t});\n\t\tthisInstance.getNearCalendarEvent(data);\n\t},\n\tgetNearCalendarEvent: function (container) {\n\t\tlet dateStartVal = container.find('[name=\"date_start\"]').val();\n\t\tif (typeof dateStartVal === \"undefined\" || dateStartVal === '') {\n\t\t\treturn;\n\t\t}\n\t\tlet params = {\n\t\t\tmodule: 'Calendar',\n\t\t\tview: 'QuickCreateEvents',\n\t\t\tcurrentDate: dateStartVal,\n\t\t\tuser: container.find('[name=\"assigned_user_id\"]').val(),\n\t\t}\n\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\tposition: 'html',\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true,\n\t\t\t\telementToBlock: container.find('.eventsTable')\n\t\t\t}\n\t\t});\n\t\tAppConnector.request(params).done(function (events) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\tcontainer.find('.eventsTable').remove();\n\t\t\tcontainer.append(events);\n\t\t\tVtiger_Header_Js.getInstance().registerHelpInfo(container);\n\t\t});\n\t},\n\tregisterEvents: function (container) {\n\t\tlet calendarType = container.closest('.js-modal-container').find('.js-calendar-type').val();\n\t\tthis.setContainer(container);\n\t\tif (calendarType === 'Extended') {\n\t\t\tthis.registerExtendCalendar();\n\t\t} else {\n\t\t\tthis.registerStandardCalendar();\n\t\t}\n\t}\n});\n"],"names":["window","Calendar_CalendarModal_Js","container","readonly","isSwitchAllDays","sidebarName","eventCreate","module","renderCalendar","registerEvents","hiddenDays","app","getMainParams","registerSwitchEvents","registerUsersChange","registerAutofillTime","registerPopoverButtonsClickEvent","calendarview","getCalendarView","switchContainer","$","insertAfter","find","switchTpl","vtranslate","prependTo","on","e","currentTarget","data","fullCalendar","type","registerViewRenderEvents","view","options","loadView","val","startDate","endDate","getCalendarCreateView","done","selectDays","startHour","endHour","hasTime","add","format","name","activityType","activityDurations","JSON","parse","minutes","i","activitytype","parseInt","duration","moment","toISOString","dateFormat","toUpperCase","timeFormat","defaultTimeFormat","prop","calendarEditInstance","Calendar_Edit_Js","getFreeTime","sideBar","editViewInstance","Vtiger_Edit_Js","getInstanceByModuleName","headerInstance","Vtiger_Header_Js","params","rightFormCreate","registerBasicEvents","validationEngine","validationEngineOptions","registerHelpInfo","Fields","Picklist","showSelect2ElementView","registerQuickCreatePostLoadEvents","App","Text","Editor","height","toolbar","sidebar","modalTitleContainer","modalTitles","addClass","hasClass","title","filter","removeClass","html","Calendar_CalendarExtended_Js","jQuery","Class","getContainer","form","append","submit","remove","thisInstance","user","dateStartEl","dateEnd","element","closest","getNearCalendarEvent","startDay","dateStartFormat","Vtiger_Helper_Js","convertToDateString","trigger","dateStartVal","progressIndicatorElement","progressIndicator","request","events","getInstance","calendarType","setContainer","registerExtendCalendar","registerStandardCalendar"],"mappings":"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"}