{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\n/**\n *  Class representing a standard calendar.\n * @extends Calendar_Js\n */\nwindow.Calendar_Calendar_Js = class extends Calendar_Js {\n\tsetCalendarModuleOptions() {\n\t\tlet self = this,\n\t\t\toptions = {\n\t\t\t\tselect: function(start, end) {\n\t\t\t\t\tself.selectDays(start, end);\n\t\t\t\t\tself.getCalendarView().fullCalendar('unselect');\n\t\t\t\t},\n\t\t\t\teventClick: function(calEvent, jsEvent, view) {\n\t\t\t\t\tjsEvent.preventDefault();\n\t\t\t\t\tconst link = new URL($(this)[0].href);\n\t\t\t\t\tif (self.createView) {\n\t\t\t\t\t\tlet progressInstance = jQuery.progressIndicator({\n\t\t\t\t\t\t\tblockInfo: { enabled: true }\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst callbackFunction = data => {\n\t\t\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t};\n\t\t\t\t\t\tapp.showModalWindow({\n\t\t\t\t\t\t\turl: `index.php?module=${\n\t\t\t\t\t\t\t\tthis.module\n\t\t\t\t\t\t\t}&view=ActivityStateModal&record=${link.searchParams.get('record')}`,\n\t\t\t\t\t\t\tcb: callbackFunction\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.location.assign(\n\t\t\t\t\t\t\t`index.php?module=${this.module}&view=Detail&record=${link.searchParams.get('record')}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\treturn options;\n\t}\n\n\tgetValuesFromSelect2(element, data, text) {\n\t\tif (element.hasClass('select2-hidden-accessible')) {\n\t\t\tvar types = element.select2('data');\n\t\t\tfor (var i = 0; i < types.length; i++) {\n\t\t\t\tif (text) {\n\t\t\t\t\tdata.push(types[i].text);\n\t\t\t\t} else {\n\t\t\t\t\tdata.push(types[i].id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n\n\tgetDefaultParams() {\n\t\tlet parentParams = super.getDefaultParams(),\n\t\t\tusers = app.moduleCacheGet('calendar-groups') || [],\n\t\t\tfilters = [];\n\t\t$('.calendarFilters .filterField').each(function() {\n\t\t\tlet element = $(this),\n\t\t\t\tname,\n\t\t\t\tvalue;\n\t\t\tif (element.attr('type') == 'checkbox') {\n\t\t\t\tname = element.val();\n\t\t\t\tvalue = element.prop('checked') ? 1 : 0;\n\t\t\t} else {\n\t\t\t\tname = element.attr('name');\n\t\t\t\tvalue = element.val();\n\t\t\t}\n\t\t\tfilters.push({ name: name, value: value });\n\t\t});\n\t\tlet params = {\n\t\t\ttime: app.getMainParams('showType'),\n\t\t\tfilters: filters\n\t\t};\n\t\tif (users.length) {\n\t\t\tparams.user = parentParams.user.concat(users);\n\t\t\tparams.emptyFilters = false;\n\t\t}\n\t\tparams = Object.assign(parentParams, params);\n\t\treturn params;\n\t}\n\n\tselectDays(startDate, endDate) {\n\t\tvar thisInstance = this;\n\t\tvar start_hour = app.getMainParams('startHour');\n\t\tvar end_hour = app.getMainParams('endHour');\n\t\tif (endDate.hasTime() == false) {\n\t\t\tendDate.add(-1, 'days');\n\t\t}\n\t\tstartDate = startDate.format();\n\t\tendDate = endDate.format();\n\t\tvar view = thisInstance.getCalendarView().fullCalendar('getView');\n\t\tif (start_hour == '') {\n\t\t\tstart_hour = '00';\n\t\t}\n\t\tif (end_hour == '') {\n\t\t\tend_hour = '00';\n\t\t}\n\t\tthis.getCalendarCreateView().done(function(data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (view.name != 'agendaDay' && view.name != 'agendaWeek') {\n\t\t\t\tstartDate = startDate + 'T' + start_hour + ':00';\n\t\t\t\tendDate = endDate + 'T' + start_hour + ':00';\n\t\t\t\tif (startDate == endDate) {\n\t\t\t\t\tlet activityType = data.find('[name=\"activitytype\"]').val();\n\t\t\t\t\tlet activityDurations = JSON.parse(data.find('[name=\"defaultOtherEventDuration\"]').val());\n\t\t\t\t\tlet minutes = 0;\n\t\t\t\t\tfor (let i in activityDurations) {\n\t\t\t\t\t\tif (activityDurations[i].activitytype === activityType) {\n\t\t\t\t\t\t\tminutes = parseInt(activityDurations[i].duration);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tendDate = moment(endDate)\n\t\t\t\t\t\t.add(minutes, 'minutes')\n\t\t\t\t\t\t.toISOString();\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar dateFormat = data\n\t\t\t\t.find('[name=\"date_start\"]')\n\t\t\t\t.data('dateFormat')\n\t\t\t\t.toUpperCase();\n\t\t\tvar timeFormat = data.find('[name=\"time_start\"]').data('format');\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tvar defaultTimeFormat = 'HH:mm';\n\t\t\t} else {\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\t}\n\t\t\tvar startDateString = moment(startDate).format(dateFormat);\n\t\t\tvar startTimeString = moment(startDate).format(defaultTimeFormat);\n\t\t\tvar endDateString = moment(endDate).format(dateFormat);\n\t\t\tvar endTimeString = moment(endDate).format(defaultTimeFormat);\n\n\t\t\tdata.find('[name=\"date_start\"]').val(startDateString);\n\t\t\tdata.find('[name=\"due_date\"]').val(endDateString);\n\t\t\tdata.find('[name=\"time_start\"]').val(startTimeString);\n\t\t\tdata.find('[name=\"time_end\"]').val(endTimeString);\n\n\t\t\tvar headerInstance = new Vtiger_Header_Js();\n\t\t\theaderInstance.handleQuickCreateData(data, {\n\t\t\t\tcallbackFunction: function(data) {\n\t\t\t\t\tthisInstance.addCalendarEvent(data.result);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tisNewEventToDisplay(eventObject) {\n\t\tif (super.isNewEventToDisplay(eventObject)) {\n\t\t\tlet taskstatus = $.inArray(eventObject.activitystatus.value, [\n\t\t\t\t'PLL_POSTPONED',\n\t\t\t\t'PLL_CANCELLED',\n\t\t\t\t'PLL_COMPLETED'\n\t\t\t]);\n\t\t\tvar state = $('.fc-toolbar .js-switch--label-on')\n\t\t\t\t.last()\n\t\t\t\t.hasClass('active');\n\t\t\tif ((state === true && taskstatus >= 0) || (state != true && taskstatus == -1)) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tgetCalendarCreateView() {\n\t\tvar thisInstance = this;\n\t\tvar aDeferred = jQuery.Deferred();\n\n\t\tif (this.calendarCreateView !== false) {\n\t\t\taDeferred.resolve(this.calendarCreateView.clone(true, true));\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t\tvar progressInstance = jQuery.progressIndicator({\n\t\t\tblockInfo: { enabled: true }\n\t\t});\n\t\tthis.loadCalendarCreateView()\n\t\t\t.done(function(data) {\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\tthisInstance.calendarCreateView = data;\n\t\t\t\taDeferred.resolve(data.clone(true, true));\n\t\t\t})\n\t\t\t.fail(function(error) {\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\tloadCalendarCreateView() {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar url = `index.php?module=${this.module}&view=QuickCreateAjax`;\n\t\tvar headerInstance = Vtiger_Header_Js.getInstance();\n\t\theaderInstance\n\t\t\t.getQuickCreateForm(url, this.module)\n\t\t\t.done(function(data) {\n\t\t\t\taDeferred.resolve(jQuery(data));\n\t\t\t})\n\t\t\t.fail(function() {\n\t\t\t\taDeferred.reject();\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\tswitchTpl(on, off, state) {\n\t\treturn `<div class=\"btn-group btn-group-toggle js-switch c-calendar-switch\" data-toggle=\"buttons\">\n\t\t\t\t\t<label class=\"btn btn-outline-primary c-calendar-switch__button js-switch--label-on ${state ? '' : 'active'}\">\n\t\t\t\t\t\t<input type=\"radio\" name=\"options\" data-on-text=\"${on}\" autocomplete=\"off\" ${state ? '' : 'checked'}>\n\t\t\t\t\t\t${on}\n\t\t\t\t\t</label>\n\t\t\t\t\t<label class=\"btn btn-outline-primary c-calendar-switch__button ${state ? 'active' : ''}\">\n\t\t\t\t\t\t<input type=\"radio\" name=\"options\" data-off-text=\"${off}\" autocomplete=\"off\" ${state ? 'checked' : ''}>\n\t\t\t\t\t\t${off}\n\t\t\t\t\t</label>\n\t\t\t\t</div>`;\n\t}\n\n\tregisterSwitchEvents() {\n\t\tconst calendarview = this.getCalendarView();\n\t\tlet switchHistory,\n\t\t\tswitchAllDays,\n\t\t\tswitchContainer = $(`<div class=\"js-calendar-switch-container\"></div>`).insertAfter(\n\t\t\t\tcalendarview.find('.fc-center')\n\t\t\t);\n\t\tif (app.getMainParams('showType') == 'current' && app.moduleCacheGet('defaultShowType') != 'history') {\n\t\t\tswitchHistory = false;\n\t\t} else {\n\t\t\tswitchHistory = true;\n\t\t}\n\t\t$(this.switchTpl(app.vtranslate('JS_TO_REALIZE'), app.vtranslate('JS_HISTORY'), switchHistory))\n\t\t\t.prependTo(switchContainer)\n\t\t\t.on('change', 'input', e => {\n\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('showType', 'current');\n\t\t\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('showType', 'history');\n\t\t\t\t\tapp.moduleCacheSet('defaultShowType', 'history');\n\t\t\t\t}\n\t\t\t\tthis.loadCalendarData();\n\t\t\t});\n\t\tif (app.getMainParams('switchingDays') === 'workDays' && app.moduleCacheGet('defaultSwitchingDays') !== 'all') {\n\t\t\tswitchAllDays = false;\n\t\t} else {\n\t\t\tswitchAllDays = true;\n\t\t}\n\t\tif (app.getMainParams('hiddenDays', true) !== false) {\n\t\t\t$(this.switchTpl(app.vtranslate('JS_WORK_DAYS'), app.vtranslate('JS_ALL'), switchAllDays))\n\t\t\t\t.prependTo(switchContainer)\n\t\t\t\t.on('change', 'input', e => {\n\t\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\t\tlet hiddenDays = [];\n\t\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\t\tapp.setMainParams('switchingDays', 'workDays');\n\t\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'workDays');\n\t\t\t\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\t\t\tapp.setMainParams('switchingDays', 'all');\n\t\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'all');\n\t\t\t\t\t}\n\t\t\t\t\tcalendarview.fullCalendar('option', 'hiddenDays', hiddenDays);\n\t\t\t\t\tthis.registerSwitchEvents();\n\t\t\t\t\tthis.loadCalendarData();\n\t\t\t\t});\n\t\t}\n\t}\n\n\tregisterCacheSettings() {\n\t\tvar thisInstance = this;\n\t\tvar calendar = thisInstance.getCalendarView();\n\t\tif (app.moduleCacheGet('defaultSwitchingDays') == 'all') {\n\t\t\tapp.setMainParams('switchingDays', 'all');\n\t\t} else {\n\t\t\tapp.setMainParams('switchingDays', 'workDays');\n\t\t}\n\t\tif (app.moduleCacheGet('defaultShowType') == 'history') {\n\t\t\tapp.setMainParams('showType', 'history');\n\t\t} else {\n\t\t\tapp.setMainParams('showType', 'current');\n\t\t}\n\t\t$('.siteBarRight .filterField').each(function(index) {\n\t\t\tvar name = $(this).attr('id');\n\t\t\tvar value = app.moduleCacheGet(name);\n\t\t\tvar element = $('#' + name);\n\t\t\tif (element.length > 0 && value != null) {\n\t\t\t\tif (element.attr('type') == 'checkbox') {\n\t\t\t\t\telement.prop('checked', value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tcalendar.find('.fc-toolbar .fc-button').on('click', function(e) {\n\t\t\tlet view;\n\t\t\tlet element = $(e.currentTarget);\n\t\t\tview = calendar.fullCalendar('getView');\n\t\t\tif (element.hasClass('fc-' + view.name + '-button')) {\n\t\t\t\tapp.moduleCacheSet('defaultView', view.name);\n\t\t\t} else if (\n\t\t\t\telement.hasClass('fc-prev-button') ||\n\t\t\t\telement.hasClass('fc-next-button') ||\n\t\t\t\telement.hasClass('fc-today-button')\n\t\t\t) {\n\t\t\t\tapp.moduleCacheSet('start', view.start.format());\n\t\t\t\tapp.moduleCacheSet('end', view.end.format());\n\t\t\t}\n\t\t});\n\t\tvar keys = app.moduleCacheKeys();\n\t\tif (keys.length > 0) {\n\t\t\tvar alert = $('#moduleCacheAlert');\n\t\t\t$('.bodyContents').on('Vtiger.Widget.Load.undefined', function(e, data) {\n\t\t\t\talert.removeClass('d-none');\n\t\t\t});\n\t\t\talert.find('.cacheClear').on('click', function(e) {\n\t\t\t\tapp.moduleCacheClear();\n\t\t\t\talert.addClass('d-none');\n\t\t\t\tlocation.reload();\n\t\t\t});\n\t\t}\n\t}\n\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerCacheSettings();\n\t\tthis.registerSwitchEvents();\n\t}\n};\n"],"names":["window","Calendar_Calendar_Js","self","options","start","end","selectDays","getCalendarView","fullCalendar","calEvent","jsEvent","view","preventDefault","link","URL","$","href","createView","progressInstance","jQuery","progressIndicator","enabled","callbackFunction","mode","showModalWindow","module","searchParams","get","location","assign","element","data","text","hasClass","types","select2","i","length","push","id","parentParams","users","app","moduleCacheGet","filters","each","name","value","attr","val","prop","params","getMainParams","user","concat","emptyFilters","Object","startDate","endDate","thisInstance","start_hour","end_hour","hasTime","add","format","getCalendarCreateView","done","activityType","find","activityDurations","JSON","parse","minutes","activitytype","parseInt","duration","moment","toISOString","dateFormat","toUpperCase","timeFormat","defaultTimeFormat","startDateString","startTimeString","endDateString","endTimeString","headerInstance","Vtiger_Header_Js","handleQuickCreateData","addCalendarEvent","result","eventObject","taskstatus","inArray","activitystatus","state","last","aDeferred","Deferred","calendarCreateView","resolve","clone","promise","loadCalendarCreateView","fail","error","url","getInstance","getQuickCreateForm","reject","on","off","calendarview","switchHistory","switchAllDays","switchContainer","insertAfter","switchTpl","vtranslate","prependTo","currentTarget","e","setMainParams","moduleCacheSet","loadCalendarData","hiddenDays","registerSwitchEvents","calendar","index","keys","moduleCacheKeys","alert","removeClass","moduleCacheClear","addClass","reload","registerCacheSettings","Calendar_Js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;AAQA;;;;;;AAMAA,OAAOC,oBAAP;;;;;;;;;;6CAC4B;OACtBC,OAAO,IAAX;OACCC,UAAU;YACD,gBAASC,KAAT,EAAgBC,GAAhB,EAAqB;UACvBC,UAAL,CAAgBF,KAAhB,EAAuBC,GAAvB;UACKE,eAAL,GAAuBC,YAAvB,CAAoC,UAApC;KAHQ;gBAKG,oBAASC,QAAT,EAAmBC,OAAnB,EAA4BC,IAA5B,EAAkC;aACrCC,cAAR;SACMC,OAAO,IAAIC,GAAJ,CAAQC,EAAE,IAAF,EAAQ,CAAR,EAAWC,IAAnB,CAAb;SACId,KAAKe,UAAT,EAAqB;UAChBC,mBAAmBC,OAAOC,iBAAP,CAAyB;kBACpC,EAAEC,SAAS,IAAX;OADW,CAAvB;UAGMC,mBAAmB,SAAnBA,gBAAmB,OAAQ;wBACfF,iBAAjB,CAAmC,EAAEG,MAAM,MAAR,EAAnC;OADD;UAGIC,eAAJ,CAAoB;kCAElB,KAAKC,MADN,wCAEmCZ,KAAKa,YAAL,CAAkBC,GAAlB,CAAsB,QAAtB,CAHhB;WAIfL;OAJL;MAPD,MAaO;aACCM,QAAP,CAAgBC,MAAhB,uBACqB,KAAKJ,MAD1B,4BACuDZ,KAAKa,YAAL,CAAkBC,GAAlB,CAAsB,QAAtB,CADvD;;;IAvBJ;UA6BOxB,OAAP;;;;uCAGoB2B,OAlCtB,EAkC+BC,IAlC/B,EAkCqCC,IAlCrC,EAkC2C;OACrCF,QAAQG,QAAR,CAAiB,2BAAjB,CAAJ,EAAmD;QAC9CC,QAAQJ,QAAQK,OAAR,CAAgB,MAAhB,CAAZ;SACK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,MAAMG,MAA1B,EAAkCD,GAAlC,EAAuC;SAClCJ,IAAJ,EAAU;WACJM,IAAL,CAAUJ,MAAME,CAAN,EAASJ,IAAnB;MADD,MAEO;WACDM,IAAL,CAAUJ,MAAME,CAAN,EAASG,EAAnB;;;;UAIIR,IAAP;;;;qCAGkB;OACdS,8HAAJ;OACCC,QAAQC,IAAIC,cAAJ,CAAmB,iBAAnB,KAAyC,EADlD;OAECC,UAAU,EAFX;KAGE,+BAAF,EAAmCC,IAAnC,CAAwC,YAAW;QAC9Cf,UAAUf,EAAE,IAAF,CAAd;QACC+B,aADD;QAECC,cAFD;QAGIjB,QAAQkB,IAAR,CAAa,MAAb,KAAwB,UAA5B,EAAwC;YAChClB,QAAQmB,GAAR,EAAP;aACQnB,QAAQoB,IAAR,CAAa,SAAb,IAA0B,CAA1B,GAA8B,CAAtC;KAFD,MAGO;YACCpB,QAAQkB,IAAR,CAAa,MAAb,CAAP;aACQlB,QAAQmB,GAAR,EAAR;;YAEOX,IAAR,CAAa,EAAEQ,MAAMA,IAAR,EAAcC,OAAOA,KAArB,EAAb;IAXD;OAaII,SAAS;UACNT,IAAIU,aAAJ,CAAkB,UAAlB,CADM;aAEHR;IAFV;OAIIH,MAAMJ,MAAV,EAAkB;WACVgB,IAAP,GAAcb,aAAaa,IAAb,CAAkBC,MAAlB,CAAyBb,KAAzB,CAAd;WACOc,YAAP,GAAsB,KAAtB;;YAEQC,OAAO3B,MAAP,CAAcW,YAAd,EAA4BW,MAA5B,CAAT;UACOA,MAAP;;;;6BAGUM,SA7EZ,EA6EuBC,OA7EvB,EA6EgC;OAC1BC,eAAe,IAAnB;OACIC,aAAalB,IAAIU,aAAJ,CAAkB,WAAlB,CAAjB;OACIS,WAAWnB,IAAIU,aAAJ,CAAkB,SAAlB,CAAf;OACIM,QAAQI,OAAR,MAAqB,KAAzB,EAAgC;YACvBC,GAAR,CAAY,CAAC,CAAb,EAAgB,MAAhB;;eAEWN,UAAUO,MAAV,EAAZ;aACUN,QAAQM,MAAR,EAAV;OACIrD,OAAOgD,aAAapD,eAAb,GAA+BC,YAA/B,CAA4C,SAA5C,CAAX;OACIoD,cAAc,EAAlB,EAAsB;iBACR,IAAb;;OAEGC,YAAY,EAAhB,EAAoB;eACR,IAAX;;QAEII,qBAAL,GAA6BC,IAA7B,CAAkC,UAASnC,IAAT,EAAe;QAC5CA,KAAKM,MAAL,IAAe,CAAnB,EAAsB;;;QAGlB1B,KAAKmC,IAAL,IAAa,WAAb,IAA4BnC,KAAKmC,IAAL,IAAa,YAA7C,EAA2D;iBAC9CW,YAAY,GAAZ,GAAkBG,UAAlB,GAA+B,KAA3C;eACUF,UAAU,GAAV,GAAgBE,UAAhB,GAA6B,KAAvC;SACIH,aAAaC,OAAjB,EAA0B;UACrBS,eAAepC,KAAKqC,IAAL,CAAU,uBAAV,EAAmCnB,GAAnC,EAAnB;UACIoB,oBAAoBC,KAAKC,KAAL,CAAWxC,KAAKqC,IAAL,CAAU,oCAAV,EAAgDnB,GAAhD,EAAX,CAAxB;UACIuB,UAAU,CAAd;WACK,IAAIpC,CAAT,IAAciC,iBAAd,EAAiC;WAC5BA,kBAAkBjC,CAAlB,EAAqBqC,YAArB,KAAsCN,YAA1C,EAAwD;kBAC7CO,SAASL,kBAAkBjC,CAAlB,EAAqBuC,QAA9B,CAAV;;;;gBAIQC,OAAOlB,OAAP,EACRK,GADQ,CACJS,OADI,EACK,SADL,EAERK,WAFQ,EAAV;;;QAKEC,aAAa/C,KACfqC,IADe,CACV,qBADU,EAEfrC,IAFe,CAEV,YAFU,EAGfgD,WAHe,EAAjB;QAIIC,aAAajD,KAAKqC,IAAL,CAAU,qBAAV,EAAiCrC,IAAjC,CAAsC,QAAtC,CAAjB;QACIiD,cAAc,EAAlB,EAAsB;SACjBC,oBAAoB,OAAxB;KADD,MAEO;yBACc,SAApB;;QAEGC,kBAAkBN,OAAOnB,SAAP,EAAkBO,MAAlB,CAAyBc,UAAzB,CAAtB;QACIK,kBAAkBP,OAAOnB,SAAP,EAAkBO,MAAlB,CAAyBiB,iBAAzB,CAAtB;QACIG,gBAAgBR,OAAOlB,OAAP,EAAgBM,MAAhB,CAAuBc,UAAvB,CAApB;QACIO,gBAAgBT,OAAOlB,OAAP,EAAgBM,MAAhB,CAAuBiB,iBAAvB,CAApB;;SAEKb,IAAL,CAAU,qBAAV,EAAiCnB,GAAjC,CAAqCiC,eAArC;SACKd,IAAL,CAAU,mBAAV,EAA+BnB,GAA/B,CAAmCmC,aAAnC;SACKhB,IAAL,CAAU,qBAAV,EAAiCnB,GAAjC,CAAqCkC,eAArC;SACKf,IAAL,CAAU,mBAAV,EAA+BnB,GAA/B,CAAmCoC,aAAnC;;QAEIC,iBAAiB,IAAIC,gBAAJ,EAArB;mBACeC,qBAAf,CAAqCzD,IAArC,EAA2C;uBACxB,0BAASA,IAAT,EAAe;mBACnB0D,gBAAb,CAA8B1D,KAAK2D,MAAnC;;KAFF;IA3CD;;;;sCAmDmBC,WAhJrB,EAgJkC;0HACFA,WAA9B,GAA4C;QACvCC,aAAa7E,EAAE8E,OAAF,CAAUF,YAAYG,cAAZ,CAA2B/C,KAArC,EAA4C,CAC5D,eAD4D,EAE5D,eAF4D,EAG5D,eAH4D,CAA5C,CAAjB;QAKIgD,QAAQhF,EAAE,kCAAF,EACViF,IADU,GAEV/D,QAFU,CAED,QAFC,CAAZ;QAGK8D,UAAU,IAAV,IAAkBH,cAAc,CAAjC,IAAwCG,SAAS,IAAT,IAAiBH,cAAc,CAAC,CAA5E,EAAgF;YACxE,KAAP;KADD,MAEO;YACC,IAAP;;IAZF,MAcO;WACC,KAAP;;;;;0CAIsB;OACnBjC,eAAe,IAAnB;OACIsC,YAAY9E,OAAO+E,QAAP,EAAhB;;OAEI,KAAKC,kBAAL,KAA4B,KAAhC,EAAuC;cAC5BC,OAAV,CAAkB,KAAKD,kBAAL,CAAwBE,KAAxB,CAA8B,IAA9B,EAAoC,IAApC,CAAlB;WACOJ,UAAUK,OAAV,EAAP;;OAEGpF,mBAAmBC,OAAOC,iBAAP,CAAyB;eACpC,EAAEC,SAAS,IAAX;IADW,CAAvB;QAGKkF,sBAAL,GACErC,IADF,CACO,UAASnC,IAAT,EAAe;qBACHX,iBAAjB,CAAmC,EAAEG,MAAM,MAAR,EAAnC;iBACa4E,kBAAb,GAAkCpE,IAAlC;cACUqE,OAAV,CAAkBrE,KAAKsE,KAAL,CAAW,IAAX,EAAiB,IAAjB,CAAlB;IAJF,EAMEG,IANF,CAMO,UAASC,KAAT,EAAgB;qBACJrF,iBAAjB,CAAmC,EAAEG,MAAM,MAAR,EAAnC;YACQkF,KAAR,CAAcA,KAAd;IARF;UAUOR,UAAUK,OAAV,EAAP;;;;2CAGwB;OACpBL,YAAY9E,OAAO+E,QAAP,EAAhB;OACIQ,4BAA0B,KAAKjF,MAA/B,0BAAJ;OACI6D,iBAAiBC,iBAAiBoB,WAAjB,EAArB;kBAEEC,kBADF,CACqBF,GADrB,EAC0B,KAAKjF,MAD/B,EAEEyC,IAFF,CAEO,UAASnC,IAAT,EAAe;cACVqE,OAAV,CAAkBjF,OAAOY,IAAP,CAAlB;IAHF,EAKEyE,IALF,CAKO,YAAW;cACNK,MAAV;IANF;UAQOZ,UAAUK,OAAV,EAAP;;;;4BAGSQ,EA3MX,EA2MeC,GA3Mf,EA2MoBhB,KA3MpB,EA2M2B;0MAEgEA,QAAQ,EAAR,GAAa,QADtG,0EAEuDe,EAFvD,8BAEiFf,QAAQ,EAAR,GAAa,SAF9F,wBAGMe,EAHN,yGAKqEf,QAAQ,QAAR,GAAmB,EALxF,2EAMwDgB,GANxD,8BAMmFhB,QAAQ,SAAR,GAAoB,EANvG,wBAOMgB,GAPN;;;;yCAYsB;;;OAChBC,eAAe,KAAKzG,eAAL,EAArB;OACI0G,sBAAJ;OACCC,sBADD;OAECC,kBAAkBpG,sDAAsDqG,WAAtD,CACjBJ,aAAa5C,IAAb,CAAkB,YAAlB,CADiB,CAFnB;OAKI1B,IAAIU,aAAJ,CAAkB,UAAlB,KAAiC,SAAjC,IAA8CV,IAAIC,cAAJ,CAAmB,iBAAnB,KAAyC,SAA3F,EAAsG;oBACrF,KAAhB;IADD,MAEO;oBACU,IAAhB;;KAEC,KAAK0E,SAAL,CAAe3E,IAAI4E,UAAJ,CAAe,eAAf,CAAf,EAAgD5E,IAAI4E,UAAJ,CAAe,YAAf,CAAhD,EAA8EL,aAA9E,CAAF,EACEM,SADF,CACYJ,eADZ,EAEEL,EAFF,CAEK,QAFL,EAEe,OAFf,EAEwB,aAAK;QACrBU,gBAAgBzG,EAAE0G,EAAED,aAAJ,CAAtB;QACI,OAAOA,cAAczF,IAAd,CAAmB,SAAnB,CAAP,KAAyC,WAA7C,EAA0D;SACrD2F,aAAJ,CAAkB,UAAlB,EAA8B,SAA9B;SACIC,cAAJ,CAAmB,iBAAnB,EAAsC,SAAtC;KAFD,MAGO,IAAI,OAAOH,cAAczF,IAAd,CAAmB,UAAnB,CAAP,KAA0C,WAA9C,EAA2D;SAC7D2F,aAAJ,CAAkB,UAAlB,EAA8B,SAA9B;SACIC,cAAJ,CAAmB,iBAAnB,EAAsC,SAAtC;;WAEIC,gBAAL;IAXF;OAaIlF,IAAIU,aAAJ,CAAkB,eAAlB,MAAuC,UAAvC,IAAqDV,IAAIC,cAAJ,CAAmB,sBAAnB,MAA+C,KAAxG,EAA+G;oBAC9F,KAAhB;IADD,MAEO;oBACU,IAAhB;;OAEGD,IAAIU,aAAJ,CAAkB,YAAlB,EAAgC,IAAhC,MAA0C,KAA9C,EAAqD;MAClD,KAAKiE,SAAL,CAAe3E,IAAI4E,UAAJ,CAAe,cAAf,CAAf,EAA+C5E,IAAI4E,UAAJ,CAAe,QAAf,CAA/C,EAAyEJ,aAAzE,CAAF,EACEK,SADF,CACYJ,eADZ,EAEEL,EAFF,CAEK,QAFL,EAEe,OAFf,EAEwB,aAAK;SACrBU,gBAAgBzG,EAAE0G,EAAED,aAAJ,CAAtB;SACIK,aAAa,EAAjB;SACI,OAAOL,cAAczF,IAAd,CAAmB,SAAnB,CAAP,KAAyC,WAA7C,EAA0D;UACrD2F,aAAJ,CAAkB,eAAlB,EAAmC,UAAnC;UACIC,cAAJ,CAAmB,sBAAnB,EAA2C,UAA3C;mBACajF,IAAIU,aAAJ,CAAkB,YAAlB,EAAgC,IAAhC,CAAb;MAHD,MAIO,IAAI,OAAOoE,cAAczF,IAAd,CAAmB,UAAnB,CAAP,KAA0C,WAA9C,EAA2D;UAC7D2F,aAAJ,CAAkB,eAAlB,EAAmC,KAAnC;UACIC,cAAJ,CAAmB,sBAAnB,EAA2C,KAA3C;;kBAEYnH,YAAb,CAA0B,QAA1B,EAAoC,YAApC,EAAkDqH,UAAlD;YACKC,oBAAL;YACKF,gBAAL;KAfF;;;;;0CAoBsB;OACnBjE,eAAe,IAAnB;OACIoE,WAAWpE,aAAapD,eAAb,EAAf;OACImC,IAAIC,cAAJ,CAAmB,sBAAnB,KAA8C,KAAlD,EAAyD;QACpD+E,aAAJ,CAAkB,eAAlB,EAAmC,KAAnC;IADD,MAEO;QACFA,aAAJ,CAAkB,eAAlB,EAAmC,UAAnC;;OAEGhF,IAAIC,cAAJ,CAAmB,iBAAnB,KAAyC,SAA7C,EAAwD;QACnD+E,aAAJ,CAAkB,UAAlB,EAA8B,SAA9B;IADD,MAEO;QACFA,aAAJ,CAAkB,UAAlB,EAA8B,SAA9B;;KAEC,4BAAF,EAAgC7E,IAAhC,CAAqC,UAASmF,KAAT,EAAgB;QAChDlF,OAAO/B,EAAE,IAAF,EAAQiC,IAAR,CAAa,IAAb,CAAX;QACID,QAAQL,IAAIC,cAAJ,CAAmBG,IAAnB,CAAZ;QACIhB,UAAUf,EAAE,MAAM+B,IAAR,CAAd;QACIhB,QAAQO,MAAR,GAAiB,CAAjB,IAAsBU,SAAS,IAAnC,EAAyC;SACpCjB,QAAQkB,IAAR,CAAa,MAAb,KAAwB,UAA5B,EAAwC;cAC/BE,IAAR,CAAa,SAAb,EAAwBH,KAAxB;;;IANH;YAUSqB,IAAT,CAAc,wBAAd,EAAwC0C,EAAxC,CAA2C,OAA3C,EAAoD,UAASW,CAAT,EAAY;QAC3D9G,aAAJ;QACImB,UAAUf,EAAE0G,EAAED,aAAJ,CAAd;WACOO,SAASvH,YAAT,CAAsB,SAAtB,CAAP;QACIsB,QAAQG,QAAR,CAAiB,QAAQtB,KAAKmC,IAAb,GAAoB,SAArC,CAAJ,EAAqD;SAChD6E,cAAJ,CAAmB,aAAnB,EAAkChH,KAAKmC,IAAvC;KADD,MAEO,IACNhB,QAAQG,QAAR,CAAiB,gBAAjB,KACAH,QAAQG,QAAR,CAAiB,gBAAjB,CADA,IAEAH,QAAQG,QAAR,CAAiB,iBAAjB,CAHM,EAIL;SACG0F,cAAJ,CAAmB,OAAnB,EAA4BhH,KAAKP,KAAL,CAAW4D,MAAX,EAA5B;SACI2D,cAAJ,CAAmB,KAAnB,EAA0BhH,KAAKN,GAAL,CAAS2D,MAAT,EAA1B;;IAZF;OAeIiE,OAAOvF,IAAIwF,eAAJ,EAAX;OACID,KAAK5F,MAAL,GAAc,CAAlB,EAAqB;QAChB8F,QAAQpH,EAAE,mBAAF,CAAZ;MACE,eAAF,EAAmB+F,EAAnB,CAAsB,8BAAtB,EAAsD,UAASW,CAAT,EAAY1F,IAAZ,EAAkB;WACjEqG,WAAN,CAAkB,QAAlB;KADD;UAGMhE,IAAN,CAAW,aAAX,EAA0B0C,EAA1B,CAA6B,OAA7B,EAAsC,UAASW,CAAT,EAAY;SAC7CY,gBAAJ;WACMC,QAAN,CAAe,QAAf;cACSC,MAAT;KAHD;;;;;mCAQe;;QAEXC,qBAAL;QACKV,oBAAL;;;;EAlU0CW,WAA5C"}