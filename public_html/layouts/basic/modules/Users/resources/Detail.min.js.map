{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\"Users_Detail_Js\", {\n\t/*\n\t * function to trigger delete record action\n\t * @params: delete record url.\n\t */\n\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\tvar message = app.vtranslate('LBL_DELETE_USER_CONFIRMATION');\n\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(function (data) {\n\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tjQuery('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t};\n\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}).fail(function (error, err) {\n\t\t\t\tconsole.error(error);\t\n\t\t});\n\t},\n\tdeleteUser: function (form) {\n\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\tvar params = {\n\t\t\t'module': app.getModuleName(),\n\t\t\t'action': \"DeleteAjax\",\n\t\t\t'mode': 'deleteUser',\n\t\t\t'transfer_user_id': transferUserId,\n\t\t\t'userid': userid,\n\t\t\t'permanent': form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t};\n\t\tAppConnector.request(params).done(\n\t\t\tfunction (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate(data.result.message));\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\ttriggerChangeAccessKey: function (url) {\n\t\tvar title = app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED');\n\t\tvar message = app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION');\n\t\tVtiger_Helper_Js.showConfirmationBox({title: title, message: message}).done(function (data) {\n\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\tvar params = {};\n\t\t\t\tif (data['success']) {\n\t\t\t\t\tdata = data.result;\n\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\tvar accessKeyEle = jQuery('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t}\n\t\t\t\tparams['text'] = message;\n\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t});\n\t\t});\n\t},\n\n}, {\n\tusersEditInstance: false,\n\tupdateStartHourElement: function (form) {\n\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\tthis.updateStartHourElementValue();\n\t},\n\thourFormatUpdateEvent: function () {\n\t\tvar thisInstance = this;\n\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\tthisInstance.updateStartHourElementValue();\n\t\t});\n\t},\n\tupdateStartHourElementValue: function () {\n\t\tvar form = this.getForm();\n\t\tvar startHourSelectElement = jQuery('select[name=\"start_hour\"]', form);\n\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\tvar endHourSelectElement = jQuery('select[name=\"end_hour\"]', form);\n\t\tendHourSelectElement.closest('.fieldValue').find('span.value').text(endHourSelectElement.find('option:selected').text());\n\t},\n\tstartHourUpdateEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\tthisInstance.updateStartHourElement(form);\n\t\t});\n\t},\n\tsaveFieldValues: function (fieldDetailList) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar thisInstance = this;\n\t\tvar lock = false;\n\t\tvar recordId = this.getRecordId();\n\t\tvar data = {};\n\t\tif (typeof fieldDetailList !== \"undefined\") {\n\t\t\tdata = fieldDetailList;\n\t\t\tif (data['field'] == 'email1') {\n\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\tfunction (data) {\n\t\t\t\t\t},\n\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (lock !== true) {\n\t\t\tdata['record'] = recordId;\n\t\t\tdata['module'] = app.getModuleName();\n\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(\n\t\t\t\tfunction (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tvar form = this.getForm();\n\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\tthis.updateStartHourElement(form);\n\t\tthis.hourFormatUpdateEvent();\n\t\tthis.startHourUpdateEvent(form);\n\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t}\n\n});\n"],"names":["Vtiger_Detail_Js","deleteUserUrl","message","app","vtranslate","showConfirmationBox","done","data","request","callback","params","validationEngineOptions","onValidationComplete","form","valid","deleteUser","validationEngine","showModalWindow","fail","error","err","userid","find","val","transferUserId","getModuleName","success","hideModalWindow","showPnotify","result","url","listViewUrl","location","href","title","accessKeyEle","jQuery","length","html","accessKey","usersEditInstance","triggerHourFormatChangeEvent","updateStartHourElementValue","thisInstance","getForm","on","fieldUpdatedEvent","e","startHourSelectElement","selectedElementValue","text","closest","endHourSelectElement","updateStartHourElement","fieldDetailList","aDeferred","Deferred","lock","recordId","getRecordId","checkEmail","reject","async","dataType","reponseData","resolve","promise","_super","Vtiger_Edit_Js","getInstance","hourFormatUpdateEvent","startHourUpdateEvent","registerChangeEventForCurrencySeparator"],"mappings":"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"}