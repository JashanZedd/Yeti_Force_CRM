{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\"Users_Detail_Js\", {\n\t/*\n\t * function to trigger delete record action\n\t * @params: delete record url.\n\t */\n\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\tvar message = app.vtranslate('LBL_DELETE_USER_CONFIRMATION');\n\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(function (data) {\n\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tjQuery('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t};\n\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}).fail(function (error, err) {\n\t\t\t\tconsole.error(error);\t\n\t\t});\n\t},\n\tdeleteUser: function (form) {\n\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\tvar params = {\n\t\t\t'module': app.getModuleName(),\n\t\t\t'action': \"DeleteAjax\",\n\t\t\t'mode': 'deleteUser',\n\t\t\t'transfer_user_id': transferUserId,\n\t\t\t'userid': userid,\n\t\t\t'permanent': form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t};\n\t\tAppConnector.request(params).done(\n\t\t\tfunction (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate(data.result.message));\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\ttriggerChangeAccessKey: function (url) {\n\t\tvar title = app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED');\n\t\tvar message = app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION');\n\t\tVtiger_Helper_Js.showConfirmationBox({title: title, message: message}).done(function (data) {\n\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\tvar params = {};\n\t\t\t\tif (data['success']) {\n\t\t\t\t\tdata = data.result;\n\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\tvar accessKeyEle = jQuery('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t}\n\t\t\t\tparams['text'] = message;\n\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t});\n\t\t});\n\t},\n\n}, {\n\tusersEditInstance: false,\n\tupdateStartHourElement: function (form) {\n\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\tthis.updateStartHourElementValue();\n\t},\n\thourFormatUpdateEvent: function () {\n\t\tvar thisInstance = this;\n\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\tthisInstance.updateStartHourElementValue();\n\t\t});\n\t},\n\tupdateStartHourElementValue: function () {\n\t\tvar form = this.getForm();\n\t\tvar startHourSelectElement = jQuery('select[name=\"start_hour\"]', form);\n\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\tvar endHourSelectElement = jQuery('select[name=\"end_hour\"]', form);\n\t\tendHourSelectElement.closest('.fieldValue').find('span.value').text(endHourSelectElement.find('option:selected').text());\n\t},\n\tstartHourUpdateEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\tthisInstance.updateStartHourElement(form);\n\t\t});\n\t},\n\tsaveFieldValues: function (fieldDetailList) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar thisInstance = this;\n\t\tvar lock = false;\n\t\tvar recordId = this.getRecordId();\n\t\tvar data = {};\n\t\tif (typeof fieldDetailList !== \"undefined\") {\n\t\t\tdata = fieldDetailList;\n\t\t\tif (data['field'] == 'email1') {\n\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\tfunction (data) {\n\t\t\t\t\t},\n\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (lock !== true) {\n\t\t\tdata['record'] = recordId;\n\t\t\tdata['module'] = app.getModuleName();\n\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\tvar params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(\n\t\t\t\tfunction (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tvar form = this.getForm();\n\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\tthis.updateStartHourElement(form);\n\t\tthis.hourFormatUpdateEvent();\n\t\tthis.startHourUpdateEvent(form);\n\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t}\n\n});\n"],"names":["Vtiger_Detail_Js","deleteUserUrl","message","app","vtranslate","showConfirmationBox","done","data","request","callback","validationEngineOptions","onValidationComplete","form","valid","deleteUser","validationEngine","showModalWindow","fail","error","err","userid","find","val","transferUserId","params","getModuleName","success","hideModalWindow","showPnotify","result","url","listViewUrl","location","href","title","accessKeyEle","jQuery","length","html","accessKey","usersEditInstance","triggerHourFormatChangeEvent","updateStartHourElementValue","thisInstance","this","getForm","on","fieldUpdatedEvent","e","startHourSelectElement","selectedElementValue","text","closest","endHourSelectElement","updateStartHourElement","fieldDetailList","aDeferred","Deferred","lock","recordId","getRecordId","checkEmail","reject","async","dataType","reponseData","resolve","promise","_super","Vtiger_Edit_Js","getInstance","hourFormatUpdateEvent","startHourUpdateEvent","registerChangeEventForCurrencySeparator"],"mappings":"aAWAA,iBAAiB,kBAAmB,mBAKhB,SAAUC,mBACxBC,QAAUC,IAAIC,WAAW,iDACZC,oBAAoB,CAACH,QAAWA,UAAUI,MAAK,SAAUC,mBAC5DC,QAAQP,eAAeK,MAAK,SAAUC,SAC9CA,KAAM,KACLE,SAAW,SAAUF,MACXJ,IAAIO,wBACVC,qBAAuB,SAAUC,KAAMC,cACzCA,uBACaC,WAAWF,OAErB,UAED,eAAeG,iBAAiBZ,IAAIO,8BAExCM,gBAAgBT,MAAM,SAAUA,2BAOpCU,MAAK,SAAUC,MAAOC,aACfD,MAAMA,sBAGL,SAAUN,UACjBQ,OAASR,KAAKS,KAAK,mBAAmBC,MACtCC,eAAiBX,KAAKS,KAAK,6BAA6BC,MAExDE,OAAS,QACFrB,IAAIsB,uBACJ,kBACF,8BACYF,sBACVH,iBACGR,KAAKS,KAAK,wCAAwCC,oBAEnDd,QAAQgB,QAAQlB,MAC5B,SAAUC,SACLA,KAAKmB,QAAS,KACbC,mCACaC,YAAYzB,IAAIC,WAAWG,KAAKsB,OAAO3B,cACpD4B,IAAMvB,KAAKsB,OAAOE,mBACfC,SAASC,KAAOH,gCAKH,SAAUA,SAC7BI,MAAQ/B,IAAIC,WAAW,+BACvBF,QAAUC,IAAIC,WAAW,sDACZC,oBAAoB,CAAC6B,MAAOA,MAAOhC,QAASA,UAAUI,MAAK,SAAUC,mBACxEC,QAAQsB,KAAKxB,MAAK,SAAUC,UACpCiB,OAAS,MACTjB,KAAA,QAAiB,MACbA,KAAKsB,cACZ,KAAiB,kBACP1B,IAAIC,WAAWG,KAAKL,aAC1BiC,aAAeC,OAAO,0CACtBD,aAAaE,qBACHhB,KAAK,UAAUiB,KAAK/B,KAAKgC,wBAG7BpC,IAAIC,WAAWG,KAAA,MAAA,gBAE1B,KAAiBL,yBACA0B,YAAYJ,gBAK9B,oBACiB,yBACK,SAAUZ,WAC5B4B,kBAAkBC,6BAA6B7B,WAC/C8B,qDAEiB,eAClBC,aAAeC,UACdC,UAAUC,GAAGF,KAAKG,kBAAmB,wBAAwB,SAAUC,EAAGxB,qBACjEkB,8DAGc,eACxB9B,KAAOgC,KAAKC,UACZI,uBAAyBb,OAAO,4BAA6BxB,MAC7DsC,qBAAuBD,uBAAuB5B,KAAK,mBAAmB8B,8BACnDC,QAAQ,eAAe/B,KAAK,cAAc8B,KAAKD,0BAClEG,qBAAuBjB,OAAO,0BAA2BxB,2BACxCwC,QAAQ,eAAe/B,KAAK,cAAc8B,KAAKE,qBAAqBhC,KAAK,mBAAmB8B,8BAE5F,SAAUvC,UAC3B+B,aAAeC,UACdE,GAAGF,KAAKG,kBAAmB,uBAAuB,SAAUC,EAAGxB,qBACtD8B,uBAAuB1C,0BAGrB,SAAU2C,qBACtBC,UAAYpB,OAAOqB,WAEnBC,MAAO,EACPC,SAAWf,KAAKgB,cAChBrD,KAAO,WACoB,IAApBgD,iBAEW,gBADdA,iBACH,OANcX,KAOJJ,kBAAkBqB,WAAWtD,KAAA,OAAeD,MACxD,SAAUC,UAEV,SAAUA,KAAMW,aACR,YACG4C,aAKD,IAATJ,KAAe,MAClB,OAAiBC,cACjB,OAAiBxD,IAAIsB,qBACrB,OAAiB,eAEbD,OAAS,UACNjB,KAAOA,YACPwD,OAAQ,SACRC,SAAW,oBACLxD,QAAQgB,QAAQlB,MAC5B,SAAU2D,uBACCC,QAAQD,uBAIdT,UAAUW,0BAEF,gBACVC,aACDxD,KAAOgC,KAAKC,eACXL,kBAAoB6B,eAAeC,mBACnChB,uBAAuB1C,WACvB2D,6BACAC,qBAAqB5D,oBACZ6D"}