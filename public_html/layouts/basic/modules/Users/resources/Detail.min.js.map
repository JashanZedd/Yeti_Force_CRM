{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce S.A.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Users_Detail_Js',\n\t{\n\t\t/*\n\t\t * function to trigger delete record action\n\t\t * @params: delete record url.\n\t\t */\n\t\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_DELETE_USER_CONFIRMATION'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t$('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdeleteUser: function (form) {\n\t\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'DeleteAjax',\n\t\t\t\tmode: 'deleteUser',\n\t\t\t\ttransfer_user_id: transferUserId,\n\t\t\t\tuserid: userid,\n\t\t\t\tpermanent: form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate(data.result.message),\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttriggerChangeAccessKey: function (url) {\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED'),\n\t\t\t\ttext: app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\t\t\tlet params = {},\n\t\t\t\t\t\t\tmessage;\n\t\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\t\tdata = data.result;\n\t\t\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\t\t\tlet accessKeyEle = $('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparams['text'] = message;\n\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tusersEditInstance: false,\n\t\tupdateStartHourElement: function (form) {\n\t\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\t\tthis.updateStartHourElementValue();\n\t\t},\n\t\thourFormatUpdateEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElementValue();\n\t\t\t});\n\t\t},\n\t\tupdateStartHourElementValue: function () {\n\t\t\tvar form = this.getForm();\n\t\t\tvar startHourSelectElement = $('select[name=\"start_hour\"]', form);\n\t\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\t\tvar endHourSelectElement = $('select[name=\"end_hour\"]', form);\n\t\t\tendHourSelectElement\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('span.value')\n\t\t\t\t.text(endHourSelectElement.find('option:selected').text());\n\t\t},\n\t\tstartHourUpdateEvent: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElement(form);\n\t\t\t});\n\t\t},\n\t\tsaveFieldValues: function (fieldDetailList) {\n\t\t\tvar aDeferred = $.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar lock = false;\n\t\t\tvar recordId = this.getRecordId();\n\t\t\tvar data = {};\n\t\t\tif (typeof fieldDetailList !== 'undefined') {\n\t\t\t\tdata = fieldDetailList;\n\t\t\t\tif (data['field'] == 'email1') {\n\t\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\t\tfunction (data) {},\n\t\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lock !== true) {\n\t\t\t\tdata['record'] = recordId;\n\t\t\t\tdata['module'] = app.getModuleName();\n\t\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\t\tvar params = {};\n\t\t\t\tparams.data = data;\n\t\t\t\tparams.async = false;\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tAppConnector.request(params).done(function (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tvar form = this.getForm();\n\t\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.updateStartHourElement(form);\n\t\t\tthis.hourFormatUpdateEvent();\n\t\t\tthis.startHourUpdateEvent(form);\n\t\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","triggerDeleteUser","deleteUserUrl","app","showConfirmModal","title","vtranslate","confirmedCallback","AppConnector","request","done","data","callback","validationEngineOptions","params","onValidationComplete","form","valid","Users_Detail_Js","deleteUser","$","validationEngine","showModalWindow","userid","find","val","transferUserId","module","getModuleName","action","mode","transfer_user_id","permanent","success","hideModalWindow","showNotify","text","result","message","type","url","listViewUrl","window","location","href","triggerChangeAccessKey","accessKeyEle","length","html","accessKey","usersEditInstance","updateStartHourElement","triggerHourFormatChangeEvent","updateStartHourElementValue","hourFormatUpdateEvent","getForm","on","fieldUpdatedEvent","thisInstance","startHourSelectElement","selectedElementValue","closest","endHourSelectElement","startHourUpdateEvent","saveFieldValues","fieldDetailList","aDeferred","Deferred","lock","recordId","getRecordId","checkEmail","reject","async","dataType","reponseData","resolve","promise","registerEvents","_super","Vtiger_Edit_Js","getInstance","Users_Edit_Js","registerChangeEventForCurrencySeparator"],"mappings":"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"}