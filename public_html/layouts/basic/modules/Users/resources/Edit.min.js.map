{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Edit_Js(\"Users_Edit_Js\", {\n\t/**\n\t * Function to register change event for currency separator\n\t */\n\tregisterChangeEventForCurrencySeparator: function () {\n\t\tvar form = jQuery('form');\n\t\tjQuery('[name=\"currency_decimal_separator\"]', form).on('change', function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tvar selectedValue = element.val();\n\t\t\tvar groupingSeparatorValue = jQuery('[name=\"currency_grouping_separator\"]', form).data('selectedValue');\n\t\t\tif (groupingSeparatorValue == selectedValue) {\n\t\t\t\tvar message = app.vtranslate('JS_DECIMAL_SEPARATOR_AND_GROUPING_SEPARATOR_CANT_BE_SAME');\n\t\t\t\tvar params = {\n\t\t\t\t\ttext: message,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\tvar previousSelectedValue = element.data('selectedValue');\n\t\t\t\telement.find('option').removeAttr('selected');\n\t\t\t\telement.find('option[value=\"' + previousSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t\telement.trigger('change');\n\t\t\t} else {\n\t\t\t\telement.data('selectedValue', selectedValue);\n\t\t\t}\n\t\t});\n\t\tjQuery('[name=\"currency_grouping_separator\"]', form).on('change', function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tvar selectedValue = element.val();\n\t\t\tvar decimalSeparatorValue = jQuery('[name=\"currency_decimal_separator\"]', form).data('selectedValue');\n\t\t\tif (decimalSeparatorValue == selectedValue) {\n\t\t\t\tvar message = app.vtranslate('JS_DECIMAL_SEPARATOR_AND_GROUPING_SEPARATOR_CANT_BE_SAME');\n\t\t\t\tvar params = {\n\t\t\t\t\ttext: message,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\tvar previousSelectedValue = element.data('selectedValue');\n\t\t\t\telement.find('option').removeAttr('selected');\n\t\t\t\telement.find('option[value=\"' + previousSelectedValue + '\"]').attr('selected', 'selected');\n\t\t\t\telement.trigger('change');\n\t\t\t} else {\n\t\t\t\telement.data('selectedValue', selectedValue);\n\t\t\t}\n\t\t});\n\t}\n\n}, {\n\tduplicateCheckCache: {},\n\tuserExistCheckCache: {},\n\tpassCheckCache: {},\n\t//Hold the conditions for a hour format\n\thourFormatConditionMapping: false,\n\tregisterHourFormatChangeEvent: function () {\n\n\t},\n\tgetHourValues: function (list, currentValue) {\n\t\tvar options = '';\n\t\tfor (var key in list) {\n\t\t\t//IE Browser consider the prototype properties also, it should consider has own properties only.\n\t\t\tif (list.hasOwnProperty(key)) {\n\t\t\t\tvar conditionValue = list[key];\n\t\t\t\toptions += '<option value=\"' + key + '\"';\n\t\t\t\tif (key == currentValue) {\n\t\t\t\t\toptions += ' selected=\"selected\" ';\n\t\t\t\t}\n\t\t\t\toptions += '>' + conditionValue + '</option>';\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t},\n\tchangeStartHourValuesEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.on('change', 'select[name=\"hour_format\"]', function (e) {\n\t\t\tvar hourFormatVal = jQuery(e.currentTarget).val();\n\t\t\tvar startHourElement = jQuery('select[name=\"start_hour\"]', form);\n\t\t\tvar endHourElement = jQuery('select[name=\"end_hour\"]', form);\n\t\t\tvar conditionStartSelected = startHourElement.val();\n\t\t\tvar conditionEndSelected = endHourElement.val();\n\t\t\tif (typeof thisInstance.hourFormatConditionMapping === \"undefined\") {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar list = thisInstance.hourFormatConditionMapping['hour_format'][hourFormatVal]['start_hour'];\n\t\t\tstartHourElement.html(thisInstance.getHourValues(list, conditionStartSelected)).trigger('change');\n\t\t\tendHourElement.html(thisInstance.getHourValues(list, conditionEndSelected)).trigger('change');\n\t\t});\n\t},\n\ttriggerHourFormatChangeEvent(form) {\n\t\tthis.hourFormatConditionMapping = $('input[name=\"timeFormatOptions\"]', form).data('value');\n\t\tthis.changeStartHourValuesEvent(form);\n\t\t$('select[name=\"hour_format\"]', form).trigger('change');\n\t},\n\t/**\n\t * Function to register recordpresave event\n\t */\n\tregisterRecordPreSaveEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\tvar record = jQuery('input[name=\"record\"]').val();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'message': app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!record && jQuery('input[name=\"user_password\"]').val() != jQuery('input[name=\"confirm_password\"]').val()) {\n\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_REENTER_PASSWORDS'));\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tthisInstance.verifyFormData()\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(data.result.message);\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, error) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\te.preventDefault();\n\t\t\t\t});\n\t\t});\n\t},\n\tverifyFormData: function () {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar thisInstance = this;\n\t\tthisInstance.verifyData().done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}, function (data, error) {\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tverifyData: function () {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tAppConnector.request({\n\t\t\tasync: false,\n\t\t\tdata: {\n\t\t\t\tmodule: 'Users',\n\t\t\t\taction: 'VerifyData',\n\t\t\t\temail: jQuery('[name=\"email1\"]').val(),\n\t\t\t\tuserName: jQuery('input[name=\"user_name\"]').val(),\n\t\t\t\trecord: jQuery('input[name=\"record\"]').val(),\n\t\t\t\tpassword: jQuery('input[name=\"user_password\"]').val(),\n\n\t\t\t}\n\t\t}).done(function (data) {\n\t\t\tif (data.result) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t} else {\n\t\t\t\taDeferred.reject(data);\n\t\t\t}\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\tregisterEvents: function () {\n\t\tthis._super();\n\t\tvar form = this.getForm();\n\t\tthis.triggerHourFormatChangeEvent(form);\n\t\tthis.registerRecordPreSaveEvent(form);\n\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t}\n});\n"],"names":["Vtiger_Edit_Js","form","jQuery","on","e","element","currentTarget","selectedValue","val","data","params","app","vtranslate","showMessage","previousSelectedValue","find","removeAttr","attr","trigger","list","currentValue","options","key","hasOwnProperty","thisInstance","this","hourFormatVal","startHourElement","endHourElement","conditionStartSelected","conditionEndSelected","hourFormatConditionMapping","html","getHourValues","$","changeStartHourValuesEvent","recordPreSave","record","progressIndicatorElement","progressIndicator","showPnotify","mode","preventDefault","verifyFormData","done","result","message","fail","error","aDeferred","Deferred","verifyData","resolve","reject","promise","request","_super","getForm","triggerHourFormatChangeEvent","registerRecordPreSaveEvent","registerChangeEventForCurrencySeparator"],"mappings":"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"}