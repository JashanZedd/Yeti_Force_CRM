{"version":3,"file":"Import.min.js","sources":["Import.js"],"sourcesContent":["/*+**********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n ************************************************************************************/\n'use strict';\n\nif (typeof ImportJs === 'undefined') {\n\t/*\n\t * Namespaced javascript class for Import\n\t */\n\tvar ImportJs = {\n\t\ttoogleMergeConfiguration: function() {\n\t\t\tvar mergeChecked = jQuery('#auto_merge').is(':checked');\n\t\t\tvar duplicateMergeConfiguration = jQuery('#duplicates_merge_configuration');\n\t\t\tif (mergeChecked) {\n\t\t\t\tduplicateMergeConfiguration.show();\n\t\t\t} else {\n\t\t\t\tduplicateMergeConfiguration.hide();\n\t\t\t}\n\t\t},\n\t\tcheckFileType: function() {\n\t\t\tvar filePath = jQuery('#import_file').val();\n\t\t\tif (filePath != '') {\n\t\t\t\tvar fileExtension = filePath.split('.').pop();\n\t\t\t\tjQuery('#type').val(fileExtension);\n\t\t\t\tImportJs.handleFileTypeChange();\n\t\t\t}\n\t\t},\n\t\thandleFileTypeChange: function() {\n\t\t\tvar fileType = jQuery('.js-type').val();\n\t\t\tvar delimiterContainer = jQuery('.js-delimiter-container');\n\t\t\tvar hasHeaderContainer = jQuery('.js-has-header-container');\n\t\t\tvar xmlTpl = jQuery('.js-xml-tpl');\n\t\t\tvar extension = jQuery('.js-zip-extension');\n\n\t\t\tswitch (fileType) {\n\t\t\t\tcase 'xml':\n\t\t\t\t\tdelimiterContainer.addClass('d-none');\n\t\t\t\t\thasHeaderContainer.addClass('d-none');\n\t\t\t\t\txmlTpl.removeClass('d-none');\n\t\t\t\t\textension.addClass('d-none');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'zip':\n\t\t\t\t\tdelimiterContainer.addClass('d-none');\n\t\t\t\t\thasHeaderContainer.addClass('d-none');\n\t\t\t\t\textension.removeClass('d-none');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdelimiterContainer.removeClass('d-none');\n\t\t\t\t\thasHeaderContainer.removeClass('d-none');\n\t\t\t\t\textension.addClass('d-none');\n\t\t\t\t\txmlTpl.addClass('d-none');\n\t\t\t}\n\t\t},\n\t\tuploadAndParse: function() {\n\t\t\tif (!ImportJs.validateFilePath()) return false;\n\t\t\tif (!ImportJs.validateMergeCriteria()) return false;\n\t\t\treturn true;\n\t\t},\n\t\tregisterImportClickEvent() {\n\t\t\t$('#importButton')\n\t\t\t\t.removeAttr('disabled')\n\t\t\t\t.on('click', function(e) {\n\t\t\t\t\treturn ImportJs.sanitizeAndSubmit();\n\t\t\t\t});\n\t\t},\n\t\tvalidateFilePath: function() {\n\t\t\tvar importFile = jQuery('#import_file');\n\t\t\tvar filePath = importFile.val();\n\t\t\tif (jQuery.trim(filePath) == '') {\n\t\t\t\tvar errorMessage = app.vtranslate('JS_IMPORT_FILE_CAN_NOT_BE_EMPTY');\n\t\t\t\tvar params = {\n\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\timportFile.focus();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!ImportJs.uploadFilter('import_file', 'csv|vcf|xml|zip|ics|ical')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!ImportJs.uploadFileSize('import_file')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tuploadFilter: function(elementId, allowedExtensions) {\n\t\t\tvar obj = jQuery('#' + elementId);\n\t\t\tif (obj) {\n\t\t\t\tvar filePath = obj.val();\n\t\t\t\tvar fileParts = filePath.toLowerCase().split('.');\n\t\t\t\tvar fileType = fileParts[fileParts.length - 1];\n\t\t\t\tvar validExtensions = allowedExtensions.toLowerCase().split('|');\n\t\t\t\tif (validExtensions.indexOf(fileType) < 0) {\n\t\t\t\t\tvar errorMessage = app.vtranslate('JS_SELECT_FILE_EXTENSION') + '\\n' + validExtensions;\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\t\tobj.focus();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tuploadFileSize: function(elementId) {\n\t\t\tvar element = jQuery('#' + elementId);\n\t\t\tvar importMaxUploadSize = element.closest('td').data('importUploadSize');\n\t\t\tvar importMaxUploadSizeInMb = element.closest('td').data('importUploadSizeMb');\n\t\t\tvar uploadedFileSize = element.get(0).files[0].size;\n\t\t\tif (uploadedFileSize > importMaxUploadSize) {\n\t\t\t\tvar errorMessage =\n\t\t\t\t\tapp.vtranslate('JS_UPLOADED_FILE_SIZE_EXCEEDS') +\n\t\t\t\t\t' ' +\n\t\t\t\t\timportMaxUploadSizeInMb +\n\t\t\t\t\t' MB.' +\n\t\t\t\t\tapp.vtranslate('JS_PLEASE_SPLIT_FILE_AND_IMPORT_AGAIN');\n\t\t\t\tvar params = {\n\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tvalidateMergeCriteria: function() {\n\t\t\tvar mergeChecked = jQuery('#auto_merge').is(':checked');\n\t\t\tif (mergeChecked) {\n\t\t\t\tvar selectedOptions = jQuery('#selected_merge_fields option');\n\t\t\t\tif (selectedOptions.length == 0) {\n\t\t\t\t\tvar errorMessage = app.vtranslate('JS_PLEASE_SELECT_ONE_FIELD_FOR_MERGE');\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tImportJs.convertOptionsToJSONArray('#selected_merge_fields', '#merge_fields');\n\t\t\treturn true;\n\t\t},\n\t\tconvertOptionsToJSONArray: function(objName, targetObjName) {\n\t\t\tvar obj = jQuery(objName);\n\t\t\tvar arr = [];\n\t\t\tif (typeof obj !== 'undefined' && obj[0] != '') {\n\t\t\t\tfor (var i = 0; i < obj[0].length; ++i) {\n\t\t\t\t\tarr.push(obj[0].options[i].value);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (targetObjName !== 'undefined') {\n\t\t\t\tvar targetObj = $(targetObjName);\n\t\t\t\tif (typeof targetObj !== 'undefined') targetObj.val(JSON.stringify(arr));\n\t\t\t}\n\t\t\treturn arr;\n\t\t},\n\t\tcopySelectedOptions: function(source, destination) {\n\t\t\tvar srcObj = jQuery(source);\n\t\t\tvar destObj = jQuery(destination);\n\n\t\t\tif (typeof srcObj === 'undefined' || typeof destObj === 'undefined') return;\n\n\t\t\tfor (var i = 0; i < srcObj[0].length; i++) {\n\t\t\t\tif (srcObj[0].options[i].selected == true) {\n\t\t\t\t\tvar rowFound = false;\n\t\t\t\t\tvar existingObj = null;\n\t\t\t\t\tfor (var j = 0; j < destObj[0].length; j++) {\n\t\t\t\t\t\tif (destObj[0].options[j].value == srcObj[0].options[i].value) {\n\t\t\t\t\t\t\trowFound = true;\n\t\t\t\t\t\t\texistingObj = destObj[0].options[j];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (rowFound != true) {\n\t\t\t\t\t\tvar opt = $('<option selected>');\n\t\t\t\t\t\topt.attr('value', srcObj[0].options[i].value);\n\t\t\t\t\t\topt.text(srcObj[0].options[i].text);\n\t\t\t\t\t\tjQuery(destObj[0]).append(opt);\n\t\t\t\t\t\tsrcObj[0].options[i].selected = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (existingObj != null) existingObj.selected = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveSelectedOptions: function(objName) {\n\t\t\tvar obj = jQuery(objName);\n\t\t\tif (!obj.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (var i = obj[0].options.length - 1; i >= 0; i--) {\n\t\t\t\tif (obj[0].options[i].selected == true) {\n\t\t\t\t\tobj[0].options[i] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsanitizeAndSubmit: function() {\n\t\t\tif (!ImportJs.sanitizeFieldMapping()) return false;\n\t\t\tif (!ImportJs.validateCustomMap()) return false;\n\t\t\treturn true;\n\t\t},\n\t\tsanitizeFieldMapping: function() {\n\t\t\tvar fieldsList = jQuery('.fieldIdentifier');\n\t\t\tvar mappedFields = {};\n\t\t\tvar inventoryMappedFields = {};\n\t\t\tvar errorMessage;\n\t\t\tvar params = {};\n\t\t\tvar mappedDefaultValues = {};\n\t\t\tfor (var i = 0; i < fieldsList.length; ++i) {\n\t\t\t\tvar fieldElement = jQuery(fieldsList.get(i));\n\t\t\t\tvar rowId = jQuery('[name=row_counter]', fieldElement).get(0).value;\n\t\t\t\tvar selectElement = jQuery('select', fieldElement);\n\t\t\t\tvar selectedFieldElement = selectElement.find('option:selected');\n\t\t\t\tvar selectedFieldName = selectedFieldElement.val();\n\t\t\t\tvar selectedFieldDefaultValueElement = jQuery('#' + selectedFieldName + '_defaultvalue', fieldElement);\n\t\t\t\tvar defaultValue = '';\n\t\t\t\tif (selectedFieldDefaultValueElement.attr('type') == 'checkbox') {\n\t\t\t\t\tdefaultValue = selectedFieldDefaultValueElement.is(':checked');\n\t\t\t\t} else {\n\t\t\t\t\tdefaultValue = selectedFieldDefaultValueElement.val();\n\t\t\t\t}\n\t\t\t\tif (selectedFieldName != '') {\n\t\t\t\t\tvar stopImmediately;\n\t\t\t\t\tif (selectElement.hasClass('inventory')) {\n\t\t\t\t\t\tstopImmediately = ImportJs.checkIfMappedFieldExist(\n\t\t\t\t\t\t\tselectedFieldName,\n\t\t\t\t\t\t\tinventoryMappedFields,\n\t\t\t\t\t\t\tselectedFieldElement\n\t\t\t\t\t\t);\n\t\t\t\t\t\tinventoryMappedFields[selectedFieldName] = rowId - 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstopImmediately = ImportJs.checkIfMappedFieldExist(selectedFieldName, mappedFields, selectedFieldElement);\n\t\t\t\t\t\tmappedFields[selectedFieldName] = rowId - 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (stopImmediately) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (defaultValue != '') {\n\t\t\t\t\t\tmappedDefaultValues[selectedFieldName] = defaultValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar mandatoryFields = JSON.parse(jQuery('#mandatory_fields').val());\n\t\t\tvar missingMandatoryFields = [];\n\t\t\tfor (var mandatoryFieldName in mandatoryFields) {\n\t\t\t\tif (mandatoryFieldName in mappedFields) {\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\tmissingMandatoryFields.push('\"' + mandatoryFields[mandatoryFieldName] + '\"');\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (missingMandatoryFields.length > 0) {\n\t\t\t\terrorMessage = app.vtranslate('JS_MAP_MANDATORY_FIELDS') + missingMandatoryFields.join(',');\n\t\t\t\tparams = {\n\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tjQuery('#field_mapping').val(JSON.stringify(mappedFields));\n\t\t\tjQuery('#inventory_field_mapping').val(JSON.stringify(inventoryMappedFields));\n\t\t\tjQuery('#default_values').val(JSON.stringify(mappedDefaultValues));\n\t\t\treturn true;\n\t\t},\n\t\tcheckIfMappedFieldExist: function(selectedFieldName, mappedFields, selectedFieldElement) {\n\t\t\tif (selectedFieldName in mappedFields) {\n\t\t\t\tvar errorMessage = app.vtranslate('JS_FIELD_MAPPED_MORE_THAN_ONCE') + ' ' + selectedFieldElement.data('label');\n\t\t\t\tvar params = {\n\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t};\n\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tvalidateCustomMap: function() {\n\t\t\tvar errorMessage;\n\t\t\tvar params = {};\n\t\t\tvar saveMap = jQuery('#save_map').is(':checked');\n\t\t\tif (saveMap) {\n\t\t\t\tvar mapName = jQuery('#save_map_as').val();\n\t\t\t\tif (jQuery.trim(mapName) == '') {\n\t\t\t\t\terrorMessage = app.vtranslate('JS_MAP_NAME_CAN_NOT_BE_EMPTY');\n\t\t\t\t\tparams = {\n\t\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar mapOptions = jQuery('#saved_maps option');\n\t\t\t\tfor (var i = 0; i < mapOptions.length; ++i) {\n\t\t\t\t\tvar mapOption = jQuery(mapOptions.get(i));\n\t\t\t\t\tif (mapOption.html() == mapName) {\n\t\t\t\t\t\terrorMessage = app.vtranslate('JS_MAP_NAME_ALREADY_EXISTS');\n\t\t\t\t\t\tparams = {\n\t\t\t\t\t\t\ttext: errorMessage,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tVtiger_Helper_Js.showMessage(params);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tloadSavedMap: function() {\n\t\t\tvar selectedMapElement = jQuery('#saved_maps option:selected');\n\t\t\tvar mapId = selectedMapElement.attr('id');\n\t\t\tvar fieldsList = jQuery('.fieldIdentifier');\n\t\t\tvar deleteMapContainer = jQuery('#delete_map_container');\n\t\t\tfieldsList.each(function(i, element) {\n\t\t\t\tvar fieldElement = jQuery(element);\n\t\t\t\tjQuery('[name=mapped_fields]', fieldElement).val('');\n\t\t\t});\n\t\t\tif (mapId == -1) {\n\t\t\t\tdeleteMapContainer.hide();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdeleteMapContainer.show();\n\t\t\tvar mappingString = selectedMapElement.val();\n\t\t\tif (mappingString == '') return;\n\t\t\tvar mappingPairs = mappingString.split('&');\n\t\t\tvar mapping = {};\n\t\t\tfor (var i = 0; i < mappingPairs.length; ++i) {\n\t\t\t\tvar mappingPair = mappingPairs[i].split('=');\n\t\t\t\tvar header = mappingPair[0];\n\t\t\t\theader = header.replace(/\\/eq\\//g, '=');\n\t\t\t\theader = header.replace(/\\/amp\\//g, '&');\n\t\t\t\tmapping[\"'\" + header + \"'\"] = mappingPair[1];\n\t\t\t}\n\t\t\tfieldsList.each(function(i, element) {\n\t\t\t\tvar fieldElement = jQuery(element);\n\t\t\t\tvar mappedFields = jQuery('[name=mapped_fields]', fieldElement);\n\t\t\t\tvar rowId = jQuery('[name=row_counter]', fieldElement).get(0).value;\n\t\t\t\tvar headerNameElement = jQuery('[name=header_name]', fieldElement).get(0);\n\t\t\t\tvar headerName = jQuery(headerNameElement).html();\n\t\t\t\tif (\"'\" + headerName + \"'\" in mapping) {\n\t\t\t\t\tmappedFields.val(mapping[\"'\" + headerName + \"'\"]);\n\t\t\t\t} else if (rowId in mapping) {\n\t\t\t\t\tmappedFields.val($rowId);\n\t\t\t\t}\n\t\t\t\tmappedFields.trigger('change');\n\t\t\t\tImportJs.loadDefaultValueWidget(fieldElement.attr('id'));\n\t\t\t});\n\t\t},\n\t\tdeleteMap: function(module) {\n\t\t\tlet callback = function() {\n\t\t\t\tvar selectedMapElement = jQuery('#saved_maps option:selected');\n\t\t\t\tvar mapId = selectedMapElement.attr('id');\n\t\t\t\tvar status = jQuery('#status');\n\t\t\t\tstatus.show();\n\t\t\t\tvar postData = {\n\t\t\t\t\tmodule: module,\n\t\t\t\t\tview: 'Import',\n\t\t\t\t\tmode: 'deleteMap',\n\t\t\t\t\tmapid: mapId\n\t\t\t\t};\n\n\t\t\t\tAppConnector.request(postData)\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tjQuery('#savedMapsContainer').html(data);\n\t\t\t\t\t\tstatus.hide();\n\t\t\t\t\t\tvar parent = jQuery('#saved_maps');\n\t\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(parent);\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t});\n\t\t\t};\n\t\t\tapp.showConfirmModal(app.vtranslate('LBL_DELETE_CONFIRMATION'), callback);\n\t\t},\n\t\tloadDefaultValueWidget: function(rowIdentifierId) {\n\t\t\tvar affectedRow = jQuery('#' + rowIdentifierId);\n\t\t\tif (typeof affectedRow === 'undefined' || affectedRow == null) return;\n\t\t\tvar selectedFieldElement = jQuery('[name=mapped_fields]', affectedRow).get(0);\n\t\t\tvar selectedFieldName = jQuery(selectedFieldElement).val();\n\t\t\tvar defaultValueContainer = jQuery(jQuery('[name=default_value_container]', affectedRow).get(0));\n\t\t\tvar allDefaultValuesContainer = jQuery('#defaultValuesElementsContainer');\n\t\t\tif (defaultValueContainer.children.length > 0) {\n\t\t\t\tvar copyOfDefaultValueWidget = jQuery(':first', defaultValueContainer).detach();\n\t\t\t\tcopyOfDefaultValueWidget.appendTo(allDefaultValuesContainer);\n\t\t\t}\n\t\t\tvar selectedFieldDefValueContainer = jQuery(\n\t\t\t\t'#' + selectedFieldName + '_defaultvalue_container',\n\t\t\t\tallDefaultValuesContainer\n\t\t\t);\n\t\t\tvar defaultValueWidget = selectedFieldDefValueContainer.detach();\n\t\t\tdefaultValueWidget.appendTo(defaultValueContainer);\n\t\t},\n\t\tloadDefaultValueWidgetForMappedFields: function() {\n\t\t\tvar fieldsList = jQuery('.fieldIdentifier');\n\t\t\tfieldsList.each(function(i, element) {\n\t\t\t\tvar fieldElement = jQuery(element);\n\t\t\t\tvar mappedFieldName = jQuery('[name=mapped_fields]', fieldElement).val();\n\t\t\t\tif (mappedFieldName != '') {\n\t\t\t\t\tImportJs.loadDefaultValueWidget(fieldElement.attr('id'));\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsubmitAction: function() {\n\t\t\tvar form = jQuery('[name=\"importAdvanced\"]');\n\t\t\tform.on('submit', function() {\n\t\t\t\t$.progressIndicator({\n\t\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\topenListInModal: function() {\n\t\t\t$('.js-open-list-in-modal').on('click', function() {\n\t\t\t\tlet element = $(this),\n\t\t\t\t\tmoduleName = element.data('module-name'),\n\t\t\t\t\ttype = '',\n\t\t\t\t\tforUser = element.data('for-user'),\n\t\t\t\t\tforModule = element.data('for-module');\n\t\t\t\tif ($(this).attr('data-type') !== '') {\n\t\t\t\t\ttype = '&type=' + element.data('type');\n\t\t\t\t}\n\t\t\t\tapp.showModalWindow(\n\t\t\t\t\tnull,\n\t\t\t\t\t'index.php?module=' +\n\t\t\t\t\t\tmoduleName +\n\t\t\t\t\t\t'&view=List&mode=getImportDetails' +\n\t\t\t\t\t\ttype +\n\t\t\t\t\t\t'&start=1&foruser=' +\n\t\t\t\t\t\tforUser +\n\t\t\t\t\t\t'&forModule=' +\n\t\t\t\t\t\tforModule,\n\t\t\t\t\tfunction(data) {\n\t\t\t\t\t\tlet container = data.find('.listViewEntriesDiv'),\n\t\t\t\t\t\t\tcontainerH = container.height(),\n\t\t\t\t\t\t\tcontainerOffsetTop = container.offset().top,\n\t\t\t\t\t\t\tfooterH = $('.js-footer').height(),\n\t\t\t\t\t\t\twindowH = $(window).height();\n\t\t\t\t\t\tif (Quasar.plugins.Platform.is.desktop) {\n\t\t\t\t\t\t\tif (containerH + containerOffsetTop + footerH > windowH) {\n\t\t\t\t\t\t\t\tcontainer.height(windowH - (containerOffsetTop + footerH));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tapp.showNewScrollbarTopBottomRight(container);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t};\n\n\tjQuery(document).ready(function() {\n\t\tImportJs.toogleMergeConfiguration();\n\t\tImportJs.openListInModal();\n\t\tImportJs.submitAction();\n\t\tImportJs.loadDefaultValueWidgetForMappedFields();\n\t\tImportJs.registerImportClickEvent();\n\t\tApp.Fields.Date.register(jQuery('.contentsDiv'));\n\t});\n}\n"],"names":["ImportJs","mergeChecked","jQuery","is","duplicateMergeConfiguration","show","hide","filePath","val","fileExtension","split","pop","handleFileTypeChange","fileType","delimiterContainer","hasHeaderContainer","xmlTpl","extension","addClass","removeClass","validateFilePath","validateMergeCriteria","removeAttr","on","e","sanitizeAndSubmit","importFile","trim","params","app","vtranslate","showMessage","focus","uploadFilter","uploadFileSize","elementId","allowedExtensions","obj","fileParts","toLowerCase","length","validExtensions","indexOf","element","importMaxUploadSize","closest","data","importMaxUploadSizeInMb","get","files","size","convertOptionsToJSONArray","objName","targetObjName","arr","i","push","options","value","targetObj","$","JSON","stringify","source","destination","srcObj","destObj","selected","rowFound","existingObj","j","opt","attr","text","append","sanitizeFieldMapping","validateCustomMap","fieldsList","mappedFields","inventoryMappedFields","mappedDefaultValues","fieldElement","rowId","selectElement","selectedFieldElement","find","selectedFieldName","selectedFieldDefaultValueElement","defaultValue","stopImmediately","hasClass","checkIfMappedFieldExist","mandatoryFields","parse","missingMandatoryFields","mandatoryFieldName","join","mapName","mapOptions","html","selectedMapElement","mapId","deleteMapContainer","each","mappingString","mappingPairs","mapping","mappingPair","header","replace","headerNameElement","headerName","$rowId","trigger","loadDefaultValueWidget","module","showConfirmModal","status","postData","request","done","parent","Fields","Picklist","changeSelectElementView","fail","error","err","rowIdentifierId","affectedRow","defaultValueContainer","allDefaultValuesContainer","children","detach","appendTo","progressIndicator","this","moduleName","type","forUser","forModule","showModalWindow","container","containerH","height","containerOffsetTop","offset","top","footerH","windowH","window","Quasar","plugins","Platform","desktop","showNewScrollbarTopBottomRight","document","ready","toogleMergeConfiguration","openListInModal","submitAction","loadDefaultValueWidgetForMappedFields","registerImportClickEvent","Date","register"],"mappings":"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"}