{"version":3,"file":"helper.min.js","sources":["helper.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\n$.Class(\n\t'Vtiger_Helper_Js',\n\t{\n\t\tcheckServerConfigResponseCache: '',\n\t\tlangCode: '',\n\t\t/*\n\t\t * Function to set lang code\n\t\t */\n\t\tsetLangCode: function() {\n\t\t\tvar htmlTag = document.getElementsByTagName('html')[0];\n\t\t\tthis.langCode = htmlTag.getAttribute('lang') ? htmlTag.getAttribute('lang') : 'en';\n\t\t},\n\t\t/*\n\t\t * Function to get lang code\n\t\t */\n\t\tgetLangCode: function() {\n\t\t\tif (!this.langCode) {\n\t\t\t\tthis.setLangCode();\n\t\t\t}\n\t\t\treturn this.langCode;\n\t\t},\n\t\t/*\n\t\t * Function to get the instance of Mass edit of Email\n\t\t */\n\t\tgetEmailMassEditInstance: function() {\n\t\t\tvar className = 'Emails_MassEdit_Js';\n\t\t\tvar emailMassEditInstance = new window[className]();\n\t\t\treturn emailMassEditInstance;\n\t\t},\n\t\tgetDayFromDate: function(date) {\n\t\t\tvar dayOfWeek = this.getDay(date);\n\t\t\treturn this.getLabelDayFromDate(dayOfWeek);\n\t\t},\n\t\tgetDay: function(date) {\n\t\t\tvar dateObj = new Date(date);\n\t\t\tif (isNaN(dateObj.getDay())) {\n\t\t\t\tdateObj = Date.parse(date);\n\t\t\t}\n\t\t\treturn dateObj.getDay();\n\t\t},\n\t\tgetLabelDayFromDate: function(day) {\n\t\t\tvar dayOfWeek = day;\n\t\t\tvar dayOfWeekLabel = '';\n\t\t\tswitch (dayOfWeek) {\n\t\t\t\tcase 0:\n\t\t\t\t\tdayOfWeekLabel = 'JS_SUN';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tdayOfWeekLabel = 'JS_MON';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tdayOfWeekLabel = 'JS_TUE';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tdayOfWeekLabel = 'JS_WED';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tdayOfWeekLabel = 'JS_THU';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 5:\n\t\t\t\t\tdayOfWeekLabel = 'JS_FRI';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 6:\n\t\t\t\t\tdayOfWeekLabel = 'JS_SAT';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn app.vtranslate(dayOfWeekLabel);\n\t\t},\n\t\t/*\n\t\t * Function to get Date Instance\n\t\t * @params date---this is the field value\n\t\t * @params dateFormat---user date format\n\t\t * @return date object\n\t\t */\n\n\t\tgetDateInstance: function(dateTime, dateFormat) {\n\t\t\tlet dateTimeComponents = dateTime.split(' '),\n\t\t\t\tdateComponent = dateTimeComponents[0],\n\t\t\t\ttimeComponent = dateTimeComponents[1],\n\t\t\t\tseconds = '00',\n\t\t\t\tdotMode = '-';\n\t\t\tif (dateFormat.indexOf('-') !== -1) {\n\t\t\t\tdotMode = '-';\n\t\t\t}\n\t\t\tif (dateFormat.indexOf('.') !== -1) {\n\t\t\t\tdotMode = '.';\n\t\t\t}\n\t\t\tif (dateFormat.indexOf('/') !== -1) {\n\t\t\t\tdotMode = '/';\n\t\t\t}\n\n\t\t\tlet splittedDate = dateComponent.split(dotMode),\n\t\t\t\tsplittedDateFormat = dateFormat.split(dotMode),\n\t\t\t\tyear = splittedDate[splittedDateFormat.indexOf('yyyy')],\n\t\t\t\tmonth = splittedDate[splittedDateFormat.indexOf('mm')],\n\t\t\t\tdate = splittedDate[splittedDateFormat.indexOf('dd')],\n\t\t\t\tdateInstance = Date.parse(year + '/' + month + '/' + date);\n\t\t\tif (isNaN(dateInstance) || year.length > 4 || month.length > 2 || date.length > 2 || dateInstance == null) {\n\t\t\t\tthrow app.vtranslate('JS_INVALID_DATE');\n\t\t\t}\n\n\t\t\t//Before creating date object time is set to 00\n\t\t\t//because as while calculating date object it depends system timezone\n\t\t\tif (typeof timeComponent === 'undefined') {\n\t\t\t\ttimeComponent = '00:00:00';\n\t\t\t}\n\n\t\t\tlet timeSections = timeComponent.split(':');\n\t\t\tif (typeof timeSections[2] !== 'undefined') {\n\t\t\t\tseconds = timeSections[2];\n\t\t\t}\n\n\t\t\t//Am/Pm component exits\n\t\t\tif (typeof dateTimeComponents[2] !== 'undefined') {\n\t\t\t\tif (dateTimeComponents[2].toLowerCase() === 'pm' && timeSections[0] !== '12') {\n\t\t\t\t\ttimeSections[0] = parseInt(timeSections[0], 10) + 12;\n\t\t\t\t}\n\n\t\t\t\tif (dateTimeComponents[2].toLowerCase() === 'am' && timeSections[0] === '12') {\n\t\t\t\t\ttimeSections[0] = '00';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tmonth = month - 1;\n\t\t\tdateInstance = new Date(year, month, date, timeSections[0], timeSections[1], seconds);\n\t\t\treturn dateInstance;\n\t\t},\n\t\t/*\n\t\t * Function to show the confirmation messagebox\n\t\t */\n\t\tshowConfirmationBox: function(params) {\n\t\t\tvar aDeferred = $.Deferred();\n\t\t\tvar baseParams = {\n\t\t\t\tcallback: function(result) {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\taDeferred.resolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar bootBoxModal = bootbox.confirm($.extend(baseParams, params));\n\t\t\tbootBoxModal.on('hidden', function(e) {\n\t\t\t\t//In Case of multiple modal. like mass edit and quick create, if bootbox is shown and hidden , it will remove\n\t\t\t\t// modal open\n\t\t\t\tif ($('#' + Window.lastModalId).length > 0) {\n\t\t\t\t\t// Mimic bootstrap modal action body state change\n\t\t\t\t\t$('body').addClass('modal-open');\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tshowMessage: function(params) {\n\t\t\tif (typeof params.type === 'undefined') {\n\t\t\t\tparams.type = 'info';\n\t\t\t}\n\t\t\tif (typeof params.title === 'undefined') {\n\t\t\t\tparams.title = app.vtranslate('JS_MESSAGE');\n\t\t\t}\n\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t},\n\t\t/*\n\t\t * Function to show pnotify message\n\t\t */\n\t\tshowPnotify: function(customParams) {\n\t\t\tlet userParams = customParams;\n\t\t\tif (typeof customParams === 'string') {\n\t\t\t\tuserParams = {};\n\t\t\t\tuserParams.text = customParams;\n\t\t\t}\n\t\t\tlet params = {\n\t\t\t\ttarget: document.body,\n\t\t\t\tdata: {\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\thide: false,\n\t\t\t\t\tdelay: '2000',\n\t\t\t\t\tmodules: {\n\t\t\t\t\t\tButtons: {\n\t\t\t\t\t\t\tcloserHover: false,\n\t\t\t\t\t\t\tlabels: { close: app.vtranslate('JS_CLOSE') }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tAnimate: {\n\t\t\t\t\t\t\tanimate: true,\n\t\t\t\t\t\t\tinClass: 'zoomInLeft',\n\t\t\t\t\t\t\toutClass: 'zoomOutRight'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (typeof customParams.type !== 'undefined' && customParams.type != 'error') {\n\t\t\t\tparams.data.hide = true;\n\t\t\t}\n\t\t\tparams.data = $.extend(params.data, userParams);\n\t\t\treturn new PNotify(params);\n\t\t},\n\t\t/*\n\t\t * Function to remove pnotify message\n\t\t */\n\t\thidePnotify: function(notice) {\n\t\t\tif (typeof notice === 'undefined') {\n\t\t\t\tnotice = $('.ui-pnotify');\n\t\t\t}\n\t\t\tnotice.remove();\n\t\t},\n\t\t/*\n\t\t * Function to add clickoutside event on the element - By using outside events plugin\n\t\t * @params element---On which element you want to apply the click outside event\n\t\t * @params callbackFunction---This function will contain the actions triggered after clickoutside event\n\t\t */\n\t\taddClickOutSideEvent: function(element, callbackFunction) {\n\t\t\telement.one('clickoutside', callbackFunction);\n\t\t},\n\t\t/*\n\t\t * Function to show horizontal top scroll bar\n\t\t */\n\t\tshowHorizontalTopScrollBar: function() {\n\t\t\tvar container = $('.contentsDiv');\n\t\t\tvar topScroll = $('.contents-topscroll', container);\n\t\t\tvar bottomScroll = $('.contents-bottomscroll', container);\n\t\t\t$('.bottomscroll-div', container).attr('style', '');\n\t\t\t$('.topscroll-div', container).css('width', $('.bottomscroll-div', container).outerWidth());\n\t\t\t$('.bottomscroll-div', container).css('width', $('.topscroll-div', container).outerWidth());\n\t\t\ttopScroll.on('scroll', function() {\n\t\t\t\tbottomScroll.scrollLeft(topScroll.scrollLeft());\n\t\t\t});\n\t\t\tbottomScroll.on('scroll', function() {\n\t\t\t\ttopScroll.scrollLeft(bottomScroll.scrollLeft());\n\t\t\t});\n\t\t},\n\t\tconvertToDateString: function(stringDate, dateFormat, modDay, type) {\n\t\t\tvar dotMode = '-';\n\t\t\tif (dateFormat.indexOf('-') !== -1) {\n\t\t\t\tdotMode = '-';\n\t\t\t}\n\t\t\tif (dateFormat.indexOf('.') !== -1) {\n\t\t\t\tdotMode = '.';\n\t\t\t}\n\t\t\tif (dateFormat.indexOf('/') !== -1) {\n\t\t\t\tdotMode = '/';\n\t\t\t}\n\n\t\t\tvar splittedDate = stringDate.split(dotMode);\n\t\t\tvar splittedDateFormat = dateFormat.split(dotMode);\n\t\t\tvar year = splittedDate[splittedDateFormat.indexOf('yyyy')];\n\t\t\tvar month = splittedDate[splittedDateFormat.indexOf('mm')];\n\t\t\tvar date = splittedDate[splittedDateFormat.indexOf('dd')];\n\t\t\tvar dateInstance = new Date(year, month - 1, date);\n\t\t\tif (year.length > 4 || month.length > 2 || date.length > 2 || dateInstance == null) {\n\t\t\t\tvar errorMsg = app.vtranslate('JS_INVALID_DATE');\n\t\t\t\tthrow errorMsg;\n\t\t\t}\n\t\t\tvar newDate = dateInstance;\n\t\t\tif ('0' == modDay) {\n\t\t\t\tif ('Calendar' == type) {\n\t\t\t\t\tnewDate.setDate(dateInstance.getDate() - 1);\n\t\t\t\t}\n\t\t\t} else if ('-1' == modDay) {\n\t\t\t\tif ('Calendar' == type) {\n\t\t\t\t\tnewDate.setDate(dateInstance.getDate() - 2);\n\t\t\t\t} else {\n\t\t\t\t\tnewDate.setDate(dateInstance.getDate() - 1);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ('Calendar' != type) {\n\t\t\t\t\tnewDate.setTime(dateInstance.getTime() + parseInt(modDay) * 24 * 60 * 60 * 1000);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn app.getStringDate(newDate);\n\t\t},\n\t\thideOptions: function(element, attr, value) {\n\t\t\tvar opval = '';\n\t\t\telement.find('option').each(function(index, option) {\n\t\t\t\toption = $(option);\n\t\t\t\tif (value != option.data(attr)) {\n\t\t\t\t\toption.addClass('d-none');\n\t\t\t\t\toption.attr('disabled', 'disabled');\n\t\t\t\t} else {\n\t\t\t\t\tif (opval == '') {\n\t\t\t\t\t\topval = option.val();\n\t\t\t\t\t}\n\t\t\t\t\toption.removeClass('d-none');\n\t\t\t\t\toption.removeAttr('disabled');\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.val(opval).trigger('change');\n\t\t},\n\t\tunique: function(array) {\n\t\t\treturn array.filter(function(el, index, arr) {\n\t\t\t\treturn index === arr.indexOf(el);\n\t\t\t});\n\t\t}\n\t},\n\t{}\n);\n"],"names":["$","Class","htmlTag","document","getElementsByTagName","langCode","getAttribute","this","setLangCode","window","date","dayOfWeek","getDay","getLabelDayFromDate","dateObj","Date","isNaN","parse","day","dayOfWeekLabel","app","vtranslate","dateTime","dateFormat","dateTimeComponents","split","dateComponent","timeComponent","seconds","dotMode","indexOf","splittedDate","splittedDateFormat","year","month","dateInstance","length","timeSections","toLowerCase","parseInt","params","aDeferred","Deferred","baseParams","result","resolve","reject","bootbox","confirm","extend","on","e","Window","lastModalId","addClass","promise","type","title","showPnotify","customParams","userParams","text","body","close","data","hide","PNotify","notice","remove","element","callbackFunction","one","container","topScroll","bottomScroll","attr","css","outerWidth","scrollLeft","stringDate","modDay","newDate","setDate","getDate","setTime","getTime","getStringDate","value","opval","find","each","index","option","val","removeClass","removeAttr","trigger","array","filter","el","arr"],"mappings":"aAWAA,EAAEC,MACD,mBACA,gCACiC,YACtB,eAIG,eACRC,QAAUC,SAASC,qBAAqB,QAAQ,QAC/CC,SAAWH,QAAQI,aAAa,QAAUJ,QAAQI,aAAa,QAAU,kBAKlE,kBACPC,KAAKF,eACJG,cAECD,KAAKF,mCAKa,kBAEG,IAAII,OAAA,mCAGjB,SAASC,UACpBC,UAAYJ,KAAKK,OAAOF,aACrBH,KAAKM,oBAAoBF,mBAEzB,SAASD,UACZI,QAAU,IAAIC,KAAKL,aACnBM,MAAMF,QAAQF,oBACPG,KAAKE,MAAMP,OAEfI,QAAQF,8BAEK,SAASM,SAEzBC,eAAiB,UADLD,UAGV,iBACa,oBAEb,iBACa,oBAEb,iBACa,oBAEb,iBACa,oBAEb,iBACa,oBAEb,iBACa,oBAEb,iBACa,gBAGZE,IAAIC,WAAWF,iCASN,SAASG,SAAUC,gBAC/BC,mBAAqBF,SAASG,MAAM,KACvCC,cAAgBF,mBAAmB,GACnCG,cAAgBH,mBAAmB,GACnCI,QAAU,KACVC,QAAU,KACsB,IAA7BN,WAAWO,QAAQ,eACZ,MAEsB,IAA7BP,WAAWO,QAAQ,eACZ,MAEsB,IAA7BP,WAAWO,QAAQ,eACZ,SAGPC,aAAeL,cAAcD,MAAMI,SACtCG,mBAAqBT,WAAWE,MAAMI,SACtCI,KAAOF,aAAaC,mBAAmBF,QAAQ,SAC/CI,MAAQH,aAAaC,mBAAmBF,QAAQ,OAChDpB,KAAOqB,aAAaC,mBAAmBF,QAAQ,OAC/CK,aAAepB,KAAKE,MAAMgB,KAAO,IAAMC,MAAQ,IAAMxB,SAClDM,MAAMmB,eAAiBF,KAAKG,OAAS,GAAKF,MAAME,OAAS,GAAK1B,KAAK0B,OAAS,GAAqB,MAAhBD,mBAC9Ef,IAAIC,WAAW,wBAKO,IAAlBM,8BACM,gBAGbU,aAAeV,cAAcF,MAAM,iBACR,IAApBY,aAAa,aACbA,aAAa,SAIa,IAA1Bb,mBAAmB,KACe,OAAxCA,mBAAmB,GAAGc,eAA8C,OAApBD,aAAa,kBACnD,GAAKE,SAASF,aAAa,GAAI,IAAM,IAGP,OAAxCb,mBAAmB,GAAGc,eAA8C,OAApBD,aAAa,kBACnD,GAAK,cAIJ,eACD,IAAItB,KAAKkB,KAAMC,MAAOxB,KAAM2B,aAAa,GAAIA,aAAa,GAAIT,8BAMzD,SAASY,YACzBC,UAAYzC,EAAE0C,WACdC,WAAa,UACN,SAASC,QACdA,iBACOC,oBAEAC,kBAIMC,QAAQC,QAAQhD,EAAEiD,OAAON,WAAYH,SAC3CU,GAAG,UAAU,SAASC,GAG9BnD,EAAE,IAAMoD,OAAOC,aAAajB,OAAS,KAEtC,QAAQkB,SAAS,iBAGdb,UAAUc,uBAEL,SAASf,aACM,IAAhBA,OAAOgB,cACVA,KAAO,aAEa,IAAjBhB,OAAOiB,eACVA,MAAQrC,IAAIC,WAAW,gCAEdqC,YAAYlB,qBAKjB,SAASmB,kBACjBC,WAAaD,aACW,iBAAjBA,2BACG,IACFE,KAAOF,kBAEfnB,OAAS,QACJrC,SAAS2D,UACX,MACC,cACA,QACC,eACE,SACC,cACK,SACL,CAAEC,MAAO3C,IAAIC,WAAW,sBAExB,UACC,UACA,sBACC,+BAKmB,IAAtBsC,aAAaH,MAA6C,SAArBG,aAAaH,cACrDQ,KAAKC,MAAO,UAEbD,KAAOhE,EAAEiD,OAAOT,OAAOwB,KAAMJ,YAC7B,IAAIM,QAAQ1B,qBAKP,SAAS2B,aACC,IAAXA,gBACDnE,EAAE,uBAELoE,+BAOc,SAASC,QAASC,0BAC/BC,IAAI,eAAgBD,8CAKD,eACvBE,UAAYxE,EAAE,gBACdyE,UAAYzE,EAAE,sBAAuBwE,WACrCE,aAAe1E,EAAE,yBAA0BwE,aAC7C,oBAAqBA,WAAWG,KAAK,QAAS,MAC9C,iBAAkBH,WAAWI,IAAI,QAAS5E,EAAE,oBAAqBwE,WAAWK,gBAC5E,oBAAqBL,WAAWI,IAAI,QAAS5E,EAAE,iBAAkBwE,WAAWK,wBACpE3B,GAAG,UAAU,wBACT4B,WAAWL,UAAUK,8BAEtB5B,GAAG,UAAU,qBACf4B,WAAWJ,aAAaI,sCAGf,SAASC,WAAYxD,WAAYyD,OAAQxB,UACzD3B,QAAU,KACmB,IAA7BN,WAAWO,QAAQ,eACZ,MAEsB,IAA7BP,WAAWO,QAAQ,eACZ,MAEsB,IAA7BP,WAAWO,QAAQ,eACZ,SAGPC,aAAegD,WAAWtD,MAAMI,SAChCG,mBAAqBT,WAAWE,MAAMI,SACtCI,KAAOF,aAAaC,mBAAmBF,QAAQ,SAC/CI,MAAQH,aAAaC,mBAAmBF,QAAQ,OAChDpB,KAAOqB,aAAaC,mBAAmBF,QAAQ,OAC/CK,aAAe,IAAIpB,KAAKkB,KAAMC,MAAQ,EAAGxB,SACzCuB,KAAKG,OAAS,GAAKF,MAAME,OAAS,GAAK1B,KAAK0B,OAAS,GAAqB,MAAhBD,mBAC9Cf,IAAIC,WAAW,uBAG3B4D,QAAU9C,mBACV,KAAO6C,OACN,YAAcxB,cACT0B,QAAQ/C,aAAagD,UAAY,GAEhC,MAAQH,OACd,YAAcxB,aACT0B,QAAQ/C,aAAagD,UAAY,WAEjCD,QAAQ/C,aAAagD,UAAY,GAGtC,YAAc3B,cACT4B,QAAQjD,aAAakD,UAA+B,GAAnB9C,SAASyC,QAAe,GAAK,GAAK,KAGtE5D,IAAIkE,cAAcL,sBAEb,SAASZ,QAASM,KAAMY,WAChCC,MAAQ,WACJC,KAAK,UAAUC,MAAK,SAASC,MAAOC,eAClC5F,EAAE4F,QACPL,OAASK,OAAO5B,KAAKW,cACjBrB,SAAS,iBACTqB,KAAK,WAAY,cAEX,IAATa,cACKI,OAAOC,cAETC,YAAY,iBACZC,WAAW,wBAGZF,IAAIL,OAAOQ,QAAQ,kBAEpB,SAASC,cACTA,MAAMC,QAAO,SAASC,GAAIR,MAAOS,YAChCT,QAAUS,IAAItE,QAAQqE,SAIhC"}