{"version":3,"file":"Calendar.min.js","sources":["Calendar.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/** Class representing a calendar. */\nwindow.Calendar_Js = class {\n\t/**\n\t * Create calendar's options.\n\t * @param {jQuery} container\n\t * @param {bool} readonly\n\t */\n\tconstructor(container = $('.js-base-container'), readonly = false, browserHistory = true) {\n\t\tthis.calendarView = false;\n\t\tthis.calendarCreateView = false;\n\t\tthis.container = container;\n\t\tthis.readonly = readonly;\n\t\tthis.eventCreate = app.getMainParams('eventCreate');\n\t\tthis.eventEdit = app.getMainParams('eventEdit');\n\t\tthis.browserHistory = !readonly && browserHistory\n\t\tthis.browserHistoryConfig = this.browserHistory ? {} : this.setBrowserHistoryOptions();\n\t\tthis.calendarOptions = this.setCalendarOptions();\n\t\tthis.eventTypeKeyName = false;\n\t\tthis.module = app.getModuleName();\n\t}\n\n\t/**\n\t * Set calendar's options.\n\t * @returns {object}\n\t */\n\tsetCalendarOptions() {\n\t\treturn Object.assign(\n\t\t\tthis.setCalendarBasicOptions(),\n\t\t\tthis.setCalendarAdvancedOptions(),\n\t\t\tthis.setCalendarModuleOptions(),\n\t\t\tthis.browserHistoryConfig\n\t\t);\n\t}\n\n\t/**\n\t * Set calendar's basic options.\n\t * @returns {object}\n\t */\n\tsetCalendarBasicOptions() {\n\t\tlet eventLimit = app.getMainParams('eventLimit'),\n\t\t\tuserDefaultActivityView = app.getMainParams('activity_view'),\n\t\t\tdefaultView = app.moduleCacheGet('defaultView'),\n\t\t\tuserDefaultTimeFormat = CONFIG.hourFormat;\n\t\tif (eventLimit == 'true') {\n\t\t\teventLimit = true;\n\t\t} else if (eventLimit == 'false') {\n\t\t\teventLimit = false;\n\t\t} else {\n\t\t\teventLimit = parseInt(eventLimit) + 1;\n\t\t}\n\t\tif (userDefaultActivityView === 'Today') {\n\t\t\tuserDefaultActivityView = app.getMainParams('dayView');\n\t\t} else if (userDefaultActivityView === 'This Week') {\n\t\t\tuserDefaultActivityView = app.getMainParams('weekView');\n\t\t} else {\n\t\t\tuserDefaultActivityView = 'month';\n\t\t}\n\t\tif (defaultView != null) {\n\t\t\tuserDefaultActivityView = defaultView;\n\t\t}\n\t\tif (userDefaultTimeFormat == 24) {\n\t\t\tuserDefaultTimeFormat = 'H:mm';\n\t\t} else {\n\t\t\tuserDefaultTimeFormat = 'h:mmt';\n\t\t}\n\t\tlet options = {\n\t\t\ttimeFormat: userDefaultTimeFormat,\n\t\t\tslotLabelFormat: userDefaultTimeFormat,\n\t\t\tdefaultView: userDefaultActivityView,\n\t\t\tslotMinutes: 15,\n\t\t\tdefaultEventMinutes: 0,\n\t\t\tforceEventDuration: true,\n\t\t\tdefaultTimedEventDuration: '01:00:00',\n\t\t\teventLimit: eventLimit,\n\t\t\teventLimitText: app.vtranslate('JS_MORE'),\n\t\t\tselectHelper: true,\n\t\t\tscrollTime: app.getMainParams('startHour') + ':00',\n\t\t\tmonthNamesShort: [\n\t\t\t\tapp.vtranslate('JS_JAN'),\n\t\t\t\tapp.vtranslate('JS_FEB'),\n\t\t\t\tapp.vtranslate('JS_MAR'),\n\t\t\t\tapp.vtranslate('JS_APR'),\n\t\t\t\tapp.vtranslate('JS_MAY'),\n\t\t\t\tapp.vtranslate('JS_JUN'),\n\t\t\t\tapp.vtranslate('JS_JUL'),\n\t\t\t\tapp.vtranslate('JS_AUG'),\n\t\t\t\tapp.vtranslate('JS_SEP'),\n\t\t\t\tapp.vtranslate('JS_OCT'),\n\t\t\t\tapp.vtranslate('JS_NOV'),\n\t\t\t\tapp.vtranslate('JS_DEC')\n\t\t\t],\n\t\t\tdayNames: [\n\t\t\t\tapp.vtranslate('JS_SUNDAY'),\n\t\t\t\tapp.vtranslate('JS_MONDAY'),\n\t\t\t\tapp.vtranslate('JS_TUESDAY'),\n\t\t\t\tapp.vtranslate('JS_WEDNESDAY'),\n\t\t\t\tapp.vtranslate('JS_THURSDAY'),\n\t\t\t\tapp.vtranslate('JS_FRIDAY'),\n\t\t\t\tapp.vtranslate('JS_SATURDAY')\n\t\t\t],\n\t\t\tbuttonText: {\n\t\t\t\ttoday: app.vtranslate('JS_CURRENT'),\n\t\t\t\tyear: app.vtranslate('JS_YEAR'),\n\t\t\t\tmonth: app.vtranslate('JS_MONTH'),\n\t\t\t\tweek: app.vtranslate('JS_WEEK'),\n\t\t\t\tday: app.vtranslate('JS_DAY')\n\t\t\t},\n\t\t\tallDayText: app.vtranslate('JS_ALL_DAY')\n\t\t};\n\t\tif (app.moduleCacheGet('start') !== null) {\n\t\t\tlet s = moment(app.moduleCacheGet('start')).valueOf();\n\t\t\tlet e = moment(app.moduleCacheGet('end')).valueOf();\n\t\t\toptions.defaultDate = moment(moment(s + (e - s) / 2).format('YYYY-MM-DD'));\n\t\t}\n\t\treturn Object.assign(this.setCalendarMinimalOptions(), options);\n\t}\n\n\t/**\n\t * Converts the date format.\n\t * @param {string} partOfDate\n\t */\n\tparseDateFormat(partOfDate) {\n\t\tlet parseMonthFormat = {\n\t\t\t'yyyy-mm-dd': 'YYYY-MMMM',\n\t\t\t'mm-dd-yyyy': 'MMMM-YYYY',\n\t\t\t'dd-mm-yyyy': 'MMMM-YYYY',\n\t\t\t'yyyy.mm.dd': 'YYYY.MMMM',\n\t\t\t'mm.dd.yyyy': 'MMMM.YYYY',\n\t\t\t'dd.mm.yyyy': 'MMMM.YYYY',\n\t\t\t'yyyy/mm/dd': 'YYYY/MMMM',\n\t\t\t'mm/dd/yyyy': 'MMMM/YYYY',\n\t\t\t'dd/mm/yyyy': 'MMMM/YYYY'\n\t\t};\n\t\tlet parseWeekAndDayFormat = {\n\t\t\t'yyyy-mm-dd': 'YYYY-MMM-D',\n\t\t\t'mm-dd-yyyy': 'MMM-D-YYYY',\n\t\t\t'dd-mm-yyyy': 'D-MMM-YYYY',\n\t\t\t'yyyy.mm.dd': 'YYYY.MMM.D',\n\t\t\t'mm.dd.yyyy': 'MMM.D.YYYY',\n\t\t\t'dd.mm.yyyy': 'D.MMM.YYYY',\n\t\t\t'yyyy/mm/dd': 'YYYY/MMM/D',\n\t\t\t'mm/dd/yyyy': 'MMM/D/YYYY',\n\t\t\t'dd/mm/yyyy': 'D/MMM/YYYY'\n\t\t};\n\t\tlet formatDate = CONFIG.dateFormat;\n\t\tswitch (partOfDate) {\n\t\t\tcase 'month':\n\t\t\t\treturn parseMonthFormat[formatDate];\n\t\t\t\tbreak;\n\t\t\tcase 'week':\n\t\t\t\treturn parseWeekAndDayFormat[formatDate];\n\t\t\t\tbreak;\n\t\t\tcase 'day':\n\t\t\t\treturn parseWeekAndDayFormat[formatDate];\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Set calendar's minimal options.\n\t * @returns {object}\n\t */\n\tsetCalendarMinimalOptions() {\n\t\tlet hiddenDays = [];\n\t\tif (app.getMainParams('switchingDays') === 'workDays') {\n\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t}\n\t\treturn {\n\t\t\tfirstDay: CONFIG.firstDayOfWeekNo,\n\t\t\tselectable: true,\n\t\t\thiddenDays: hiddenDays,\n\t\t\tmonthNames: [\n\t\t\t\tapp.vtranslate('JS_JANUARY'),\n\t\t\t\tapp.vtranslate('JS_FEBRUARY'),\n\t\t\t\tapp.vtranslate('JS_MARCH'),\n\t\t\t\tapp.vtranslate('JS_APRIL'),\n\t\t\t\tapp.vtranslate('JS_MAY'),\n\t\t\t\tapp.vtranslate('JS_JUNE'),\n\t\t\t\tapp.vtranslate('JS_JULY'),\n\t\t\t\tapp.vtranslate('JS_AUGUST'),\n\t\t\t\tapp.vtranslate('JS_SEPTEMBER'),\n\t\t\t\tapp.vtranslate('JS_OCTOBER'),\n\t\t\t\tapp.vtranslate('JS_NOVEMBER'),\n\t\t\t\tapp.vtranslate('JS_DECEMBER')\n\t\t\t],\n\t\t\tdayNamesShort: [\n\t\t\t\tapp.vtranslate('JS_SUN'),\n\t\t\t\tapp.vtranslate('JS_MON'),\n\t\t\t\tapp.vtranslate('JS_TUE'),\n\t\t\t\tapp.vtranslate('JS_WED'),\n\t\t\t\tapp.vtranslate('JS_THU'),\n\t\t\t\tapp.vtranslate('JS_FRI'),\n\t\t\t\tapp.vtranslate('JS_SAT')\n\t\t\t]\n\t\t};\n\t}\n\n\t/**\n\t * Set calendar's advanced options.\n\t * @returns {object}\n\t */\n\tsetCalendarAdvancedOptions() {\n\t\tlet self = this;\n\t\treturn {\n\t\t\teditable: !this.readonly && this.eventEdit,\n\t\t\tselectable: !this.readonly && this.eventCreate,\n\t\t\theader: {\n\t\t\t\tleft: 'month,' + app.getMainParams('weekView') + ',' + app.getMainParams('dayView'),\n\t\t\t\tcenter: 'title today',\n\t\t\t\tright: 'prev,next'\n\t\t\t},\n\t\t\tallDaySlot: app.getMainParams('allDaySlot'),\n\t\t\tviews: {\n\t\t\t\tbasic: {\n\t\t\t\t\teventLimit: false\n\t\t\t\t},\n\t\t\t\tmonth: {\n\t\t\t\t\ttitleFormat: this.parseDateFormat('month')\n\t\t\t\t},\n\t\t\t\tweek: {\n\t\t\t\t\ttitleFormat: this.parseDateFormat('week')\n\t\t\t\t},\n\t\t\t\tday: {\n\t\t\t\t\ttitleFormat: this.parseDateFormat('day')\n\t\t\t\t}\n\t\t\t},\n\t\t\teventDrop: function(event, delta, revertFunc) {\n\t\t\t\tself.updateEvent(event, delta, revertFunc);\n\t\t\t},\n\t\t\teventResize: function(event, delta, revertFunc) {\n\t\t\t\tself.updateEvent(event, delta, revertFunc);\n\t\t\t},\n\t\t\tviewRender: function() {\n\t\t\t\tself.loadCalendarData();\n\t\t\t},\n\t\t\teventRender: self.eventRenderer,\n\t\t\theight: this.setCalendarHeight(this.container)\n\t\t};\n\t}\n\n\t/**\n\t * Update calendar's event.\n\t * @param {Object} event\n\t * @param {Object} delta\n\t * @param {Object} revertFunc\n\t */\n\tupdateEvent(event, delta, revertFunc) {\n\t\tlet progressInstance = jQuery.progressIndicator({ blockInfo: { enabled: true } });\n\t\tlet start = event.start.format();\n\t\tlet params = {\n\t\t\tmodule: CONFIG.module,\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'updateEvent',\n\t\t\tid: event.id,\n\t\t\tstart: start,\n\t\t\tdelta: delta._data,\n\t\t\tallDay: event.allDay\n\t\t};\n\t\tAppConnector.request(params)\n\t\t\t.done(function(response) {\n\t\t\t\tif (!response['result']) {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_NO_EDIT_PERMISSION'));\n\t\t\t\t\trevertFunc();\n\t\t\t\t} else {\n\t\t\t\t\twindow.popoverCache = {};\n\t\t\t\t}\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t})\n\t\t\t.fail(function() {\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_NO_EDIT_PERMISSION'));\n\t\t\t\trevertFunc();\n\t\t\t});\n\t}\n\n\t/**\n\t * Render event.\n\t * @param {Object} event\n\t * @param {jQuery} element\n\t */\n\teventRenderer(event, element) {\n\t\telement.find('.fc-title').html(event.title);\n\t\tif (event.rendering === 'background') {\n\t\t\telement.append(\n\t\t\t\t`<span class=\"js-popover-text d-block\"><span class=\"${event.icon} js-popover-icon mr-1\"></span>${event.title}</span>`\n\t\t\t);\n\t\t\telement.addClass('js-popover-tooltip--ellipsis').attr('data-content', event.title);\n\t\t\tapp.registerPopoverEllipsis({ element });\n\t\t}\n\t}\n\n\t/**\n\t * Returns counted calendar height.\n\t * @returns {(number|string)}\n\t */\n\tsetCalendarHeight() {\n\t\tconst defaultHeightValue = 'auto';\n\t\tif ($(window).width() > 993) {\n\t\t\tlet calendarContainer = this.container.find('.js-calendar__container'),\n\t\t\t\tcalendarPadding;\n\t\t\tif (this.container.hasClass('js-modal-container')) {\n\t\t\t\tcalendarPadding = this.container.find('.js-modal-header').outerHeight(); // modal needs bigger padding to prevent modal's scrollbar\n\t\t\t} else {\n\t\t\t\tcalendarPadding = this.container\n\t\t\t\t\t.find('.js-contents-div')\n\t\t\t\t\t.css('margin-left')\n\t\t\t\t\t.replace('px', ''); //equals calendar padding bottom to left margin\n\t\t\t}\n\t\t\tlet setCalendarH = () => {\n\t\t\t\treturn (\n\t\t\t\t\t$(window).height() -\n\t\t\t\t\tthis.container.find('.js-calendar__container').offset().top -\n\t\t\t\t\t$('.js-footer').height() -\n\t\t\t\t\tcalendarPadding\n\t\t\t\t);\n\t\t\t};\n\t\t\tnew ResizeSensor(this.container.find('.contentsDiv'), () => {\n\t\t\t\tcalendarContainer.fullCalendar('option', 'height', setCalendarH());\n\t\t\t});\n\t\t}\n\t\treturn defaultHeightValue;\n\t}\n\n\t/**\n\t * Set calendar module's options.\n\t * @returns {object}\n\t */\n\tsetCalendarModuleOptions() {\n\t\treturn {};\n\t}\n\n\t/**\n\t * Set calendar options from browser history.\n\t * @returns {object}\n\t */\n\tsetBrowserHistoryOptions() {\n\t\tlet historyParams = app.getMainParams('historyParams', true),\n\t\t\toptions = null;\n\t\tif (historyParams && (historyParams.length || Object.keys(historyParams).length)) {\n\t\t\toptions = {\n\t\t\t\tstart: historyParams.start,\n\t\t\t\tend: historyParams.end,\n\t\t\t\tuser: historyParams.user.split(',').map(x => {\n\t\t\t\t\treturn parseInt(x);\n\t\t\t\t}),\n\t\t\t\ttime: historyParams.time,\n\t\t\t\thiddenDays: historyParams.hiddenDays.split(',').map(x => {\n\t\t\t\t\tlet parsedValue = parseInt(x);\n\t\t\t\t\treturn isNaN(parsedValue) ? '' : parsedValue;\n\t\t\t\t}),\n\t\t\t\tcvid: historyParams.cvid,\n\t\t\t\tdefaultView: historyParams.viewType\n\t\t\t};\n\t\t\tlet dateFormat = CONFIG.dateFormat.toUpperCase();\n\t\t\tlet s = moment(options.start, dateFormat).valueOf();\n\t\t\tlet e = moment(options.end, dateFormat).valueOf();\n\t\t\toptions.defaultDate = moment(moment(s + (e - s) / 2).format('YYYY-MM-DD'));\n\t\t\tObject.keys(options).forEach(key => options[key] === 'undefined' && delete options[key]);\n\t\t\tapp.moduleCacheSet('browserHistoryEvent', false);\n\t\t\tapp.setMainParams('showType', options.time);\n\t\t\tapp.setMainParams('usersId', options.user);\n\t\t\tapp.setMainParams('defaultView', options.defaultView);\n\t\t}\n\t\twindow.addEventListener(\n\t\t\t'popstate',\n\t\t\tfunction(event) {\n\t\t\t\tapp.moduleCacheSet('browserHistoryEvent', true);\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\t\treturn options;\n\t}\n\n\t/**\n\t * Register events.\n\t * @returns {object}\n\t */\n\tregisterEvents() {\n\t\tthis.renderCalendar();\n\t\tthis.registerSitebarEvents();\n\t\tthis.registerButtonSelectAll();\n\t\tthis.registerAddButton();\n\t}\n\n\t/**\n\t * Invokes fullcalendar with options.\n\t */\n\trenderCalendar() {\n\t\tthis.getCalendarView().fullCalendar(this.calendarOptions);\n\t}\n\n\t/**\n\t * Register sitebar events.\n\t */\n\tregisterSitebarEvents() {\n\t\t$('.bodyContents').on('Vtiger.Widget.Load.undefined', () => {\n\t\t\tthis.registerSelect2Event();\n\t\t});\n\t}\n\n\t/**\n\t * Load calendar data\n\t */\n\tloadCalendarData() {\n\t\tconst defaultParams = this.getDefaultParams();\n\t\tthis.getCalendarView().fullCalendar('removeEvents');\n\t\tif (!defaultParams.emptyFilters) {\n\t\t\tconst progressInstance = $.progressIndicator();\n\t\t\tAppConnector.request(defaultParams).done(events => {\n\t\t\t\tthis.getCalendarView().fullCalendar('addEventSource', events.result);\n\t\t\t\tprogressInstance.hide();\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Default params\n\t * @returns {{module: *, action: string, mode: string, start: *, end: *, user: *, emptyFilters: boolean}}\n\t */\n\tgetDefaultParams() {\n\t\tlet formatDate = CONFIG.dateFormat.toUpperCase(),\n\t\t\tview = this.getCalendarView().fullCalendar('getView'),\n\t\t\tusers = app.moduleCacheGet('calendar-users') || CONFIG.userId;\n\t\tlet params = {\n\t\t\tmodule: CONFIG.module,\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'getEvents',\n\t\t\tstart: view.start.format(formatDate),\n\t\t\tend: view.end.format(formatDate),\n\t\t\tuser: users,\n\t\t\temptyFilters: users.length === 0\n\t\t};\n\t\tif (app.moduleCacheGet('calendar-types')) {\n\t\t\tparams.types = app.moduleCacheGet('calendar-types');\n\t\t\tparams.emptyFilters = users.length === 0 || params.types.length === 0;\n\t\t} else {\n\t\t\tparams.types = [];\n\t\t}\n\t\treturn params;\n\t}\n\n\t/**\n\t * Register select2 event.\n\t */\n\tregisterSelect2Event() {\n\t\tlet self = this;\n\t\t$('.siteBarRight .js-calendar__filter__select').each(function() {\n\t\t\tlet element = $(this);\n\t\t\tlet name = element.data('cache');\n\t\t\tlet cachedValue = app.moduleCacheGet(name);\n\t\t\tif (element.length > 0 && cachedValue !== undefined) {\n\t\t\t\tif (element.prop('tagName') == 'SELECT') {\n\t\t\t\t\telement.val(cachedValue);\n\t\t\t\t}\n\t\t\t} else if (element.length > 0 && cachedValue === undefined && !element.find(':selected').length) {\n\t\t\t\tlet allOptions = [];\n\t\t\t\telement.find('option').each((i, option) => {\n\t\t\t\t\tallOptions.push($(option).val());\n\t\t\t\t});\n\t\t\t\telement.val(allOptions);\n\t\t\t\tapp.moduleCacheSet(name, cachedValue);\n\t\t\t}\n\t\t});\n\t\tlet selectsElements = $('.siteBarRight .select2, .siteBarRight .filterField');\n\t\tselectsElements.off('change');\n\t\tApp.Fields.Picklist.showSelect2ElementView(selectsElements);\n\t\tselectsElements.on('change', function() {\n\t\t\tlet element = $(this);\n\t\t\tlet value = element.val();\n\t\t\tif (value == null) {\n\t\t\t\tvalue = '';\n\t\t\t}\n\t\t\tif (element.attr('type') == 'checkbox') {\n\t\t\t\tvalue = element.is(':checked');\n\t\t\t}\n\t\t\tapp.moduleCacheSet(element.data('cache'), value);\n\t\t\tself.loadCalendarData();\n\t\t});\n\t}\n\n\t/**\n\t * Register button select all.\n\t */\n\tregisterButtonSelectAll() {\n\t\tlet selectBtn = $('.selectAllBtn');\n\t\tselectBtn.on('click', function(e) {\n\t\t\tlet selectAllLabel = $(this).find('.selectAll');\n\t\t\tlet deselectAllLabel = $(this).find('.deselectAll');\n\t\t\tif (selectAllLabel.hasClass('d-none')) {\n\t\t\t\tselectAllLabel.removeClass('d-none');\n\t\t\t\tdeselectAllLabel.addClass('d-none');\n\t\t\t\t$(this)\n\t\t\t\t\t.closest('.quickWidget')\n\t\t\t\t\t.find('select option')\n\t\t\t\t\t.prop('selected', false);\n\t\t\t} else {\n\t\t\t\t$(this)\n\t\t\t\t\t.closest('.quickWidget')\n\t\t\t\t\t.find('select option')\n\t\t\t\t\t.prop('selected', true);\n\t\t\t\tdeselectAllLabel.removeClass('d-none');\n\t\t\t\tselectAllLabel.addClass('d-none');\n\t\t\t}\n\t\t\t$(this)\n\t\t\t\t.closest('.quickWidget')\n\t\t\t\t.find('select')\n\t\t\t\t.trigger('change');\n\t\t});\n\t}\n\n\t/**\n\t * Register add button.\n\t */\n\tregisterAddButton() {\n\t\tconst self = this;\n\t\t$('.js-add').on('click', e => {\n\t\t\tself.getCalendarCreateView().done(data => {\n\t\t\t\tconst headerInstance = new Vtiger_Header_Js();\n\t\t\t\theaderInstance.handleQuickCreateData(data, {\n\t\t\t\t\tcallbackFunction: data => {\n\t\t\t\t\t\tself.addCalendarEvent(data.result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Get calendar create view.\n\t * @returns {promise}\n\t */\n\tgetCalendarCreateView() {\n\t\tlet self = this;\n\t\tlet aDeferred = jQuery.Deferred();\n\n\t\tif (this.calendarCreateView !== false) {\n\t\t\taDeferred.resolve(this.calendarCreateView.clone(true, true));\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t\tlet progressInstance = jQuery.progressIndicator();\n\t\tthis.loadCalendarCreateView()\n\t\t\t.done(function(data) {\n\t\t\t\tprogressInstance.hide();\n\t\t\t\tself.calendarCreateView = data;\n\t\t\t\taDeferred.resolve(data.clone(true, true));\n\t\t\t})\n\t\t\t.fail(function() {\n\t\t\t\tprogressInstance.hide();\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Load calendar create view.\n\t * @returns {promise}\n\t */\n\tloadCalendarCreateView() {\n\t\tlet aDeferred = jQuery.Deferred();\n\t\tlet moduleName = app.getModuleName();\n\t\tlet url = 'index.php?module=' + moduleName + '&view=QuickCreateAjax';\n\t\tlet headerInstance = Vtiger_Header_Js.getInstance();\n\t\theaderInstance\n\t\t\t.getQuickCreateForm(url, moduleName)\n\t\t\t.done(function(data) {\n\t\t\t\taDeferred.resolve(jQuery(data));\n\t\t\t})\n\t\t\t.fail(function(textStatus, errorThrown) {\n\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Add event data to render.\n\t */\n\tgetEventRenderData(calendarDetails) {\n\t\tconst calendar = this.getCalendarView();\n\t\tconst eventObject = {\n\t\t\tid: calendarDetails._recordId,\n\t\t\ttitle: calendarDetails._recordLabel,\n\t\t\tstart: calendar\n\t\t\t\t.fullCalendar('moment', calendarDetails.date_start.value + ' ' + calendarDetails.time_start.value)\n\t\t\t\t.format(),\n\t\t\tend: calendar\n\t\t\t\t.fullCalendar('moment', calendarDetails.due_date.value + ' ' + calendarDetails.time_end.value)\n\t\t\t\t.format(),\n\t\t\tstart_display: calendarDetails.date_start.display_value + ' ' + calendarDetails.time_start.display_value,\n\t\t\tend_display: calendarDetails.due_date.display_value + ' ' + calendarDetails.time_end.display_value,\n\t\t\turl: `index.php?module=${CONFIG.module}&view=Detail&record=${calendarDetails._recordId}`,\n\t\t\tclassName: `js-popover-tooltip--record ownerCBg_${calendarDetails.assigned_user_id.value} picklistCBr_${\n\t\t\t\tCONFIG.module\n\t\t\t}_${\n\t\t\t\t$('.js-calendar__filter__select[data-cache=\"calendar-types\"]').length\n\t\t\t\t\t? this.eventTypeKeyName + '_' + calendarDetails[this.eventTypeKeyName]['value']\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\tallDay: typeof calendarDetails.allday === 'undefined' ? false : calendarDetails.allday.value == 'on'\n\t\t};\n\t\treturn eventObject;\n\t}\n\n\tisNewEventToDisplay(eventObject) {\n\t\tlet ownerSelects = $('.js-calendar__filter__select[data-cache=\"calendar-users\"]').add(\n\t\t\t$('.js-calendar__filter__select[data-cache=\"calendar-groups\"]')\n\t\t);\n\t\tif ($.inArray(eventObject.assigned_user_id.value, ownerSelects.val()) < 0) {\n\t\t\tthis.refreshFilterValues(eventObject, ownerSelects);\n\t\t\treturn false;\n\t\t}\n\t\tlet calendarTypes = $('.js-calendar__filter__select[data-cache=\"calendar-types\"]');\n\t\tif (calendarTypes.length) {\n\t\t\tif (!this.eventTypeKeyName) {\n\t\t\t\tthis.setEventTypeKey(eventObject);\n\t\t\t}\n\t\t\tif ($.inArray(eventObject[this.eventTypeKeyName]['value'], calendarTypes.val()) < 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tsetEventTypeKey(eventObject) {\n\t\tlet self = this;\n\t\tObject.keys(eventObject).forEach(function(key, index) {\n\t\t\tif (key.endsWith('type')) {\n\t\t\t\t// there are different names for event types in modules\n\t\t\t\tself.eventTypeKeyName = key;\n\t\t\t}\n\t\t});\n\t}\n\n\trefreshFilterValues(eventObject, filtersValues) {\n\t\tif (CONFIG.searchShowOwnerOnlyInList) {\n\t\t\tlet allOptions = [];\n\t\t\tfiltersValues.find('option').each((i, option) => {\n\t\t\t\tallOptions.push($(option).val());\n\t\t\t});\n\t\t\tif ($.inArray(eventObject.assigned_user_id.value, allOptions) < 0) {\n\t\t\t\tAppConnector.request(`module=${CONFIG.module}&view=RightPanel&mode=getUsersList`).done(usersData => {\n\t\t\t\t\tlet filterUsers = $('.js-calendar__filter--users');\n\t\t\t\t\tlet filterGroups = $('.js-calendar__filter--groups');\n\t\t\t\t\tfilterUsers.html(usersData);\n\t\t\t\t\tif (usersData) {\n\t\t\t\t\t\tfilterUsers.closest('.js-toggle-panel').removeClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tif (filterGroups.length) {\n\t\t\t\t\t\tAppConnector.request(`module=${CONFIG.module}&view=RightPanel&mode=getGroupsList`).done(\n\t\t\t\t\t\t\tgroupsData => {\n\t\t\t\t\t\t\t\tfilterGroups.html(groupsData);\n\t\t\t\t\t\t\t\tif (groupsData) {\n\t\t\t\t\t\t\t\t\tfilterGroups.closest('.js-toggle-panel').removeClass('d-none');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.registerSelect2Event();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.registerSelect2Event();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Add calendar event.\n\t */\n\taddCalendarEvent(eventObject) {\n\t\tif (this.isNewEventToDisplay(eventObject)) {\n\t\t\tthis.getCalendarView().fullCalendar('renderEvent', this.getEventRenderData(eventObject));\n\t\t}\n\t}\n\n\t/**\n\t * Get calendar container.\n\t * @returns {(boolean|jQuery)}\n\t */\n\tgetCalendarView() {\n\t\tif (this.calendarView == false) {\n\t\t\tthis.calendarView = this.container.find('.js-calendar__container');\n\t\t}\n\t\treturn this.calendarView;\n\t}\n};\n\n/**\n *  Class representing a calendar with creating events by day click instead of selecting days.\n * @extends Calendar_Js\n */\nwindow.Calendar_Unselectable_Js = class extends Calendar_Js {\n\t/**\n\t * Set calendar module options.\n\t * @returns {{allDaySlot: boolean, dayClick: object, selectable: boolean}}\n\t */\n\tsetCalendarModuleOptions() {\n\t\tlet self = this;\n\t\treturn {\n\t\t\tallDaySlot: false,\n\t\t\tdayClick: this.eventCreate\n\t\t\t\t? function(date) {\n\t\t\t\t\t\tself.registerDayClickEvent(date.format());\n\t\t\t\t\t\tself.getCalendarView().fullCalendar('unselect');\n\t\t\t\t  }\n\t\t\t\t: false,\n\t\t\tselectable: false\n\t\t};\n\t}\n\n\t/**\n\t * Register day click event.\n\t * @param {string} date\n\t */\n\tregisterDayClickEvent(date) {\n\t\tlet self = this;\n\t\tself.getCalendarCreateView().done(function(data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet dateFormat = data\n\t\t\t\t\t.find('[name=\"date_start\"]')\n\t\t\t\t\t.data('dateFormat')\n\t\t\t\t\t.toUpperCase(),\n\t\t\t\ttimeFormat = data.find('[name=\"time_start\"]').data('format'),\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t\t}\n\t\t\tlet startDateInstance = Date.parse(date);\n\t\t\tlet startDateString = moment(date).format(dateFormat);\n\t\t\tlet startTimeString = moment(date).format(defaultTimeFormat);\n\t\t\tlet endDateInstance = Date.parse(date);\n\t\t\tlet endDateString = moment(date).format(dateFormat);\n\n\t\t\tlet view = self.getCalendarView().fullCalendar('getView');\n\t\t\tlet endTimeString;\n\t\t\tif ('month' == view.name) {\n\t\t\t\tlet diffDays = parseInt((endDateInstance - startDateInstance) / (1000 * 60 * 60 * 24));\n\t\t\t\tif (diffDays > 1) {\n\t\t\t\t\tlet defaultFirstHour = app.getMainParams('startHour');\n\t\t\t\t\tlet explodedTime = defaultFirstHour.split(':');\n\t\t\t\t\tstartTimeString = explodedTime['0'];\n\t\t\t\t\tlet defaultLastHour = app.getMainParams('endHour');\n\t\t\t\t\texplodedTime = defaultLastHour.split(':');\n\t\t\t\t\tendTimeString = explodedTime['0'];\n\t\t\t\t} else {\n\t\t\t\t\tlet now = new Date();\n\t\t\t\t\tstartTimeString = moment(now).format(defaultTimeFormat);\n\t\t\t\t\tendTimeString = moment(now)\n\t\t\t\t\t\t.add(15, 'minutes')\n\t\t\t\t\t\t.format(defaultTimeFormat);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tendTimeString = moment(endDateInstance)\n\t\t\t\t\t.add(30, 'minutes')\n\t\t\t\t\t.format(defaultTimeFormat);\n\t\t\t}\n\t\t\tdata.find('[name=\"date_start\"]').val(startDateString);\n\t\t\tdata.find('[name=\"due_date\"]').val(endDateString);\n\t\t\tdata.find('[name=\"time_start\"]').val(startTimeString);\n\t\t\tdata.find('[name=\"time_end\"]').val(endTimeString);\n\n\t\t\tlet headerInstance = new Vtiger_Header_Js();\n\t\t\theaderInstance.handleQuickCreateData(data, {\n\t\t\t\tcallbackFunction(data) {\n\t\t\t\t\tself.addCalendarEvent(data.result, dateFormat);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n};\n"],"names":["window","Calendar_Js","container","$","readonly","browserHistory","calendarView","calendarCreateView","eventCreate","app","getMainParams","eventEdit","browserHistoryConfig","setBrowserHistoryOptions","calendarOptions","setCalendarOptions","eventTypeKeyName","module","getModuleName","Object","assign","setCalendarBasicOptions","setCalendarAdvancedOptions","setCalendarModuleOptions","eventLimit","userDefaultActivityView","defaultView","moduleCacheGet","userDefaultTimeFormat","CONFIG","hourFormat","parseInt","options","vtranslate","s","moment","valueOf","e","defaultDate","format","setCalendarMinimalOptions","partOfDate","parseMonthFormat","parseWeekAndDayFormat","formatDate","dateFormat","hiddenDays","firstDayOfWeekNo","self","parseDateFormat","event","delta","revertFunc","updateEvent","loadCalendarData","eventRenderer","setCalendarHeight","progressInstance","jQuery","progressIndicator","blockInfo","enabled","start","params","id","_data","allDay","request","done","response","showPnotify","popoverCache","mode","fail","element","find","html","title","rendering","append","icon","addClass","attr","registerPopoverEllipsis","defaultHeightValue","width","calendarContainer","calendarPadding","hasClass","outerHeight","css","replace","setCalendarH","height","offset","top","ResizeSensor","fullCalendar","historyParams","length","keys","end","user","split","map","x","time","parsedValue","isNaN","cvid","viewType","toUpperCase","forEach","key","moduleCacheSet","setMainParams","addEventListener","renderCalendar","registerSitebarEvents","registerButtonSelectAll","registerAddButton","getCalendarView","on","registerSelect2Event","defaultParams","getDefaultParams","emptyFilters","events","result","hide","view","users","userId","types","each","name","data","cachedValue","undefined","prop","val","allOptions","i","option","push","selectsElements","off","Fields","Picklist","showSelect2ElementView","value","is","selectBtn","selectAllLabel","deselectAllLabel","removeClass","closest","trigger","getCalendarCreateView","headerInstance","Vtiger_Header_Js","handleQuickCreateData","addCalendarEvent","aDeferred","Deferred","resolve","clone","promise","loadCalendarCreateView","moduleName","url","getInstance","getQuickCreateForm","textStatus","errorThrown","reject","calendarDetails","calendar","eventObject","_recordId","_recordLabel","date_start","time_start","due_date","time_end","display_value","assigned_user_id","allday","ownerSelects","add","inArray","refreshFilterValues","calendarTypes","setEventTypeKey","index","endsWith","filtersValues","searchShowOwnerOnlyInList","filterUsers","filterGroups","usersData","groupsData","isNewEventToDisplay","getEventRenderData","Calendar_Unselectable_Js","date","registerDayClickEvent","timeFormat","defaultTimeFormat","startDateInstance","Date","parse","startDateString","startTimeString","endDateInstance","endDateString","endTimeString","diffDays","defaultFirstHour","explodedTime","defaultLastHour","now"],"mappings":"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"}