
jQuery.Class("Vtiger_Helper_Js",{checkServerConfigResponseCache:"",langCode:"",setLangCode:function(){var a=document.getElementsByTagName("html")[0];this.langCode=a.getAttribute("lang")?a.getAttribute("lang"):"en"},getLangCode:function(){if(!this.langCode){this.setLangCode()}return this.langCode},getEmailMassEditInstance:function(){var a="Emails_MassEdit_Js";var b=new window[a]();return b},checkServerConfig:function(b){var a=jQuery.Deferred();var c={action:"CheckServerInfo",module:b};AppConnector.request(c).then(function(e){var d=false;if(e.result){d=true}else{d=false}a.resolve(d)});return a.promise()},getDateInstance:function(n,b){var c=n.split(" ");var e=c[0];var d=c[1];var m="00";var o="-";if(b.indexOf("-")!=-1){o="-"}if(b.indexOf(".")!=-1){o="."}if(b.indexOf("/")!=-1){o="/"}var h=e.split(o);var j=b.split(o);var l=h[j.indexOf("yyyy")];var k=h[j.indexOf("mm")];var f=h[j.indexOf("dd")];var a=Date.parse(l+o+k+o+f);if((l.length>4)||(k.length>2)||(f.length>2)||(a==null)){var i=app.vtranslate("JS_INVALID_DATE");throw i}if(typeof d=="undefined"){d="00:00:00"}var g=d.split(":");if(typeof g[2]!="undefined"){m=g[2]}if(typeof c[2]!="undefined"){d+=" "+c[2];if(c[2].toLowerCase()=="pm"&&g[0]!="12"){g[0]=parseInt(g[0],10)+12}if(c[2].toLowerCase()=="am"&&g[0]=="12"){g[0]="00"}}k=k-1;var a=new Date(l,k,f,g[0],g[1],m);return a},requestToShowComposeEmailForm:function(d,c,f){var a=new Array();a.push(c);var b=new Array();b.push(d);var g={module:"Emails",fieldModule:f,selectedFields:a,selected_ids:b,view:"ComposeEmail"};var e=Vtiger_Helper_Js.getEmailMassEditInstance();e.showComposeEmailForm(g)},getInternalMailer:function(b,a,f){var d="Emails";var e=Vtiger_Helper_Js.checkServerConfigResponseCache;var g=function(h){if(h==true){Vtiger_Helper_Js.requestToShowComposeEmailForm(b,a,f)}else{alert(app.vtranslate("JS_EMAIL_SERVER_CONFIGURATION"))}};if(e===""){var c=Vtiger_Helper_Js.checkServerConfig(d);c.then(function(h){Vtiger_Helper_Js.checkServerConfigResponseCache=h;g(Vtiger_Helper_Js.checkServerConfigResponseCache)})}else{g(Vtiger_Helper_Js.checkServerConfigResponseCache)}},showConfirmationBox:function(c){var b=jQuery.Deferred();bootbox.setLocale(this.getLangCode());var a=bootbox.confirm(c.message,function(d){if(d){b.resolve()}else{b.reject()}});a.on("hidden",function(d){if(jQuery("#globalmodal").length>0){jQuery("body").addClass("modal-open")}});return b.promise()},showMessage:function(a){if(typeof a.type=="undefined"){a.type="info"}a.animation="show";a.title=app.vtranslate("JS_MESSAGE"),Vtiger_Helper_Js.showPnotify(a)},showPnotify:function(b){var a=b;if(typeof b=="string"){var a={};a.text=b}var c={hide:false,delay:"3000",type:"error",styling:"bootstrap3",buttons:{sticker:false,labels:{close:app.vtranslate("JS_CLOSE")}}};if(typeof b.type!="undefined"&&b.type!="error"){c.hide=true;c.animate_speed=1}if(typeof a!="undefined"){var c=jQuery.extend(c,a)}return new PNotify(c)},addClickOutSideEvent:function(b,a){b.one("clickoutside",a)},showHorizontalTopScrollBar:function(){var a=jQuery(".contentsDiv");var b=jQuery(".contents-topscroll",a);var c=jQuery(".contents-bottomscroll",a);jQuery(".bottomscroll-div",a).attr("style","");jQuery(".topscroll-div",a).css("width",jQuery(".bottomscroll-div",a).outerWidth());jQuery(".bottomscroll-div",a).css("width",jQuery(".topscroll-div",a).outerWidth());b.scroll(function(){c.scrollLeft(b.scrollLeft())});c.scroll(function(){b.scrollLeft(c.scrollLeft())})},convertToDateString:function(e,b,f,i){var l="-";if(b.indexOf("-")!=-1){l="-"}if(b.indexOf(".")!=-1){l="."}if(b.indexOf("/")!=-1){l="/"}var d=e.split(l);var g=b.split(l);var j=d[g.indexOf("yyyy")];var h=d[g.indexOf("mm")];var c=d[g.indexOf("dd")];var a=new Date(j,h-1,c);var k=a;if("0"==f){if("Calendar"==i){k.setDate(a.getDate()-1)}}else{if("-1"==f){if("Calendar"==i){k.setDate(a.getDate()-2)}else{k.setDate(a.getDate()-1)}}else{if("+1"==f){if("Calendar"!=i){k.setDate(a.getDate()+1)}}}}return app.getStringDate(k)}},{});