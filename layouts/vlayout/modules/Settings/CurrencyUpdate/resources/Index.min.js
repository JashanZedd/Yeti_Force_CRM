
jQuery.Class("Settings_CurrencyUpdate_Index_Js",{},{registerInfoButton:function(){jQuery("#supportedCurrencies").on("click",function(){jQuery("#infoBlock").toggleClass("hide")})},registerAlertButton:function(){jQuery("#unsupportedCurrencies").on("click",function(){jQuery("#alertBlock").toggleClass("hide")})},registerBankChange:function(){jQuery("#bank").on("change",function(){bankName=jQuery("#bank option:selected").data("name");jQuery("#alertSpan").html("");jQuery("#infoSpan").html("");var b=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var c={};c.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"GetBankCurrencies",mode:"supported",name:bankName};c.dataType="json";AppConnector.request(c).then(function(e){var d=e.result;jQuery("#infoSpan").html(d)},function(e,d){});c.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"GetBankCurrencies",mode:"unsupported",name:bankName};c.dataType="json";AppConnector.request(c).then(function(e){var d=e.result;console.log(d);if(d===""){console.log("puste");if(!jQuery("#unsupportedCurrencies").hasClass("hide")){jQuery("#unsupportedCurrencies").addClass("hide")}if(!jQuery("#alertBlock").hasClass("hide")){jQuery("#alertBlock").addClass("hide")}}else{console.log(" nie puste");jQuery("#unsupportedCurrencies").removeClass("hide")}jQuery("#alertSpan").html(d)},function(e,d){});var a=jQuery("#bank option:selected").val();c.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"SaveActiveBank",id:a};c.dataType="json";AppConnector.request(c).then(function(e){var d=e.result;if(d.success){var f={text:d.message,animation:"show",type:"success"};Vtiger_Helper_Js.showPnotify(f)}else{var f={text:d.message,animation:"show",hide:false,type:"error"};Vtiger_Helper_Js.showPnotify(f)}b.progressIndicator({mode:"hide"})},function(e,d){})})},registerEvents:function(){app.registerEventForDatePickerFields("#datepicker",false,{});this.registerInfoButton();this.registerAlertButton();this.registerBankChange()}});