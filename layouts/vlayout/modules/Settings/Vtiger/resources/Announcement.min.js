
jQuery.Class("Settings_Vtiger_Announcements_Js",{},{container:false,getContainer:function(){if(this.container==false){this.container=jQuery("#AnnouncementContainer").find(".contents")}return this.container},saveAnnouncement:function(b){var a=jQuery.Deferred();var c=b.val();var d={module:app.getModuleName(),parent:app.getParentModuleName(),action:"AnnouncementSaveAjax",announcement:c};AppConnector.request(d).then(function(e){a.resolve()},function(e,f){a.reject()});return a.promise()},registerKeyUpEvent:function(){var a=this.getContainer();a.one("keyup",".announcementContent",function(b){jQuery(".saveAnnouncement",a).removeClass("hide")})},registerEvents:function(){var c=this;var a=c.getContainer();var b=jQuery(".announcementContent",a);var d=jQuery(".saveAnnouncement",a);app.registerEventForTextAreaFields(b);c.registerKeyUpEvent();d.click(function(g){d.addClass("hide");var f=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});c.saveAnnouncement(b).then(function(e){f.progressIndicator({mode:"hide"});c.registerKeyUpEvent();var h={text:app.vtranslate("JS_ANNOUNCEMENT_SAVED")};Settings_Vtiger_Index_Js.showMessage(h);location.reload()},function(e){})})}});jQuery(document).ready(function(b){var a=new Settings_Vtiger_Announcements_Js();a.registerEvents()});