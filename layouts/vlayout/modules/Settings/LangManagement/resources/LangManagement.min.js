
var Settings_Index_Js={initEvants:function(){$(".LangManagement .add_lang").click(Settings_Index_Js.ShowLangMondal);$(".LangManagement .edit_lang a").click(function(a){jQuery("#edit_lang").html("");document.showDiff=false;Settings_Index_Js.LoadEditLang(this)});$(".LangManagement .editHelpIcon a").click(function(a){jQuery("#editHelpIcon").html("");document.showDiff=false;Settings_Index_Js.LoadEditLang(this)});$("#AddNewLangMondal .btn-primary").click(Settings_Index_Js.AddLangMondal);$("#AddNewTranslationMondal .btn-primary").click(Settings_Index_Js.AddTranslationMondal);$("#lang_list tr").each(function(a,b){b=$(b);Settings_Index_Js.initEvant(b)})},LoadEditLang:function(g){var f=jQuery(g);var a=f.attr("href");var d=f.data("mode");if(typeof a=="undefined"){a="#"+f.attr("id")}var c=$.progressIndicator({message:app.vtranslate("LBL_Loader"),position:a,blockInfo:{enabled:true}});var b="";if($(".LangManagement "+a+" #langs_list").val()!=undefined){b+="&lang="+$(".LangManagement "+a+" #langs_list").val()}if($(".LangManagement #mods_list").val()!=undefined){b+="&mod="+$(".LangManagement "+a+" #mods_list").val()}if(document.showDiff==true){b+="&sd=1"}if(typeof d!="undefined"){b+="&tpl="+d}$.get("index.php?module=LangManagement&parent=Settings&view=Edit"+b,function(e){jQuery(a).html(e);Settings_Index_Js.initEditLang(d,a);c.progressIndicator({mode:"hide"})})},initEditLang:function(b,a){var c=this;element=$(".LangManagement .layoutContent .active #langs_list");app.changeSelectElementView(element,"selectize",{plugins:["remove_button"]}).on("change",function(d){d=jQuery(this).closest(".active");Settings_Index_Js.LoadEditLang(d)});c.registerHoverCkEditor();c.registerHelpInfo();app.changeSelectElementView($(".LangManagement .active #helpInfoView"),"selectize",{plugins:["remove_button"]}).on("change",function(d){Settings_Index_Js.saveView(d,a)});app.changeSelectElementView($(".LangManagement .layoutContent .active #mods_list"),"select2").on("change",function(d){d=jQuery(this).closest(".active");Settings_Index_Js.LoadEditLang(d)});if(b!="editHelpIcon"){$("#edit_lang .translation").change(function(d){Settings_Index_Js.changeTranslation(d,a)});$("#edit_lang .add_translation").click(Settings_Index_Js.ShowTranslationMondal);$("#edit_lang .delete_translation").click(function(d){Settings_Index_Js.deleteTranslation(d,a)})}$(".LangManagement "+a+" .show_differences").click(Settings_Index_Js.ShowDifferences);$.extend($.fn.dataTable.defaults,{searching:true,ordering:false,bFilter:false,bLengthChange:false,bPaginate:false,bInfo:false,pageLength:-1,language:{sZeroRecords:app.vtranslate("No matching records found"),sSearch:app.vtranslate("Search"),sEmptyTable:app.vtranslate("No data available in table"),}});$(""+a+" .listViewEntriesTable").dataTable()},registerHoverCkEditor:function(){var a=this;jQuery("tr td button.editButton").on("click",function(b){elementTd=jQuery(this).closest("td");a.registerEventForCkEditor(this);a.addClickOutSideEvent(elementTd)})},addClickOutSideEvent:function(a){var b=this;a.one("clickoutside",function(){b.destroyEventForCkEditor(a)})},registerHelpInfo:function(){var a=jQuery(".LangManagement");a.find(".HelpInfoPopover").popover({trigger:"hover",html:"true",})},registerEventForCkEditor:function(f){var d=this;var c=jQuery(f);var b=c.closest("td");var a=b.find("textarea.ckEditorSource");c.addClass("hide");a.removeClass("hide");d.loadCkEditorElement(a)},destroyEventForCkEditor:function(c){var d=this;var a=c.find("textarea.ckEditorSource");var b=a.attr("id");if(typeof b!="undefined"&&a.css("display")=="none"){ckeditor=CKEDITOR.instances[b];var e=ckeditor.getData();if(a.val()!=e){a.val(e);if(e){Settings_Index_Js.changeTranslation(a,"#editHelpIcon");c.find(".HelpInfoPopover").attr("data-content",e)}else{Settings_Index_Js.deleteTranslation(a,"#editHelpIcon");a.addClass("empty_value");c.find(".HelpInfoPopover").attr("data-content","")}}ckeditor.destroy();a.addClass("hide");c.find("button.editButton").removeClass("hide")}},loadCkEditorElement:function(d){var b=this;var a={};if(d.css("display")!="none"){a={disableNativeSpellChecker:true,scayt_autoStartup:false,removePlugins:"scayt",height:"5em",toolbar:null,toolbarGroups:[{name:"document",groups:["mode","document","doctools"]},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"clipboard",groups:["clipboard","undo"]}]};var c=new Vtiger_CkEditor_Js();c.loadCkEditor(d,a)}},saveView:function(g,b){var f=$(g.currentTarget);if(typeof g.currentTarget=="undefined"){f=jQuery(g)}var c=f.closest("tr");var d=$.progressIndicator({message:app.vtranslate("LBL_Loader"),position:b,blockInfo:{enabled:true}});var a=Settings_Index_Js.registerSaveEvent("saveView",{fieldid:f.data("fieldid"),mod:$(".LangManagement #mods_list").data("target")?$(".LangManagement #mods_list").data("target"):$(".LangManagement #mods_list").val(),value:f.val(),});d.progressIndicator({mode:"hide"})},ShowDifferences:function(b){var a=$(b.currentTarget);if($(this).is(":checked")){document.showDiff=true}else{document.showDiff=false}b=$(this).closest(".active");Settings_Index_Js.LoadEditLang(b)},changeTranslation:function(f,a){var d=$(f.currentTarget);if(typeof f.currentTarget=="undefined"){d=jQuery(f)}var b=d.closest("tr");var c=$.progressIndicator({message:app.vtranslate("LBL_Loader"),position:a,blockInfo:{enabled:true}});Settings_Index_Js.registerSaveEvent("SaveTranslation",{lang:d.data("lang"),mod:jQuery(".LangManagement "+a+" #mods_list").data("target")?jQuery(".LangManagement "+a+" #mods_list").data("target"):jQuery(".LangManagement "+a+" #mods_list").val(),type:d.data("type"),langkey:b.data("langkey"),val:d.val(),is_new:d.hasClass("empty_value"),});d.removeClass("empty_value");c.progressIndicator({mode:"hide"})},deleteTranslation:function(f,a){var d=$(f.currentTarget);if(typeof f.currentTarget=="undefined"){d=f}var b=d.closest("tr");var c=$.progressIndicator({message:app.vtranslate("LBL_Loader"),position:a,blockInfo:{enabled:true}});Settings_Index_Js.registerSaveEvent("DeleteTranslation",{lang:$(".LangManagement #langs_list").val(),mod:$(".LangManagement "+a+" #mods_list").data("target")?$(".LangManagement "+a+" #mods_list").data("target"):$(".LangManagement "+a+" #mods_list").val(),langkey:b.data("langkey"),});c.progressIndicator({mode:"hide"});f=d.closest(".active");Settings_Index_Js.LoadEditLang(f)},initEvant:function(b){b.find("input[type=checkbox]").change(Settings_Index_Js.CheckboxChange);var a={title:app.vtranslate("LBL_AreYouSure"),trigger:"manual",placement:"left",html:"true",content:'<div class="popover_block"><button class="btn btn-danger deleteItem">'+app.vtranslate("LBL_YES")+'</button>   <button class="btn btn-warning pull-right cancel">'+app.vtranslate("Cancel")+"</button></div>"};var c={title:app.vtranslate("JS_ARE_YOU_SURE_TO_SET_AS_DEFAULT"),trigger:"manual",placement:"left",html:"true",content:'<div class="popover_block"><button class="btn btn-danger setDefaultItem">'+app.vtranslate("LBL_YES")+'</button>   <button class="btn btn-warning pull-right cancel">'+app.vtranslate("Cancel")+"</button></div>"};b.find("#deleteItemC").click(function(d){$(d.currentTarget).popover(a).popover("show");$(".popover_block .deleteItem").click(function(){Settings_Index_Js.DeleteLang(b,d);$(d.currentTarget).popover("hide")});$(".popover_block .cancel").click(function(){$(d.currentTarget).popover("hide")})});b.find("#setAsDefault").click(function(d){$(d.currentTarget).popover(c).popover("show");$(".popover_block .setDefaultItem").click(function(){$(d.currentTarget).popover("hide");Settings_Index_Js.setAsDefaultLang(b,d)});$(".popover_block .cancel").click(function(){$(d.currentTarget).popover("hide")})})},CheckboxChange:function(c){var b=$(c.currentTarget);var a=b.closest("tr");Settings_Index_Js.registerSaveEvent("save",{type:"Checkbox",name:b.data("name"),prefix:a.data("prefix"),val:b.is(":checked")})},ShowLangMondal:function(b){var a=$(b.currentTarget);$("#AddNewLangMondal").modal("show");$("#AddNewLangMondal").css("z-index","9999999")},ShowTranslationMondal:function(c){var d=$(".LangManagement #langs_list").val();var a="";$('#AddNewTranslationMondal input[name="langs"]').val(JSON.stringify(d));$.each(d,function(e){a+='<div class="form-group"><label class="col-md-4 control-label">'+d[e]+':</label><div class="col-md-8"><input name="'+d[e]+'" class="form-control" type="text" /></div></div>'});$("#AddNewTranslationMondal .add_translation_block").html(a);var b=$(c.currentTarget);$("#AddNewTranslationMondal").modal("show");$("#AddNewTranslationMondal").css("z-index","9999999")},AddLangMondal:function(c){var a=Settings_Index_Js.registerSaveEvent("add",{type:"Add",label:$("#AddNewLangMondal input[name='label']").val(),name:$("#AddNewLangMondal input[name='name']").val(),prefix:$("#AddNewLangMondal input[name='prefix']").val()});if(a.resp){$("#lang_list table tbody").append('<tr data-prefix="'+a.params.prefix+'"><td>'+a.params.label+"</td><td>"+a.params.name+"</td><td>"+a.params.prefix+'</td><td><button class="btn btn-danger" data-toggle="confirmation" data-original-title="" id="deleteItemC">'+app.vtranslate("Delete")+"</button></td></tr>");var b=$("#lang_list tr[data-prefix="+a.params.prefix+"]");Settings_Index_Js.initEvant(b);$("#AddNewLangMondal").modal("hide");$("#AddNewLangMondal input[name='label']").val("");$("#AddNewLangMondal input[name='name']").val("");$("#AddNewLangMondal input[name='prefix']").val("")}},AddTranslationMondal:function(c){var b=$(c.currentTarget);var a=Settings_Index_Js.registerSaveEvent("AddTranslation",{mod:$(".LangManagement #mods_list").val(),form_data:$("#AddTranslationForm").serializeFormData()});if(a.resp){$("#AddNewTranslationMondal").modal("hide");$("#AddNewTranslationMondal input[name='variable']").val("")}Settings_Index_Js.LoadEditLang(jQuery("#edit_lang"));c.preventDefault()},DeleteLang:function(a,b){Settings_Index_Js.registerSaveEvent("delete",{prefix:a.data("prefix")});a.hide()},setAsDefaultLang:function(c,f){var b=Settings_Index_Js.registerSaveEvent("setAsDefault",{prefix:c.data("prefix")});$(f.currentTarget).closest("td").find("#deleteItemC").remove();$(f.currentTarget).remove();var d=b.result.prefixOld;var a=c.closest("tbody");OldTrDefaultLang=a.find('tr[data-prefix="'+d+'"]');OldTrDefaultLang.find("td:last").prepend('<button class="btn btn-danger marginLeftZero" data-toggle="confirmation" data-original-title="" id="deleteItemC">'+app.vtranslate("Delete")+'</button> <button class="btn btn-primary marginLeftZero" data-toggle="confirmation" id="setAsDefault">'+app.vtranslate("JS_DEFAULT")+"</button>");Settings_Index_Js.initEvant(OldTrDefaultLang)},registerSaveEvent:function(e,b){var a="";var d="";var c={};c.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:e,params:b};c.async=false;c.dataType="json";AppConnector.request(c).then(function(f){a=f.result;var g={text:a.message,animation:"show"};if(a.success==true){g.type="info"}Vtiger_Helper_Js.showPnotify(g);d=a.success},function(g,f){});return{resp:d,params:c.data.params,result:a}},registerEvents:function(){Settings_Index_Js.initEvants()}};$(document).ready(function(){document.showDiff=false;Settings_Index_Js.registerEvents()});