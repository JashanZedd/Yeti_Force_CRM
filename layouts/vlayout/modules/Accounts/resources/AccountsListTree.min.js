
jQuery.Class("Accounts_AccountsListTree_Js",{},{modalContainer:false,moduleList:false,treeInstance:false,treeData:false,getContainer:function(){if(this.modalContainer==false){this.modalContainer=jQuery("#centerPanel")}return this.modalContainer},setContainer:function(a){this.modalContainer=a},getRecords:function(b){if(this.treeData==false&&b!="undefined"){var a=b.find("#treePopupValues").val();this.treeData=JSON.parse(a)}return this.treeData},generateTree:function(a){var b=this;b.treeInstance=a.find("#treeContents");b.treeInstance.jstree({core:{data:b.getRecords(a),themes:{name:"proton",responsive:true}},plugins:["checkbox",]})},registerModuleChangeEvent:function(b){var a=this;if(a.moduleList){return}b.on("change","#moduleList",function(f){var d=jQuery(f.currentTarget);var c=d.val();var g={mode:"showTree",selectedModule:c};a.getView(g).then(function(e){b.html(e);a.setContainer(b);a.registerEvents();app.changeSelectElementView(b.find("select"))})});a.moduleList=true},registerFilterChangeEvent:function(b){var a=this;b.on("change","#moduleFilter",function(g){var f=jQuery(g.currentTarget);var d=f.val();var c=[];$.each(a.treeInstance.jstree("get_selected",true),function(e,i){c.push(i.text)});var h={mode:"showAccountsList",selectedModule:b.find("#moduleList").val(),selectedFilter:d,selected:c,};a.getView(h).then(function(e){b.find("#accountsListContents").html(e)})})},getView:function(d){var c=this;var a=c.getContainer();var b=jQuery.Deferred();var e=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var f={module:app.getModuleName(),view:app.getViewName(),};if(d!=null){f=jQuery.extend(d,f)}AppConnector.request(f).then(function(g){e.progressIndicator({mode:"hide"});b.resolve(g)},function(g){e.progressIndicator({mode:"hide"});b.reject()});return b.promise()},registerSelectElement:function(a){var c=this;var b=a.find("#moduleList").val();c.treeInstance.on("changed.jstree",function(g,f){var d=[];$.each(c.treeInstance.jstree("get_selected",true),function(e,i){d.push(i.text)});var h={mode:"showAccountsList",selectedModule:a.find("#moduleList").val(),selectedFilter:a.find("#moduleFilter").val(),selected:d,};c.getView(h).then(function(e){a.find("#accountsListContents").html(e)})})},registerShowHideRightPanelEvent:function(a){a.find(".toggleSiteBarRightButton").click(function(f){var d=$(this).closest(".siteBarRight");var c=$(this).closest(".row").find(".rowContent");var b=$(this).find(".glyphicon");if(d.hasClass("col-md-4")){d.removeClass("col-md-4").addClass("hideSiteBar");c.removeClass("col-md-8").addClass("col-md-12");b.removeClass("glyphicon-chevron-right").addClass("glyphicon-chevron-left")}else{d.addClass("col-md-4").removeClass("hideSiteBar");c.addClass("col-md-8").removeClass("col-md-12");b.removeClass("glyphicon-chevron-left").addClass("glyphicon-chevron-right")}})},registerEvents:function(){var a=this.getContainer();this.getRecords(a);this.generateTree(a);this.registerModuleChangeEvent(a);this.registerFilterChangeEvent(a);this.registerSelectElement(a);this.registerShowHideRightPanelEvent(a);setTimeout(function(){var b=jQuery(".bodyContents").outerHeight();a.find(".siteBarRight").css("min-height",b+"px")},500)}});