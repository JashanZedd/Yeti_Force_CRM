
Vtiger_RelatedList_Js("Campaigns_RelatedList_Js",{triggerSendEmail:function(c,a){var b={relatedLoad:true,sourceModule:app.getModuleName(),sourceRecord:app.getRecordId(),relatedModule:jQuery(".relatedModuleName").val()};Vtiger_List_Js.triggerSendEmail(b)}},{loadRelatedList:function(c){var a=jQuery.Deferred();var b=this;this._super(c).then(function(g){b.registerEvents();var d=app.getModuleName();var e=d+"_List_Js";var f=new window[e]();f.registerEvents();a.resolve(g)});return a.promise()},getCompleteParams:function(){var a={};a.view="Detail";a.module=this.parentModuleName;a.record=this.getParentId(),a.relatedModule=this.relatedModulename,a.sortorder=this.getSortOrder(),a.orderby=this.getOrderBy(),a.page=this.getCurrentPageNum();a.mode="showRelatedList",a.selectedIds=jQuery("#selectedIds").data("selectedIds");a.excludedIds=jQuery("#excludedIds").data("excludedIds");return a},changeCustomFilterElementView:function(){var a=jQuery("#recordsFilter");if(a.length>0){app.showSelect2ElementView(a,{templateSelection:function(d){var c=jQuery("<span></span>");c.append(jQuery(jQuery(".filterImage").clone().get(0)).show());c.append(d.text);return c},customSortOptGroup:true,closeOnSelect:true});var b=a.data("select2");b.$dropdown.append(jQuery("span.filterActionsDiv"))}},registerChangeCustomFilterEvent:function(){var a=jQuery("#recordsFilter");a.change(function(c){var b=app.vtranslate("JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_ADD_THIS_FILTER");Vtiger_Helper_Js.showConfirmationBox({message:b}).then(function(){var e=jQuery(c.currentTarget);var d=e.find("option:selected").data("id");var h=jQuery(".relatedModuleName").val();var g={sourceRecord:jQuery("#recordId").val(),relatedModule:h,viewId:d,module:app.getModuleName(),action:"RelationAjax",mode:"addRelationsFromRelatedModuleViewId"};var f=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(g).then(function(i){f.progressIndicator({mode:"hide"});if(i!=null){var j=app.vtranslate("JS_NO_RECORDS_RELATED_TO_THIS_FILTER");var k={text:j,type:"info"};Vtiger_Helper_Js.showMessage(k)}else{Vtiger_Detail_Js.reloadRelatedList()}},function(j,i){})},function(d,e){})})},registerEventToEditRelatedStatus:function(){var b=this;jQuery(".currentStatus").on("click",function(d){d.stopImmediatePropagation();var c=jQuery(d.currentTarget);c.addClass("open")});var a=jQuery(".currentStatus").find(".dropdown-menu");a.on("click","a",function(j){j.stopImmediatePropagation();var g=jQuery(j.currentTarget);var h=g.closest("li");var f=g.closest(".currentStatus");var d=h.attr("id");var c=h.data("status");var i=g.closest("tr").data("id");var k={relatedModule:b.relatedModulename,relatedRecord:i,status:d,module:app.getModuleName(),action:"RelationAjax",sourceRecord:b.parentRecordId,mode:"updateStatus"};g.progressIndicator({});AppConnector.request(k).then(function(e){if(e.result[0]){g.progressIndicator({mode:"hide"});f.find(".statusValue").text(c);f.removeClass("open")}},function(l,e){})})},registerEvents:function(){this.changeCustomFilterElementView();this.registerChangeCustomFilterEvent();this.registerEventToEditRelatedStatus()}});