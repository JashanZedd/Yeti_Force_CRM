
Inventory_Edit_Js("SalesOrder_Edit_Js",{},{addressFieldsMappingBlockID:{LBL_ADDRESS_INFORMATION:"a",LBL_ADDRESS_DELIVERY_INFORMATION:"b"},registerReferenceSelectionEvent:function(a){this._super(a);var b=this;jQuery('input[name="account_id"]',a).on(Vtiger_Edit_Js.referenceSelectionEvent,function(d,c){})},getPopUpParams:function(a){var f=this._super(a);var d=jQuery('input[class="sourceField"]',a);if(d.attr("name")=="contact_id"||d.attr("name")=="potential_id"){var c=this.getForm();var e=c.find('[name="account_id"]');if(e.length>0&&e.val().length>0&&e.val()!=0){var b=e.closest(".fieldValue");f.related_parent_id=e.val();f.related_parent_module=b.find('[name="popupReferenceModule"]').val()}else{if(d.attr("name")=="potential_id"){e=c.find('[name="contact_id"]');if(e.length>0&&e.val().length>0){b=e.closest(".fieldValue");f.related_parent_id=e.val();f.related_parent_module=b.find('[name="popupReferenceModule"]').val()}}}}return f},searchModuleNames:function(e){var a=jQuery.Deferred();if(typeof e.module=="undefined"){e.module=app.getModuleName()}if(typeof e.action=="undefined"){e.action="BasicAjax"}if(e.search_module=="Contacts"||e.search_module=="Potentials"){var c=this.getForm();var d=c.find('[name="account_id"]');if(d.length>0&&d.val().length>0){var b=d.closest(".fieldValue");e.parent_id=d.val();e.parent_module=b.find('[name="popupReferenceModule"]').val()}else{if(e.search_module=="Potentials"){d=c.find('[name="contact_id"]');if(d.length>0&&d.val().length>0){b=d.closest(".fieldValue");e.parent_id=d.val();e.parent_module=b.find('[name="popupReferenceModule"]').val()}}}}else{if(e.search_module=="Products"||e.search_module=="Services"){e.potentialid=jQuery('[name="potential_id"]').val()}}AppConnector.request(e).then(function(f){a.resolve(f)},function(f){a.reject()});return a.promise()},registerEventForEnablingRecurrence:function(){var b=this;var a=this.getForm();var d=a.find('[name="enable_recurring"]');var c=new Array("recurring_frequency","start_period","end_period","payment_duration","invoicestatus");d.on("change",function(g){var f=jQuery(g.currentTarget);var h;if(f.is(":checked")){h=true}else{h=false}if(h){a.validationEngine("detach");b.AddOrRemoveRequiredValidation(c,h);a.validationEngine(app.validationEngineOptionsForRecord);b.registerSubmitEvent()}else{b.AddOrRemoveRequiredValidation(c,h)}});if(!d.is(":checked")){b.AddOrRemoveRequiredValidation(c,false)}else{if(d.is(":checked")){b.AddOrRemoveRequiredValidation(c,true)}}},AddOrRemoveRequiredValidation:function(a,c){var b=this.getForm();jQuery(a).each(function(e,g){var f=b.find('[name="'+g+'"]');if(c){var d=f.attr("data-validation-engine");if(d.indexOf("[f")>0){f.attr("data-validation-engine","validate[required,funcCall[Vtiger_Base_Validator_Js.invokeValidation]]")}if(f.is("select")){f.attr("disabled",false).trigger("chosen:updated")}else{f.removeAttr("disabled")}}else{if(!c){if(f.is("select")){f.attr("disabled",true).trigger("chosen:updated")}else{f.attr("disabled","disabled")}f.validationEngine("hide");if(f.is("select")&&f.hasClass("chzn-select")){var h=f.closest(".fieldValue");h.find(".chzn-container").validationEngine("hide")}}}})},mapResultsToFields:function(m,i,e){var q=jQuery(i).closest("tr."+this.rowClass);if(m=="Calculations"){var a=jQuery("input.calculation",q)}else{var a=jQuery("input.productName",q)}for(var c in e){var g=c;var b=e[c];var h=b.name;var l=b.listprice;var k=b.usageunit;var d=b.listpricevalues;var j=b.taxes;if(m=="Products"){q.data("quantity-in-stock",b.quantityInStock)}var o=b.description;a.val(h);a.attr("disabled","disabled");if(m=="Calculations"){jQuery("input.selectedModuleIdC",q).val(g);jQuery("input.lineItemTypeC",q).val(m)}else{jQuery("input.selectedModuleId",q).val(g);jQuery("input.lineItemType",q).val(m);jQuery("input.listPrice",q).val(l);jQuery("span.usageUnit",q).text(k);var n=jQuery("#currency_id").val();var f=JSON.stringify(d);if(typeof d[n]!="undefined"){this.setListPriceValue(q,d[n]);this.lineItemRowCalculations(q)}jQuery("input.listPrice",q).attr("list-info",f);jQuery("textarea.lineItemCommentBox",q).val(o);var p=this.getTaxDiv(j,q);jQuery(".taxDivContainer",q).html(p);if(this.isIndividualTaxMode()){q.find(".productTaxTotal").removeClass("hide")}else{q.find(".productTaxTotal").addClass("hide")}}}if(m=="Products"){this.loadSubProducts(q)}if(m!="Calculations"){jQuery(".qty",q).trigger("focusout")}},registerClearLineItemSelection:function(){var b=this;var a=this.getLineItemContentsContainer();a.on("click",".clearLineItem",function(g){var f=jQuery(g.currentTarget);var c=f.closest(".fieldValue");var d=c.find(".selectedModuleIdC");if(d.length==1){c.find("input.calculation").removeAttr("disabled").val("");c.find("input.selectedModuleIdC").val("")}else{b.clearLineItemDetails(c);c.find("input.productName").removeAttr("disabled").val("")}g.preventDefault()})},registerEvents:function(){this._super();this.registerEventForEnablingRecurrence()}});